<!DOCTYPE html>
<!-- START: inst/pkgdown/templates/layout.html --><!-- Generated by pkgdown: do not edit by hand --><html lang="en" data-bs-theme="auto">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<title>Intermediate Research Software Development: All in One View</title>
<meta name="viewport" content="width=device-width, initial-scale=1">
<script src="../assets/themetoggle.js"></script><link rel="stylesheet" type="text/css" href="../assets/styles.css">
<script src="../assets/scripts.js" type="text/javascript"></script><!-- mathjax --><script type="text/x-mathjax-config">
    MathJax.Hub.Config({
      config: ["MMLorHTML.js"],
      jax: ["input/TeX","input/MathML","output/HTML-CSS","output/NativeMML", "output/PreviewHTML"],
      extensions: ["tex2jax.js","mml2jax.js","MathMenu.js","MathZoom.js", "fast-preview.js", "AssistiveMML.js", "a11y/accessibility-menu.js"],
      TeX: {
        extensions: ["AMSmath.js","AMSsymbols.js","noErrors.js","noUndefined.js"]
      },
      tex2jax: {
        inlineMath: [['\\(', '\\)']],
        displayMath: [ ['$$','$$'], ['\\[', '\\]'] ],
        processEscapes: true
      }
    });
    </script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><!-- Responsive Favicon for The Carpentries --><link rel="apple-touch-icon" sizes="180x180" href="../favicons/incubator/apple-touch-icon.png">
<link rel="icon" type="image/png" sizes="32x32" href="../favicons/incubator/favicon-32x32.png">
<link rel="icon" type="image/png" sizes="16x16" href="../favicons/incubator/favicon-16x16.png">
<link rel="manifest" href="../favicons/incubator/site.webmanifest">
<link rel="mask-icon" href="../favicons/incubator/safari-pinned-tab.svg" color="#5bbad5">
<meta name="msapplication-TileColor" content="#da532c">
<meta name="theme-color" media="(prefers-color-scheme: light)" content="white">
<meta name="theme-color" media="(prefers-color-scheme: dark)" content="black">
</head>
<body>
    <header id="top" class="navbar navbar-expand-md top-nav incubator"><svg xmlns="http://www.w3.org/2000/svg" class="d-none"><symbol id="check2" viewbox="0 0 16 16"><path d="M13.854 3.646a.5.5 0 0 1 0 .708l-7 7a.5.5 0 0 1-.708 0l-3.5-3.5a.5.5 0 1 1 .708-.708L6.5 10.293l6.646-6.647a.5.5 0 0 1 .708 0z"></path></symbol><symbol id="circle-half" viewbox="0 0 16 16"><path d="M8 15A7 7 0 1 0 8 1v14zm0 1A8 8 0 1 1 8 0a8 8 0 0 1 0 16z"></path></symbol><symbol id="moon-stars-fill" viewbox="0 0 16 16"><path d="M6 .278a.768.768 0 0 1 .08.858 7.208 7.208 0 0 0-.878 3.46c0 4.021 3.278 7.277 7.318 7.277.527 0 1.04-.055 1.533-.16a.787.787 0 0 1 .81.316.733.733 0 0 1-.031.893A8.349 8.349 0 0 1 8.344 16C3.734 16 0 12.286 0 7.71 0 4.266 2.114 1.312 5.124.06A.752.752 0 0 1 6 .278z"></path><path d="M10.794 3.148a.217.217 0 0 1 .412 0l.387 1.162c.173.518.579.924 1.097 1.097l1.162.387a.217.217 0 0 1 0 .412l-1.162.387a1.734 1.734 0 0 0-1.097 1.097l-.387 1.162a.217.217 0 0 1-.412 0l-.387-1.162A1.734 1.734 0 0 0 9.31 6.593l-1.162-.387a.217.217 0 0 1 0-.412l1.162-.387a1.734 1.734 0 0 0 1.097-1.097l.387-1.162zM13.863.099a.145.145 0 0 1 .274 0l.258.774c.115.346.386.617.732.732l.774.258a.145.145 0 0 1 0 .274l-.774.258a1.156 1.156 0 0 0-.732.732l-.258.774a.145.145 0 0 1-.274 0l-.258-.774a1.156 1.156 0 0 0-.732-.732l-.774-.258a.145.145 0 0 1 0-.274l.774-.258c.346-.115.617-.386.732-.732L13.863.1z"></path></symbol><symbol id="sun-fill" viewbox="0 0 16 16"><path d="M8 12a4 4 0 1 0 0-8 4 4 0 0 0 0 8zM8 0a.5.5 0 0 1 .5.5v2a.5.5 0 0 1-1 0v-2A.5.5 0 0 1 8 0zm0 13a.5.5 0 0 1 .5.5v2a.5.5 0 0 1-1 0v-2A.5.5 0 0 1 8 13zm8-5a.5.5 0 0 1-.5.5h-2a.5.5 0 0 1 0-1h2a.5.5 0 0 1 .5.5zM3 8a.5.5 0 0 1-.5.5h-2a.5.5 0 0 1 0-1h2A.5.5 0 0 1 3 8zm10.657-5.657a.5.5 0 0 1 0 .707l-1.414 1.415a.5.5 0 1 1-.707-.708l1.414-1.414a.5.5 0 0 1 .707 0zm-9.193 9.193a.5.5 0 0 1 0 .707L3.05 13.657a.5.5 0 0 1-.707-.707l1.414-1.414a.5.5 0 0 1 .707 0zm9.193 2.121a.5.5 0 0 1-.707 0l-1.414-1.414a.5.5 0 0 1 .707-.707l1.414 1.414a.5.5 0 0 1 0 .707zM4.464 4.465a.5.5 0 0 1-.707 0L2.343 3.05a.5.5 0 1 1 .707-.707l1.414 1.414a.5.5 0 0 1 0 .708z"></path></symbol></svg><a class="visually-hidden-focusable skip-link" href="#main-content">Skip to main content</a>
  <div class="container-fluid top-nav-container">
    <div class="col-md-8">
      <div class="large-logo">
        <img id="incubator-logo" alt="Lesson Description" src="../assets/images/incubator-logo.svg"><span class="badge text-bg-info">
          <abbr title="This lesson is in the beta phase, which means that it is ready for teaching by instructors outside of the original author team.">
            <a href="https://docs.carpentries.org/resources/curriculum/lesson-life-cycle.html" class="external-link alert-link">
              <i aria-hidden="true" class="icon" data-feather="alert-circle" style="border-radius: 5px"></i>
              Beta
            </a>
            <span class="visually-hidden">This lesson is in the beta phase, which means that it is ready for teaching by instructors outside of the original author team.</span>
          </abbr>
        </span>

      </div>
    </div>
    <div class="selector-container">
      <div id="theme-selector">
        <li class="nav-item dropdown" id="theme-button-list">
          <button class="btn btn-link nav-link px-0 px-lg-2 dropdown-toggle d-flex align-items-center" id="bd-theme" type="button" aria-expanded="false" data-bs-toggle="dropdown" data-bs-display="static" aria-label="Toggle theme (auto)">
            <svg class="bi my-1 theme-icon-active"><use href="#circle-half"></use></svg><i data-feather="chevron-down"></i>
          </button>
          <ul class="dropdown-menu dropdown-menu-end" aria-labelledby="bd-theme-text">
<li>
              <button type="button" class="btn dropdown-item d-flex align-items-center" data-bs-theme-value="light" aria-pressed="false">
                <svg class="bi me-2 theme-icon"><use href="#sun-fill"></use></svg>
                Light
                <svg class="bi ms-auto d-none"><use href="#check2"></use></svg></button>
            </li>
            <li>
              <button type="button" class="btn dropdown-item d-flex align-items-center" data-bs-theme-value="dark" aria-pressed="false">
                <svg class="bi me-2 theme-icon"><use href="#moon-stars-fill"></use></svg>
                Dark
                <svg class="bi ms-auto d-none"><use href="#check2"></use></svg></button>
            </li>
            <li>
              <button type="button" class="btn dropdown-item d-flex align-items-center active" data-bs-theme-value="auto" aria-pressed="true">
                <svg class="bi me-2 theme-icon"><use href="#circle-half"></use></svg>
                Auto
                <svg class="bi ms-auto d-none"><use href="#check2"></use></svg></button>
            </li>
          </ul>
</li>
      </div>

      <div class="dropdown" id="instructor-dropdown">
        <button class="btn btn-secondary dropdown-toggle bordered-button" type="button" id="dropdownMenu1" data-bs-toggle="dropdown" aria-expanded="false">
          <i aria-hidden="true" class="icon" data-feather="eye"></i> Instructor View <i data-feather="chevron-down"></i>
        </button>
        <ul class="dropdown-menu" aria-labelledby="dropdownMenu1">
<li><button class="dropdown-item" type="button" onclick="window.location.href='../aio.html';">Learner View</button></li>
        </ul>
</div>
    </div>
  </div>
  <hr></header><nav class="navbar navbar-expand-xl bottom-nav incubator" aria-label="Main Navigation"><div class="container-fluid nav-container">
    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbarSupportedContent" aria-controls="navbarSupportedContent" aria-expanded="false" aria-label="Toggle Navigation">
      <span class="navbar-toggler-icon"></span>
      <span class="menu-title">Menu</span>
    </button>
    <div class="nav-logo">
      <img class="small-logo" alt="Lesson Description" src="../assets/images/incubator-logo-sm.svg">
</div>
    <div class="lesson-title-md">
      Intermediate Research Software Development
    </div>
    <div class="search-icon-sm">
      <!-- TODO: do not show until we have search
        <i role="img" aria-label="Search the All In One page" data-feather="search"></i>
      -->
    </div>
    <div class="desktop-nav">
      <ul class="navbar-nav me-auto mb-2 mb-lg-0">
<li class="nav-item">
          <span class="lesson-title">
            Intermediate Research Software Development
          </span>
        </li>
        <li class="nav-item">
          <a class="nav-link" href="../instructor/key-points.html">Key Points</a>
        </li>
        <li class="nav-item">
          <a class="nav-link" href="../instructor/instructor-notes.html">Instructor Notes</a>
        </li>
        <li class="nav-item">
          <a class="nav-link" href="../instructor/images.html">Extract All Images</a>
        </li>
        <li class="nav-item dropdown">
          <button class="nav-link dropdown-toggle" id="navbarDropdown" data-bs-toggle="dropdown" aria-expanded="false">
            More <i data-feather="chevron-down"></i>
          </button>
          <ul class="dropdown-menu" aria-labelledby="navbarDropdown">
<hr>
<li><a class="dropdown-item" href="quiz.html">Quiz</a></li>
<li><a class="dropdown-item" href="installation-instructions.html">Installation Instructions</a></li>
<li><a class="dropdown-item" href="common-issues.html">Common Issues, Fixes &amp; Tips</a></li>
<li><a class="dropdown-item" href="software-architecture-extra.html">Extra Content: Software Architecture</a></li>
<li><a class="dropdown-item" href="programming-paradigms.html">Extra Content: Programming Paradigms</a></li>
<li><a class="dropdown-item" href="procedural-programming.html">Extra Content: Procedural Programming</a></li>
<li><a class="dropdown-item" href="functional-programming.html">Extra Content: Functional Programming</a></li>
<li><a class="dropdown-item" href="object-oriented-programming.html">Extra Content: Object Oriented Programming</a></li>
<li><a class="dropdown-item" href="persistence.html">Extra Content: Persistence</a></li>
<li><a class="dropdown-item" href="databases.html">Extra Content: Databases</a></li>
<li><a class="dropdown-item" href="vscode.html">Extra Content: Using Microsoft Visual Studio Code</a></li>
<li><a class="dropdown-item" href="reference.html">Reference</a></li>
          </ul>
</li>
      </ul>
</div>
    <!--
    <form class="d-flex col-md-2 search-form">
      <fieldset disabled>
      <input class="form-control me-2 searchbox" type="search" placeholder="" aria-label="">
        <button class="btn btn-outline-success tablet-search-button"  type="submit">
          <i class="search-icon" data-feather="search" role="img" aria-label="Search the All In One page"></i>
        </button>
      </fieldset>
    </form>
    -->
    <a id="search-button" class="btn btn-primary" href="../instructor/aio.html" role="button" aria-label="Search the All In One page">Search the All In One page</a>
  </div>
<!--/div.container-fluid -->
</nav><div class="col-md-12 mobile-title">
  Intermediate Research Software Development
</div>

<aside class="col-md-12 lesson-progress"><div style="width: %" class="percentage">
    %
  </div>
  <div class="progress incubator">
    <div class="progress-bar incubator" role="progressbar" style="width: %" aria-valuenow="" aria-label="Lesson Progress" aria-valuemin="0" aria-valuemax="100">
    </div>
  </div>
</aside><div class="container">
      <div class="row">
        <!-- START: inst/pkgdown/templates/navbar.html -->
<div id="sidebar-col" class="col-lg-4">
  <div id="sidebar" class="sidebar">
      <nav aria-labelledby="flush-headingEleven"><button role="button" aria-label="close menu" alt="close menu" aria-expanded="true" aria-controls="sidebar" class="collapse-toggle" data-collapse="Collapse " data-episodes="Episodes ">
          <i class="search-icon" data-feather="x" role="img"></i>
        </button>
        <div class="sidebar-inner">
          <div class="row mobile-row" id="theme-row-mobile">
            <div class="col" id="theme-selector">
              <li class="nav-item dropdown" id="theme-button-list">
                <button class="btn btn-link nav-link px-0 px-lg-2 dropdown-toggle d-flex align-items-center" id="bd-theme" type="button" aria-expanded="false" data-bs-toggle="dropdown" data-bs-display="static" aria-label="Toggle theme (auto)">
                  <svg class="bi my-1 theme-icon-active"><use href="#circle-half"></use></svg><span class="d-lg-none ms-1" id="bd-theme-text">Toggle Theme</span>
                </button>
                <ul class="dropdown-menu dropdown-menu-right" aria-labelledby="bd-theme-text">
<li>
                    <button type="button" class="btn dropdown-item d-flex align-items-center" data-bs-theme-value="light" aria-pressed="false">
                      <svg class="bi me-2 theme-icon"><use href="#sun-fill"></use></svg>
                      Light
                      <svg class="bi ms-auto d-none"><use href="#check2"></use></svg></button>
                  </li>
                  <li>
                    <button type="button" class="btn dropdown-item d-flex align-items-center" data-bs-theme-value="dark" aria-pressed="false">
                      <svg class="bi me-2 theme-icon"><use href="#moon-stars-fill"></use></svg>
                      Dark
                      <svg class="bi ms-auto d-none"><use href="#check2"></use></svg></button>
                  </li>
                  <li>
                    <button type="button" class="btn dropdown-item d-flex align-items-center active" data-bs-theme-value="auto" aria-pressed="true">
                      <svg class="bi me-2 theme-icon"><use href="#circle-half"></use></svg>
                      Auto
                      <svg class="bi ms-auto d-none"><use href="#check2"></use></svg></button>
                  </li>
                </ul>
</li>
            </div>
          </div>
          <div class="row mobile-row">
            <div class="col">
              <div class="sidenav-view-selector">
                <div class="accordion accordion-flush" id="accordionFlush9">
                  <div class="accordion-item">
                    <h2 class="accordion-header" id="flush-headingNine">
                      <button class="accordion-button collapsed" id="instructor" type="button" data-bs-toggle="collapse" data-bs-target="#flush-collapseNine" aria-expanded="false" aria-controls="flush-collapseNine">
                        <i id="eye" aria-hidden="true" class="icon" data-feather="eye"></i> Instructor View
                      </button>
                    </h2>
                    <div id="flush-collapseNine" class="accordion-collapse collapse" aria-labelledby="flush-headingNine" data-bs-parent="#accordionFlush2">
                      <div class="accordion-body">
                        <a href="../aio.html">Learner View</a>
                      </div>
                    </div>
                  </div>
<!--/div.accordion-item-->
                </div>
<!--/div.accordion-flush-->
              </div>
<!--div.sidenav-view-selector -->
            </div>
<!--/div.col -->

            <hr>
</div>
<!--/div.mobile-row -->

          <div class="accordion accordion-flush" id="accordionFlush11">
            <div class="accordion-item">

              <button id="chapters" class="accordion-button show" type="button" data-bs-toggle="collapse" data-bs-target="#flush-collapseEleven" aria-expanded="false" aria-controls="flush-collapseEleven">
                <h2 class="accordion-header chapters" id="flush-headingEleven">
                  EPISODES
                </h2>
              </button>
              <div id="flush-collapseEleven" class="accordion-collapse show collapse" aria-labelledby="flush-headingEleven" data-bs-parent="#accordionFlush11">

                <div class="accordion-body">
                  <div class="accordion accordion-flush" id="accordionFlush1">
  <div class="accordion-item">
    <div class="accordion-header" id="flush-heading1">
        <a href="index.html">Summary and Schedule</a>
    </div>
<!--/div.accordion-header-->

  </div>
<!--/div.accordion-item-->
</div>
<!--/div.accordion-flush-->

<div class="accordion accordion-flush" id="accordionFlush2">
  <div class="accordion-item">
    <div class="accordion-header" id="flush-heading2">
        <a href="00-setting-the-scene.html">Setting the Scene</a>
    </div>
<!--/div.accordion-header-->

  </div>
<!--/div.accordion-item-->
</div>
<!--/div.accordion-flush-->

<div class="accordion accordion-flush" id="accordionFlush3">
  <div class="accordion-item">
    <div class="accordion-header" id="flush-heading3">
        <a href="10-section1-intro.html">Section 1: Setting Up Environment For Collaborative Code Development</a>
    </div>
<!--/div.accordion-header-->

  </div>
<!--/div.accordion-item-->
</div>
<!--/div.accordion-flush-->

<div class="accordion accordion-flush" id="accordionFlush4">
  <div class="accordion-item">
    <div class="accordion-header" id="flush-heading4">
        <a href="11-software-project.html">1.1 Introduction to Our Software Project</a>
    </div>
<!--/div.accordion-header-->

  </div>
<!--/div.accordion-item-->
</div>
<!--/div.accordion-flush-->

<div class="accordion accordion-flush" id="accordionFlush5">
  <div class="accordion-item">
    <div class="accordion-header" id="flush-heading5">
        <a href="12-virtual-environments.html">1.2 Virtual Environments For Software Development</a>
    </div>
<!--/div.accordion-header-->

  </div>
<!--/div.accordion-item-->
</div>
<!--/div.accordion-flush-->

<div class="accordion accordion-flush" id="accordionFlush6">
  <div class="accordion-item">
    <div class="accordion-header" id="flush-heading6">
        <a href="13-ides.html">1.3 Integrated Software Development Environments</a>
    </div>
<!--/div.accordion-header-->

  </div>
<!--/div.accordion-item-->
</div>
<!--/div.accordion-flush-->

<div class="accordion accordion-flush" id="accordionFlush7">
  <div class="accordion-item">
    <div class="accordion-header" id="flush-heading7">
        <a href="14-collaboration-using-git.html">1.4 Software Development Using Git and GitHub</a>
    </div>
<!--/div.accordion-header-->

  </div>
<!--/div.accordion-item-->
</div>
<!--/div.accordion-flush-->

<div class="accordion accordion-flush" id="accordionFlush8">
  <div class="accordion-item">
    <div class="accordion-header" id="flush-heading8">
        <a href="15-coding-conventions.html">1.5 Python Code Style Conventions</a>
    </div>
<!--/div.accordion-header-->

  </div>
<!--/div.accordion-item-->
</div>
<!--/div.accordion-flush-->

<div class="accordion accordion-flush" id="accordionFlush9">
  <div class="accordion-item">
    <div class="accordion-header" id="flush-heading9">
        <a href="16-verifying-code-style-linters.html">1.6 Verifying Code Style Using Linters</a>
    </div>
<!--/div.accordion-header-->

  </div>
<!--/div.accordion-item-->
</div>
<!--/div.accordion-flush-->

<div class="accordion accordion-flush" id="accordionFlush10">
  <div class="accordion-item">
    <div class="accordion-header" id="flush-heading10">
        <a href="17-section1-optional-exercises.html">1.7 Optional Exercises</a>
    </div>
<!--/div.accordion-header-->

  </div>
<!--/div.accordion-item-->
</div>
<!--/div.accordion-flush-->

<div class="accordion accordion-flush" id="accordionFlush11">
  <div class="accordion-item">
    <div class="accordion-header" id="flush-heading11">
        <a href="20-section2-intro.html">Section 2: Ensuring Correctness of Software at Scale</a>
    </div>
<!--/div.accordion-header-->

  </div>
<!--/div.accordion-item-->
</div>
<!--/div.accordion-flush-->

<div class="accordion accordion-flush" id="accordionFlush12">
  <div class="accordion-item">
    <div class="accordion-header" id="flush-heading12">
        <a href="21-automatically-testing-software.html">2.1 Automatically Testing Software</a>
    </div>
<!--/div.accordion-header-->

  </div>
<!--/div.accordion-item-->
</div>
<!--/div.accordion-flush-->

<div class="accordion accordion-flush" id="accordionFlush13">
  <div class="accordion-item">
    <div class="accordion-header" id="flush-heading13">
        <a href="22-scaling-up-unit-testing.html">2.2 Scaling Up Unit Testing</a>
    </div>
<!--/div.accordion-header-->

  </div>
<!--/div.accordion-item-->
</div>
<!--/div.accordion-flush-->

<div class="accordion accordion-flush" id="accordionFlush14">
  <div class="accordion-item">
    <div class="accordion-header" id="flush-heading14">
        <a href="23-continuous-integration-automated-testing.html">2.3 Continuous Integration for Automated Testing</a>
    </div>
<!--/div.accordion-header-->

  </div>
<!--/div.accordion-item-->
</div>
<!--/div.accordion-flush-->

<div class="accordion accordion-flush" id="accordionFlush15">
  <div class="accordion-item">
    <div class="accordion-header" id="flush-heading15">
        <a href="24-diagnosing-issues-improving-robustness.html">2.4 Diagnosing Issues and Improving Robustness</a>
    </div>
<!--/div.accordion-header-->

  </div>
<!--/div.accordion-item-->
</div>
<!--/div.accordion-flush-->

<div class="accordion accordion-flush" id="accordionFlush16">
  <div class="accordion-item">
    <div class="accordion-header" id="flush-heading16">
        <a href="25-section2-optional-exercises.html">2.5 Optional Exercises for Section 2</a>
    </div>
<!--/div.accordion-header-->

  </div>
<!--/div.accordion-item-->
</div>
<!--/div.accordion-flush-->

<div class="accordion accordion-flush" id="accordionFlush17">
  <div class="accordion-item">
    <div class="accordion-header" id="flush-heading17">
        <a href="30-section3-intro.html">Section 3: Software Development as a Process</a>
    </div>
<!--/div.accordion-header-->

  </div>
<!--/div.accordion-item-->
</div>
<!--/div.accordion-flush-->

<div class="accordion accordion-flush" id="accordionFlush18">
  <div class="accordion-item">
    <div class="accordion-header" id="flush-heading18">
        <a href="31-software-requirements.html">3.1 Software Requirements</a>
    </div>
<!--/div.accordion-header-->

  </div>
<!--/div.accordion-item-->
</div>
<!--/div.accordion-flush-->

<div class="accordion accordion-flush" id="accordionFlush19">
  <div class="accordion-item">
    <div class="accordion-header" id="flush-heading19">
        <a href="32-software-architecture-design.html">3.2 Software Architecture and Design</a>
    </div>
<!--/div.accordion-header-->

  </div>
<!--/div.accordion-item-->
</div>
<!--/div.accordion-flush-->

<div class="accordion accordion-flush" id="accordionFlush20">
  <div class="accordion-item">
    <div class="accordion-header" id="flush-heading20">
        <a href="33-code-decoupling-abstractions.html">3.3 Code Decoupling &amp; Abstractions</a>
    </div>
<!--/div.accordion-header-->

  </div>
<!--/div.accordion-item-->
</div>
<!--/div.accordion-flush-->

<div class="accordion accordion-flush" id="accordionFlush21">
  <div class="accordion-item">
    <div class="accordion-header" id="flush-heading21">
        <a href="34-code-refactoring.html">3.4 Code Refactoring</a>
    </div>
<!--/div.accordion-header-->

  </div>
<!--/div.accordion-item-->
</div>
<!--/div.accordion-flush-->

<div class="accordion accordion-flush" id="accordionFlush22">
  <div class="accordion-item">
    <div class="accordion-header" id="flush-heading22">
        <a href="35-software-architecture-revisited.html">3.5 Software Architecture Revisited</a>
    </div>
<!--/div.accordion-header-->

  </div>
<!--/div.accordion-item-->
</div>
<!--/div.accordion-flush-->

<div class="accordion accordion-flush" id="accordionFlush23">
  <div class="accordion-item">
    <div class="accordion-header" id="flush-heading23">
        <a href="40-section4-intro.html">Section 4: Collaborative Software Development for Reuse</a>
    </div>
<!--/div.accordion-header-->

  </div>
<!--/div.accordion-item-->
</div>
<!--/div.accordion-flush-->

<div class="accordion accordion-flush" id="accordionFlush24">
  <div class="accordion-item">
    <div class="accordion-header" id="flush-heading24">
        <a href="41-code-review.html">4.1 Developing Software In a Team: Code Review</a>
    </div>
<!--/div.accordion-header-->

  </div>
<!--/div.accordion-item-->
</div>
<!--/div.accordion-flush-->

<div class="accordion accordion-flush" id="accordionFlush25">
  <div class="accordion-item">
    <div class="accordion-header" id="flush-heading25">
        <a href="42-software-reuse.html">4.2 Preparing Software for Reuse and Release</a>
    </div>
<!--/div.accordion-header-->

  </div>
<!--/div.accordion-item-->
</div>
<!--/div.accordion-flush-->

<div class="accordion accordion-flush" id="accordionFlush26">
  <div class="accordion-item">
    <div class="accordion-header" id="flush-heading26">
        <a href="43-software-release.html">4.3 Packaging Code for Release and Distribution</a>
    </div>
<!--/div.accordion-header-->

  </div>
<!--/div.accordion-item-->
</div>
<!--/div.accordion-flush-->

<div class="accordion accordion-flush" id="accordionFlush27">
  <div class="accordion-item">
    <div class="accordion-header" id="flush-heading27">
        <a href="50-section5-intro.html">Section 5: Managing and Improving Software Over Its Lifetime</a>
    </div>
<!--/div.accordion-header-->

  </div>
<!--/div.accordion-item-->
</div>
<!--/div.accordion-flush-->

<div class="accordion accordion-flush" id="accordionFlush28">
  <div class="accordion-item">
    <div class="accordion-header" id="flush-heading28">
        <a href="51-managing-software.html">5.1 Managing a Collaborative Software Project</a>
    </div>
<!--/div.accordion-header-->

  </div>
<!--/div.accordion-item-->
</div>
<!--/div.accordion-flush-->

<div class="accordion accordion-flush" id="accordionFlush29">
  <div class="accordion-item">
    <div class="accordion-header" id="flush-heading29">
        <a href="52-assessing-software-suitability-improvement.html">5.2 Assessing Software for Suitability and Improvement</a>
    </div>
<!--/div.accordion-header-->

  </div>
<!--/div.accordion-item-->
</div>
<!--/div.accordion-flush-->

<div class="accordion accordion-flush" id="accordionFlush30">
  <div class="accordion-item">
    <div class="accordion-header" id="flush-heading30">
        <a href="53-improvement-through-feedback.html">5.3 Software Improvement Through Feedback</a>
    </div>
<!--/div.accordion-header-->

  </div>
<!--/div.accordion-item-->
</div>
<!--/div.accordion-flush-->

<div class="accordion accordion-flush" id="accordionFlush31">
  <div class="accordion-item">
    <div class="accordion-header" id="flush-heading31">
        <a href="60-wrap-up.html">Wrap-up</a>
    </div>
<!--/div.accordion-header-->

  </div>
<!--/div.accordion-item-->
</div>
<!--/div.accordion-flush-->

                </div>
              </div>
            </div>

            <hr class="half-width">
<div class="accordion accordion-flush lesson-resources" id="accordionFlush12">
              <div class="accordion-item">
                <h2 class="accordion-header" id="flush-headingTwelve">
                  <button class="accordion-button collapsed" id="lesson-resources" type="button" data-bs-toggle="collapse" data-bs-target="#flush-collapseTwelve" aria-expanded="false" aria-controls="flush-collapseTwelve">
                    RESOURCES
                  </button>
                </h2>
                <div id="flush-collapseTwelve" class="accordion-collapse collapse" aria-labelledby="flush-headingTwelve" data-bs-parent="#accordionFlush12">
                  <div class="accordion-body">
                    <ul>
<li>
                        <a href="../instructor/key-points.html">Key Points</a>
                      </li>
                      <li>
                        <a href="../instructor/instructor-notes.html">Instructor Notes</a>
                      </li>
                      <li>
                        <a href="../instructor/images.html">Extract All Images</a>
                      </li>
                      <hr>
<li><a class="dropdown-item" href="quiz.html">Quiz</a></li>
<li><a class="dropdown-item" href="installation-instructions.html">Installation Instructions</a></li>
<li><a class="dropdown-item" href="common-issues.html">Common Issues, Fixes &amp; Tips</a></li>
<li><a class="dropdown-item" href="software-architecture-extra.html">Extra Content: Software Architecture</a></li>
<li><a class="dropdown-item" href="programming-paradigms.html">Extra Content: Programming Paradigms</a></li>
<li><a class="dropdown-item" href="procedural-programming.html">Extra Content: Procedural Programming</a></li>
<li><a class="dropdown-item" href="functional-programming.html">Extra Content: Functional Programming</a></li>
<li><a class="dropdown-item" href="object-oriented-programming.html">Extra Content: Object Oriented Programming</a></li>
<li><a class="dropdown-item" href="persistence.html">Extra Content: Persistence</a></li>
<li><a class="dropdown-item" href="databases.html">Extra Content: Databases</a></li>
<li><a class="dropdown-item" href="vscode.html">Extra Content: Using Microsoft Visual Studio Code</a></li>
<li><a class="dropdown-item" href="reference.html">Reference</a></li>
                    </ul>
</div>
                </div>
              </div>
            </div>
            <hr class="half-width lesson-resources">
<a href="../instructor/aio.html">See all in one page</a>


            <hr class="d-none d-sm-block d-md-none">
<div class="d-grid gap-1">

            </div>
          </div>
<!-- /div.accordion -->
        </div>
<!-- /div.sidebar-inner -->
      </nav>
</div>
<!-- /div.sidebar -->
  </div>
<!-- /div.sidebar-col -->
<!-- END:   inst/pkgdown/templates/navbar.html-->

        <!-- START: inst/pkgdown/templates/content-extra.html -->
  <div class="col-xl-8 col-lg-12 primary-content">
    <main id="main-content" class="main-content"><div class="container lesson-content">
        
        
<section id="aio-00-setting-the-scene"><p>Content from <a href="00-setting-the-scene.html">Setting the Scene</a></p>
<hr>
<p>Last updated on 2024-12-06 |

        <a href="https://github.com/carpentries-incubator/python-intermediate-development/edit/main/episodes/00-setting-the-scene.md" class="external-link">Edit this page <i aria-hidden="true" data-feather="edit"></i></a></p>
<p>Estimated time: <i aria-hidden="true" data-feather="clock"></i> 15 minutes</p>
<div class="text-end">
          <button role="button" aria-pressed="false" tabindex="0" id="expand-code" class="pull-right" data-expand="Expand All Solutions " data-collapse="Collapse All Solutions "> Expand All Solutions <i aria-hidden="true" data-feather="plus"></i></button>
        </div>
<div class="overview card">
<h2 class="card-header">Overview</h2>
<div class="row g-0">
<div class="col-md-4">
<div class="card-body">
<div class="inner">
<h3 class="card-title">Questions</h3>
<ul>
<li>What are we teaching in this course?</li>
<li>What motivated the selection of topics covered in the course?</li>
</ul>
</div>
</div>
</div>
<div class="col-md-8">
<div class="card-body">
<div class="inner bordered">
<h3 class="card-title">Objectives</h3>
<ul>
<li>Setting the scene and expectations</li>
<li>Making sure everyone has all the necessary software installed</li>
</ul>
</div>
</div>
</div>
</div>
</div>
<section><h2 class="section-heading" id="introduction">Introduction<a class="anchor" aria-label="anchor" href="#introduction"></a>
</h2>
<hr class="half-width">
<p>So, you have gained basic software development skills either by
self-learning or attending, e.g., a <a href="https://software-carpentry.org/lessons/" class="external-link">novice Software Carpentry
course</a>. You have been applying those skills for a while by writing
code to help with your work and you feel comfortable developing code and
troubleshooting problems. However, your software has now reached a point
where there is too much code to be kept in one script. Perhaps it is
involving more researchers (developers) and users, and more
collaborative development effort is needed to add new functionality
while ensuring previous development efforts remain functional and
maintainable.</p>
<p>This course provides the next step in software development - it
teaches some <strong>intermediate software engineering skills and best
practices</strong> to help you restructure existing code and design more
robust, reusable and maintainable code, automate the process of testing
and verifying software correctness and support collaborations with
others in a way that mimics a typical software development process
within a team.</p>
<p>The course uses a number of different <strong>software development
tools and techniques</strong> interchangeably as you would in a real
life. We had to make some choices about topics and tools to teach here,
based on established best practices, ease of tool installation for the
audience, length of the course and other considerations. Tools used here
are not mandated though: alternatives exist and we point some of them
out along the way. Over time, you will develop a preference for certain
tools and programming languages based on your personal taste or based on
what is commonly used by your group, collaborators or community.
However, the topics covered should give you a solid foundation for
working on software development in a team and producing high quality
software that is easier to develop and sustain in the future by yourself
and others. Skills and tools taught here, while Python-specific, are
transferable to other similar tools and programming languages.</p>
<p>The course is organised into the following sections:</p>
<figure><img src="../fig/course-overview.svg" alt="Course overview diagram. Arrows connect the following boxed text in order: 1) Setting up software environment 2) Verifying software correctness 3) Software development as a process 4) Collaborative development for reuse 5) Managing software over its lifetime." class="figure mx-auto d-block"><div class="figcaption">Course overview diagram</div>
</figure><!---
Source of the above image can be rendered in the Mermaid live editor:
<https://mermaid.live/edit#pako:eNpdkE1rwzAMhv-K8CmFNrCvSw6D9eO2XlbYYeSiJXJqcKwgKyml9L_PaZox5pOQn8ey3oupuCZTGOv5VB1RFN4_ygDpvGUPORxI1YUG-m5qRrZ6QiGgMDjh0FLQBZRhtXqFdfaYwyeJs-ek_OMrFqFKA8U485vsKQ2YgZoG8tyND8LkYgSETrganUnZZs85bNh7_GZBdQPd2b-2ZQGhPtJd2mUvOewxYDNu8vujSeSBBJxG8M6SupYWZmlakhZdnWK5jFRp9EgtlaZIZU0We6-lKcM1odgrH86hMoVKT0vTdzUqbR02gq0pLPqYulQ7ZdlPUd8Sn8nd7Wa2OwxfzLN3_QE4H4oo>

The mermaid source is (with one less dash in arrows than needed):

```mermaid
flowchart LR
  A(1. Setting up software environment) -> B(2. Verifying software correctness)
  B -> C(3. Software development as a process)
  C -> D(4. Collaborative development for reuse)
  D -> E(5. Managing software over its lifetime)
```
--><div class="section level3">
<h3 id="section-1-setting-up-software-environment">
<a href="10-section1-intro.html">Section 1: Setting up Software
Environment</a><a class="anchor" aria-label="anchor" href="#section-1-setting-up-software-environment"></a>
</h3>
<p>In the first section we are going to set up our working environment
and familiarise ourselves with various tools and techniques for software
development in a typical collaborative code development cycle:</p>
<ul>
<li>
<strong>Virtual environments</strong> for <strong>isolating a
project</strong> from other projects developed on the same machine</li>
<li>
<strong>Command line</strong> for running code and interacting with
the <strong>command line tool Git</strong> for</li>
<li>
<strong>Integrated Development Environment</strong> for <strong>code
development, testing and debugging</strong>, <strong>Version
control</strong> and using code branches to develop new features in
parallel,</li>
<li>
<strong>GitHub</strong> (central and remote source code management
platform supporting version control with Git) for <strong>code backup,
sharing and collaborative development</strong>, and</li>
<li>
<strong>Python code style guidelines</strong> to make sure our code
is <strong>documented, readable and consistently
formatted</strong>.</li>
</ul>
</div>
<div class="section level3">
<h3 id="section-2-verifying-software-correctness-at-scale">
<a href="20-section2-intro.html">Section 2: Verifying Software
Correctness at Scale</a><a class="anchor" aria-label="anchor" href="#section-2-verifying-software-correctness-at-scale"></a>
</h3>
<p>Once we know our way around different code development tools,
techniques and conventions, in this section we learn:</p>
<ul>
<li>how to set up a <strong>test framework</strong> and write tests to
verify the behaviour of our code is correct, and</li>
<li>how to automate and scale testing with <strong>Continuous
Integration (CI)</strong> using <strong>GitHub Actions</strong> (a CI
service available on GitHub).</li>
</ul>
</div>
<div class="section level3">
<h3 id="section-3-software-development-as-a-process">
<a href="30-section3-intro.html">Section 3: Software Development as
a Process</a><a class="anchor" aria-label="anchor" href="#section-3-software-development-as-a-process"></a>
</h3>
<p>In this section, we step away from writing code for a bit to look at
software from a higher level as a process of development and its
components:</p>
<ul>
<li>different types of <strong>software requirements</strong> and
<strong>designing and architecting software</strong> to meet them, how
these fit within the larger <strong>software development
process</strong> and what we should consider when
<strong>testing</strong> against particular types of requirements.</li>
<li>different <strong>programming and software design
paradigms</strong>, each representing a slightly different way of
thinking about, structuring and <strong>implementing</strong> the
code.</li>
</ul>
</div>
<div class="section level3">
<h3 id="section-4-collaborative-software-development-for-reuse">
<a href="40-section4-intro.html">Section 4: Collaborative Software
Development for Reuse</a><a class="anchor" aria-label="anchor" href="#section-4-collaborative-software-development-for-reuse"></a>
</h3>
<p>Advancing from developing code as an individual, in this section you
will start working with your fellow learners on a group project (as you
would do when collaborating on a software project in a team), and
learn:</p>
<ul>
<li>how <strong>code review</strong> can help improve team software
contributions, identify wider codebase issues, and increase codebase
knowledge across a team.</li>
<li>what we can do to prepare our software for further development and
reuse, by adopting best practices in <strong>documenting</strong>,
<strong>licencing</strong>, <strong>tracking issues</strong>,
<strong>supporting</strong> your software, and <strong>packaging
software</strong> for release to others.</li>
</ul>
</div>
<div class="section level3">
<h3 id="section-5-managing-and-improving-software-over-its-lifetime">
<a href="50-section5-intro.html">Section 5: Managing and Improving
Software Over Its Lifetime</a><a class="anchor" aria-label="anchor" href="#section-5-managing-and-improving-software-over-its-lifetime"></a>
</h3>
<p>Finally, we move beyond just software development to managing a
collaborative software project and will look into:</p>
<ul>
<li>internal <strong>planning and prioritising tasks</strong> for future
development using agile techniques and effort estimation, management of
<strong>internal and external communication</strong>, and
<strong>software improvement</strong> through feedback.</li>
<li>how to adopt a critical mindset not just towards our own software
project but also to <strong>assess other people’s software to ensure it
is suitable</strong> for us to reuse, identify areas for improvement,
and how to use GitHub to register good quality issues with a particular
code repository.</li>
</ul>
</div>
</section><section><h2 class="section-heading" id="before-we-start">Before We Start<a class="anchor" aria-label="anchor" href="#before-we-start"></a>
</h2>
<hr class="half-width">
<p>A few notes before we start.</p>
<div id="prerequisite-knowledge" class="callout">
<div class="callout-square">
<i class="callout-icon" data-feather="bell"></i>
</div>
<div id="prerequisite-knowledge" class="callout-inner">
<h3 class="callout-title">Prerequisite Knowledge</h3>
<div class="callout-content">
<p>This is an intermediate-level software development course intended
for people who have already been developing code in Python (or other
languages) and applying it to their own problems after gaining basic
software development skills. So, it is expected for you to have some
prerequisite knowledge on the topics covered, as outlined at the <a href="index.html#prerequisites">beginning of the lesson</a>. Check out
this <a href="quiz.html">quiz</a> to help you test your prior knowledge
and determine if this course is for you.</p>
</div>
</div>
</div>
<div id="setup-common-issues-fixes" class="callout">
<div class="callout-square">
<i class="callout-icon" data-feather="bell"></i>
</div>
<div id="setup-common-issues-fixes" class="callout-inner">
<h3 class="callout-title">Setup, Common Issues &amp; Fixes</h3>
<div class="callout-content">
<p>Have you <a href="index.html#setup">setup and installed</a> all the tools
and accounts required for this course? Check the list of <a href="common-issues.html">common issues, fixes &amp; tips</a> if you
experience any problems running any of the tools you installed - your
issue may be solved there.</p>
</div>
</div>
</div>
<div id="compulsory-and-optional-exercises" class="callout">
<div class="callout-square">
<i class="callout-icon" data-feather="bell"></i>
</div>
<div id="compulsory-and-optional-exercises" class="callout-inner">
<h3 class="callout-title">Compulsory and Optional Exercises</h3>
<div class="callout-content">
<p>Exercises are a crucial part of this course and the narrative. They
are used to reinforce the points taught and give you an opportunity to
practice things on your own. Please do not be tempted to skip exercises
as that will get your local software project out of sync with the course
and break the narrative. Exercises that are clearly marked as “optional”
can be skipped without breaking things but we advise you to go through
them too, if time allows. All exercises contain solutions but, wherever
possible, try and work out a solution on your own.</p>
</div>
</div>
</div>
<div id="outdated-screenshots" class="callout">
<div class="callout-square">
<i class="callout-icon" data-feather="bell"></i>
</div>
<div id="outdated-screenshots" class="callout-inner">
<h3 class="callout-title">Outdated Screenshots</h3>
<div class="callout-content">
<p>Throughout this lesson we will make use and show content from
Graphical User Interface (GUI) tools (PyCharm and GitHub). These are
evolving tools and platforms, always adding new features and new visual
elements. Screenshots in the lesson may then become out-of-sync, refer
to or show content that no longer exists or is different to what you see
on your machine. If during the lesson you find screenshots that no
longer match what you see or have a big discrepancy with what you see,
please <a href="../%7B%7B%20site.github.repository_url%20%7D%7D/issues/new">open an
issue</a> describing what you see and how it differs from the lesson
content. Feel free to add as many screenshots as necessary to clarify
the issue.</p>
</div>
</div>
</div>
<div id="keypoints1" class="callout keypoints">
<div class="callout-square">
<i class="callout-icon" data-feather="key"></i>
</div>
<div class="callout-inner">
<h3 class="callout-title">Key Points</h3>
<div class="callout-content">
<ul>
<li>This lesson focuses on core, intermediate skills covering the whole
software development life-cycle that will be of most use to anyone
working collaboratively on code.</li>
<li>For code development in teams - you need more than just the right
tools and languages. You need a strategy (best practices) for how you’ll
use these tools as a team.</li>
<li>The lesson follows on from the novice Software Carpentry lesson, but
this is not a prerequisite for attending as long as you have some basic
Python, command line and Git skills and you have been using them for a
while to write code to help with your work.</li>
</ul>
</div>
</div>
</div>
</section></section><section id="aio-10-section1-intro"><p>Content from <a href="10-section1-intro.html">Section 1: Setting Up Environment For Collaborative Code Development</a></p>
<hr>
<p>Last updated on 2024-12-06 |

        <a href="https://github.com/carpentries-incubator/python-intermediate-development/edit/main/episodes/10-section1-intro.md" class="external-link">Edit this page <i aria-hidden="true" data-feather="edit"></i></a></p>
<p>Estimated time: <i aria-hidden="true" data-feather="clock"></i> 10 minutes</p>
<div class="text-end">
          <button role="button" aria-pressed="false" tabindex="0" id="expand-code" class="pull-right" data-expand="Expand All Solutions " data-collapse="Collapse All Solutions "> Expand All Solutions <i aria-hidden="true" data-feather="plus"></i></button>
        </div>
<div class="overview card">
<h2 class="card-header">Overview</h2>
<div class="row g-0">
<div class="col-md-4">
<div class="card-body">
<div class="inner">
<h3 class="card-title">Questions</h3>
<ul>
<li>What tools are needed to collaborate on code development
effectively?</li>
</ul>
</div>
</div>
</div>
<div class="col-md-8">
<div class="card-body">
<div class="inner bordered">
<h3 class="card-title">Objectives</h3>
<ul>
<li>Provide an overview of all the different tools that will be used in
this course.</li>
</ul>
</div>
</div>
</div>
</div>
</div>
<p>The first section of the course is dedicated to setting up your
environment for collaborative software development and introducing the
project that we will be working on throughout the course. In order to
build working (research) software efficiently and to do it in
collaboration with others rather than in isolation, you will have to get
comfortable with using a number of different tools interchangeably as
they will make your life a lot easier. There are many options when it
comes to deciding which software development tools to use for your daily
tasks - we will use a few of them in this course that we believe make a
difference. There are sometimes multiple tools for the job - we select
one to use but mention alternatives too. As you get more comfortable
with different tools and their alternatives, you will select the one
that is right for you based on your personal preferences or based on
what your collaborators are using.</p>
<figure><img src="../fig/section1-overview.svg" alt="Tools needed to collaborate on code development effectively" class="figure mx-auto d-block"><div class="figcaption">Section 1 Overview</div>
</figure><p>Here is an overview of the tools we will be using.</p>
<div id="setup-common-issues-fixes" class="callout">
<div class="callout-square">
<i class="callout-icon" data-feather="bell"></i>
</div>
<div id="setup-common-issues-fixes" class="callout-inner">
<h3 class="callout-title">Setup, Common Issues &amp; Fixes</h3>
<div class="callout-content">
<p>Have you <a href="index.html#setup">setup and installed</a> all the tools
and accounts required for this course? Check the list of <a href="common-issues.html">common issues, fixes &amp; tips</a> if you
experience any problems running any of the tools you installed - your
issue may be solved there.</p>
</div>
</div>
</div>
<div class="section level3">
<h3 id="command-line-python-virtual-development-environment">Command Line &amp; Python Virtual Development Environment<a class="anchor" aria-label="anchor" href="#command-line-python-virtual-development-environment"></a>
</h3>
<p>We will use the <a href="https://en.wikipedia.org/wiki/Shell_(computing)" class="external-link">command line</a>
(also known as the command line shell/prompt/console) to run our Python
code and interact with the version control tool Git and software sharing
platform GitHub. We will also use command line tools <a href="https://docs.python.org/3/library/venv.html" class="external-link"><code>venv</code></a>
and <a href="https://pip.pypa.io/en/stable/" class="external-link"><code>pip</code></a> to set
up a Python virtual development environment and isolate our software
project from other Python projects we may work on.</p>
<p><em><strong>Note:</strong> some Windows users experience the issue
where Python hangs from Git Bash (i.e. typing <code>python</code> causes
it to just hang with no error message or output) - <a href="common-issues.html#python-hangs-in-git-bash">see the solution to
this issue</a>.</em></p>
</div>
<div class="section level3">
<h3 id="integrated-development-environment-ide">Integrated Development Environment (IDE)<a class="anchor" aria-label="anchor" href="#integrated-development-environment-ide"></a>
</h3>
<p>An IDE integrates a number of tools that we need to develop a
software project that goes beyond a single script - including a smart
code editor, a code compiler/interpreter, a debugger, etc. It will help
you write well-formatted and readable code that conforms to code style
guides (such as <a href="https://www.python.org/dev/peps/pep-0008/" class="external-link">PEP8</a> for Python)
more efficiently by giving relevant and intelligent suggestions for code
completion and refactoring. IDEs often integrate command line console
and version control tools - we teach them separately in this course as
this knowledge can be ported to other programming languages and command
line tools you may use in the future (but is applicable to the
integrated versions too).</p>
<p>We will use <a href="https://www.jetbrains.com/pycharm/" class="external-link">PyCharm</a>
in this course - a free, open source IDE.</p>
</div>
<div class="section level3">
<h3 id="git-github">Git &amp; GitHub<a class="anchor" aria-label="anchor" href="#git-github"></a>
</h3>
<p><a href="https://git-scm.com/" class="external-link">Git</a> is a free and open source
distributed version control system designed to save every change made to
a (software) project, allowing others to collaborate and contribute. In
this course, we use Git to version control our code in conjunction with
<a href="https://github.com/" class="external-link">GitHub</a> for code backup and sharing.
GitHub is one of the leading integrated products and social platforms
for modern software development, monitoring and management - it will
help us with version control, issue management, code review, code
testing/Continuous Integration, and collaborative development. An
important concept in collaborative development is version control
workflows (i.e. how to effectively use version control on a project with
others).</p>
</div>
<div class="section level3">
<h3 id="python-coding-style">Python Coding Style<a class="anchor" aria-label="anchor" href="#python-coding-style"></a>
</h3>
<p>Most programming languages will have associated standards and
conventions for how the source code should be formatted and styled.
Although this sounds pedantic, it is important for maintaining the
consistency and readability of code across a project. Therefore, one
should be aware of these guidelines and adhere to whatever the project
you are working on has specified. In Python, we will be looking at a
convention called PEP8.</p>
<p>Let us get started with setting up our software development
environment!</p>
<div id="keypoints1" class="callout keypoints">
<div class="callout-square">
<i class="callout-icon" data-feather="key"></i>
</div>
<div class="callout-inner">
<h3 class="callout-title">Key Points</h3>
<div class="callout-content">
<ul>
<li>In order to develop (write, test, debug, backup) code efficiently,
you need to use a number of different tools.</li>
<li>When there is a choice of tools for a task you will have to decide
which tool is right for you, which may be a matter of personal
preference or what the team or community you belong to is using.</li>
</ul>
</div>
</div>
</div>
</div></section><section id="aio-11-software-project"><p>Content from <a href="11-software-project.html">1.1 Introduction to Our Software Project</a></p>
<hr>
<p>Last updated on 2024-12-06 |

        <a href="https://github.com/carpentries-incubator/python-intermediate-development/edit/main/episodes/11-software-project.md" class="external-link">Edit this page <i aria-hidden="true" data-feather="edit"></i></a></p>
<p>Estimated time: <i aria-hidden="true" data-feather="clock"></i> 30 minutes</p>
<div class="text-end">
          <button role="button" aria-pressed="false" tabindex="0" id="expand-code" class="pull-right" data-expand="Expand All Solutions " data-collapse="Collapse All Solutions "> Expand All Solutions <i aria-hidden="true" data-feather="plus"></i></button>
        </div>
<div class="overview card">
<h2 class="card-header">Overview</h2>
<div class="row g-0">
<div class="col-md-4">
<div class="card-body">
<div class="inner">
<h3 class="card-title">Questions</h3>
<ul>
<li>What is the design architecture of our example software
project?</li>
<li>Why is splitting code into smaller functional units (modules) good
when designing software?</li>
</ul>
</div>
</div>
</div>
<div class="col-md-8">
<div class="card-body">
<div class="inner bordered">
<h3 class="card-title">Objectives</h3>
<ul>
<li>Use Git to obtain a working copy of our software project from
GitHub.</li>
<li>Inspect the structure and architecture of our software project.</li>
<li>Understand Model-View-Controller (MVC) architecture in software
design and its use in our project.</li>
</ul>
</div>
</div>
</div>
</div>
</div>
<section><h2 class="section-heading" id="patient-inflammation-study-project">Patient Inflammation Study Project<a class="anchor" aria-label="anchor" href="#patient-inflammation-study-project"></a>
</h2>
<hr class="half-width">
<p>You have joined a software development team that has been working on
the <a href="https://github.com/carpentries-incubator/python-intermediate-inflammation" class="external-link">patient
inflammation study project</a> developed in Python and stored on GitHub.
The project analyses the data to study the effect of a new treatment for
arthritis by analysing the inflammation levels in patients who have been
given this treatment. It reuses the inflammation datasets from the <a href="https://swcarpentry.github.io/python-novice-inflammation/index.html" class="external-link">Software
Carpentry Python novice lesson</a>.</p>
<figure><img src="../fig/inflammation-study-pipeline.png" class="image-with-shadow figure mx-auto d-block" alt="Snapshot of the inflammation dataset" width="800"></figure><p style="text-align: center;">
Inflammation study pipeline from the
<a href="https://swcarpentry.github.io/python-novice-inflammation/fig/lesson-overview.svg" class="external-link">Software
Carpentry Python novice lesson</a>
</p>
<div id="what-does-patient-inflammation-data-contain" class="callout">
<div class="callout-square">
<i class="callout-icon" data-feather="bell"></i>
</div>
<div id="what-does-patient-inflammation-data-contain" class="callout-inner">
<h3 class="callout-title">What Does Patient Inflammation Data Contain?</h3>
<div class="callout-content">
<p>Each dataset records inflammation measurements from a separate
clinical trial of the drug, and each dataset contains information for 60
patients, who had their inflammation levels recorded (in some arbitrary
units of inflammation measurement) for 40 days whilst participating in
the trial. A snapshot of one of the data files is shown in the diagram
above.</p>
<p>Each of the data files uses the popular <a href="https://en.wikipedia.org/wiki/Comma-separated_values" class="external-link">comma-separated
(CSV) format</a> to represent the data, where:</p>
<ul>
<li>each row holds inflammation measurements for a single patient</li>
<li>each column represents a successive day in the trial</li>
<li>each cell represents an inflammation reading on a given day for a
patient</li>
</ul>
</div>
</div>
</div>
<p>The project is not finished and contains some errors. You will be
working on your own and in collaboration with others to fix and build on
top of the existing code during the course.</p>
</section><section><h2 class="section-heading" id="downloading-our-software-project">Downloading Our Software Project<a class="anchor" aria-label="anchor" href="#downloading-our-software-project"></a>
</h2>
<hr class="half-width">
<p>To start working on the project, you will first create a fork of the
software project repository from GitHub within your own GitHub account
and then obtain a local copy of that project (from your GitHub) on your
machine.</p>
<ol style="list-style-type: decimal">
<li>Make sure you have a GitHub account and that you have <a href="index.html#secure-access-to-github-using-git-from-command-line">set
up SSH key pair for authentication with GitHub</a>.</li>
</ol>
<p><em><strong>Note:</strong> while it is possible to use HTTPS with a
personal access token for authentication with GitHub, the recommended
and supported authentication method to use for this course is SSH with
key pairs.</em></p>
<ol start="2" style="list-style-type: decimal">
<li><p>Log into your GitHub account.</p></li>
<li><p>Go to the <a href="https://github.com/carpentries-incubator/python-intermediate-inflammation" class="external-link">software
project repository</a> in GitHub.</p></li>
</ol>
<figure><img src="../fig/github-fork-repository.png" class="image-with-shadow figure mx-auto d-block" alt="Software project fork repository in GitHub" width="900"></figure><ol start="4" style="list-style-type: decimal">
<li>Click the <code>Fork</code> button towards the top right of the
repository’s GitHub page to <strong>create a fork</strong> of the
repository under your GitHub account. Remember, you will need to be
signed into GitHub for the <code>Fork</code> button to work.</li>
</ol>
<p><em><strong>Note:</strong> each participant is creating their own
fork of the project to work on.</em></p>
<p><em><strong>Note 2:</strong> we are creating a fork of the software
project repository (instead of copying it from its template) because we
want to preserve the history of all commits (with template copying you
only get a snapshot of a repository at a given point in time).</em></p>
<ol start="5" style="list-style-type: decimal">
<li>Make sure to select your personal account and set the name of the
project to <code>python-intermediate-inflammation</code> (you can call
it anything you like, but it may be easier for future group exercises if
everyone uses the same name). Ensure that you <strong>uncheck</strong>
the <code>Copy the main branch only</code> option. This guarantees you
get all the branches from this repository needed for later
exercises.</li>
</ol>
<figure><img src="../fig/github-fork-repository-confirm.png" class="image-with-shadow figure mx-auto d-block" alt="Making a fork of the software project repository in GitHub" width="600"></figure><ol start="6" style="list-style-type: decimal">
<li><p>Click the <code>Create fork</code> button and wait for GitHub to
create the forked copy of the repository under your account.</p></li>
<li><p>Locate the forked repository under your own GitHub account.
GitHub should redirect you there automatically after creating the fork.
If this does not happen, click your user icon in the top right corner
and select <code>Your Repositories</code> from the drop-down menu, then
locate your newly created fork.</p></li>
</ol>
<figure><img src="../fig/github-forked-repository-own.png" class="image-with-shadow figure mx-auto d-block" alt="View of your own fork of the software repository in GitHub" width="900"></figure><div id="exercise-obtain-the-software-project-locally" class="callout challenge">
<div class="callout-square">
<i class="callout-icon" data-feather="zap"></i>
</div>
<div id="exercise-obtain-the-software-project-locally" class="callout-inner">
<h3 class="callout-title">Exercise: Obtain the Software Project Locally</h3>
<div class="callout-content">
<p>Using the command line, clone the copied repository from your GitHub
account into the home directory on your computer using SSH. Which
command(s) would you use to get a detailed list of contents of the
directory you have just cloned?</p>
</div>
</div>
</div>
<div id="accordionSolution1" class="accordion challenge-accordion accordion-flush">
<div class="accordion-item">
<button class="accordion-button solution-button collapsed" type="button" data-bs-toggle="collapse" data-bs-target="#collapseSolution1" aria-expanded="false" aria-controls="collapseSolution1">
  <h4 class="accordion-header" id="headingSolution1"> Show me the solution </h4>
</button>
<div id="collapseSolution1" class="accordion-collapse collapse" data-bs-parent="#accordionSolution1" aria-labelledby="headingSolution1">
<div class="accordion-body">
<ol style="list-style-type: decimal">
<li>Find the SSH URL of the software project repository to clone from
your GitHub account. Make sure you do not clone the original repository
but rather your own fork, as you should be able to push commits to it
later on. Also make sure you select the <strong>SSH</strong> tab and not
the <strong>HTTPS</strong> one. For this course, SSH is the preferred
way of authenticating when sending your changes back to GitHub. If you
have only authenticated through HTTPS in the past, please follow the
guidance <a href="#downloading-our-software-project">at the top of this
section</a> to add an SSH key to your GitHub account.</li>
</ol>
<figure><img src="../fig/clone-repository.png" class="image-with-shadow figure mx-auto d-block" alt="URL to clone the repository in GitHub" width="800"></figure><ol start="2" style="list-style-type: decimal">
<li>Make sure you are located in your home directory in the command line
with:</li>
</ol>
<div class="codewrapper sourceCode" id="cb1">
<h3 class="code-label">BASH<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="sourceCode bash" tabindex="0"><code class="sourceCode bash"><span id="cb1-1"><a href="#cb1-1" tabindex="-1"></a><span class="ex">$</span> cd ~</span></code></pre>
</div>
<ol start="3" style="list-style-type: decimal">
<li>From your home directory in the command line, do:</li>
</ol>
<div class="codewrapper sourceCode" id="cb2">
<h3 class="code-label">BASH<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="sourceCode bash" tabindex="0"><code class="sourceCode bash"><span id="cb2-1"><a href="#cb2-1" tabindex="-1"></a><span class="ex">$</span> git clone git@github.com:<span class="op">&lt;</span>YOUR_GITHUB_USERNAME<span class="op">&gt;</span>/python-intermediate-inflammation.git</span></code></pre>
</div>
<p>Make sure you are cloning your fork of the software project and not
the original repository.</p>
<ol start="4" style="list-style-type: decimal">
<li>Navigate into the cloned repository folder in your command line
with:</li>
</ol>
<div class="codewrapper sourceCode" id="cb3">
<h3 class="code-label">BASH<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="sourceCode bash" tabindex="0"><code class="sourceCode bash"><span id="cb3-1"><a href="#cb3-1" tabindex="-1"></a><span class="ex">$</span> cd python-intermediate-inflammation</span></code></pre>
</div>
<p>Note: If you have accidentally copied the <strong>HTTPS</strong> URL
of your repository instead of the SSH one, you can easily fix that from
your project folder in the command line with:</p>
<div class="codewrapper sourceCode" id="cb4">
<h3 class="code-label">BASH<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="sourceCode bash" tabindex="0"><code class="sourceCode bash"><span id="cb4-1"><a href="#cb4-1" tabindex="-1"></a><span class="ex">$</span> git remote set-url origin git@github.com:<span class="op">&lt;</span>YOUR_GITHUB_USERNAME<span class="op">&gt;</span>/python-intermediate-inflammation.git</span></code></pre>
</div>
</div>
</div>
</div>
</div>
</section><section><h2 class="section-heading" id="our-software-projects-structure">Our Software Project’s Structure<a class="anchor" aria-label="anchor" href="#our-software-projects-structure"></a>
</h2>
<hr class="half-width">
<p>Let’s inspect the content of the software project from the command
line. From the root directory of the project, you can use the command
<code>ls -l</code> to get a more detailed list of the contents. You
should see something similar to the following.</p>
<div class="codewrapper sourceCode" id="cb5">
<h3 class="code-label">BASH<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="sourceCode bash" tabindex="0"><code class="sourceCode bash"><span id="cb5-1"><a href="#cb5-1" tabindex="-1"></a><span class="ex">$</span> cd ~/python-intermediate-inflammation</span>
<span id="cb5-2"><a href="#cb5-2" tabindex="-1"></a><span class="ex">$</span> ls <span class="at">-l</span></span>
<span id="cb5-3"><a href="#cb5-3" tabindex="-1"></a><span class="ex">total</span> 24</span>
<span id="cb5-4"><a href="#cb5-4" tabindex="-1"></a><span class="ex">-rw-r--r--</span>   1 carpentry  users  1055 20 Apr 15:41 README.md</span>
<span id="cb5-5"><a href="#cb5-5" tabindex="-1"></a><span class="ex">drwxr-xr-x</span>  18 carpentry  users   576 20 Apr 15:41 data</span>
<span id="cb5-6"><a href="#cb5-6" tabindex="-1"></a><span class="ex">drwxr-xr-x</span>   5 carpentry  users   160 20 Apr 15:41 inflammation</span>
<span id="cb5-7"><a href="#cb5-7" tabindex="-1"></a><span class="ex">-rw-r--r--</span>   1 carpentry  users  1122 20 Apr 15:41 inflammation-analysis.py</span>
<span id="cb5-8"><a href="#cb5-8" tabindex="-1"></a><span class="ex">drwxr-xr-x</span>   4 carpentry  users   128 20 Apr 15:41 tests</span></code></pre>
</div>
<p>As can be seen from the above, our software project contains the
<code>README</code> file (that typically describes the project, its
usage, installation, authors and how to contribute), Python script
<code>inflammation-analysis.py</code>, and three directories -
<code>inflammation</code>, <code>data</code> and <code>tests</code>.</p>
<p>The Python script <code>inflammation-analysis.py</code> provides the
main entry point in the application, and on closer inspection, we can
see that the <code>inflammation</code> directory contains two more
Python scripts - <code>views.py</code> and <code>models.py</code>. We
will have a more detailed look into these shortly.</p>
<div class="codewrapper sourceCode" id="cb6">
<h3 class="code-label">BASH<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="sourceCode bash" tabindex="0"><code class="sourceCode bash"><span id="cb6-1"><a href="#cb6-1" tabindex="-1"></a><span class="ex">$</span> ls <span class="at">-l</span> inflammation</span>
<span id="cb6-2"><a href="#cb6-2" tabindex="-1"></a><span class="ex">total</span> 24</span>
<span id="cb6-3"><a href="#cb6-3" tabindex="-1"></a><span class="ex">-rw-r--r--</span>  1 alex  staff   71 29 Jun 09:59 __init__.py</span>
<span id="cb6-4"><a href="#cb6-4" tabindex="-1"></a><span class="ex">-rw-r--r--</span>  1 alex  staff  838 29 Jun 09:59 models.py</span>
<span id="cb6-5"><a href="#cb6-5" tabindex="-1"></a><span class="ex">-rw-r--r--</span>  1 alex  staff  649 25 Jun 13:13 views.py</span></code></pre>
</div>
<p>Directory <code>data</code> contains several files with patients’
daily inflammation information (along with some other files):</p>
<div class="codewrapper sourceCode" id="cb7">
<h3 class="code-label">BASH<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="sourceCode bash" tabindex="0"><code class="sourceCode bash"><span id="cb7-1"><a href="#cb7-1" tabindex="-1"></a><span class="ex">$</span> ls <span class="at">-l</span> data</span>
<span id="cb7-2"><a href="#cb7-2" tabindex="-1"></a><span class="ex">total</span> 264</span>
<span id="cb7-3"><a href="#cb7-3" tabindex="-1"></a><span class="ex">-rw-r--r--</span>  1 alex  staff   5365 25 Jun 13:13 inflammation-01.csv</span>
<span id="cb7-4"><a href="#cb7-4" tabindex="-1"></a><span class="ex">-rw-r--r--</span>  1 alex  staff   5314 25 Jun 13:13 inflammation-02.csv</span>
<span id="cb7-5"><a href="#cb7-5" tabindex="-1"></a><span class="ex">-rw-r--r--</span>  1 alex  staff   5127 25 Jun 13:13 inflammation-03.csv</span>
<span id="cb7-6"><a href="#cb7-6" tabindex="-1"></a><span class="ex">-rw-r--r--</span>  1 alex  staff   5367 25 Jun 13:13 inflammation-04.csv</span>
<span id="cb7-7"><a href="#cb7-7" tabindex="-1"></a><span class="ex">-rw-r--r--</span>  1 alex  staff   5345 25 Jun 13:13 inflammation-05.csv</span>
<span id="cb7-8"><a href="#cb7-8" tabindex="-1"></a><span class="ex">-rw-r--r--</span>  1 alex  staff   5330 25 Jun 13:13 inflammation-06.csv</span>
<span id="cb7-9"><a href="#cb7-9" tabindex="-1"></a><span class="ex">-rw-r--r--</span>  1 alex  staff   5342 25 Jun 13:13 inflammation-07.csv</span>
<span id="cb7-10"><a href="#cb7-10" tabindex="-1"></a><span class="ex">-rw-r--r--</span>  1 alex  staff   5127 25 Jun 13:13 inflammation-08.csv</span>
<span id="cb7-11"><a href="#cb7-11" tabindex="-1"></a><span class="ex">-rw-r--r--</span>  1 alex  staff   5327 25 Jun 13:13 inflammation-09.csv</span>
<span id="cb7-12"><a href="#cb7-12" tabindex="-1"></a><span class="ex">-rw-r--r--</span>  1 alex  staff   5342 25 Jun 13:13 inflammation-10.csv</span>
<span id="cb7-13"><a href="#cb7-13" tabindex="-1"></a><span class="ex">-rw-r--r--</span>  1 alex  staff   5127 25 Jun 13:13 inflammation-11.csv</span>
<span id="cb7-14"><a href="#cb7-14" tabindex="-1"></a><span class="ex">-rw-r--r--</span>  1 alex  staff   5340 25 Jun 13:13 inflammation-12.csv</span>
<span id="cb7-15"><a href="#cb7-15" tabindex="-1"></a><span class="ex">-rw-r--r--</span>  1 alex  staff  22554 25 Jun 13:13 python-novice-inflammation-data.zip</span>
<span id="cb7-16"><a href="#cb7-16" tabindex="-1"></a><span class="ex">-rw-r--r--</span>  1 alex  staff     12 25 Jun 13:13 small-01.csv</span>
<span id="cb7-17"><a href="#cb7-17" tabindex="-1"></a><span class="ex">-rw-r--r--</span>  1 alex  staff     15 25 Jun 13:13 small-02.csv</span>
<span id="cb7-18"><a href="#cb7-18" tabindex="-1"></a><span class="ex">-rw-r--r--</span>  1 alex  staff     12 25 Jun 13:13 small-03.csv</span></code></pre>
</div>
<p>As <a href="#what-does-patient-inflammation-data-contain">previously
mentioned</a>, each of the inflammation data files contains separate
trial data for 60 patients over 40 days.</p>
<div id="exercise-have-a-peek-at-the-data" class="callout challenge">
<div class="callout-square">
<i class="callout-icon" data-feather="zap"></i>
</div>
<div id="exercise-have-a-peek-at-the-data" class="callout-inner">
<h3 class="callout-title">Exercise: Have a Peek at the Data</h3>
<div class="callout-content">
<p>Which command(s) would you use to list the contents or a first few
lines of <code>data/inflammation-01.csv</code> file?</p>
</div>
</div>
</div>
<div id="accordionSolution2" class="accordion challenge-accordion accordion-flush">
<div class="accordion-item">
<button class="accordion-button solution-button collapsed" type="button" data-bs-toggle="collapse" data-bs-target="#collapseSolution2" aria-expanded="false" aria-controls="collapseSolution2">
  <h4 class="accordion-header" id="headingSolution2"> Show me the solution </h4>
</button>
<div id="collapseSolution2" class="accordion-collapse collapse" data-bs-parent="#accordionSolution2" aria-labelledby="headingSolution2">
<div class="accordion-body">
<ol style="list-style-type: decimal">
<li>To list the entire content of a file from the project root do:
<code>cat data/inflammation-01.csv</code>.</li>
<li>To list the first 5 lines of a file from the project root do:</li>
</ol>
<div class="codewrapper sourceCode" id="cb8">
<h3 class="code-label">BASH<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="sourceCode bash" tabindex="0"><code class="sourceCode bash"><span id="cb8-1"><a href="#cb8-1" tabindex="-1"></a><span class="fu">head</span> <span class="at">-n</span> 5 data/inflammation-01.csv</span></code></pre>
</div>
<div class="codewrapper">
<h3 class="code-label">OUTPUT<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="output" tabindex="0"><code>0,0,1,3,1,2,4,7,8,3,3,3,10,5,7,4,7,7,12,18,6,13,11,11,7,7,4,6,8,8,4,4,5,7,3,4,2,3,0,0
0,1,2,1,2,1,3,2,2,6,10,11,5,9,4,4,7,16,8,6,18,4,12,5,12,7,11,5,11,3,3,5,4,4,5,5,1,1,0,1
0,1,1,3,3,2,6,2,5,9,5,7,4,5,4,15,5,11,9,10,19,14,12,17,7,12,11,7,4,2,10,5,4,2,2,3,2,2,1,1
0,0,2,0,4,2,2,1,6,7,10,7,9,13,8,8,15,10,10,7,17,4,4,7,6,15,6,4,9,11,3,5,6,3,3,4,2,3,2,1
0,1,1,3,3,1,3,5,2,4,4,7,6,5,3,10,8,10,6,17,9,14,9,7,13,9,12,6,7,7,9,6,3,2,2,4,2,0,1,1</code></pre>
</div>
</div>
</div>
</div>
</div>
<p>Directory <code>tests</code> contains several tests that have been
implemented already. We will be adding more tests during the course as
our code grows.</p>
<div class="codewrapper sourceCode" id="cb10">
<h3 class="code-label">BASH<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="sourceCode bash" tabindex="0"><code class="sourceCode bash"><span id="cb10-1"><a href="#cb10-1" tabindex="-1"></a><span class="ex">$</span> ls <span class="at">-l</span> tests</span>
<span id="cb10-2"><a href="#cb10-2" tabindex="-1"></a><span class="ex">total</span> 16</span>
<span id="cb10-3"><a href="#cb10-3" tabindex="-1"></a><span class="ex">-rw-r--r--</span>  1 alex  staff  941 18 Dec 11:42 test_models.py</span>
<span id="cb10-4"><a href="#cb10-4" tabindex="-1"></a><span class="ex">-rw-r--r--</span>  1 alex  staff  182 18 Dec 11:42 test_patient.py</span></code></pre>
</div>
<p>An important thing to note here is that the structure of our project
is not arbitrary. One of the big differences between novice and
intermediate software development is planning the structure of your
code. This structure includes software components and behavioural
interactions between them, including how these components are laid out
in a directory and file structure. A novice will often make up the
structure of their code as they go along. However, for more advanced
software development, we need to plan and design this structure - called
a <em>software architecture</em> - beforehand.</p>
<p>Let us have a quick look into what a software architecture is and
which architecture is used by our software project before we start
adding more code to it.</p>
<div class="section level3">
<h3 id="software-architecture">Software Architecture<a class="anchor" aria-label="anchor" href="#software-architecture"></a>
</h3>
<p>A software architecture is the fundamental structure of a software
system that is decided at the beginning of project development based on
its requirements and cannot be changed that easily once implemented. It
refers to a “bigger picture” of a software system that describes
high-level components (modules) of the system and how they interact.</p>
<p>In software design and development, large systems or programs are
often decomposed into a set of smaller modules each with a subset of
functionality. Typical examples of modules in programming are software
libraries; some software libraries, such as <code>numpy</code> and
<code>matplotlib</code> in Python, are bigger modules that contain
several smaller sub-modules. Another example of modules are classes in
object-oriented programming languages.</p>
<div id="programming-modules-and-interfaces" class="callout">
<div class="callout-square">
<i class="callout-icon" data-feather="bell"></i>
</div>
<div id="programming-modules-and-interfaces" class="callout-inner">
<h3 class="callout-title">Programming Modules and Interfaces</h3>
<div class="callout-content">
<p>Although modules are self-contained and independent elements to a
large extent (they can depend on other modules), there are well-defined
ways of how they interact with one another. These rules of interaction
are called <strong>programming interfaces</strong> - they define how
other modules (clients) can use a particular module. Typically, an
interface to a module includes rules on how a module can take input from
and how it gives output back to its clients. A client can be a human, in
which case we also call these user interfaces. Even smaller functional
units such as functions/methods have clearly defined interfaces - a
function/method’s definition (also known as a <em>signature</em>) states
what parameters it can take as input and what it returns as an
output.</p>
</div>
</div>
</div>
<p>We are going to talk about software architecture and design a bit
more in <a href="30-section3-intro.html">Section 3</a> - for now it is
sufficient to know that the way our software project’s code is
structured is intentional.</p>
</div>
<div class="section level3">
<h3 id="our-projects-architecture">Our Project’s Architecture<a class="anchor" aria-label="anchor" href="#our-projects-architecture"></a>
</h3>
<p>Our software project uses the <a href="https://en.wikipedia.org/wiki/Model%E2%80%93view%E2%80%93controller" class="external-link">Model-View-Controller
(MVC) architecture</a>. MVC architecture divides the software logic into
three interconnected modules:</p>
<ul>
<li>
<strong>Model</strong> (data) - represents the data used by a
program and contains operations/rules for manipulating and changing the
data in the model (a database, a file, a single data object or a series
of objects - for example a table representing patients’ data).</li>
<li>
<strong>View</strong> (client interface) - provides means of
displaying data to users/clients within an application (i.e. provides
visualisation of the state of the model). For example, displaying a
window with input fields and buttons (Graphical User Interface, GUI) or
textual options within a command line (Command Line Interface, CLI) are
examples of Views.</li>
<li>
<strong>Controller</strong> (processes that handle input/output and
manipulate the data) - accepts input from the <strong>View</strong> and
performs the corresponding action on the <strong>Model</strong>
(changing the state of the model) and then updates the
<strong>View</strong> accordingly.</li>
</ul>
<p>In our project, <code>inflammation-analysis.py</code> is the
<strong>Controller</strong> module that performs basic statistical
analysis over patient data and provides the main entry point into the
application. The <strong>View</strong> and <strong>Model</strong>
modules are contained in the files <code>views.py</code> and
<code>models.py</code>, respectively, and are conveniently named. Data
underlying the <strong>Model</strong> is contained within the directory
<code>data</code> - as we have seen already it contains several files
with patients’ daily inflammation information.</p>
<p>We will revisit the software architecture and MVC topics once again
in later episodes when we talk in more detail about <a href="32-software-architecture-design.html">software architecture and
design</a>. We now proceed to set up our virtual development environment
and start working with the code using a more convenient graphical tool -
<a href="https://www.jetbrains.com/pycharm/" class="external-link">IDE PyCharm</a>.</p>
<div id="keypoints1" class="callout keypoints">
<div class="callout-square">
<i class="callout-icon" data-feather="key"></i>
</div>
<div class="callout-inner">
<h3 class="callout-title">Key Points</h3>
<div class="callout-content">
<ul>
<li>Programming interfaces define how individual modules within a
software application interact among themselves or how the application
itself interacts with its users.</li>
<li>MVC is a software design architecture which divides the application
into three interconnected modules: Model (data), View (user interface),
and Controller (input/output and data manipulation).</li>
<li>The software project we use throughout this course is an example of
an MVC application that manipulates patients’ inflammation data and
performs basic statistical analysis using Python.</li>
</ul>
</div>
</div>
</div>
</div>
</section></section><section id="aio-12-virtual-environments"><p>Content from <a href="12-virtual-environments.html">1.2 Virtual Environments For Software Development</a></p>
<hr>
<p>Last updated on 2025-04-01 |

        <a href="https://github.com/carpentries-incubator/python-intermediate-development/edit/main/episodes/12-virtual-environments.md" class="external-link">Edit this page <i aria-hidden="true" data-feather="edit"></i></a></p>
<p>Estimated time: <i aria-hidden="true" data-feather="clock"></i> 30 minutes</p>
<div class="text-end">
          <button role="button" aria-pressed="false" tabindex="0" id="expand-code" class="pull-right" data-expand="Expand All Solutions " data-collapse="Collapse All Solutions "> Expand All Solutions <i aria-hidden="true" data-feather="plus"></i></button>
        </div>
<div class="overview card">
<h2 class="card-header">Overview</h2>
<div class="row g-0">
<div class="col-md-4">
<div class="card-body">
<div class="inner">
<h3 class="card-title">Questions</h3>
<ul>
<li>What are virtual environments in software development and why you
should use them?</li>
<li>How can we manage Python virtual environments and external
(third-party) libraries?</li>
</ul>
</div>
</div>
</div>
<div class="col-md-8">
<div class="card-body">
<div class="inner bordered">
<h3 class="card-title">Objectives</h3>
<ul>
<li>Set up a Python virtual environment for our software project using
<code>venv</code> and <code>pip</code>.</li>
<li>Run our software from the command line.</li>
</ul>
</div>
</div>
</div>
</div>
</div>
<section><h2 class="section-heading" id="introduction">Introduction<a class="anchor" aria-label="anchor" href="#introduction"></a>
</h2>
<hr class="half-width">
<p>So far we have cloned our software project from GitHub and inspected
its contents and architecture a bit. We now want to run our code to see
what it does - let us do that from the command line. For the most part
of the course we will run our code and interact with Git from the
command line. While we will develop and debug our code using the PyCharm
IDE and it is possible to use Git from PyCharm too, typing commands in
the command line allows you to familiarise yourself and learn it well. A
bonus is that this knowledge is transferable to running code in other
programming languages and is independent from any IDE you may use in the
future.</p>
<p>If you have a little peek into our code (e.g. run
<code>cat inflammation/views.py</code> from the project root), you will
see the following two lines somewhere at the top.</p>
<div class="codewrapper sourceCode" id="cb1">
<h3 class="code-label">PYTHON<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="sourceCode python" tabindex="0"><code class="sourceCode python"><span id="cb1-1"><a href="#cb1-1" tabindex="-1"></a><span class="im">from</span> matplotlib <span class="im">import</span> pyplot <span class="im">as</span> plt</span>
<span id="cb1-2"><a href="#cb1-2" tabindex="-1"></a><span class="im">import</span> numpy <span class="im">as</span> np</span></code></pre>
</div>
<p>This means that our code requires two <strong>external
libraries</strong> (also called third-party packages or dependencies) -
<code>numpy</code> and <code>matplotlib</code>. Python applications
often use external libraries that don’t come as part of the standard
Python distribution. This means that you will have to use a <em>package
manager</em> tool to install them on your system. Applications will also
sometimes need a specific version of an external library (e.g. because
they were written to work with feature, class, or function that may have
been updated in more recent versions), or a specific version of Python
interpreter. This means that each Python application you work with may
require a different setup and a set of dependencies so it is useful to
be able to keep these configurations separate to avoid confusion between
projects. The solution for this problem is to create a self-contained
<strong>virtual environment</strong> per project, which contains a
particular version of Python installation plus a number of additional
external libraries.</p>
<p>Virtual environments are not just a feature of Python - most modern
programming languages use a similar mechanism to isolate libraries or
dependencies for a specific project, making it easier to develop, run,
test and share code with others. Some examples include Bundler for Ruby,
Conan for C++, or Maven with classpath for Java. This can also be
achieved with more generic package managers like Spack, which is used
extensively in HPC settings to resolve complex dependencies. In this
episode, we learn how to set up a virtual environment to develop our
code and manage our external dependencies.</p>
</section><section><h2 class="section-heading" id="virtual-environments">Virtual Environments<a class="anchor" aria-label="anchor" href="#virtual-environments"></a>
</h2>
<hr class="half-width">
<p>So what exactly are virtual environments, and why use them?</p>
<p>A Python virtual environment helps us create an <strong>isolated
working copy</strong> of a software project that uses a specific version
of Python interpreter together with specific versions of a number of
external libraries installed into that virtual environment. Python
virtual environments are implemented as directories with a particular
structure within software projects, containing links to specified
dependencies allowing isolation from other software projects on your
machine that may require different versions of Python or external
libraries.</p>
<p>As more external libraries are added to your Python project over
time, you can add them to its specific virtual environment and avoid a
great deal of confusion by having separate (smaller) virtual
environments for each project rather than one huge global environment
with potential package version clashes. Another big motivator for using
virtual environments is that they make sharing your code with others
much easier (as we will see shortly). Here are some typical scenarios
where the use of virtual environments is highly recommended (almost
unavoidable):</p>
<ul>
<li>You have an older project that only works under Python 2. You do not
have the time to migrate the project to Python 3 or it may not even be
possible as some of the third party dependencies are not available under
Python 3. You have to start another project under Python 3. The best way
to do this on a single machine is to set up two separate Python virtual
environments.</li>
<li>One of your Python 3 projects is locked to use a particular older
version of a third party dependency. You cannot use the latest version
of the dependency as it breaks things in your project. In a separate
branch of your project, you want to try and fix problems introduced by
the new version of the dependency without affecting the working version
of your project. You need to set up a separate virtual environment for
your branch to ‘isolate’ your code while testing the new feature.</li>
</ul>
<p>You do not have to worry too much about specific versions of external
libraries that your project depends on most of the time. Virtual
environments also enable you to always use the latest available version
without specifying it explicitly. They also enable you to use a specific
older version of a package for your project, should you need to.</p>
<div id="a-specific-python-or-package-version-is-only-ever-installed-once" class="callout">
<div class="callout-square">
<i class="callout-icon" data-feather="bell"></i>
</div>
<div id="a-specific-python-or-package-version-is-only-ever-installed-once" class="callout-inner">
<h3 class="callout-title">A Specific Python or Package Version is Only Ever Installed Once</h3>
<div class="callout-content">
<p>Note that you will not have a separate Python or package
installations for each of your projects - they will only ever be
installed once on your system but will be referenced from different
virtual environments.</p>
</div>
</div>
</div>
<div class="section level3">
<h3 id="managing-python-virtual-environments">Managing Python Virtual Environments<a class="anchor" aria-label="anchor" href="#managing-python-virtual-environments"></a>
</h3>
<p>There are several commonly used command line tools for managing
Python virtual environments:</p>
<ul>
<li>
<code>venv</code>, available by default from the standard
<code>Python</code> distribution from <code>Python 3.3+</code>
</li>
<li>
<code>virtualenv</code>, needs to be installed separately but
supports both <code>Python 2.7+</code> and
<code>Python 3.3+</code>versions</li>
<li>
<code>pipenv</code>, created to fix certain shortcomings of
<code>virtualenv</code>
</li>
<li>
<code>conda</code>, package and environment management system (also
included as part of the Anaconda Python distribution often used by the
scientific community)</li>
<li>
<code>poetry</code>, a modern Python packaging tool which handles
virtual environments automatically</li>
</ul>
<p>While there are pros and cons for using each of the above, all will
do the job of managing Python virtual environments for you and it may be
a matter of personal preference which one you go for. In this course, we
will use <code>venv</code> to create and manage our virtual environment
(which is the preferred way for Python 3.3+). The upside is that
<code>venv</code> virtual environments created from the command line are
also recognised and picked up automatically by PyCharm IDE, as we will
see in the next episode.</p>
</div>
<div class="section level3">
<h3 id="managing-external-packages">Managing External Packages<a class="anchor" aria-label="anchor" href="#managing-external-packages"></a>
</h3>
<p>Part of managing your (virtual) working environment involves
installing, updating and removing external packages on your system. The
Python package manager tool <code>pip</code> is most commonly used for
this - it interacts and obtains the packages from the central repository
called <a href="https://pypi.org/" class="external-link">Python Package Index (PyPI)</a>.
<code>pip</code> can now be used with all Python distributions
(including Anaconda).</p>
<div id="a-note-on-anaconda-and-conda" class="callout">
<div class="callout-square">
<i class="callout-icon" data-feather="bell"></i>
</div>
<div id="a-note-on-anaconda-and-conda" class="callout-inner">
<h3 class="callout-title">A Note on Anaconda and <code>conda</code>
</h3>
<div class="callout-content">
<p>Anaconda is an open source Python distribution commonly used for
scientific programming - it conveniently installs Python, package and
environment management <code>conda</code>, and a number of commonly used
scientific computing packages so you do not have to obtain them
separately. <code>conda</code> is an independent command line tool
(available separately from the Anaconda distribution too) with dual
functionality: (1) it is a package manager that helps you find Python
packages from remote package repositories and install them on your
system, and (2) it is also a virtual environment manager. So, you can
use <code>conda</code> for both tasks instead of using <code>venv</code>
and <code>pip</code>.</p>
</div>
</div>
</div>
</div>
<div class="section level3">
<h3 id="many-tools-for-the-job">Many Tools for the Job<a class="anchor" aria-label="anchor" href="#many-tools-for-the-job"></a>
</h3>
<p>Installing and managing Python distributions, external libraries and
virtual environments is, well, complex. There is an abundance of tools
for each task, each with its advantages and disadvantages, and there are
different ways to achieve the same effect (and even different ways to
install the same tool!). Note that each Python distribution comes with
its own version of <code>pip</code> - and if you have several Python
versions installed you have to be extra careful to use the correct
<code>pip</code> to manage external packages for that Python
version.</p>
<p><code>venv</code> and <code>pip</code> are considered the <em>de
facto</em> standards for virtual environment and package management for
Python 3. However, the advantages of using Anaconda and
<code>conda</code> are that you get (most of the) packages needed for
scientific code development included with the distribution. If you are
only collaborating with others who are also using Anaconda, you may find
that <code>conda</code> satisfies all your needs. It is good, however,
to be aware of all these tools, and use them accordingly. As you become
more familiar with them you will realise that equivalent tools work in a
similar way even though the command syntax may be different (and that
there are equivalent tools for other programming languages too to which
your knowledge can be ported).</p>
<figure><img src="../fig/python-environment-hell.png" alt="Python environment hell XKCD comic" class="figure mx-auto d-block"><div class="figcaption">Python Environment Hell from <a href="https://xkcd.com/1987/" class="external-link">XKCD</a> (Creative Commons
Attribution-NonCommercial 2.5 License)</div>
</figure><p>Let us have a look at how we can create and manage virtual
environments from the command line using <code>venv</code> and manage
packages using <code>pip</code>.</p>
<div id="making-sure-you-can-invoke-python" class="callout prereq">
<div class="callout-square">
<i class="callout-icon" data-feather="check"></i>
</div>
<div id="making-sure-you-can-invoke-python" class="callout-inner">
<h3 class="callout-title">Making Sure You Can Invoke Python</h3>
<div class="callout-content">
<p>You can test your Python installation from the command line with:</p>
<div class="codewrapper sourceCode" id="cb2">
<h3 class="code-label">BASH<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="sourceCode bash" tabindex="0"><code class="sourceCode bash"><span id="cb2-1"><a href="#cb2-1" tabindex="-1"></a><span class="ex">$</span> python3 <span class="at">--version</span> <span class="co"># on Mac/Linux</span></span>
<span id="cb2-2"><a href="#cb2-2" tabindex="-1"></a><span class="ex">$</span> python <span class="at">--version</span> <span class="co"># on Windows — Windows installation comes with a python.exe file rather than a python3.exe file </span></span></code></pre>
</div>
<p>If you are using Windows and invoking <code>python</code> command
causes your Git Bash terminal to hang with no error message or output,
you may need to create an alias for the python executable
<code>python.exe</code>, as explained in the <a href="common-issues.html#python-hangs-in-git-bash">troubleshooting
section</a>.</p>
</div>
</div>
</div>
</div>
<div class="section level3">
<h3 id="creating-virtual-environments-using-venv">Creating Virtual Environments Using <code>venv</code>
<a class="anchor" aria-label="anchor" href="#creating-virtual-environments-using-venv"></a>
</h3>
<p>Creating a virtual environment with <code>venv</code> is done by
executing the following command:</p>
<div class="codewrapper sourceCode" id="cb3">
<h3 class="code-label">BASH<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="sourceCode bash" tabindex="0"><code class="sourceCode bash"><span id="cb3-1"><a href="#cb3-1" tabindex="-1"></a><span class="ex">$</span> python3 <span class="at">-m</span> venv /path/to/new/virtual/environment</span></code></pre>
</div>
<p>where <code>/path/to/new/virtual/environment</code> is a path to a
directory where you want to place it - conventionally within your
software project so they are co-located. This will create the target
directory for the virtual environment (and any parent directories that
don’t exist already).</p>
<div id="what-is--m-flag-in-python3-command" class="callout">
<div class="callout-square">
<i class="callout-icon" data-feather="bell"></i>
</div>
<div id="what-is--m-flag-in-python3-command" class="callout-inner">
<h3 class="callout-title">What is <code>-m</code> Flag in
<code>python3</code> Command?</h3>
<div class="callout-content">
<p>The Python <code>-m</code> flag means “module” and tells the Python
interpreter to treat what follows <code>-m</code> as the name of a
module and not as a single, executable program with the same name. Some
modules (such as <code>venv</code> or <code>pip</code>) have main entry
points and the <code>-m</code> flag can be used to invoke them on the
command line via the <code>python</code> command. The main difference
between running such modules as standalone programs (e.g. executing
“venv” by running the <code>venv</code> command directly) versus using
<code>python3 -m</code> command seems to be that with latter you are in
full control of which Python module will be invoked (the one that came
with your environment’s Python interpreter vs. some other version you
may have on your system). This makes it a more reliable way to set
things up correctly and avoid issues that could prove difficult to trace
and debug.</p>
</div>
</div>
</div>
<p>For our project let us create a virtual environment called “venv”.
First, ensure you are within the project root directory, then:</p>
<div class="codewrapper sourceCode" id="cb4">
<h3 class="code-label">BASH<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="sourceCode bash" tabindex="0"><code class="sourceCode bash"><span id="cb4-1"><a href="#cb4-1" tabindex="-1"></a><span class="ex">$</span> python3 <span class="at">-m</span> venv venv</span></code></pre>
</div>
<p>If you list the contents of the newly created directory “venv”, on a
Mac or Linux system (slightly different on Windows as explained below)
you should see something like:</p>
<div class="codewrapper sourceCode" id="cb5">
<h3 class="code-label">BASH<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="sourceCode bash" tabindex="0"><code class="sourceCode bash"><span id="cb5-1"><a href="#cb5-1" tabindex="-1"></a><span class="ex">$</span> ls <span class="at">-l</span> venv</span></code></pre>
</div>
<div class="codewrapper">
<h3 class="code-label">OUTPUT<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="output" tabindex="0"><code>total 8
drwxr-xr-x  12 alex  staff  384  5 Oct 11:47 bin
drwxr-xr-x   2 alex  staff   64  5 Oct 11:47 include
drwxr-xr-x   3 alex  staff   96  5 Oct 11:47 lib
-rw-r--r--   1 alex  staff   90  5 Oct 11:47 pyvenv.cfg</code></pre>
</div>
<p>So, running the <code>python3 -m venv venv</code> command created the
target directory called “venv” containing:</p>
<ul>
<li>
<code>pyvenv.cfg</code> configuration file with a home key pointing
to the Python installation from which the command was run,</li>
<li>
<code>bin</code> subdirectory (called <code>Scripts</code> on
Windows) containing a symlink of the Python interpreter binary used to
create the environment and the standard Python library,</li>
<li>
<code>lib/pythonX.Y/site-packages</code> subdirectory (called
<code>Lib\site-packages</code> on Windows) to contain its own
independent set of installed Python packages isolated from other
projects, and</li>
<li>various other configuration and supporting files and
subdirectories.</li>
</ul>
<div id="naming-virtual-environments" class="callout">
<div class="callout-square">
<i class="callout-icon" data-feather="bell"></i>
</div>
<div id="naming-virtual-environments" class="callout-inner">
<h3 class="callout-title">Naming Virtual Environments</h3>
<div class="callout-content">
<p>What is a good name to use for a virtual environment? Using “venv” or
“.venv” as the name for an environment and storing it within the
project’s directory seems to be the recommended way - this way when you
come across such a subdirectory within a software project, by convention
you know it contains its virtual environment details. A slight downside
is that all different virtual environments on your machine then use the
same name and the current one is determined by the context of the path
you are currently located in. A (non-conventional) alternative is to use
your project name for the name of the virtual environment, with the
downside that there is nothing to indicate that such a directory
contains a virtual environment. In our case, we have settled to use the
name “venv” instead of “.venv” since it is not a hidden directory and we
want it to be displayed by the command line when listing directory
contents (the “.” in its name that would, by convention, make it
hidden). In the future, you will decide what naming convention works
best for you. Here are some references for each of the naming
conventions:</p>
<ul>
<li>
<a href="https://docs.python-guide.org/dev/virtualenvs/" class="external-link">The
Hitchhiker’s Guide to Python</a> notes that “venv” is the general
convention used globally</li>
<li>
<a href="https://docs.python.org/3/library/venv.html" class="external-link">The Python
Documentation</a> indicates that “.venv” is common</li>
<li><a href="https://discuss.python.org/t/trying-to-come-up-with-a-default-directory-name-for-virtual-environments/3750" class="external-link">“venv”
vs “.venv” discussion</a></li>
</ul>
</div>
</div>
</div>
<p>Once you’ve created a virtual environment, you will need to activate
it.</p>
<p>On Mac or Linux, it is done as:</p>
<div class="codewrapper sourceCode" id="cb7">
<h3 class="code-label">BASH<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="sourceCode bash" tabindex="0"><code class="sourceCode bash"><span id="cb7-1"><a href="#cb7-1" tabindex="-1"></a><span class="ex">$</span> source venv/bin/activate</span>
<span id="cb7-2"><a href="#cb7-2" tabindex="-1"></a><span class="kw">(</span><span class="ex">venv</span><span class="kw">)</span> <span class="ex">$</span></span></code></pre>
</div>
<p>On Windows, recall that we have <code>Scripts</code> directory
instead of <code>bin</code> and activating a virtual environment is done
as:</p>
<div class="codewrapper sourceCode" id="cb8">
<h3 class="code-label">BASH<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="sourceCode bash" tabindex="0"><code class="sourceCode bash"><span id="cb8-1"><a href="#cb8-1" tabindex="-1"></a><span class="ex">$</span> source venv/Scripts/activate</span>
<span id="cb8-2"><a href="#cb8-2" tabindex="-1"></a><span class="kw">(</span><span class="ex">venv</span><span class="kw">)</span> <span class="ex">$</span></span></code></pre>
</div>
<p>Activating the virtual environment will change your command line’s
prompt to show what virtual environment you are currently using
(indicated by its name in round brackets at the start of the prompt),
and modify the environment so that running Python will get you the
particular version of Python configured in your virtual environment.</p>
<p>You can verify you are using your virtual environment’s version of
Python by checking the path using the command <code>which</code>:</p>
<div class="codewrapper sourceCode" id="cb9">
<h3 class="code-label">BASH<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="sourceCode bash" tabindex="0"><code class="sourceCode bash"><span id="cb9-1"><a href="#cb9-1" tabindex="-1"></a><span class="kw">(</span><span class="ex">venv</span><span class="kw">)</span> <span class="ex">$</span> which python3</span></code></pre>
</div>
<div class="codewrapper">
<h3 class="code-label">OUTPUT<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="output" tabindex="0"><code>/home/alex/python-intermediate-inflammation/venv/bin/python3</code></pre>
</div>
<p>When you’re done working on your project, you can exit the
environment with:</p>
<div class="codewrapper sourceCode" id="cb11">
<h3 class="code-label">BASH<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="sourceCode bash" tabindex="0"><code class="sourceCode bash"><span id="cb11-1"><a href="#cb11-1" tabindex="-1"></a><span class="kw">(</span><span class="ex">venv</span><span class="kw">)</span> <span class="ex">$</span> deactivate</span></code></pre>
</div>
<p>If you have just done the <code>deactivate</code>, ensure you
reactivate the environment ready for the next part:</p>
<div class="codewrapper sourceCode" id="cb12">
<h3 class="code-label">BASH<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="sourceCode bash" tabindex="0"><code class="sourceCode bash"><span id="cb12-1"><a href="#cb12-1" tabindex="-1"></a><span class="ex">$</span> source venv/bin/activate</span>
<span id="cb12-2"><a href="#cb12-2" tabindex="-1"></a><span class="kw">(</span><span class="ex">venv</span><span class="kw">)</span> <span class="ex">$</span></span></code></pre>
</div>
<div id="python-within-a-virtual-environment" class="callout">
<div class="callout-square">
<i class="callout-icon" data-feather="bell"></i>
</div>
<div id="python-within-a-virtual-environment" class="callout-inner">
<h3 class="callout-title">Python Within A Virtual Environment</h3>
<div class="callout-content">
<p>Within an active virtual environment, commands <code>python3</code>
and <code>python</code> should both refer to the version of Python 3 you
created the environment with (note you may have multiple Python 3
versions installed).</p>
<p>However, on some machines with Python 2 installed,
<code>python</code> command may still be hardwired to the copy of Python
2 installed outside of the virtual environment - this can cause errors
and confusion.</p>
<p>You can always check which version of Python you are using in your
virtual environment with the command <code>which python</code> to be
absolutely sure. We continue using <code>python3</code> in this material
to avoid mistakes, but the command <code>python</code> may work for you
as expected.</p>
</div>
</div>
</div>
<p>Note that, since our software project is being tracked by Git, the
newly created virtual environment will show up in version control - we
will see how to handle it using Git in one of the subsequent
episodes.</p>
</div>
<div class="section level3">
<h3 id="installing-external-packages-using-pip">Installing External Packages Using <code>pip</code>
<a class="anchor" aria-label="anchor" href="#installing-external-packages-using-pip"></a>
</h3>
<p>We noticed earlier that our code depends on two <em>external
packages/libraries</em> - <code>numpy</code> and
<code>matplotlib</code>. In order for the code to run on your machine,
you need to install these two dependencies into your virtual
environment.</p>
<p>To install the latest version of a package with <code>pip</code> you
use pip’s <code>install</code> command and specify the package’s name,
e.g.:</p>
<div class="codewrapper sourceCode" id="cb13">
<h3 class="code-label">BASH<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="sourceCode bash" tabindex="0"><code class="sourceCode bash"><span id="cb13-1"><a href="#cb13-1" tabindex="-1"></a><span class="kw">(</span><span class="ex">venv</span><span class="kw">)</span> <span class="ex">$</span> python3 <span class="at">-m</span> pip install numpy</span>
<span id="cb13-2"><a href="#cb13-2" tabindex="-1"></a><span class="kw">(</span><span class="ex">venv</span><span class="kw">)</span> <span class="ex">$</span> python3 <span class="at">-m</span> pip install matplotlib</span></code></pre>
</div>
<p>or like this to install multiple packages at once for short:</p>
<div class="codewrapper sourceCode" id="cb14">
<h3 class="code-label">BASH<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="sourceCode bash" tabindex="0"><code class="sourceCode bash"><span id="cb14-1"><a href="#cb14-1" tabindex="-1"></a><span class="kw">(</span><span class="ex">venv</span><span class="kw">)</span> <span class="ex">$</span> python3 <span class="at">-m</span> pip install numpy matplotlib</span></code></pre>
</div>
<div id="how-about-pip3-install-package-name-command" class="callout">
<div class="callout-square">
<i class="callout-icon" data-feather="bell"></i>
</div>
<div id="how-about-pip3-install-package-name-command" class="callout-inner">
<h3 class="callout-title">How About
<code>pip3 install &lt;package-name&gt;</code> Command?</h3>
<div class="callout-content">
<p>You may have seen or used the
<code>pip3 install &lt;package-name&gt;</code> command in the past,
which is shorter and perhaps more intuitive than
<code>python3 -m pip install</code>. However, the <a href="https://pip.pypa.io/en/stable/user_guide/#running-pip" class="external-link">official
Pip documentation</a> recommends <code>python3 -m pip install</code> and
core Python developer Brett Cannon offers a <a href="https://snarky.ca/why-you-should-use-python-m-pip/" class="external-link">more detailed
explanation</a> of edge cases when the two commands may produce
different results and why <code>python3 -m pip install</code> is
recommended. In this material, we will use <code>python3 -m</code>
whenever we have to invoke a Python module from command line.</p>
</div>
</div>
</div>
<p>If you run the <code>python3 -m pip install</code> command on a
package that is already installed, <code>pip</code> will notice this and
do nothing.</p>
<p>To install a specific version of a Python package give the package
name followed by <code>==</code> and the version number,
e.g. <code>python3 -m pip install numpy==1.21.1</code>.</p>
<p>To specify a minimum version of a Python package, you can do
<code>python3 -m pip install numpy&gt;=1.20</code>.</p>
<p>To upgrade a package to the latest version,
e.g. <code>python3 -m pip install --upgrade numpy</code>.</p>
<p>To display information about a particular installed package do:</p>
<div class="codewrapper sourceCode" id="cb15">
<h3 class="code-label">BASH<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="sourceCode bash" tabindex="0"><code class="sourceCode bash"><span id="cb15-1"><a href="#cb15-1" tabindex="-1"></a><span class="kw">(</span><span class="ex">venv</span><span class="kw">)</span> <span class="ex">$</span> python3 <span class="at">-m</span> pip show numpy</span></code></pre>
</div>
<div class="codewrapper">
<h3 class="code-label">OUTPUT<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="output" tabindex="0"><code>Name: numpy
Version: 1.26.2
Summary: Fundamental package for array computing in Python
Home-page: https://numpy.org
Author: Travis E. Oliphant et al.
Author-email:
License: Copyright (c) 2005-2023, NumPy Developers.
All rights reserved.
...
Required-by: contourpy, matplotlib</code></pre>
</div>
<p>To list all packages installed with <code>pip</code> (in your current
virtual environment):</p>
<div class="codewrapper sourceCode" id="cb17">
<h3 class="code-label">BASH<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="sourceCode bash" tabindex="0"><code class="sourceCode bash"><span id="cb17-1"><a href="#cb17-1" tabindex="-1"></a><span class="kw">(</span><span class="ex">venv</span><span class="kw">)</span> <span class="ex">$</span> python3 <span class="at">-m</span> pip list</span></code></pre>
</div>
<div class="codewrapper">
<h3 class="code-label">OUTPUT<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="output" tabindex="0"><code>Package         Version
--------------- -------
contourpy       1.2.0
cycler          0.12.1
fonttools       4.45.0
kiwisolver      1.4.5
matplotlib      3.8.2
numpy           1.26.2
packaging       23.2
Pillow          10.1.0
pip             23.0.1
pyparsing       3.1.1
python-dateutil 2.8.2
setuptools      67.6.1
six             1.16.0</code></pre>
</div>
<p>To uninstall a package installed in the virtual environment do:
<code>python3 -m pip uninstall &lt;package-name&gt;</code>. You can also
supply a list of packages to uninstall at the same time.</p>
</div>
<div class="section level3">
<h3 id="installing-our-local-project-as-a-package-using-pip">Installing Our Local Project as a Package Using
<code>pip</code>
<a class="anchor" aria-label="anchor" href="#installing-our-local-project-as-a-package-using-pip"></a>
</h3>
<p>Often when working on a Python project, the project itself will be a
Python package (like <code>numpy</code> or <code>matplotlib</code>
above) or at the very least it might be useful to treat it like a
package. Said another way, it is usually the case we want a convenient
way to call the Python code we are writing from another location, and
making this code accessible as a package is the best way to do this. We
will save the details of Python packaging for <a href="43-software-release.html">a future episode</a>, and for the
meantime we can use the minimal package setup that our project already
comes with, which is contained in the <code>pyproject.toml</code> file.
Once again, we can use <code>pip</code> to install our local
package:</p>
<div class="codewrapper sourceCode" id="cb19">
<h3 class="code-label">BASH<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="sourceCode bash" tabindex="0"><code class="sourceCode bash"><span id="cb19-1"><a href="#cb19-1" tabindex="-1"></a><span class="ex">python3</span> <span class="at">-m</span> pip install <span class="at">--editable</span> .</span></code></pre>
</div>
<div id="accordionSpoiler1" class="accordion spoiler-accordion accordion-flush">
<div class="accordion-item">
<button class="accordion-button spoiler-button collapsed" type="button" data-bs-toggle="collapse" data-bs-target="#collapseSpoiler1" aria-expanded="false" aria-controls="collapseSpoiler1">
  <h3 class="accordion-header" id="headingSpoiler1">
  <div class="note-square"><i aria-hidden="true" class="callout-icon" data-feather="eye"></i></div>
  This command fails for me
  </h3>
</button>
<div id="collapseSpoiler1" class="accordion-collapse collapse" aria-labelledby="headingSpoiler1" data-bs-parent="#accordionSpoiler1">
<div class="accordion-body">
<p>If your <code>pip</code> installation is older than version 21.3,
then this command will probably fail for you. This is because these
older versions of <code>pip</code> do not support
<code>pyproject.toml</code> as the package metadata. Given these
versions of <code>pip</code> are now over 4 years old, we strongly
recommend that you update <code>pip</code> if you can:</p>
<div class="codewrapper sourceCode" id="cb20">
<h3 class="code-label">BASH<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="sourceCode bash" tabindex="0"><code class="sourceCode bash"><span id="cb20-1"><a href="#cb20-1" tabindex="-1"></a><span class="ex">python3</span> <span class="at">-m</span> pip install <span class="at">--upgrade</span> pip</span></code></pre>
</div>
</div>
</div>
</div>
</div>
<p>This is similar syntax to above, with two important differences:</p>
<ol style="list-style-type: decimal">
<li>The <code>--editable</code> or <code>-e</code> flag indicates that
the package we are specifying should be an “editable” install. An
“editable” install is one that allows the package in our environment to
change dynamically based on source code locally. This is very convenient
when we are developing the package because we can instantly see changes
when we call the code from within our virtual environment, rather than
having to install the local package again to get the updates.</li>
<li>The argument <code>'.'</code> indicates that the package we want to
install is located in the current directory. The
<code>pyproject.toml</code> file located in this directory then handles
the rest.</li>
</ol>
<p>If we reissue the <code>pip list</code> command we should now see our
local package with the name
<code>python-intermediate-inflammation</code> in the output:</p>
<div class="codewrapper">
<h3 class="code-label">OUTPUT<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="output" tabindex="0"><code>Package                          Version     Editable project location
-------------------------------- ----------- ----------------------------------------------------------------------------------------------
contourpy                        1.3.1
cycler                           0.12.1
exceptiongroup                   1.2.2
fonttools                        4.56.0
iniconfig                        2.0.0
kiwisolver                       1.4.8
matplotlib                       3.10.0
numpy                            2.2.3
packaging                        24.2
pillow                           11.1.0
pip                              22.0.2
pluggy                           1.5.0
pyparsing                        3.2.1
pytest                           8.3.4
python-dateutil                  2.9.0.post0
python-intermediate-inflammation 0.0.0       /path/to/your/project/directory/python-intermediate-inflammation
setuptools                       59.6.0
six                              1.17.0
tomli                            2.2.1</code></pre>
</div>
</div>
<div class="section level3">
<h3 id="exportingimporting-virtual-environments-using-pip">Exporting/Importing Virtual Environments Using <code>pip</code>
<a class="anchor" aria-label="anchor" href="#exportingimporting-virtual-environments-using-pip"></a>
</h3>
<p>You are collaborating on a project with a team so, naturally, you
will want to share your environment with your collaborators so they can
easily ‘clone’ your software project with all of its dependencies and
everyone can replicate equivalent virtual environments on their
machines. <code>pip</code> has a handy way of exporting, saving and
sharing virtual environments.</p>
<p>To export your active environment use the
<code>python3 -m pip freeze --exclude-editable</code> command to produce
a list of packages installed in the virtual environment. A common
convention is to put this list in a <code>requirements.txt</code>
file:</p>
<div class="codewrapper sourceCode" id="cb22">
<h3 class="code-label">BASH<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="sourceCode bash" tabindex="0"><code class="sourceCode bash"><span id="cb22-1"><a href="#cb22-1" tabindex="-1"></a><span class="kw">(</span><span class="ex">venv</span><span class="kw">)</span> <span class="ex">$</span> python3 <span class="at">-m</span> pip freeze <span class="at">--exclude-editable</span> <span class="op">&gt;</span> requirements.txt</span>
<span id="cb22-2"><a href="#cb22-2" tabindex="-1"></a><span class="kw">(</span><span class="ex">venv</span><span class="kw">)</span> <span class="ex">$</span> cat requirements.txt</span></code></pre>
</div>
<div class="codewrapper">
<h3 class="code-label">OUTPUT<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="output" tabindex="0"><code>contourpy==1.2.0
cycler==0.12.1
fonttools==4.45.0
kiwisolver==1.4.5
matplotlib==3.8.2
numpy==1.26.2
packaging==23.2
Pillow==10.1.0
pyparsing==3.1.1
python-dateutil==2.8.2
six==1.16.0</code></pre>
</div>
<p>The first of the above commands will create a
<code>requirements.txt</code> file in your current directory. Yours may
look a little different, depending on the version of the packages you
have installed, as well as any differences in the packages that they
themselves use. Also, we need to use the <code>--exclude-editable</code>
command so that our local package is not included in the output,
otherwise pip will try to pull from a specific commit at the time we
made the editable install, which is not what we want.</p>
<p>The <code>requirements.txt</code> file can then be committed to a
version control system (we will see how to do this using Git in one of
the following episodes) and get shipped as part of your software and
shared with collaborators and/or users. They can then replicate your
environment and install all the necessary packages from the project root
as follows:</p>
<div class="codewrapper sourceCode" id="cb24">
<h3 class="code-label">BASH<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="sourceCode bash" tabindex="0"><code class="sourceCode bash"><span id="cb24-1"><a href="#cb24-1" tabindex="-1"></a><span class="kw">(</span><span class="ex">venv</span><span class="kw">)</span> <span class="ex">$</span> python3 <span class="at">-m</span> pip install <span class="at">-r</span> requirements.txt <span class="at">--editable</span> .</span></code></pre>
</div>
<p>As your project grows you may need to update your environment for a
variety of reasons. For example, one of your project’s dependencies has
just released a new version (dependency version number update), you need
an additional package for data analysis (adding a new dependency) or you
have found a better package and no longer need the older package (adding
a new and removing an old dependency). What you need to do in this case
(apart from installing the new and removing the packages that are no
longer needed from your virtual environment) is update the contents of
the <code>requirements.txt</code> file accordingly by re-issuing
<code>pip freeze</code> command and propagate the updated
<code>requirements.txt</code> file to your collaborators via your code
sharing platform (e.g. GitHub).</p>
<div id="official-documentation" class="callout testimonial">
<div class="callout-square">
<i class="callout-icon" data-feather="heart"></i>
</div>
<div id="official-documentation" class="callout-inner">
<h3 class="callout-title">Official Documentation</h3>
<div class="callout-content">
<p>For a full list of options and commands, consult the <a href="https://docs.python.org/3/library/venv.html" class="external-link">official
<code>venv</code> documentation</a> and the <a href="https://docs.python.org/3/installing/index.html#installing-index" class="external-link">Installing
Python Modules with <code>pip</code> guide</a>. Also check out the guide
<a href="https://packaging.python.org/guides/installing-using-pip-and-virtual-environments/#installing-packages-using-pip-and-virtual-environments" class="external-link">“Installing
packages using <code>pip</code> and virtual environments”</a>.</p>
</div>
</div>
</div>
</div>
</section><section><h2 class="section-heading" id="running-python-scripts-from-command-line">Running Python Scripts From Command Line<a class="anchor" aria-label="anchor" href="#running-python-scripts-from-command-line"></a>
</h2>
<hr class="half-width">
<p>Congratulations! Your environment is now activated and set up to run
our <code>inflammation-analysis.py</code> script from the command
line.</p>
<p>You should already be located in the root of the
<code>python-intermediate-inflammation</code> directory (if not, please
navigate to it from the command line now). To run the script, type the
following command:</p>
<div class="codewrapper sourceCode" id="cb25">
<h3 class="code-label">BASH<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="sourceCode bash" tabindex="0"><code class="sourceCode bash"><span id="cb25-1"><a href="#cb25-1" tabindex="-1"></a><span class="kw">(</span><span class="ex">venv</span><span class="kw">)</span> <span class="ex">$</span> python3 inflammation-analysis.py</span></code></pre>
</div>
<div class="codewrapper">
<h3 class="code-label">OUTPUT<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="output" tabindex="0"><code>usage: inflammation-analysis.py [-h] infiles [infiles ...]
inflammation-analysis.py: error: the following arguments are required: infiles</code></pre>
</div>
<p>In the above command, we tell the command line two things:</p>
<ol style="list-style-type: decimal">
<li>to find a Python interpreter (in this case, the one that was
configured via the virtual environment), and</li>
<li>to use it to run our script <code>inflammation-analysis.py</code>,
which resides in the current directory.</li>
</ol>
<p>As we can see, the Python interpreter ran our script, which threw an
error -
<code>inflammation-analysis.py: error: the following arguments are required: infiles</code>.
It looks like the script expects a list of input files to process, so
this is expected behaviour since we do not supply any. We will fix this
error in a moment.</p>
</section><section><h2 class="section-heading" id="optional-exercises">Optional Exercises<a class="anchor" aria-label="anchor" href="#optional-exercises"></a>
</h2>
<hr class="half-width">
<p>Have a look at <a href="17-section1-optional-exercises.html">some
optional exercises</a>.</p>
<div id="keypoints1" class="callout keypoints">
<div class="callout-square">
<i class="callout-icon" data-feather="key"></i>
</div>
<div class="callout-inner">
<h3 class="callout-title">Key Points</h3>
<div class="callout-content">
<ul>
<li>Virtual environments keep Python versions and dependencies required
by different projects separate.</li>
<li>A virtual environment is itself a directory structure.</li>
<li>Use <code>venv</code> to create and manage Python virtual
environments.</li>
<li>Use <code>pip</code> to install and manage Python external
(third-party) libraries.</li>
<li>
<code>pip</code> allows you to declare all dependencies for a
project in a separate file (by convention called
<code>requirements.txt</code>) which can be shared with
collaborators/users and used to replicate a virtual environment.</li>
<li>Use
<code>python3 -m pip freeze --exclude-editable &gt; requirements.txt</code>
to take snapshot of your project’s dependencies.</li>
<li>Use <code>python3 -m pip install -r requirements.txt</code> to
replicate someone else’s virtual environment on your machine from the
<code>requirements.txt</code> file.</li>
</ul>
</div>
</div>
</div>
</section></section><section id="aio-13-ides"><p>Content from <a href="13-ides.html">1.3 Integrated Software Development Environments</a></p>
<hr>
<p>Last updated on 2025-03-07 |

        <a href="https://github.com/carpentries-incubator/python-intermediate-development/edit/main/episodes/13-ides.md" class="external-link">Edit this page <i aria-hidden="true" data-feather="edit"></i></a></p>
<p>Estimated time: <i aria-hidden="true" data-feather="clock"></i> 35 minutes</p>
<div class="text-end">
          <button role="button" aria-pressed="false" tabindex="0" id="expand-code" class="pull-right" data-expand="Expand All Solutions " data-collapse="Collapse All Solutions "> Expand All Solutions <i aria-hidden="true" data-feather="plus"></i></button>
        </div>
<div class="overview card">
<h2 class="card-header">Overview</h2>
<div class="row g-0">
<div class="col-md-4">
<div class="card-body">
<div class="inner">
<h3 class="card-title">Questions</h3>
<ul>
<li>What are Integrated Development Environments (IDEs)?</li>
<li>What are the advantages of using IDEs for software development?</li>
</ul>
</div>
</div>
</div>
<div class="col-md-8">
<div class="card-body">
<div class="inner bordered">
<h3 class="card-title">Objectives</h3>
<ul>
<li>Set up a (virtual) development environment in PyCharm</li>
<li>Use PyCharm to run a Python script</li>
</ul>
</div>
</div>
</div>
</div>
</div>
<section><h2 class="section-heading" id="introduction">Introduction<a class="anchor" aria-label="anchor" href="#introduction"></a>
</h2>
<hr class="half-width">
<p>As we have seen in the previous episode - even a simple software
project is typically split into smaller functional units and modules,
which are kept in separate files and subdirectories. As your code starts
to grow and becomes more complex, it will involve many different files
and various external libraries. You will need an application to help you
manage all the complexities of, and provide you with some useful
(visual) facilities for, the software development process. Such clever
and useful graphical software development applications are called
Integrated Development Environments (IDEs).</p>
</section><section><h2 class="section-heading" id="integrated-development-environments">Integrated Development Environments<a class="anchor" aria-label="anchor" href="#integrated-development-environments"></a>
</h2>
<hr class="half-width">
<p>An IDE normally consists of at least a source code editor, build
automation tools and a debugger. The boundaries between modern IDEs and
other aspects of the broader software development process are often
blurred. Nowadays IDEs also offer version control support, tools to
construct graphical user interfaces (GUI) and web browser integration
for web app development, source code inspection for dependencies and
many other useful functionalities. The following is a list of the most
commonly seen IDE features:</p>
<ul>
<li>
<strong>syntax highlighting</strong> - to show the language
constructs, keywords and the syntax errors with visually distinct
colours and font effects</li>
<li>
<strong>code completion</strong> - to speed up programming by
offering a set of possible (syntactically correct) code options</li>
<li>
<strong>code search</strong> - finding package, class, function and
variable declarations, their usages and referencing</li>
<li>
<strong>version control support</strong> - to interact with source
code repositories</li>
<li>
<strong>debugging support</strong> - for setting breakpoints in the
code editor, step-by-step execution of code and inspection of
variables</li>
</ul>
<p>IDEs are extremely useful and modern software development would be
very hard without them. There are a number of IDEs available for Python
development; a good overview is available from the <a href="https://wiki.python.org/moin/IntegratedDevelopmentEnvironments" class="external-link">Python
Project Wiki</a>. In addition to IDEs, there are also a number of code
editors that have Python support. Code editors can be as simple as a
text editor with syntax highlighting and code formatting capabilities
(e.g., GNU EMACS, Vi/Vim). Most good code editors can also execute code
and control a debugger, and some can also interact with a version
control system. Compared to an IDE, a good dedicated code editor is
usually smaller and quicker, but often less feature-rich. You will have
to decide which one is the best for you - in this course we will learn
how to use <a href="https://www.jetbrains.com/pycharm/" class="external-link">PyCharm</a>, a
free, open source Python IDE. Some popular alternatives include free and
open source IDE <a href="https://www.spyder-ide.org/" class="external-link">Spyder</a> and
Microsoft’s free <a href="https://code.visualstudio.com/" class="external-link">Visual Studio
Code (VS Code)</a>.</p>
<div id="using-vs-code-for-this-course" class="callout">
<div class="callout-square">
<i class="callout-icon" data-feather="bell"></i>
</div>
<div id="using-vs-code-for-this-course" class="callout-inner">
<h3 class="callout-title">Using VS Code for This Course</h3>
<div class="callout-content">
<p>If you want to use VS Code as your IDE for this course, there is a
separate <a href="vscode.html">extras episode</a> to help you set up.
The instructions for PyCharm in the course will not apply to you
verbatim but there is an equivalent functionality in VS Code for each of
the actions we ask you to do in PyCharm.</p>
</div>
</div>
</div>
</section><section><h2 class="section-heading" id="using-the-pycharm-ide">Using the PyCharm IDE<a class="anchor" aria-label="anchor" href="#using-the-pycharm-ide"></a>
</h2>
<hr class="half-width">
<p>Let us open our project in PyCharm now and familiarise ourselves with
some commonly used features.</p>
<div class="section level3">
<h3 id="opening-a-software-project">Opening a Software Project<a class="anchor" aria-label="anchor" href="#opening-a-software-project"></a>
</h3>
<p>If you do not have PyCharm running yet, start it up now. You can skip
the initial configuration steps which just go through selecting a theme
and other aspects. You should be presented with a dialog box that asks
you what you want to do, e.g. <code>Create New Project</code>,
<code>Open</code>, or <code>Check out from Version Control</code>.</p>
<p>Select <code>Open</code> and find the software project directory
<code>python-intermediate-inflammation</code> you cloned earlier. This
directory is now the current working directory for PyCharm, so when we
run scripts from PyCharm, this is the directory they will run from.</p>
<p>PyCharm will show you a <em>‘Tip of the Day’</em> window which you
can safely ignore and close for now. You may also get a warning <em>‘No
Python interpreter configured for the project’</em> - we <a href="#configuring-a-virtual-environment-in-pycharm">will deal with
this</a> shortly after we familiarise ourselves with the PyCharm
environment. You will notice the IDE shows you a project/file navigator
window on the left hand side, to traverse and select the files (and any
subdirectories) within the working directory, and an editor window on
the right. At the bottom, you would typically have a panel for version
control, terminal (the command line within PyCharm) and a TODO list.</p>
<figure><img src="../fig/pycharm-open-project.png" class="image-with-shadow figure mx-auto d-block" alt="View of an opened project in PyCharm" width="1000"></figure><p>Select the <code>inflammation-analysis.py</code> file in the project
navigator on the left so that its contents are displayed in the editor
window. You may notice a warning about the missing Python interpreter at
the top of the editor panel showing
<code>inflammation-analysis.py</code> file - this is one of the first
things you will have to configure for your project before you can do any
work.</p>
<figure><img src="../fig/pycharm-missing-python-interpreter.png" class="image-with-shadow figure mx-auto d-block" alt="Missing Python Interpreter Warning in PyCharm" width="800"></figure><p>You may take the shortcut and click on one of the offered options
above but we want to take you through the whole process of setting up
your environment in PyCharm as this is important conceptually.</p>
</div>
<div class="section level3">
<h3 id="configuring-a-virtual-environment-in-pycharm">Configuring a Virtual Environment in PyCharm<a class="anchor" aria-label="anchor" href="#configuring-a-virtual-environment-in-pycharm"></a>
</h3>
<p>Before you can run the code from PyCharm, you need to explicitly
specify the path to the Python interpreter on your system. The same goes
for any dependencies your code may have - you need to tell PyCharm where
to find them - much like we did from the command line in the previous
episode. Luckily for us, we have already set up a virtual environment
for our project from the command line and PyCharm is clever enough to
understand it.</p>
<div class="section level4">
<h4 id="adding-a-python-interpreter">Adding a Python Interpreter<a class="anchor" aria-label="anchor" href="#adding-a-python-interpreter"></a>
</h4>
<ol style="list-style-type: decimal">
<li>Select either <code>PyCharm</code> &gt; <code>Settings</code> (Mac)
or <code>File</code> &gt; <code>Settings</code> (Linux, Windows).</li>
<li>In the window that appears, select
<code>Project: python-intermediate-inflammation</code> &gt;
<code>Python Interpreter</code> from the left. You’ll see a number of
Python packages displayed as a list, and importantly above that, the
current Python interpreter that is being used. These may be blank or set
to <code>&lt;No interpreter&gt;</code>, or possibly the default version
of Python installed on your system,
e.g. <code>Python 2.7 /usr/bin/python2.7</code>, which we do not want to
use in this instance.</li>
<li>Select the cog-like button in the top right, then
<code>Add...</code> (or <code>Add Local...</code> depending on your
PyCharm version). An <code>Add Python Interpreter</code> window will
appear.</li>
<li>Select <code>Virtualenv Environment</code> from the list on the left
and ensure that <code>Existing environment</code> checkbox is selected
within the popup window. In the <code>Interpreter</code> field point to
the Python 3 executable inside your virtual environment’s
<code>bin</code> directory (make sure you navigate to it and select it
from the file browser rather than just accept the default offered by
PyCharm). Note that there is also an option to create a new virtual
environment, but we are not using that option as we want to reuse the
one we created from the command line in the previous episode. <img src="../fig/pycharm-configuring-interpreter.png" class="image-with-shadow figure" alt="Configuring Python Interpreter in PyCharm" width="800">
</li>
<li>Select <code>Make available to all projects</code> checkbox so we
can also use this environment for other projects if we wish.</li>
<li>Select <code>OK</code> in the <code>Add Python Interpreter</code>
window. Back in the <code>Preferences</code> window, you should select
“Python 3.11 (python-intermediate-inflammation)” or similar (that you
have just added) from the <code>Project Interpreter</code> drop-down
list.</li>
</ol>
<p>Note that a number of external libraries have magically appeared
under the “Python 3.11 (python-intermediate-inflammation)” interpreter,
including <code>numpy</code> and <code>matplotlib</code>. PyCharm has
recognised the virtual environment we created from the command line
using <code>venv</code> and has added these libraries effectively
replicating our virtual environment in PyCharm (referred to as “Python
3.11 (python-intermediate-inflammation)”).</p>
<figure><img src="../fig/pycharm-installed-packages.png" class="image-with-shadow figure mx-auto d-block" alt="Packages Currently Installed in a Virtual Environment in PyCharm" width="800"></figure><p>Also note that, although the names are not the same - this is one and
the same virtual environment and changes done to it in PyCharm will
propagate to the command line and vice versa. Let us see this in action
through the following exercise.</p>
<div id="compare-external-libraries-in-the-command-line-and-pycharm" class="callout challenge">
<div class="callout-square">
<i class="callout-icon" data-feather="zap"></i>
</div>
<div id="compare-external-libraries-in-the-command-line-and-pycharm" class="callout-inner">
<h3 class="callout-title">Compare External Libraries in the Command Line and PyCharm</h3>
<div class="callout-content">
<p>Can you recall two places where information about our project’s
dependencies can be found from the command line? Compare that
information with the equivalent configuration in PyCharm.</p>
<p>Hint: We can use an argument to <code>pip</code>, or find the
packages directly in a subdirectory of our virtual environment directory
“venv”.</p>
</div>
</div>
</div>
<div id="accordionSolution1" class="accordion challenge-accordion accordion-flush">
<div class="accordion-item">
<button class="accordion-button solution-button collapsed" type="button" data-bs-toggle="collapse" data-bs-target="#collapseSolution1" aria-expanded="false" aria-controls="collapseSolution1">
  <h4 class="accordion-header" id="headingSolution1"> Show me the solution </h4>
</button>
<div id="collapseSolution1" class="accordion-collapse collapse" data-bs-parent="#accordionSolution1" aria-labelledby="headingSolution1">
<div class="accordion-body">
<p>From the previous episode, you may remember that we can get the list
of packages in the current virtual environment using
<code>pip</code>:</p>
<div class="codewrapper sourceCode" id="cb1">
<h3 class="code-label">BASH<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="sourceCode bash" tabindex="0"><code class="sourceCode bash"><span id="cb1-1"><a href="#cb1-1" tabindex="-1"></a><span class="kw">(</span><span class="ex">venv</span><span class="kw">)</span> <span class="ex">$</span> python3 <span class="at">-m</span> pip list <span class="at">--exclude-editable</span></span></code></pre>
</div>
<div class="codewrapper">
<h3 class="code-label">OUTPUT<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="output" tabindex="0"><code>Package         Version

***

contourpy       1.2.0
cycler          0.12.1
fonttools       4.45.0
kiwisolver      1.4.5
matplotlib      3.8.2
numpy           1.26.2
packaging       23.2
Pillow          10.1.0
pip             23.0.1
pyparsing       3.1.1
python-dateutil 2.8.2
setuptools      67.6.1
six             1.16.0</code></pre>
</div>
<p>However, <code>python3 -m pip list</code> shows all the packages in
the virtual environment - if we want to see only the list of packages
that we installed, we can use the <code>python3 -m pip freeze</code>
command instead:</p>
<div class="codewrapper sourceCode" id="cb3">
<h3 class="code-label">BASH<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="sourceCode bash" tabindex="0"><code class="sourceCode bash"><span id="cb3-1"><a href="#cb3-1" tabindex="-1"></a><span class="kw">(</span><span class="ex">venv</span><span class="kw">)</span> <span class="ex">$</span> python3 <span class="at">-m</span> pip freeze <span class="at">--exclude-editable</span></span></code></pre>
</div>
<div class="codewrapper">
<h3 class="code-label">OUTPUT<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="output" tabindex="0"><code>contourpy==1.2.0
cycler==0.12.1
fonttools==4.45.0
kiwisolver==1.4.5
matplotlib==3.8.2
numpy==1.26.2
packaging==23.2
Pillow==10.1.0
pyparsing==3.1.1
python-dateutil==2.8.2
six==1.16.0</code></pre>
</div>
<p>We see the <code>pip</code> package in
<code>python3 -m pip list</code> but not in
<code>python3 -m pip freeze</code> as we did not install it using
<code>pip</code>. Remember that we use
<code>python3 -m pip freeze --exclude-editable</code> to update our
<code>requirements.txt</code> file, to keep a list of the packages our
virtual environment includes. Python will not do this automatically; we
have to manually update the file when our requirements change using:</p>
<div class="codewrapper sourceCode" id="cb5">
<h3 class="code-label">BASH<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="sourceCode bash" tabindex="0"><code class="sourceCode bash"><span id="cb5-1"><a href="#cb5-1" tabindex="-1"></a><span class="ex">python3</span> <span class="at">-m</span> pip freeze <span class="at">--exclude-editable</span> <span class="op">&gt;</span> requirements.txt</span></code></pre>
</div>
<p>If we want, we can also see the list of packages directly in the
following subdirectory of <code>venv</code>:</p>
<div class="codewrapper sourceCode" id="cb6">
<h3 class="code-label">BASH<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="sourceCode bash" tabindex="0"><code class="sourceCode bash"><span id="cb6-1"><a href="#cb6-1" tabindex="-1"></a><span class="kw">(</span><span class="ex">venv</span><span class="kw">)</span> <span class="ex">$</span> ls <span class="at">-l</span> venv/lib/python3.11/site-packages</span></code></pre>
</div>
<div class="codewrapper">
<h3 class="code-label">OUTPUT<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="output" tabindex="0"><code>total 88
drwxr-xr-x  105 alex  staff   3360 20 Nov 15:34 PIL
drwxr-xr-x    9 alex  staff    288 20 Nov 15:34 Pillow-10.1.0.dist-info
drwxr-xr-x    4 alex  staff    128 20 Nov 15:34 **pycache**
drwxr-xr-x    5 alex  staff    160 20 Nov 15:32 \_distutils\_hack
drwxr-xr-x   16 alex  staff    512 20 Nov 15:34 contourpy
drwxr-xr-x    7 alex  staff    224 20 Nov 15:34 contourpy-1.2.0.dist-info
drwxr-xr-x    5 alex  staff    160 20 Nov 15:34 cycler
drwxr-xr-x    8 alex  staff    256 20 Nov 15:34 cycler-0.12.1.dist-info
drwxr-xr-x   14 alex  staff    448 20 Nov 15:34 dateutil
\-rw-r--r--    1 alex  staff    151 20 Nov 15:32 distutils-precedence.pth
drwxr-xr-x   33 alex  staff   1056 20 Nov 15:34 fontTools
drwxr-xr-x    9 alex  staff    288 20 Nov 15:34 fonttools-4.45.0.dist-info
drwxr-xr-x    8 alex  staff    256 20 Nov 15:34 kiwisolver
drwxr-xr-x    8 alex  staff    256 20 Nov 15:34 kiwisolver-1.4.5.dist-info
drwxr-xr-x  150 alex  staff   4800 20 Nov 15:34 matplotlib
drwxr-xr-x   20 alex  staff    640 20 Nov 15:34 matplotlib-3.8.2.dist-info
drwxr-xr-x    5 alex  staff    160 20 Nov 15:34 mpl\_toolkits
drwxr-xr-x   43 alex  staff   1376 20 Nov 15:34 numpy
drwxr-xr-x    9 alex  staff    288 20 Nov 15:34 numpy-1.26.2.dist-info
drwxr-xr-x   18 alex  staff    576 20 Nov 15:34 packaging
drwxr-xr-x    9 alex  staff    288 20 Nov 15:34 packaging-23.2.dist-info
drwxr-xr-x    9 alex  staff    288 20 Nov 15:32 pip
drwxr-xr-x   10 alex  staff    320 20 Nov 15:33 pip-23.0.1.dist-info
drwxr-xr-x    6 alex  staff    192 20 Nov 15:32 pkg\_resources
\-rw-r--r--    1 alex  staff     90 20 Nov 15:34 pylab.py
drwxr-xr-x   15 alex  staff    480 20 Nov 15:34 pyparsing
drwxr-xr-x    7 alex  staff    224 20 Nov 15:34 pyparsing-3.1.1.dist-info
drwxr-xr-x    9 alex  staff    288 20 Nov 15:34 python\_dateutil-2.8.2.dist-info
drwxr-xr-x   49 alex  staff   1568 20 Nov 15:32 setuptools
drwxr-xr-x   10 alex  staff    320 20 Nov 15:32 setuptools-67.6.1.dist-info
drwxr-xr-x    8 alex  staff    256 20 Nov 15:34 six-1.16.0.dist-info
\-rw-r--r--    1 alex  staff  34549 20 Nov 15:34 six.py</code></pre>
</div>
<p>Finally, if you look at both the contents of
<code>venv/lib/python3.11/site-packages</code> and
<code>requirements.txt</code> and compare that with the packages shown
in PyCharm’s Python Interpreter Configuration - you will see that they
all contain equivalent information.</p>
</div>
</div>
</div>
</div>
</div>
<div class="section level4">
<h4 id="adding-an-external-library">Adding an External Library<a class="anchor" aria-label="anchor" href="#adding-an-external-library"></a>
</h4>
<p>We have already added packages <code>numpy</code> and
<code>matplotlib</code> to our virtual environment from the command line
in the previous episode, so we are up-to-date with all external
libraries we require at the moment. However, we will need library
<code>pytest</code> soon to implement tests for our code. We will use
this opportunity to install it from PyCharm in order to see an
alternative way of doing this and how it propagates to the command
line.</p>
<ol style="list-style-type: decimal">
<li>Select either <code>PyCharm</code> &gt; <code>Settings</code> (Mac)
or <code>File</code> &gt; <code>Settings</code> (Linux, Windows).</li>
<li>In the preferences window that appears, select
<code>Project: python-intermediate-inflammation</code> &gt;
<code>Project Interpreter</code> from the left.</li>
<li>Select the <code>+</code> icon at the top of the window. In the
window that appears, search for the name of the library
(<code>pytest</code>), select it from the list, then select
<code>Install Package</code>. Once it finishes installing, you can close
that window. <img src="../fig/pycharm-add-library.png" class="image-with-shadow figure" alt="Installing a package in PyCharm" width="800">
</li>
<li>Select <code>OK</code> in the
<code>Preferences</code>/<code>Settings</code> window.</li>
</ol>
<p>It may take a few minutes for PyCharm to install it. After it is
done, the <code>pytest</code> library is added to our virtual
environment. You can also verify this from the command line by listing
the <code>venv/lib/python3.11/site-packages</code> subdirectory. Note,
however, that <code>requirements.txt</code> is not updated - as we
mentioned earlier this is something you have to do manually. Let us do
this as an exercise.</p>
<div id="update-requirements.txt-after-adding-a-new-dependency" class="callout challenge">
<div class="callout-square">
<i class="callout-icon" data-feather="zap"></i>
</div>
<div id="update-requirements.txt-after-adding-a-new-dependency" class="callout-inner">
<h3 class="callout-title">Update <code>requirements.txt</code> After
Adding a New Dependency</h3>
<div class="callout-content">
<p>Export the newly updated virtual environment into
<code>requirements.txt</code> file.</p>
</div>
</div>
</div>
<div id="accordionSolution2" class="accordion challenge-accordion accordion-flush">
<div class="accordion-item">
<button class="accordion-button solution-button collapsed" type="button" data-bs-toggle="collapse" data-bs-target="#collapseSolution2" aria-expanded="false" aria-controls="collapseSolution2">
  <h4 class="accordion-header" id="headingSolution2"> Show me the solution </h4>
</button>
<div id="collapseSolution2" class="accordion-collapse collapse" data-bs-parent="#accordionSolution2" aria-labelledby="headingSolution2">
<div class="accordion-body">
<p>Let us verify first that the newly installed library
<code>pytest</code> is appearing in our virtual environment but not in
<code>requirements.txt</code>. First, let us check the list of installed
packages:</p>
<div class="codewrapper sourceCode" id="cb8">
<h3 class="code-label">BASH<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="sourceCode bash" tabindex="0"><code class="sourceCode bash"><span id="cb8-1"><a href="#cb8-1" tabindex="-1"></a><span class="kw">(</span><span class="ex">venv</span><span class="kw">)</span> <span class="ex">$</span> python3 <span class="at">-m</span> pip list</span></code></pre>
</div>
<div class="codewrapper">
<h3 class="code-label">OUTPUT<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="output" tabindex="0"><code>Package         Version

***

contourpy       1.2.0
cycler          0.12.1
fonttools       4.45.0
iniconfig       2.0.0
kiwisolver      1.4.5
matplotlib      3.8.2
numpy           1.26.2
packaging       23.2
Pillow          10.1.0
pip             23.0.1
pluggy          1.3.0
pyparsing       3.1.1
pytest          7.4.3
python-dateutil 2.8.2
setuptools      67.6.1
six             1.16.0</code></pre>
</div>
<p>We can see the <code>pytest</code> library appearing in the listing
above. However, if we do:</p>
<div class="codewrapper sourceCode" id="cb10">
<h3 class="code-label">BASH<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="sourceCode bash" tabindex="0"><code class="sourceCode bash"><span id="cb10-1"><a href="#cb10-1" tabindex="-1"></a><span class="kw">(</span><span class="ex">venv</span><span class="kw">)</span> <span class="ex">$</span> cat requirements.txt</span></code></pre>
</div>
<div class="codewrapper">
<h3 class="code-label">OUTPUT<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="output" tabindex="0"><code>contourpy==1.2.0
cycler==0.12.1
fonttools==4.45.0
kiwisolver==1.4.5
matplotlib==3.8.2
numpy==1.26.2
packaging==23.2
Pillow==10.1.0
pyparsing==3.1.1
python-dateutil==2.8.2
six==1.16.0</code></pre>
</div>
<p><code>pytest</code> is missing from <code>requirements.txt</code>. To
add it, we need to update the file by repeating the command:</p>
<div class="codewrapper sourceCode" id="cb12">
<h3 class="code-label">BASH<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="sourceCode bash" tabindex="0"><code class="sourceCode bash"><span id="cb12-1"><a href="#cb12-1" tabindex="-1"></a><span class="kw">(</span><span class="ex">venv</span><span class="kw">)</span> <span class="ex">$</span> python3 <span class="at">-m</span> pip freeze <span class="at">--exclude-editable</span> <span class="op">&gt;</span> requirements.txt</span></code></pre>
</div>
<p><code>pytest</code> is now present in
<code>requirements.txt</code>:</p>
<div class="codewrapper">
<h3 class="code-label">OUTPUT<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="output" tabindex="0"><code>contourpy==1.2.0
cycler==0.12.1
fonttools==4.45.0
iniconfig==2.0.0
kiwisolver==1.4.5
matplotlib==3.8.2
numpy==1.26.2
packaging==23.2
Pillow==10.1.0
pluggy==1.3.0
pyparsing==3.1.1
pytest==7.4.3
python-dateutil==2.8.2
six==1.16.0</code></pre>
</div>
</div>
</div>
</div>
</div>
</div>
<div class="section level4">
<h4 id="adding-a-run-configuration-for-our-project">Adding a Run Configuration for Our Project<a class="anchor" aria-label="anchor" href="#adding-a-run-configuration-for-our-project"></a>
</h4>
<p>Having configured a virtual environment, we now need to tell PyCharm
to use it for our project. This is done by creating and adding a
<strong>Run Configuration</strong> to a project. Run Configurations in
PyCharm are named sets of startup properties that define which main
Python script to execute and what (optional) runtime
parameters/environment variables (i.e. additional configuration options)
to pass and use on top of virtual environments.</p>
<ol style="list-style-type: decimal">
<li>To add a new Run Configuration for a project - select
<code>Run</code> &gt; <code>Edit Configurations...</code> from the top
menu.</li>
<li>Select <code>Add new run configuration...</code> then
<code>Python</code>. <img src="../fig/pycharm-add-run-configuration.png" class="image-with-shadow figure" alt="Adding a Run Configuration in PyCharm" width="800">
</li>
<li>In the new popup window, in the <code>Script path</code> field
select the folder button and find and select
<code>inflammation-analysis.py</code>. This tells PyCharm which script
to run (i.e. what the main entry point to our application is). <img src="../fig/pycharm-run-configuration-popup.png" class="image-with-shadow figure" alt="Run Configuration Popup in PyCharm" width="800">
</li>
<li>In the same window, select “Python 3.11
(python-intermediate-inflammation)” (i.e. the virtual environment and
interpreter you configured earlier in this episode) in the
<code>Python interpreter</code> field.</li>
<li>You can give this run configuration a name at the top of the window
if you like - e.g. let us name it
<code>inflammation analysis</code>.</li>
<li>You can optionally configure run parameters and environment
variables in the same window - we do not need this at the moment.</li>
<li>Select <code>Apply</code> to confirm these settings.</li>
</ol>
<div id="virtual-environments-and-run-configurations-in-pycharm" class="callout">
<div class="callout-square">
<i class="callout-icon" data-feather="bell"></i>
</div>
<div id="virtual-environments-and-run-configurations-in-pycharm" class="callout-inner">
<h3 class="callout-title">Virtual Environments And Run Configurations in PyCharm</h3>
<div class="callout-content">
<p>We configured the Python interpreter to use for our project by
pointing PyCharm to the virtual environment we created from the command
line (which encapsulates a Python interpreter and external libraries our
code needs to run). Recall that you can create several virtual
environments based on the same Python interpreter but with different
external libraries - this is helpful when you need to develop different
types of applications. For example, you can create one virtual
environment based on Python 3.11 to develop Django Web applications and
another virtual environment based on the same Python 3.11 to work with
scientific libraries.</p>
<p>Run Configurations provided by PyCharm are one extra layer on top of
virtual environments - you can vary a run configuration each time your
code is executed and you can have separate configurations for running,
debugging and testing your code.</p>
</div>
</div>
</div>
<p>Now you know how to configure and manipulate your environment in both
tools (command line and PyCharm), which is a useful parallel to be aware
of. Let us have a look at some other features afforded to us by
PyCharm.</p>
</div>
</div>
<div class="section level3">
<h3 id="syntax-highlighting">Syntax Highlighting<a class="anchor" aria-label="anchor" href="#syntax-highlighting"></a>
</h3>
<p>The first thing you may notice is that code is displayed using
different colours. Syntax highlighting is a feature that displays source
code terms in different colours and fonts according to the syntax
category the highlighted term belongs to. It also makes syntax errors
visually distinct. Highlighting does not affect the meaning of the code
itself - it is intended only for humans to make reading code and finding
errors easier.</p>
<figure><img src="../fig/pycharm-syntax-highlighting.png" class="image-with-shadow figure mx-auto d-block" alt="Syntax Highlighting Functionality in PyCharm" width="1000"></figure>
</div>
<div class="section level3">
<h3 id="code-completion">Code Completion<a class="anchor" aria-label="anchor" href="#code-completion"></a>
</h3>
<p>As you start typing code, PyCharm will offer to complete some of the
code for you in the form of an auto completion popup. This is a
context-aware code completion feature that speeds up the process of
coding (e.g. reducing typos and other common mistakes) by offering
available variable names, functions from available packages, parameters
of functions, hints related to syntax errors, etc.</p>
<figure><img src="../fig/pycharm-code-completion.png" class="image-with-shadow figure mx-auto d-block" alt="Code Completion Functionality in PyCharm" width="600"></figure>
</div>
<div class="section level3">
<h3 id="code-definition-documentation-references">Code Definition &amp; Documentation References<a class="anchor" aria-label="anchor" href="#code-definition-documentation-references"></a>
</h3>
<p>You will often need code reference information to help you code.
PyCharm shows this useful information, such as definitions of symbols
(e.g. functions, parameters, classes, fields, and methods) and
documentation references by means of quick popups and inline
tooltips.</p>
<p>For a selected piece of code, you can access various code reference
information from the <code>View</code> menu (or via various keyboard
shortcuts), including:</p>
<ul>
<li>Quick Definition - where and how symbols (functions, parameters,
classes, fields, and methods) are defined</li>
<li>Quick Type Definition - type definition of variables, fields or any
other symbols</li>
<li>Quick Documentation - inline documentation (<a href="15-coding-conventions.html"><em>docstrings</em></a> for any symbol
created in accordance with <a href="https://peps.python.org/pep-0257/" class="external-link">PEP-257</a>)</li>
<li>Parameter Info - the names and expected types of parameters in
method and function calls. Use this when cursor is on the argument of a
function call.</li>
<li>Type Info - type of an expression</li>
</ul>
<figure><img src="../fig/pycharm-code-reference.png" class="image-with-shadow figure mx-auto d-block" alt="Code References Functionality in PyCharm" width="1000"></figure>
</div>
<div class="section level3">
<h3 id="code-search">Code Search<a class="anchor" aria-label="anchor" href="#code-search"></a>
</h3>
<p>You can search for a text string within a project, use different
scopes to narrow your search process, use regular expressions for
complex searches, include/exclude certain files from your search, find
usages and occurrences. To find a search string in the whole
project:</p>
<ol style="list-style-type: decimal">
<li><p>From the main menu, select
<code>Edit | Find | Find in Path ...</code> (or
<code>Edit | Find | Find in Files...</code> depending on your version of
PyCharm).</p></li>
<li>
<p>Type your search string in the search field of the popup.
Alternatively, in the editor, highlight the string you want to find and
press <code>Command-Shift-F</code> (on Mac) or
<code>Control-Shift-F</code> (on Windows). PyCharm places the
highlighted string into the search field of the popup.</p>
<figure><img src="../fig/pycharm-code-search.png" class="image-with-shadow figure mx-auto d-block" alt="Code Search Functionality in PyCharm" width="800"></figure><p>If you need, specify the additional options in the popup. PyCharm
will list the search strings and all the files that contain
them.</p>
</li>
<li><p>Check the results in the preview area of the dialog where you can
replace the search string or select another string, or press
<code>Command-Shift-F</code> (on Mac) or <code>Control-Shift-F</code>
(on Windows) again to start a new search.</p></li>
<li>
<p>To see the list of occurrences in a separate panel, click the
<code>Open in Find Window</code> button in the bottom right corner. The
find panel will appear at the bottom of the main window; use this panel
and its options to group the results, preview them, and work with them
further.</p>
<figure><img src="../fig/pycharm-find-panel.png" class="image-with-shadow figure mx-auto d-block" alt="Code Search Functionality in PyCharm" width="1000"></figure>
</li>
</ol>
</div>
<div class="section level3">
<h3 id="version-control">Version Control<a class="anchor" aria-label="anchor" href="#version-control"></a>
</h3>
<p>PyCharm supports a directory-based versioning model, which means that
each project directory can be associated with a different version
control system. Our project was already under Git version control and
PyCharm recognised it. It is also possible to add an unversioned project
directory to version control directly from PyCharm.</p>
<p>During this course, we will do all our version control commands from
the command line but it is worth noting that PyCharm supports a
comprehensive subset of Git commands (i.e. it is possible to perform a
set of common Git commands from PyCharm but not all). A very useful
version control feature in PyCharm is graphically comparing changes you
made locally to a file with the version of the file in a repository, a
different commit version or a version in a different branch - this is
something that cannot be done equally well from the text-based command
line.</p>
<p>You can get a full <a href="https://www.jetbrains.com/help/pycharm/version-control-integration.html" class="external-link">documentation
on PyCharm’s built-in version control support</a> online.</p>
<figure><img src="../fig/pycharm-version-control.png" class="image-with-shadow figure mx-auto d-block" alt="Version Control Functionality in PyCharm" width="1000"></figure>
</div>
<div class="section level3">
<h3 id="running-scripts-in-pycharm">Running Scripts in PyCharm<a class="anchor" aria-label="anchor" href="#running-scripts-in-pycharm"></a>
</h3>
<p>We have configured our environment and explored some of the most
commonly used PyCharm features and are now ready to run our script from
PyCharm! To do so, right-click the <code>inflammation-analysis.py</code>
file in the PyCharm project/file navigator on the left, and select
<code>Run 'inflammation analysis'</code> (i.e. the Run Configuration we
created earlier).</p>
<figure><img src="../fig/pycharm-run-script.png" class="image-with-shadow figure mx-auto d-block" alt="Running a script from PyCharm" width="800"></figure><p>The script will run in a terminal window at the bottom of the IDE
window and display something like:</p>
<div class="codewrapper">
<h3 class="code-label">OUTPUT<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="output" tabindex="0"><code>/Users/alex/work/python-intermediate-inflammation/venv/bin/python /Users/alex/work/python-intermediate-inflammation/inflammation-analysis.py
usage: inflammation-analysis.py [-h] infiles [infiles ...]
inflammation-analysis.py: error: the following arguments are required: infiles

Process finished with exit code 2</code></pre>
</div>
<p>This is the same error we got when running the script from the
command line. We will get back to this error shortly - for now, the good
thing is that we managed to set up our project for development both from
the command line and PyCharm and are getting the same outputs. Before we
move on to fixing errors and writing more code, Let us have a look at
the last set of tools for collaborative code development which we will
be using in this course - Git and GitHub.</p>
</div>
</section><section><h2 class="section-heading" id="optional-exercises">Optional exercises<a class="anchor" aria-label="anchor" href="#optional-exercises"></a>
</h2>
<hr class="half-width">
<p>Checkout <a href="17-section1-optional-exercises.html">this optional
exercise</a> to try out different IDEs and code editors.</p>
<div id="keypoints1" class="callout keypoints">
<div class="callout-square">
<i class="callout-icon" data-feather="key"></i>
</div>
<div class="callout-inner">
<h3 class="callout-title">Key Points</h3>
<div class="callout-content">
<ul>
<li>An IDE is an application that provides a comprehensive set of
facilities for software development, including syntax highlighting, code
search and completion, version control, testing and debugging.</li>
<li>PyCharm recognises virtual environments configured from the command
line using <code>venv</code> and <code>pip</code>.</li>
</ul>
</div>
</div>
</div>
</section></section><section id="aio-14-collaboration-using-git"><p>Content from <a href="14-collaboration-using-git.html">1.4 Software Development Using Git and GitHub</a></p>
<hr>
<p>Last updated on 2025-06-19 |

        <a href="https://github.com/carpentries-incubator/python-intermediate-development/edit/main/episodes/14-collaboration-using-git.md" class="external-link">Edit this page <i aria-hidden="true" data-feather="edit"></i></a></p>
<p>Estimated time: <i aria-hidden="true" data-feather="clock"></i> 35 minutes</p>
<div class="text-end">
          <button role="button" aria-pressed="false" tabindex="0" id="expand-code" class="pull-right" data-expand="Expand All Solutions " data-collapse="Collapse All Solutions "> Expand All Solutions <i aria-hidden="true" data-feather="plus"></i></button>
        </div>
<div class="overview card">
<h2 class="card-header">Overview</h2>
<div class="row g-0">
<div class="col-md-4">
<div class="card-body">
<div class="inner">
<h3 class="card-title">Questions</h3>
<ul>
<li>What are Git branches and why are they useful for code
development?</li>
<li>What are some best practices when developing software
collaboratively using Git?</li>
</ul>
</div>
</div>
</div>
<div class="col-md-8">
<div class="card-body">
<div class="inner bordered">
<h3 class="card-title">Objectives</h3>
<ul>
<li>Commit changes in a software project to a local repository and
publish them in a remote repository on GitHub</li>
<li>Create branches for managing different threads of code
development</li>
<li>Learn to use feature branch workflow to effectively collaborate with
a team on a software project</li>
</ul>
</div>
</div>
</div>
</div>
</div>
<section><h2 class="section-heading" id="introduction">Introduction<a class="anchor" aria-label="anchor" href="#introduction"></a>
</h2>
<hr class="half-width">
<p>So far we have checked out our software project from GitHub and used
command line tools to configure a virtual environment for our project
and run our code. We have also familiarised ourselves with PyCharm - a
graphical tool we will use for code development, testing and debugging.
We are now going to start using another set of tools from the
collaborative code development toolbox - namely, the version control
system Git and code sharing platform GitHub. These two will enable us to
track changes to our code and share it with others.</p>
<p>You may recall that we have already made some changes to our project
locally - we created a virtual environment in the directory called
“venv” and exported it to the <code>requirements.txt</code> file. We
should now decide which of those changes we want to check in and share
with others in our team. This is a typical software development workflow
- you work locally on code, test it to make sure it works correctly and
as expected, then record your changes using version control and share
your work with others via a shared and centrally backed-up
repository.</p>
<p>Firstly, let us remind ourselves how to work with Git from the
command line.</p>
</section><section><h2 class="section-heading" id="git-refresher">Git Refresher<a class="anchor" aria-label="anchor" href="#git-refresher"></a>
</h2>
<hr class="half-width">
<p>Git is a version control system for tracking changes in computer
files and coordinating work on those files among multiple people. It is
primarily used for source code management in software development but it
can be used to track changes in files in general - it is particularly
effective for tracking text-based files (e.g. source code files, CSV,
Markdown, HTML, CSS, Tex, etc. files).</p>
<p>Git has several important characteristics:</p>
<ul>
<li>support for non-linear development allowing you and your colleagues
to work on different parts of a project concurrently,</li>
<li>support for distributed development allowing for multiple people to
be working on the same project (even the same file) at the same
time,</li>
<li>every change recorded by Git remains part of the project history and
can be retrieved at a later date, so even if you make a mistake you can
revert to a point before it.</li>
</ul>
<p>The diagram below shows a typical software development lifecycle with
Git (in our case starting from making changes in a local branch that
“tracks” a remote branch) and the commonly used commands to interact
with different parts of the Git infrastructure, including:</p>
<ul>
<li>
<strong>working tree</strong> - a local directory (including any
subdirectories) where your project files live and where you are
currently working. It is also known as the “untracked” area of Git or
“working directory”. Any changes to files will be marked by Git in the
working tree. If you make changes to the working tree and do not
explicitly tell Git to save them - you will likely lose those changes.
Using <code>git add filename</code> command, you tell Git to start
tracking changes to file <code>filename</code> within your working
tree.</li>
<li>
<strong>staging area (index)</strong> - once you tell Git to start
tracking changes to files (with <code>git add filename</code> command),
Git saves those changes in the staging area on your local machine. Each
subsequent change to the same file needs to be followed by another
<code>git add filename</code> command to tell Git to update it in the
staging area. To see what is in your working tree and staging area at
any moment (i.e. what changes is Git tracking), run the command
<code>git status</code>.</li>
<li>
<strong>local repository</strong> - stored within the
<code>.git</code> working tree of your project locally, this is where
Git wraps together all your changes from the staging area and puts them
using the <code>git commit</code> command. Each commit is a new,
permanent snapshot (checkpoint, record) of your project in time, which
you can share or revert to.</li>
<li>
<strong>remote repository</strong> - this is a version of your
project that is hosted somewhere on the Internet (e.g., on GitHub,
GitLab or somewhere else). While your project is nicely
version-controlled in your local repository, and you have snapshots of
its versions from the past, if your machine crashes - you still may lose
all your work. Furthermore, you cannot share or collaborate on this
local work with others easily. Working with a remote repository involves
pushing your local changes remotely (using <code>git push</code>) and
pulling other people’s changes from a remote repository to your local
copy (using <code>git fetch</code> or <code>git pull</code>) to keep the
two in sync in order to collaborate (with a bonus that your work also
gets backed up to another machine). Note that a common best practice
when collaborating with others on a shared repository is to always do a
<code>git pull</code> before a <code>git push</code>, to ensure you have
any latest changes before you push your own.</li>
</ul>
<!--
Created with https://mermaid.live/edit#pako:eNqVUsFOwzAM_ZXIJxBldK3aZjlMQsANLhsSEuolNF5brU1KmgjKtH8nbRlsTEPCJ9t5L-9Z9gYyJRAYtPhqUWZ4W_Jc8zqVxMWT0utS5uRRI17O5xdLw_O-vtbIGclLQ7gQI3T_qYfeq4xXZIGNakujdDfCM1XXpRkZvxE9a4G1MnhEa2xbjKQjwGmtFZqsOC21PxsbvBWYrZU1_6DUqHP8w9gB4WuSqiJnbaG0yazzqPSPV1dVlXpDQV46su_oatA5Bw9cUvNSuH1tetkUTIE1psBcKnDFbWVSSOXWQbk1atnJDJjRFj2wjeBmt15gK161rouiN_sw3sBwCh5oZfPiG9Fw-axUffjN3UDb9XLdWxpzjVKgvlFWGmDxdOAD28A7sIhGkygJ_Wjm08APp4EHHbAknszCJAoCSumUhvHWg49Bz5_QJPJdRGEYz5IkpttPWWLlPg

sequenceDiagram
    Working Tree->>+Staging Area: git add
    Staging Area->>+Local Repository: git commit
    Local Repository->>+Remote Repository: git push
    Remote Repository->>+Local Repository: git fetch
    Local Repository->>+Working Tree:git checkout
    Local Repository->>+Working Tree:git merge
    Remote Repository->>+Working Tree: git pull (shortcut for git fetch followed by git checkout/merge)
--><!--
SVG of the diagram can be downloaded from:
https://mermaid.ink/svg/pako:eNqFksFuwyAMhl8FcemmdS_AodKm7rZe2sOkKRcXnAQNcEaMpqjquw-SZZtUReEE9vfbP5iL1GRQKtnjZ8KgcW-hieCrIPJ6o_hhQyP2NqJmisPjbvdwYmhK8CkiKNFYFmDMxP9PFfSVNDhxxI56W-TiOULQ7aTS5L3lSbgAlhpH9MS4VKRLfTuVWOJWfdTIul21cfMUqmg9xgbX-9-Kf8w7J-76liLrlI1Q_DOUT87RFxpxHsRvq5EBseEIeqx4Hnts7uVWZsCDNXmWl-Koktyix0qqvDVYQ3JcySpcMwqJ6TQELRXHhFuZOgM8j16qGlyfo2jKPQ7T_xi_yUy-jJlZ3UF4J5p112_HVM9r
--><figure><img src="../fig/git-lifecycle.svg" class="image-with-shadow figure mx-auto d-block" width="600" alt="Development lifecycle with Git, containing Git commands add, commit, push, fetch, restore, merge and pull"><div class="figcaption">Software development lifecycle with Git</div>
</figure></section><section><h2 class="section-heading" id="checking-in-changes-to-our-project">Checking-in Changes to Our Project<a class="anchor" aria-label="anchor" href="#checking-in-changes-to-our-project"></a>
</h2>
<hr class="half-width">
<p>Let us check-in the changes we have done to our project so far. The
first thing to do upon navigating into our software project’s directory
root is to check the current status of our local working directory and
repository.</p>
<div class="codewrapper sourceCode" id="cb1">
<h3 class="code-label">BASH<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="sourceCode bash" tabindex="0"><code class="sourceCode bash"><span id="cb1-1"><a href="#cb1-1" tabindex="-1"></a><span class="ex">$</span> git status</span></code></pre>
</div>
<div class="codewrapper">
<h3 class="code-label">OUTPUT<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="output" tabindex="0"><code>On branch main
Your branch is up to date with 'origin/main'.

Untracked files:
  (use "git add &lt;file&gt;..." to include in what will be committed)
	requirements.txt
	venv/

nothing added to commit but untracked files present (use "git add" to track)</code></pre>
</div>
<p>As expected, Git is telling us that we have some untracked files -
<code>requirements.txt</code> and directory “venv” - present in our
working directory which we have not staged nor committed to our local
repository yet. You do not want to commit the newly created directory
“venv” and share it with others because this directory is specific to
your machine and setup only (i.e. it contains local paths to libraries
on your system that most likely would not work on any other machine).
You do, however, want to share <code>requirements.txt</code> with your
team as this file can be used to replicate the virtual environment on
your collaborators’ systems.</p>
<p>To tell Git to intentionally ignore and not track certain files and
directories, you need to specify them in the <code>.gitignore</code>
text file. A common place to put this file is in the project root. Our
project already has <code>.gitignore</code>, but in cases where you do
not have it - you can simply create it yourself. In our case, we want to
tell Git to ignore the “venv” directory (and “.venv” as another naming
convention for directories containing virtual environments) and stop
notifying us about it. Edit your <code>.gitignore</code> file in PyCharm
and add a line containing “venv/” and another one containing “.venv/”.
It does not matter much in this case where within the file you add these
lines, so let us do it at the end. Your <code>.gitignore</code> should
look something like this:</p>
<div class="codewrapper">
<h3 class="code-label">OUTPUT<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="output" tabindex="0"><code># IDEs
.vscode/
.idea/

# Intermediate Coverage file
.coverage

# Output files
*.png

# Python runtime
*.pyc
*.egg-info
.pytest_cache

# Virtual environments
venv/
.venv/</code></pre>
</div>
<p>You may notice that we are already not tracking certain files and
directories with useful comments about what exactly we are ignoring. You
may also notice that each line in <code>.gitignore</code> is actually a
pattern, so you can ignore multiple files that match a pattern
(e.g. “*.png” will ignore all PNG files in the current directory).</p>
<p>If you run the <code>git status</code> command now, you will notice
that Git has cleverly understood that you want to ignore changes to the
“venv” directory so it is not warning us about it any more. However, it
has now detected a change to <code>.gitignore</code> file that needs to
be committed.</p>
<div class="codewrapper sourceCode" id="cb4">
<h3 class="code-label">BASH<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="sourceCode bash" tabindex="0"><code class="sourceCode bash"><span id="cb4-1"><a href="#cb4-1" tabindex="-1"></a><span class="ex">$</span> git status</span></code></pre>
</div>
<div class="codewrapper">
<h3 class="code-label">OUTPUT<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="output" tabindex="0"><code>On branch main
Your branch is up to date with 'origin/main'.

Changes not staged for commit:
  (use "git add &lt;file&gt;..." to update what will be committed)
  (use "git restore &lt;file&gt;..." to discard changes in working directory)
	modified:   .gitignore

Untracked files:
  (use "git add &lt;file&gt;..." to include in what will be committed)
	requirements.txt

no changes added to commit (use "git add" and/or "git commit -a")</code></pre>
</div>
<p>To commit the changes <code>.gitignore</code> and
<code>requirements.txt</code> to the local repository, we first have to
add these files to staging area to prepare them for committing. We can
do that at the same time as:</p>
<div class="codewrapper sourceCode" id="cb6">
<h3 class="code-label">BASH<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="sourceCode bash" tabindex="0"><code class="sourceCode bash"><span id="cb6-1"><a href="#cb6-1" tabindex="-1"></a><span class="ex">$</span> git add .gitignore requirements.txt</span></code></pre>
</div>
<p>Now we can commit them to the local repository with:</p>
<div class="codewrapper sourceCode" id="cb7">
<h3 class="code-label">BASH<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="sourceCode bash" tabindex="0"><code class="sourceCode bash"><span id="cb7-1"><a href="#cb7-1" tabindex="-1"></a><span class="ex">$</span> git commit <span class="at">-m</span> <span class="st">"Initial commit of requirements.txt. Ignoring virtual env. folder."</span></span></code></pre>
</div>
<p>Remember to use meaningful messages for your commits.</p>
<p>So far we have been working in isolation - all the changes we have
done are still only stored locally on our individual machines. In order
to share our work with others, we should push our changes to the remote
repository on GitHub. Before we push our changes however, we should
first do a <code>git pull</code>. This is considered best practice,
since any changes made to the repository - notably by other people - may
impact the changes we are about to push. This could occur, for example,
by two collaborators making different changes to the same lines in a
file. By pulling first, we are made aware of any changes made by others,
in particular if there are any conflicts between their changes and
ours.</p>
<div class="codewrapper sourceCode" id="cb8">
<h3 class="code-label">BASH<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="sourceCode bash" tabindex="0"><code class="sourceCode bash"><span id="cb8-1"><a href="#cb8-1" tabindex="-1"></a><span class="ex">$</span> git pull</span></code></pre>
</div>
<p>Now we have ensured our repository is synchronised with the remote
one, we can now push our changes:</p>
<div class="codewrapper sourceCode" id="cb9">
<h3 class="code-label">BASH<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="sourceCode bash" tabindex="0"><code class="sourceCode bash"><span id="cb9-1"><a href="#cb9-1" tabindex="-1"></a><span class="ex">$</span> git push origin main</span></code></pre>
</div>
<p>In the above command, <code>origin</code> is an alias for the remote
repository you used when cloning the project locally (it is called that
by convention and set up automatically by Git when you run
<code>git clone remote_url</code> command to replicate a remote
repository locally); <code>main</code> is the name of our main (and
currently only) development branch.</p>
<div id="github-authenticationauthorisation-error" class="callout">
<div class="callout-square">
<i class="callout-icon" data-feather="bell"></i>
</div>
<div id="github-authenticationauthorisation-error" class="callout-inner">
<h3 class="callout-title">GitHub Authentication/Authorisation Error</h3>
<div class="callout-content">
<p>If, at this point (i.e. the first time you try to write to a remote
repository on GitHub), you get a warning/error that HTTPS access is
deprecated, or a personal access token is required, then you have cloned
the repository using HTTPS and not SSH. You should revisit the <a href="index.html#secure-access-to-github-using-git-from-command-line">instructions
on setting up your GitHub for SSH and key pair authentication</a> and
can fix this from the command line by changing the remote repository’s
HTTPS URL to its SSH equivalent:</p>
<div class="codewrapper sourceCode" id="cb10">
<h3 class="code-label">BASH<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="sourceCode bash" tabindex="0"><code class="sourceCode bash"><span id="cb10-1"><a href="#cb10-1" tabindex="-1"></a><span class="ex">$</span> git remote set-url origin git@github.com:<span class="op">&lt;</span>YOUR_GITHUB_USERNAME<span class="op">&gt;</span>/python-intermediate-inflammation.git</span></code></pre>
</div>
</div>
</div>
</div>
<div id="git-remotes" class="callout">
<div class="callout-square">
<i class="callout-icon" data-feather="bell"></i>
</div>
<div id="git-remotes" class="callout-inner">
<h3 class="callout-title">Git Remotes</h3>
<div class="callout-content">
<p>Note that systems like Git allow us to synchronise work between any
two or more copies of the same repository - the ones that are not
located on your machine are “Git remotes” for you. In practice, though,
it is easiest to agree with your collaborators to use one copy as a
central hub (such as GitHub or GitLab), where everyone pushes their
changes to. This also avoid risks associated with keeping the “central
copy” on someone’s laptop. You can have more than one remote configured
for your local repository, each of which generally is either read-only
or read/write for you. Collaborating with others involves managing these
remote repositories and pushing and pulling information to and from them
when you need to share work.</p>
<figure><img src="../fig/git-distributed.png" class="image-with-shadow figure mx-auto d-block" alt="git-distributed" width="400"></figure><p style="text-align: center;">
Git - distributed version control system<br> From
<a href="https://www.w3docs.com/learn-git/git-repository.html" target="_blank" class="external-link">W3Docs</a>
(freely available)
</p>
</div>
</div>
</div>
</section><section><h2 class="section-heading" id="git-branches">Git Branches<a class="anchor" aria-label="anchor" href="#git-branches"></a>
</h2>
<hr class="half-width">
<p>When we do <code>git status</code>, Git also tells us that we are
currently on the <code>main</code> branch of the project. A branch is
one version of your project (the files in your repository) that can
contain its own set of commits. We can create a new branch, make changes
to the code which we then commit to the branch, and, once we are happy
with those changes, merge them back to the main branch. To see what
other branches are available, do:</p>
<div class="codewrapper sourceCode" id="cb11">
<h3 class="code-label">BASH<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="sourceCode bash" tabindex="0"><code class="sourceCode bash"><span id="cb11-1"><a href="#cb11-1" tabindex="-1"></a><span class="ex">$</span> git branch</span></code></pre>
</div>
<div class="codewrapper">
<h3 class="code-label">OUTPUT<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="output" tabindex="0"><code>* main</code></pre>
</div>
<p>At the moment, there is only one branch (<code>main</code>) and hence
only one version of the code available. When you create a Git repository
for the first time, by default you only get one version (i.e. branch) -
<code>main</code>. Let us have a look at why having different branches
might be useful.</p>
<div class="section level3">
<h3 id="feature-branch-software-development-workflow">Feature Branch Software Development Workflow<a class="anchor" aria-label="anchor" href="#feature-branch-software-development-workflow"></a>
</h3>
<p>While it is technically OK to commit your changes directly to
<code>main</code> branch, and you may often find yourself doing so for
some minor changes, the best practice is to use a new branch for each
separate and self-contained unit/piece of work you want to add to the
project. This unit of work is also often called a <em>feature</em> and
the branch where you develop it is called a <em>feature branch</em>.
Each feature branch should have its own meaningful name - indicating its
purpose (e.g. “issue23-fix”). If we keep making changes and pushing them
directly to <code>main</code> branch on GitHub, then anyone who
downloads our software from there will get all of our work in progress -
whether or not it is ready to use! So, working on a separate branch for
each feature you are adding is good for several reasons:</p>
<ul>
<li>it enables the main branch to remain stable while you and the team
explore and test the new code on a feature branch,</li>
<li>it enables you to keep the untested and not-yet-functional feature
branch code under version control and backed up,</li>
<li>you and other team members may work on several features at the same
time independently from one another, and</li>
<li>if you decide that the feature is not working or is no longer needed
- you can easily and safely discard that branch without affecting the
rest of the code.</li>
</ul>
<p>Branches are commonly used as part of a feature-branch workflow,
shown in the diagram below.</p>
<figure><img src="../fig/git-feature-branch.svg" class="image-with-shadow figure mx-auto d-block" alt="Git feature branch workflow diagram" width="800"></figure><p style="text-align: center;">
Git feature branches<br> Adapted from
<a href="https://sillevl.gitbooks.io/git/content/collaboration/workflows/gitflow/" target="_blank" class="external-link">Git
Tutorial by sillevl</a> (Creative Commons Attribution 4.0 International
License)
</p>
<p>In the software development workflow, we typically have a main branch
which is the version of the code that is tested, stable and reliable.
Then, we normally have a development branch (called <code>develop</code>
or <code>dev</code> by convention) that we use for work-in-progress
code. As we work on adding new features to the code, we create new
feature branches that first get merged into <code>develop</code> after a
thorough testing process. After even more testing - <code>develop</code>
branch will get merged into <code>main</code>. The points when feature
branches are merged to <code>develop</code>, and <code>develop</code> to
<code>main</code> depend entirely on the practice/strategy established
in the team. For example, for smaller projects (e.g. if you are working
alone on a project or in a very small team), feature branches sometimes
get directly merged into <code>main</code> upon testing, skipping the
<code>develop</code> branch step. In other projects, the merge into
<code>main</code> happens only at the point of making a new software
release. Whichever is the case for you, a good rule of thumb is -
nothing that is broken should be in <code>main</code>.</p>
</div>
<div class="section level3">
<h3 id="creating-branches">Creating Branches<a class="anchor" aria-label="anchor" href="#creating-branches"></a>
</h3>
<p>Let us create a <code>develop</code> branch to work on:</p>
<div class="codewrapper sourceCode" id="cb13">
<h3 class="code-label">BASH<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="sourceCode bash" tabindex="0"><code class="sourceCode bash"><span id="cb13-1"><a href="#cb13-1" tabindex="-1"></a><span class="ex">$</span> git branch develop</span></code></pre>
</div>
<p>This command does not give any output, but if we run
<code>git branch</code> again, without giving it a new branch name, we
can see the list of branches we have - including the new one we have
just made.</p>
<div class="codewrapper sourceCode" id="cb14">
<h3 class="code-label">BASH<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="sourceCode bash" tabindex="0"><code class="sourceCode bash"><span id="cb14-1"><a href="#cb14-1" tabindex="-1"></a><span class="ex">$</span> git branch</span></code></pre>
</div>
<div class="codewrapper">
<h3 class="code-label">OUTPUT<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="output" tabindex="0"><code>    develop
  * main</code></pre>
</div>
<p>The <code>*</code> indicates the currently active branch. So how do
we switch to our new branch? We use the <code>git switch</code> command
with the name of the branch:</p>
<div class="codewrapper sourceCode" id="cb16">
<h3 class="code-label">BASH<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="sourceCode bash" tabindex="0"><code class="sourceCode bash"><span id="cb16-1"><a href="#cb16-1" tabindex="-1"></a><span class="ex">$</span> git switch develop</span></code></pre>
</div>
<div class="codewrapper">
<h3 class="code-label">OUTPUT<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="output" tabindex="0"><code>Switched to branch 'develop'</code></pre>
</div>
<div id="create-and-switch-to-branch-shortcut" class="callout">
<div class="callout-square">
<i class="callout-icon" data-feather="bell"></i>
</div>
<div id="create-and-switch-to-branch-shortcut" class="callout-inner">
<h3 class="callout-title">Create and Switch to Branch Shortcut</h3>
<div class="callout-content">
<p>A shortcut to create a new branch and immediately switch to it:</p>
<div class="codewrapper sourceCode" id="cb18">
<h3 class="code-label">BASH<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="sourceCode bash" tabindex="0"><code class="sourceCode bash"><span id="cb18-1"><a href="#cb18-1" tabindex="-1"></a><span class="ex">$</span> git switch <span class="at">-c</span> develop</span></code></pre>
</div>
</div>
</div>
</div>
</div>
<div class="section level3">
<h3 id="updating-branches">Updating Branches<a class="anchor" aria-label="anchor" href="#updating-branches"></a>
</h3>
<p>If we start updating and committing files now, the commits will
happen on the <code>develop</code> branch and will not affect the
version of the code in <code>main</code>. We add and commit things to
<code>develop</code> branch in the same way as we do to
<code>main</code>.</p>
<p>Let us make a small modification to
<code>inflammation/models.py</code> in PyCharm, and, say, change the
spelling of “2d” to “2D” in docstrings for functions
<code>daily_mean()</code>, <code>daily_max()</code> and
<code>daily_min()</code> to see updating branches in action.</p>
<p>If we do:</p>
<div class="codewrapper sourceCode" id="cb19">
<h3 class="code-label">BASH<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="sourceCode bash" tabindex="0"><code class="sourceCode bash"><span id="cb19-1"><a href="#cb19-1" tabindex="-1"></a><span class="ex">$</span> git status</span></code></pre>
</div>
<div class="codewrapper">
<h3 class="code-label">OUTPUT<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="output" tabindex="0"><code>   On branch develop
   Changes not staged for commit:
     (use "git add &lt;file&gt;..." to update what will be committed)
     (use "git restore &lt;file&gt;..." to discard changes in working directory)

   	modified:   inflammation/models.py

   no changes added to commit (use "git add" and/or "git commit -a")</code></pre>
</div>
<p>Git is telling us that we are on branch <code>develop</code> and
which tracked files have been modified in our working directory.</p>
<p>We can now <code>add</code> and <code>commit</code> the changes in
the usual way.</p>
<div class="codewrapper sourceCode" id="cb21">
<h3 class="code-label">BASH<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="sourceCode bash" tabindex="0"><code class="sourceCode bash"><span id="cb21-1"><a href="#cb21-1" tabindex="-1"></a><span class="ex">$</span> git add inflammation/models.py</span>
<span id="cb21-2"><a href="#cb21-2" tabindex="-1"></a><span class="ex">$</span> git commit <span class="at">-m</span> <span class="st">"Spelling fix"</span></span></code></pre>
</div>
<div id="currently-active-branch" class="callout">
<div class="callout-square">
<i class="callout-icon" data-feather="bell"></i>
</div>
<div id="currently-active-branch" class="callout-inner">
<h3 class="callout-title">Currently Active Branch</h3>
<div class="callout-content">
<p>Remember, <code>add</code> and <code>commit</code> commands always
act on the currently active branch. You have to be careful and aware of
which branch you are working with at any given moment.
<code>git status</code> can help with that, and you will find yourself
invoking it very often.</p>
</div>
</div>
</div>
</div>
<div class="section level3">
<h3 id="pushing-new-branch-remotely">Pushing New Branch Remotely<a class="anchor" aria-label="anchor" href="#pushing-new-branch-remotely"></a>
</h3>
<p>We push the contents of the <code>develop</code> branch to GitHub in
the same way as we pushed the <code>main</code> branch. However, as we
have just created this branch locally, it still does not exist in our
remote repository. You can check that in GitHub by listing all
branches.</p>
<figure><img src="../fig/github-main-branch.png" class="image-with-shadow figure mx-auto d-block" alt="Software project's main branch" width="600"></figure><p>To push a new local branch remotely for the first time, you could use
the <code>-u</code> flag and the name of the branch you are creating and
pushing to:</p>
<div class="codewrapper sourceCode" id="cb22">
<h3 class="code-label">BASH<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="sourceCode bash" tabindex="0"><code class="sourceCode bash"><span id="cb22-1"><a href="#cb22-1" tabindex="-1"></a><span class="ex">$</span> git push <span class="at">-u</span> origin develop</span></code></pre>
</div>
<div id="git-push-with--u-flag" class="callout">
<div class="callout-square">
<i class="callout-icon" data-feather="bell"></i>
</div>
<div id="git-push-with--u-flag" class="callout-inner">
<h3 class="callout-title">Git Push With <code>-u</code> Flag</h3>
<div class="callout-content">
<p>Using the <code>-u</code> switch with the <code>git push</code>
command is a handy shortcut for: (1) creating the new remote branch and
(2) setting your local branch to automatically track the remote one at
the same time. You need to use the <code>-u</code> switch only once to
set up that association between your branch and the remote one
explicitly. After that you could simply use <code>git push</code>
without specifying the remote repository, if you wished so. We still
prefer to explicitly state this information in commands.</p>
</div>
</div>
</div>
<p>Let us confirm that the new branch <code>develop</code> now exists
remotely on GitHub too. From the <code>Code</code> tab in your
repository in GitHub, click the branch dropdown menu (currently showing
the default branch <code>main</code>). You should see your
<code>develop</code> branch in the list too.</p>
<figure><img src="../fig/github-develop-branch.png" class="image-with-shadow figure mx-auto d-block" alt="Software project's develop branch" width="600"></figure><p>You may also have noticed GitHub’s notification about the latest push
to your <code>develop</code> branch just on top of the repository files
and branches drop-down menu.</p>
<p>Now the others can check out the <code>develop</code> branch too and
continue to develop code on it.</p>
<p>After the initial push of the new branch, each next time we push to
it in the usual manner (i.e. without the <code>-u</code> switch):</p>
<div class="codewrapper sourceCode" id="cb23">
<h3 class="code-label">BASH<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="sourceCode bash" tabindex="0"><code class="sourceCode bash"><span id="cb23-1"><a href="#cb23-1" tabindex="-1"></a><span class="ex">$</span> git push origin develop</span></code></pre>
</div>
<div id="what-is-the-relationship-between-originating-and-new-branches" class="callout">
<div class="callout-square">
<i class="callout-icon" data-feather="bell"></i>
</div>
<div id="what-is-the-relationship-between-originating-and-new-branches" class="callout-inner">
<h3 class="callout-title">What is the Relationship Between Originating and New Branches?</h3>
<div class="callout-content">
<p>it is natural to think that new branches have a parent/child
relationship with their originating branch, but in actual Git terms,
branches themselves do not have parents but single commits do. Any
commit can have zero parents (a root, or initial, commit), one parent (a
regular commit), or multiple parents (a merge commit), and using this
structure, we can build a ‘view’ of branches from a set of commits and
their relationships. A common way to look at it is that Git branches are
really only <a href="https://git-scm.com/book/en/v2/Git-Branching-Branches-in-a-Nutshell" class="external-link">lightweight,
movable pointers to commits</a>. So as a new commit is added to a
branch, the branch pointer is moved to the new commit.</p>
<p>What this means is that when you accomplish a merge between two
branches, Git is able to determine the common ‘commit ancestor’ through
the commits in a ‘branch’, and use that common ancestor to determine
which commits need to be merged onto the destination branch. It also
means that, in theory, you could merge any branch with any other at any
time… although it may not make sense to do so!</p>
</div>
</div>
</div>
</div>
<div class="section level3">
<h3 id="merging-into-main-branch">Merging Into Main Branch<a class="anchor" aria-label="anchor" href="#merging-into-main-branch"></a>
</h3>
<p>Once you have tested your changes on the <code>develop</code> branch,
you will want to merge them onto the <code>main</code> branch. To do so,
make sure you have committed all your changes on the
<code>develop</code> branch and then switch to <code>main</code>:</p>
<div class="codewrapper sourceCode" id="cb24">
<h3 class="code-label">BASH<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="sourceCode bash" tabindex="0"><code class="sourceCode bash"><span id="cb24-1"><a href="#cb24-1" tabindex="-1"></a><span class="ex">$</span> git switch main</span></code></pre>
</div>
<div class="codewrapper">
<h3 class="code-label">OUTPUT<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="output" tabindex="0"><code>Switched to branch 'main'
Your branch is up to date with 'origin/main'.</code></pre>
</div>
<p>To merge the <code>develop</code> branch on top of <code>main</code>
do:</p>
<div class="codewrapper sourceCode" id="cb26">
<h3 class="code-label">BASH<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="sourceCode bash" tabindex="0"><code class="sourceCode bash"><span id="cb26-1"><a href="#cb26-1" tabindex="-1"></a><span class="ex">$</span> git merge develop</span></code></pre>
</div>
<div class="codewrapper">
<h3 class="code-label">OUTPUT<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="output" tabindex="0"><code>Updating 05e1ffb..be60389
Fast-forward
 inflammation/models.py | 6 +++---
 1 files changed, 3 insertions(+), 3 deletions(-)</code></pre>
</div>
<p>If there are no conflicts, Git will merge the branches without
complaining and replay all commits from <code>develop</code> on top of
the last commit from <code>main</code>. If there are merge conflicts
(e.g. a team collaborator modified the same portion of the same file you
are working on and checked in their changes before you), the particular
files with conflicts will be marked and you will need to resolve those
conflicts and commit the changes before attempting to merge again. Since
we have no conflicts, we can now push the <code>main</code> branch to
the remote repository:</p>
<div class="codewrapper sourceCode" id="cb28">
<h3 class="code-label">BASH<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="sourceCode bash" tabindex="0"><code class="sourceCode bash"><span id="cb28-1"><a href="#cb28-1" tabindex="-1"></a><span class="ex">$</span> git push origin main</span></code></pre>
</div>
<div id="all-branches-are-equal" class="callout">
<div class="callout-square">
<i class="callout-icon" data-feather="bell"></i>
</div>
<div id="all-branches-are-equal" class="callout-inner">
<h3 class="callout-title">All Branches Are Equal</h3>
<div class="callout-content">
<p>In Git, all branches are equal - there is nothing special about the
<code>main</code> branch. It is called that by convention and is created
by default, but it can also be called something else. A good example is
<code>gh-pages</code> branch which is often the source branch for
website projects hosted on GitHub (rather than <code>main</code>).</p>
</div>
</div>
</div>
<div id="keeping-main-branch-stable" class="callout">
<div class="callout-square">
<i class="callout-icon" data-feather="bell"></i>
</div>
<div id="keeping-main-branch-stable" class="callout-inner">
<h3 class="callout-title">Keeping Main Branch Stable</h3>
<div class="callout-content">
<p>Good software development practice is to keep the <code>main</code>
branch stable while you and the team develop and test new
functionalities on feature branches (which can be done in parallel and
independently by different team members). The next step is to merge
feature branches onto the <code>develop</code> branch, where more
testing can occur to verify that the new features work well with the
rest of the code (and not just in isolation). We talk more about
different types of code testing in one of the following episodes.</p>
</div>
</div>
</div>
<div id="keypoints1" class="callout keypoints">
<div class="callout-square">
<i class="callout-icon" data-feather="key"></i>
</div>
<div class="callout-inner">
<h3 class="callout-title">Key Points</h3>
<div class="callout-content">
<ul>
<li>A branch is one version of your project that can contain its own set
of commits.</li>
<li>Feature branches enable us to develop / explore / test new code
features without affecting the stable <code>main</code> code.</li>
</ul>
</div>
</div>
</div>
</div>
</section></section><section id="aio-15-coding-conventions"><p>Content from <a href="15-coding-conventions.html">1.5 Python Code Style Conventions</a></p>
<hr>
<p>Last updated on 2025-04-01 |

        <a href="https://github.com/carpentries-incubator/python-intermediate-development/edit/main/episodes/15-coding-conventions.md" class="external-link">Edit this page <i aria-hidden="true" data-feather="edit"></i></a></p>
<p>Estimated time: <i aria-hidden="true" data-feather="clock"></i> 40 minutes</p>
<div class="text-end">
          <button role="button" aria-pressed="false" tabindex="0" id="expand-code" class="pull-right" data-expand="Expand All Solutions " data-collapse="Collapse All Solutions "> Expand All Solutions <i aria-hidden="true" data-feather="plus"></i></button>
        </div>
<div class="overview card">
<h2 class="card-header">Overview</h2>
<div class="row g-0">
<div class="col-md-4">
<div class="card-body">
<div class="inner">
<h3 class="card-title">Questions</h3>
<ul>
<li>Why should you follow software code style conventions?</li>
<li>Who is setting code style conventions?</li>
<li>What code style conventions exist for Python?</li>
</ul>
</div>
</div>
</div>
<div class="col-md-8">
<div class="card-body">
<div class="inner bordered">
<h3 class="card-title">Objectives</h3>
<ul>
<li>Understand the benefits of following community coding
conventions</li>
</ul>
</div>
</div>
</div>
</div>
</div>
<section><h2 class="section-heading" id="introduction">Introduction<a class="anchor" aria-label="anchor" href="#introduction"></a>
</h2>
<hr class="half-width">
<p>We now have all the tools we need for software development and are
raring to go. But before you dive into writing some more code and
sharing it with others, ask yourself what kind of code should you be
writing and publishing? It may be worth spending some time learning a
bit about Python coding style conventions to make sure that your code is
consistently formatted and readable by yourself and others.</p>
<blockquote>
<p><em>“Any fool can write code that a computer can understand. Good
programmers write code that humans can understand.”</em></p>
<p>— <a href="https://en.wikiquote.org/wiki/Martin_Fowler" class="external-link">Martin
Fowler</a>, British software engineer, author and international speaker
on software development</p>
</blockquote>
</section><section><h2 class="section-heading" id="python-coding-style-guide">Python Coding Style Guide<a class="anchor" aria-label="anchor" href="#python-coding-style-guide"></a>
</h2>
<hr class="half-width">
<p>One of the most important things we can do to make sure our code is
readable by other developers (and ourselves a few months down the line)
is to make sure that it is descriptive, cleanly and consistently
formatted and uses sensible, descriptive names for variable, function
and module names. In order to help us format our code, we generally
follow guidelines known as a <strong>style guide</strong>. A style guide
is a set of conventions that we agree upon with our colleagues or
community, to ensure that everyone contributing to the same project is
producing code which looks similar in style. While a group of developers
may choose to write and agree upon a new style guide unique to each
project, in practice many programming languages have a single style
guide which is adopted almost universally by the communities around the
world. In Python, although we do have a choice of style guides
available, the <a href="https://www.python.org/dev/peps/pep-0008/" class="external-link">PEP
8</a> style guide is most commonly used. PEP here stands for Python
Enhancement Proposals; PEPs are design documents for the Python
community, typically specifications or conventions for how to do
something in Python, a description of a new feature in Python, etc.</p>
<div id="style-consistency" class="callout">
<div class="callout-square">
<i class="callout-icon" data-feather="bell"></i>
</div>
<div id="style-consistency" class="callout-inner">
<h3 class="callout-title">Style consistency</h3>
<div class="callout-content">
<p>One of the <a href="https://www.python.org/dev/peps/pep-0008/#a-foolish-consistency-is-the-hobgoblin-of-little-minds" class="external-link">key
insights from Guido van Rossum</a>, the creator of the Python
programming language and one of the PEP 8 authors, is that code is read
much more often than it is written. Style guidelines are intended to
improve the readability of code and make it consistent across the wide
spectrum of Python code. Consistency with the style guide is important.
Consistency within a project is more important. Consistency within one
module or function is the most important. However, know when to be
inconsistent - sometimes style guide recommendations are just not
applicable. When in doubt, use your best judgment. Look at other
examples and decide what looks best. And do not hesitate to ask!</p>
</div>
</div>
</div>
<p>As we have already covered in the <a href="13-ides.html">episode on
PyCharm IDE</a>, PyCharm highlights the language constructs (reserved
words) and syntax errors to help us with coding. PyCharm also gives us
recommendations for formatting the code - these recommendations are
mostly taken from the PEP 8 style guide.</p>
<p>A full list of style guidelines for this style is available from the
<a href="https://www.python.org/dev/peps/pep-0008/" class="external-link">PEP 8 website</a>;
here we highlight a few.</p>
<div class="section level3">
<h3 id="indentation">Indentation<a class="anchor" aria-label="anchor" href="#indentation"></a>
</h3>
<p>Python is a kind of language that uses indentation as a way of
grouping statements that belong to a particular block of code. Spaces
are the recommended indentation method in Python code. The guideline is
to use 4 spaces per indentation level - so 4 spaces on level one, 8
spaces on level two and so on. Many people prefer the use of tabs to
spaces to indent the code for many reasons (e.g. additional typing, easy
to introduce an error by missing a single space character, accessibility
for individuals using screen readers, etc.) and do not follow this
guideline. Whether you decide to follow this guideline or not, be
consistent and follow the style already used in the project.</p>
<div id="indentation-in-python-2-vs-python-3" class="callout">
<div class="callout-square">
<i class="callout-icon" data-feather="bell"></i>
</div>
<div id="indentation-in-python-2-vs-python-3" class="callout-inner">
<h3 class="callout-title">Indentation in Python 2 vs Python 3</h3>
<div class="callout-content">
<p>Python 2 allowed code indented with a mixture of tabs and spaces.
Python 3 disallows mixing the use of tabs and spaces for indentation.
Whichever you choose, be consistent throughout the project.</p>
</div>
</div>
</div>
<p>PyCharm has built-in support for converting tab indentation to spaces
“under the hood” for Python code in order to conform to PEP 8. So, you
can type a tab character and PyCharm will automatically convert it to 4
spaces. You can control the amount of spaces that PyCharm uses to
replace one tab character or you can decide to keep the tab character
altogether and prevent automatic conversion. You can modify these
settings in PyCharm’s
<code>Settings</code>&gt;<code>Editor</code>&gt;<code>Code Style</code>&gt;<code>Python</code>.</p>
<figure><img src="../fig/pycharm-indentation.png" class="image-with-shadow figure mx-auto d-block" alt="Python code indentation settings in PyCharm" width="800"></figure><p>You can also tell the editor to show non-printable characters if you
are ever unsure what character exactly is being used by selecting
<code>Settings</code> &gt; <code>Editor</code> &gt; <code>General</code>
&gt; <code>Appearance</code> then checking “Show whitespaces”
option.</p>
<figure><img src="../fig/pycharm-whitespace.png" class="image-with-shadow figure mx-auto d-block" alt="Python code whitespace settings in PyCharm" width="800"></figure><p>There are more complex rules on indenting single units of code that
continue over several lines, e.g. function, list or dictionary
definitions can all take more than one line. The preferred way of
wrapping such long lines is by using Python’s implied line continuation
inside delimiters such as parentheses (<code>()</code>), brackets
(<code>[]</code>) and braces (<code>{}</code>), or a hanging indent.</p>
<div class="codewrapper sourceCode" id="cb1">
<h3 class="code-label">PYTHON<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="sourceCode python" tabindex="0"><code class="sourceCode python"><span id="cb1-1"><a href="#cb1-1" tabindex="-1"></a><span class="co"># Add an extra level of indentation (extra 4 spaces) to distinguish arguments from the rest of the code that follows</span></span>
<span id="cb1-2"><a href="#cb1-2" tabindex="-1"></a><span class="kw">def</span> long_function_name(</span>
<span id="cb1-3"><a href="#cb1-3" tabindex="-1"></a>        var_one, var_two, var_three,</span>
<span id="cb1-4"><a href="#cb1-4" tabindex="-1"></a>        var_four):</span>
<span id="cb1-5"><a href="#cb1-5" tabindex="-1"></a>    <span class="bu">print</span>(var_one)</span>
<span id="cb1-6"><a href="#cb1-6" tabindex="-1"></a></span>
<span id="cb1-7"><a href="#cb1-7" tabindex="-1"></a></span>
<span id="cb1-8"><a href="#cb1-8" tabindex="-1"></a><span class="co"># Aligned with opening delimiter</span></span>
<span id="cb1-9"><a href="#cb1-9" tabindex="-1"></a>foo <span class="op">=</span> long_function_name(var_one, var_two,</span>
<span id="cb1-10"><a href="#cb1-10" tabindex="-1"></a>                         var_three, var_four)</span>
<span id="cb1-11"><a href="#cb1-11" tabindex="-1"></a></span>
<span id="cb1-12"><a href="#cb1-12" tabindex="-1"></a><span class="co"># Use hanging indents to add an indentation level like paragraphs of text where all the lines in a paragraph are</span></span>
<span id="cb1-13"><a href="#cb1-13" tabindex="-1"></a><span class="co"># indented except the first one</span></span>
<span id="cb1-14"><a href="#cb1-14" tabindex="-1"></a>foo <span class="op">=</span> long_function_name(</span>
<span id="cb1-15"><a href="#cb1-15" tabindex="-1"></a>    var_one, var_two,</span>
<span id="cb1-16"><a href="#cb1-16" tabindex="-1"></a>    var_three, var_four)</span>
<span id="cb1-17"><a href="#cb1-17" tabindex="-1"></a></span>
<span id="cb1-18"><a href="#cb1-18" tabindex="-1"></a><span class="co"># Using hanging indent again, but closing bracket aligned with the first non-blank character of the previous line</span></span>
<span id="cb1-19"><a href="#cb1-19" tabindex="-1"></a>a_long_list <span class="op">=</span> [</span>
<span id="cb1-20"><a href="#cb1-20" tabindex="-1"></a>    [[<span class="dv">1</span>, <span class="dv">2</span>, <span class="dv">3</span>], [<span class="dv">4</span>, <span class="dv">5</span>, <span class="dv">6</span>], [<span class="dv">7</span>, <span class="dv">8</span>, <span class="dv">9</span>]], [[<span class="fl">0.33</span>, <span class="fl">0.66</span>, <span class="dv">1</span>], [<span class="fl">0.66</span>, <span class="fl">0.83</span>, <span class="dv">1</span>], [<span class="fl">0.77</span>, <span class="fl">0.88</span>, <span class="dv">1</span>]]</span>
<span id="cb1-21"><a href="#cb1-21" tabindex="-1"></a>    ]</span>
<span id="cb1-22"><a href="#cb1-22" tabindex="-1"></a></span>
<span id="cb1-23"><a href="#cb1-23" tabindex="-1"></a><span class="co"># Using hanging indent again, but closing bracket aligned with the start of the multiline contruct</span></span>
<span id="cb1-24"><a href="#cb1-24" tabindex="-1"></a>a_long_list2 <span class="op">=</span> [</span>
<span id="cb1-25"><a href="#cb1-25" tabindex="-1"></a>    <span class="dv">1</span>,</span>
<span id="cb1-26"><a href="#cb1-26" tabindex="-1"></a>    <span class="dv">2</span>,</span>
<span id="cb1-27"><a href="#cb1-27" tabindex="-1"></a>    <span class="dv">3</span>,</span>
<span id="cb1-28"><a href="#cb1-28" tabindex="-1"></a>    <span class="co"># ...</span></span>
<span id="cb1-29"><a href="#cb1-29" tabindex="-1"></a>    <span class="dv">79</span></span>
<span id="cb1-30"><a href="#cb1-30" tabindex="-1"></a>]</span></code></pre>
</div>
<p>More details on good and bad practices for continuation lines can be
found in <a href="https://www.python.org/dev/peps/pep-0008/#indentation" class="external-link">PEP 8
guideline on indentation</a>.</p>
</div>
<div class="section level3">
<h3 id="maximum-line-length">Maximum Line Length<a class="anchor" aria-label="anchor" href="#maximum-line-length"></a>
</h3>
<p>All lines should be up to 80 characters long; for lines containing
comments or docstrings (to be covered later) the line length limit
should be 73 - see <a href="https://stackoverflow.com/q/15438326" class="external-link">this
discussion</a> for reasoning behind these numbers. Some teams strongly
prefer a longer line length, and seemed to have settled on the length of
100. Long lines of code can be broken over multiple lines by wrapping
expressions in delimiters, as mentioned above (preferred method), or
using a backslash (<code>\</code>) at the end of the line to indicate
line continuation (slightly less preferred method).</p>
<div class="codewrapper sourceCode" id="cb2">
<h3 class="code-label">PYTHON<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="sourceCode python" tabindex="0"><code class="sourceCode python"><span id="cb2-1"><a href="#cb2-1" tabindex="-1"></a><span class="co"># Using delimiters ( ) to wrap a multi-line expression</span></span>
<span id="cb2-2"><a href="#cb2-2" tabindex="-1"></a><span class="cf">if</span> (a <span class="op">==</span> <span class="va">True</span> <span class="kw">and</span></span>
<span id="cb2-3"><a href="#cb2-3" tabindex="-1"></a>    b <span class="op">==</span> <span class="va">False</span>):</span>
<span id="cb2-4"><a href="#cb2-4" tabindex="-1"></a></span>
<span id="cb2-5"><a href="#cb2-5" tabindex="-1"></a><span class="co"># Using a backslash (\) for line continuation</span></span>
<span id="cb2-6"><a href="#cb2-6" tabindex="-1"></a><span class="cf">if</span> a <span class="op">==</span> <span class="va">True</span> <span class="kw">and</span> <span class="op">\</span></span>
<span id="cb2-7"><a href="#cb2-7" tabindex="-1"></a>    b <span class="op">==</span> <span class="va">False</span>:</span></code></pre>
</div>
</div>
<div class="section level3">
<h3 id="should-a-line-break-before-or-after-a-binary-operator">Should a Line Break Before or After a Binary Operator?<a class="anchor" aria-label="anchor" href="#should-a-line-break-before-or-after-a-binary-operator"></a>
</h3>
<p>Lines should break before binary operators so that the operators do
not get scattered across different columns on the screen. In the example
below, the eye does not have to do the extra work to tell which items
are added and which are subtracted:</p>
<div class="codewrapper sourceCode" id="cb3">
<h3 class="code-label">PYTHON<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="sourceCode python" tabindex="0"><code class="sourceCode python"><span id="cb3-1"><a href="#cb3-1" tabindex="-1"></a><span class="co"># PEP 8 compliant - easy to match operators with operands</span></span>
<span id="cb3-2"><a href="#cb3-2" tabindex="-1"></a>income <span class="op">=</span> (gross_wages</span>
<span id="cb3-3"><a href="#cb3-3" tabindex="-1"></a>          <span class="op">+</span> taxable_interest</span>
<span id="cb3-4"><a href="#cb3-4" tabindex="-1"></a>          <span class="op">+</span> (dividends <span class="op">-</span> qualified_dividends)</span>
<span id="cb3-5"><a href="#cb3-5" tabindex="-1"></a>          <span class="op">-</span> ira_deduction</span>
<span id="cb3-6"><a href="#cb3-6" tabindex="-1"></a>          <span class="op">-</span> student_loan_interest)</span></code></pre>
</div>
</div>
<div class="section level3">
<h3 id="blank-lines">Blank Lines<a class="anchor" aria-label="anchor" href="#blank-lines"></a>
</h3>
<p>Top-level function and class definitions should be surrounded with
two blank lines. Method definitions inside a class should be surrounded
by a single blank line. You can use blank lines in functions, sparingly,
to indicate logical sections.</p>
</div>
<div class="section level3">
<h3 id="whitespace-in-expressions-and-statements">Whitespace in Expressions and Statements<a class="anchor" aria-label="anchor" href="#whitespace-in-expressions-and-statements"></a>
</h3>
<p>Avoid extraneous whitespace in the following situations:</p>
<ul>
<li>
<p>immediately inside parentheses, brackets or braces</p>
<div class="codewrapper sourceCode" id="cb4">
<h3 class="code-label">PYTHON<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="sourceCode python" tabindex="0"><code class="sourceCode python"><span id="cb4-1"><a href="#cb4-1" tabindex="-1"></a><span class="co"># PEP 8 compliant:</span></span>
<span id="cb4-2"><a href="#cb4-2" tabindex="-1"></a>my_function(colour[<span class="dv">1</span>], {<span class="bu">id</span>: <span class="dv">2</span>})</span>
<span id="cb4-3"><a href="#cb4-3" tabindex="-1"></a></span>
<span id="cb4-4"><a href="#cb4-4" tabindex="-1"></a><span class="co"># Not PEP 8 compliant:</span></span>
<span id="cb4-5"><a href="#cb4-5" tabindex="-1"></a>my_function( colour[ <span class="dv">1</span> ], { <span class="bu">id</span>: <span class="dv">2</span> } )</span></code></pre>
</div>
</li>
<li>
<p>Immediately before a comma, semicolon, or colon (unless doing
slicing where the colon acts like a binary operator in which case it
should should have equal amounts of whitespace on either side)</p>
<div class="codewrapper sourceCode" id="cb5">
<h3 class="code-label">PYTHON<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="sourceCode python" tabindex="0"><code class="sourceCode python"><span id="cb5-1"><a href="#cb5-1" tabindex="-1"></a><span class="co"># PEP 8 compliant:</span></span>
<span id="cb5-2"><a href="#cb5-2" tabindex="-1"></a><span class="cf">if</span> x <span class="op">==</span> <span class="dv">4</span>: <span class="bu">print</span>(x, y)<span class="op">;</span> x, y <span class="op">=</span> y, x</span>
<span id="cb5-3"><a href="#cb5-3" tabindex="-1"></a></span>
<span id="cb5-4"><a href="#cb5-4" tabindex="-1"></a><span class="co"># Not PEP 8 compliant:</span></span>
<span id="cb5-5"><a href="#cb5-5" tabindex="-1"></a><span class="cf">if</span> x <span class="op">==</span> <span class="dv">4</span> : <span class="bu">print</span>(x , y)<span class="op">;</span> x , y <span class="op">=</span> y, x</span></code></pre>
</div>
</li>
<li>
<p>Immediately before the open parenthesis that starts the argument
list of a function call</p>
<div class="codewrapper sourceCode" id="cb6">
<h3 class="code-label">PYTHON<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="sourceCode python" tabindex="0"><code class="sourceCode python"><span id="cb6-1"><a href="#cb6-1" tabindex="-1"></a><span class="co"># PEP 8 compliant:</span></span>
<span id="cb6-2"><a href="#cb6-2" tabindex="-1"></a>my_function(<span class="dv">1</span>)</span>
<span id="cb6-3"><a href="#cb6-3" tabindex="-1"></a></span>
<span id="cb6-4"><a href="#cb6-4" tabindex="-1"></a><span class="co"># Not PEP 8 compliant:</span></span>
<span id="cb6-5"><a href="#cb6-5" tabindex="-1"></a>my_function (<span class="dv">1</span>)</span></code></pre>
</div>
</li>
<li>
<p>Immediately before the open parenthesis that starts an indexing
or slicing</p>
<div class="codewrapper sourceCode" id="cb7">
<h3 class="code-label">PYTHON<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="sourceCode python" tabindex="0"><code class="sourceCode python"><span id="cb7-1"><a href="#cb7-1" tabindex="-1"></a><span class="co"># PEP 8 compliant:</span></span>
<span id="cb7-2"><a href="#cb7-2" tabindex="-1"></a>my_dct[<span class="st">'key'</span>] <span class="op">=</span> my_lst[<span class="bu">id</span>]</span>
<span id="cb7-3"><a href="#cb7-3" tabindex="-1"></a>first_char <span class="op">=</span> my_str[:, <span class="dv">1</span>]</span>
<span id="cb7-4"><a href="#cb7-4" tabindex="-1"></a></span>
<span id="cb7-5"><a href="#cb7-5" tabindex="-1"></a><span class="co"># Not PEP 8 compliant:</span></span>
<span id="cb7-6"><a href="#cb7-6" tabindex="-1"></a>my_dct [<span class="st">'key'</span>] <span class="op">=</span> my_lst [<span class="bu">id</span>]</span>
<span id="cb7-7"><a href="#cb7-7" tabindex="-1"></a>first_char <span class="op">=</span> my_str [:, <span class="dv">1</span>]</span></code></pre>
</div>
</li>
<li>
<p>More than one space around an assignment (or other) operator to
align it with another</p>
<div class="codewrapper sourceCode" id="cb8">
<h3 class="code-label">PYTHON<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="sourceCode python" tabindex="0"><code class="sourceCode python"><span id="cb8-1"><a href="#cb8-1" tabindex="-1"></a><span class="co"># PEP 8 compliant:</span></span>
<span id="cb8-2"><a href="#cb8-2" tabindex="-1"></a>x <span class="op">=</span> <span class="dv">1</span></span>
<span id="cb8-3"><a href="#cb8-3" tabindex="-1"></a>y <span class="op">=</span> <span class="dv">2</span></span>
<span id="cb8-4"><a href="#cb8-4" tabindex="-1"></a>student_loan_interest <span class="op">=</span> <span class="dv">3</span></span>
<span id="cb8-5"><a href="#cb8-5" tabindex="-1"></a></span>
<span id="cb8-6"><a href="#cb8-6" tabindex="-1"></a><span class="co"># Not PEP 8 compliant:</span></span>
<span id="cb8-7"><a href="#cb8-7" tabindex="-1"></a>x                     <span class="op">=</span> <span class="dv">1</span></span>
<span id="cb8-8"><a href="#cb8-8" tabindex="-1"></a>y                     <span class="op">=</span> <span class="dv">2</span></span>
<span id="cb8-9"><a href="#cb8-9" tabindex="-1"></a>student_loan_interest <span class="op">=</span> <span class="dv">3</span></span></code></pre>
</div>
</li>
<li><p>Avoid trailing whitespace anywhere - it is not necessary and can
cause errors. For example, if you use backslash (<code>\</code>) for
continuation lines and have a space after it, the continuation line will
not be interpreted correctly.</p></li>
<li><p>Surround these binary operators with a single space on either
side: assignment (=), augmented assignment (+=, -= etc.), comparisons
(==, &lt;, &gt;, !=, &lt;&gt;, &lt;=, &gt;=, in, not in, is, is not),
booleans (and, or, not).</p></li>
<li>
<p>Do not use spaces around the = sign when used to indicate a
keyword argument assignment or to indicate a default value for an
unannotated function parameter</p>
<div class="codewrapper sourceCode" id="cb9">
<h3 class="code-label">PYTHON<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="sourceCode python" tabindex="0"><code class="sourceCode python"><span id="cb9-1"><a href="#cb9-1" tabindex="-1"></a><span class="co"># PEP 8 compliant use of spaces around = for variable assignment</span></span>
<span id="cb9-2"><a href="#cb9-2" tabindex="-1"></a>axis <span class="op">=</span> <span class="st">'x'</span></span>
<span id="cb9-3"><a href="#cb9-3" tabindex="-1"></a>angle <span class="op">=</span> <span class="dv">90</span></span>
<span id="cb9-4"><a href="#cb9-4" tabindex="-1"></a>size <span class="op">=</span> <span class="dv">450</span></span>
<span id="cb9-5"><a href="#cb9-5" tabindex="-1"></a>name <span class="op">=</span> <span class="st">'my_graph'</span></span>
<span id="cb9-6"><a href="#cb9-6" tabindex="-1"></a></span>
<span id="cb9-7"><a href="#cb9-7" tabindex="-1"></a><span class="co"># PEP 8 compliant use of no spaces around = for keyword argument assignment in a function call</span></span>
<span id="cb9-8"><a href="#cb9-8" tabindex="-1"></a>my_function(</span>
<span id="cb9-9"><a href="#cb9-9" tabindex="-1"></a>   <span class="dv">1</span>,</span>
<span id="cb9-10"><a href="#cb9-10" tabindex="-1"></a>   <span class="dv">2</span>,</span>
<span id="cb9-11"><a href="#cb9-11" tabindex="-1"></a>   axis<span class="op">=</span>axis,</span>
<span id="cb9-12"><a href="#cb9-12" tabindex="-1"></a>   angle<span class="op">=</span>angle,</span>
<span id="cb9-13"><a href="#cb9-13" tabindex="-1"></a>   size<span class="op">=</span>size,</span>
<span id="cb9-14"><a href="#cb9-14" tabindex="-1"></a>   name<span class="op">=</span>name)</span></code></pre>
</div>
</li>
</ul>
</div>
<div class="section level3">
<h3 id="string-quotes">String Quotes<a class="anchor" aria-label="anchor" href="#string-quotes"></a>
</h3>
<p>In Python, single-quoted strings and double-quoted strings are the
same. PEP 8 does not make a recommendation for this apart from picking
one rule and consistently sticking to it. When a string contains single
or double quote characters, use the other one to avoid backslashes in
the string as it improves readability.</p>
</div>
<div class="section level3">
<h3 id="naming-conventions">Naming Conventions<a class="anchor" aria-label="anchor" href="#naming-conventions"></a>
</h3>
<p>There are a lot of different naming styles in use, including:</p>
<ul>
<li>lower_case_with_underscores (or snake_case)</li>
<li>UPPER_CASE_WITH_UNDERSCORES</li>
<li>CapitalisedWords (or PascalCase) (note: when using acronyms in
CapitalisedWords, capitalise all the letters of the acronym, e.g
HTTPServerError)</li>
<li>camelCase (differs from CapitalisedWords/PascalCase by the initial
lowercase character)</li>
<li>Capitalised_Words_With_Underscores</li>
</ul>
<p>As with other style guide recommendations - consistency is key.
Follow the one already established in the project, if there is one. If
there is not, follow any standard language style (such as <a href="https://www.python.org/dev/peps/pep-0008/" class="external-link">PEP 8</a> for Python).
Failing that, just pick one, document it and stick to it.</p>
<p>Some things to be wary of when naming things in the code:</p>
<ul>
<li>Avoid any names that could cause confusion (e.g. <code>l</code>
(lower case L) is hard to distinguish from a <code>1</code> (one),
<code>O</code> (uppercase o) from a <code>0</code> (zero),
<code>I</code> (uppercase i) from <code>l</code> (lowercase L)).</li>
<li>Avoid using non-ASCII (e.g. Unicode) characters for identifiers as
these can trip up software that does not support Unicode.</li>
<li>If your audience is international and English is the common
language, try to use English words for identifiers and comments whenever
possible but try to avoid abbreviations/local slang as they may not be
understood by everyone. Also consider sticking with either ‘American’ or
‘British’ English spellings and try not to mix the two.</li>
</ul>
<div id="function-variable-class-module-package-naming-in-python" class="callout">
<div class="callout-square">
<i class="callout-icon" data-feather="bell"></i>
</div>
<div id="function-variable-class-module-package-naming-in-python" class="callout-inner">
<h3 class="callout-title">Function, Variable, Class, Module, Package Naming in Python</h3>
<div class="callout-content">
<ul>
<li>Function and variable names should use
lower_case_with_underscores</li>
<li>Avoid single character names in almost all instances.</li>
<li>Variable names should tell you what they store, and not just the
type (e.g. <code>name_of_patient</code> is better than
<code>string</code>)</li>
<li>Function names should tell you what the function does.</li>
<li>Class names should use the CapitalisedWords convention.</li>
<li>Modules should have short, all-lowercase names. Underscores can be
used in the module name if it improves readability.</li>
<li>Packages should also have short, all-lowercase names, although the
use of underscores is discouraged.</li>
</ul>
<p>A more detailed guide on <a href="https://www.python.org/dev/peps/pep-0008/#package-and-module-names" class="external-link">naming
functions, modules, classes and variables</a> is available from PEP
8.</p>
</div>
</div>
</div>
</div>
<div class="section level3">
<h3 id="comments">Comments<a class="anchor" aria-label="anchor" href="#comments"></a>
</h3>
<p>Comments allow us to provide the reader with additional information
on what the code does - reading and understanding source code is slow,
laborious and can lead to misinterpretation, plus it is always a good
idea to keep others in mind when writing code. A good rule of thumb is
to assume that someone will <em>always</em> read your code at a later
date, and this includes a future version of yourself. It can be easy to
forget why you did something a particular way in six months’ time. Write
comments as complete sentences and in English unless you are 100% sure
the code will never be read by people who do not speak your
language.</p>
<div id="the-good-the-bad-and-the-ugly-comments" class="callout">
<div class="callout-square">
<i class="callout-icon" data-feather="bell"></i>
</div>
<div id="the-good-the-bad-and-the-ugly-comments" class="callout-inner">
<h3 class="callout-title">The Good, the Bad, and the Ugly Comments</h3>
<div class="callout-content">
<p>As a side reading, check out the <a href="https://medium.com/free-code-camp/code-comments-the-good-the-bad-and-the-ugly-be9cc65fbf83" class="external-link">‘Putting
comments in code: the good, the bad, and the ugly’ blogpost</a>.
Remember - a comment should answer the ‘why’ question”. Occasionally the
“what” question. The “how” question should be answered by the code
itself.</p>
</div>
</div>
</div>
<p>Block comments generally apply to some (or all) code that follows
them, and are indented to the same level as that code. Each line of a
block comment starts with a <code>#</code> and a single space (unless it
is indented text inside the comment).</p>
<div class="codewrapper sourceCode" id="cb10">
<h3 class="code-label">PYTHON<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="sourceCode python" tabindex="0"><code class="sourceCode python"><span id="cb10-1"><a href="#cb10-1" tabindex="-1"></a><span class="kw">def</span> fahr_to_cels(fahr):</span>
<span id="cb10-2"><a href="#cb10-2" tabindex="-1"></a>    <span class="co"># Block comment example: convert temperature in Fahrenheit to Celsius</span></span>
<span id="cb10-3"><a href="#cb10-3" tabindex="-1"></a>    cels <span class="op">=</span> (fahr <span class="op">+</span> <span class="dv">32</span>) <span class="op">*</span> (<span class="dv">5</span> <span class="op">/</span> <span class="dv">9</span>)</span>
<span id="cb10-4"><a href="#cb10-4" tabindex="-1"></a>    <span class="cf">return</span> cels</span></code></pre>
</div>
<p>An inline comment is a comment on the same line as a statement.
Inline comments should be separated by at least two spaces from the
statement. They should start with a <code>#</code> and a single space
and should be used sparingly.</p>
<div class="codewrapper sourceCode" id="cb11">
<h3 class="code-label">PYTHON<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="sourceCode python" tabindex="0"><code class="sourceCode python"><span id="cb11-1"><a href="#cb11-1" tabindex="-1"></a><span class="kw">def</span> fahr_to_cels(fahr):</span>
<span id="cb11-2"><a href="#cb11-2" tabindex="-1"></a>    cels <span class="op">=</span> (fahr <span class="op">+</span> <span class="dv">32</span>) <span class="op">*</span> (<span class="dv">5</span> <span class="op">/</span> <span class="dv">9</span>)  <span class="co"># Inline comment example: convert temperature in Fahrenheit to Celsius</span></span>
<span id="cb11-3"><a href="#cb11-3" tabindex="-1"></a>    <span class="cf">return</span> cels</span></code></pre>
</div>
<p>Python does not have any multi-line comments, like you may have seen
in other languages like C++ or Java. However, there are ways to do it
using <em>docstrings</em> as we will see in a moment.</p>
<p>The reader should be able to understand a single function or method
from its code and its comments, and should not have to look elsewhere in
the code for clarification. The kind of things that need to be commented
are:</p>
<ul>
<li>Why certain design or implementation decisions were adopted,
especially in cases where the decision may seem counter-intuitive</li>
<li>The names of any algorithms or design patterns that have been
implemented</li>
<li>The expected format of input files or database schemas</li>
</ul>
<p>However, there are some restrictions. Comments that simply restate
what the code does are redundant, and comments must be accurate and
updated with the code, because an incorrect comment causes more
confusion than no comment at all.</p>
<div id="exercise-improve-code-style-of-our-project" class="callout challenge">
<div class="callout-square">
<i class="callout-icon" data-feather="zap"></i>
</div>
<div id="exercise-improve-code-style-of-our-project" class="callout-inner">
<h3 class="callout-title">Exercise: Improve Code Style of Our Project</h3>
<div class="callout-content">
<p>let us look at improving the coding style of our project. First, from
the project root, use <code>git switch</code> to create a new feature
branch called <code>style-fixes</code> from our develop branch. (Note
that at this point <code>develop</code> and <code>main</code> branches
are pointing at the same commit so it does not really matter which one
we are branching off - in real collaborative software development
environments, you’d likely be expected to branch off
<code>develop</code> as it would contain the latest code developed by
your team.)</p>
<div class="codewrapper sourceCode" id="cb12">
<h3 class="code-label">BASH<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="sourceCode bash" tabindex="0"><code class="sourceCode bash"><span id="cb12-1"><a href="#cb12-1" tabindex="-1"></a><span class="ex">$</span> git switch develop</span>
<span id="cb12-2"><a href="#cb12-2" tabindex="-1"></a><span class="ex">$</span> git switch <span class="at">-c</span> style-fixes</span></code></pre>
</div>
<p>Next look at the <code>inflammation-analysis.py</code> file in
PyCharm and identify where the above guidelines have not been followed.
Fix the discovered inconsistencies and commit them to the feature
branch.</p>
</div>
</div>
</div>
<div id="accordionSolution1" class="accordion challenge-accordion accordion-flush">
<div class="accordion-item">
<button class="accordion-button solution-button collapsed" type="button" data-bs-toggle="collapse" data-bs-target="#collapseSolution1" aria-expanded="false" aria-controls="collapseSolution1">
  <h4 class="accordion-header" id="headingSolution1"> Show me the solution </h4>
</button>
<div id="collapseSolution1" class="accordion-collapse collapse" data-bs-parent="#accordionSolution1" aria-labelledby="headingSolution1">
<div class="accordion-body">
<p>Modify <code>inflammation-analysis.py</code> from PyCharm, which is
helpfully marking inconsistencies with coding guidelines by underlying
them. There are a few things to fix in
<code>inflammation-analysis.py</code>, for example:</p>
<ol style="list-style-type: decimal">
<li>Line 30 in <code>inflammation-analysis.py</code> is too long and not
very readable. A better style would be to use multiple lines and hanging
indent, with the closing brace `}’ aligned either with the first
non-whitespace character of the last line of list or the first character
of the line that starts the multiline construct or simply moved to the
end of the previous line. All three acceptable modifications are shown
below.</li>
</ol>
<div class="codewrapper sourceCode" id="cb13">
<h3 class="code-label">PYTHON<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="sourceCode python" tabindex="0"><code class="sourceCode python"><span id="cb13-1"><a href="#cb13-1" tabindex="-1"></a><span class="co"># Using hanging indent, with the closing '}' aligned with the first non-blank character of the previous line</span></span>
<span id="cb13-2"><a href="#cb13-2" tabindex="-1"></a>view_data <span class="op">=</span> {</span>
<span id="cb13-3"><a href="#cb13-3" tabindex="-1"></a>    <span class="st">'average'</span>: models.daily_mean(inflammation_data),</span>
<span id="cb13-4"><a href="#cb13-4" tabindex="-1"></a>    <span class="st">'max'</span>: models.daily_max(inflammation_data),</span>
<span id="cb13-5"><a href="#cb13-5" tabindex="-1"></a>    <span class="st">'min'</span>: models.daily_min(inflammation_data)</span>
<span id="cb13-6"><a href="#cb13-6" tabindex="-1"></a>    }</span></code></pre>
</div>
<div class="codewrapper sourceCode" id="cb14">
<h3 class="code-label">PYTHON<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="sourceCode python" tabindex="0"><code class="sourceCode python"><span id="cb14-1"><a href="#cb14-1" tabindex="-1"></a><span class="co"># Using hanging indent with the, closing '}' aligned with the start of the multiline contruct</span></span>
<span id="cb14-2"><a href="#cb14-2" tabindex="-1"></a>view_data <span class="op">=</span> {</span>
<span id="cb14-3"><a href="#cb14-3" tabindex="-1"></a>    <span class="st">'average'</span>: models.daily_mean(inflammation_data),</span>
<span id="cb14-4"><a href="#cb14-4" tabindex="-1"></a>    <span class="st">'max'</span>: models.daily_max(inflammation_data),</span>
<span id="cb14-5"><a href="#cb14-5" tabindex="-1"></a>    <span class="st">'min'</span>: models.daily_min(inflammation_data)</span>
<span id="cb14-6"><a href="#cb14-6" tabindex="-1"></a>}</span></code></pre>
</div>
<div class="codewrapper sourceCode" id="cb15">
<h3 class="code-label">PYTHON<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="sourceCode python" tabindex="0"><code class="sourceCode python"><span id="cb15-1"><a href="#cb15-1" tabindex="-1"></a><span class="co"># Using hanging indent where all the lines of the multiline contruct are indented except the first one</span></span>
<span id="cb15-2"><a href="#cb15-2" tabindex="-1"></a>view_data <span class="op">=</span> {</span>
<span id="cb15-3"><a href="#cb15-3" tabindex="-1"></a>    <span class="st">'average'</span>: models.daily_mean(inflammation_data),</span>
<span id="cb15-4"><a href="#cb15-4" tabindex="-1"></a>    <span class="st">'max'</span>: models.daily_max(inflammation_data),</span>
<span id="cb15-5"><a href="#cb15-5" tabindex="-1"></a>    <span class="st">'min'</span>: models.daily_min(inflammation_data)}</span></code></pre>
</div>
<ol start="2" style="list-style-type: decimal">
<li><p>Variable ‘InFiles’ in <code>inflammation-analysis.py</code> uses
CapitalisedWords naming convention which is recommended for class names
but not variable names. By convention, variable names should be in
lowercase with optional underscores so you should rename the variable
‘InFiles’ to, e.g., ‘infiles’ or ‘in_files’.</p></li>
<li><p>There are two blank lines starting from line 19 in
<code>inflammation-analysis.py</code>. Normally, you should not use
blank lines in the middle of the code unless you want to separate
logical units - in which case only one blank line is used. Note how
PyCharm is warning us by underlining the whole line below.</p></li>
<li><p>Only one blank line after the end of definition of function
<code>main</code> and the rest of the code below line 27 in
<code>inflammation-analysis.py</code> - should be two blank lines (PEP 8
recommends surrounding top-level function (and class) definitions with
two blank lines). Note how PyCharm is warning us by underlining the
whole line below.</p></li>
</ol>
<p>Finally, let us add and commit our changes to the feature branch. We
will check the status of our working directory first.</p>
<div class="codewrapper sourceCode" id="cb16">
<h3 class="code-label">BASH<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="sourceCode bash" tabindex="0"><code class="sourceCode bash"><span id="cb16-1"><a href="#cb16-1" tabindex="-1"></a><span class="ex">$</span> git status</span></code></pre>
</div>
<div class="codewrapper">
<h3 class="code-label">OUTPUT<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="output" tabindex="0"><code>On branch style-fixes
Changes not staged for commit:
(use "git add &lt;file&gt;..." to update what will be committed)
(use "git restore &lt;file&gt;..." to discard changes in working directory)
modified:   inflammation-analysis.py

no changes added to commit (use "git add" and/or "git commit -a")</code></pre>
</div>
<p>Git tells us we are on branch <code>style-fixes</code> and that we
have unstaged and uncommited changes to
<code>inflammation-analysis.py</code>. let us commit them to the local
repository.</p>
<div class="codewrapper sourceCode" id="cb18">
<h3 class="code-label">BASH<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="sourceCode bash" tabindex="0"><code class="sourceCode bash"><span id="cb18-1"><a href="#cb18-1" tabindex="-1"></a><span class="ex">$</span> git add inflammation-analysis.py</span>
<span id="cb18-2"><a href="#cb18-2" tabindex="-1"></a><span class="ex">$</span> git commit <span class="at">-m</span> <span class="st">"Code style fixes."</span></span></code></pre>
</div>
</div>
</div>
</div>
</div>
<div id="optional-exercise-improve-code-style-of-your-other-python-projects" class="callout discussion">
<div class="callout-square">
<i class="callout-icon" data-feather="message-circle"></i>
</div>
<div id="optional-exercise-improve-code-style-of-your-other-python-projects" class="callout-inner">
<h3 class="callout-title">Optional Exercise: Improve Code Style of Your Other Python Projects</h3>
<div class="callout-content">
<p>If you have another Python project, check to which extent it conforms
to PEP 8 coding style.</p>
</div>
</div>
</div>
</div>
<div class="section level3">
<h3 id="documentation-strings-aka-docstrings">Documentation Strings aka Docstrings<a class="anchor" aria-label="anchor" href="#documentation-strings-aka-docstrings"></a>
</h3>
<p>If the first thing in a function is a string that is not assigned to
a variable, that string is attached to the function as its
documentation. Consider the following code implementing function for
calculating the nth Fibonacci number:</p>
<div class="codewrapper sourceCode" id="cb19">
<h3 class="code-label">PYTHON<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="sourceCode python" tabindex="0"><code class="sourceCode python"><span id="cb19-1"><a href="#cb19-1" tabindex="-1"></a><span class="kw">def</span> fibonacci(n):</span>
<span id="cb19-2"><a href="#cb19-2" tabindex="-1"></a>    <span class="co">"""Calculate the nth Fibonacci number.</span></span>
<span id="cb19-3"><a href="#cb19-3" tabindex="-1"></a></span>
<span id="cb19-4"><a href="#cb19-4" tabindex="-1"></a><span class="co">    A recursive implementation of Fibonacci array elements.</span></span>
<span id="cb19-5"><a href="#cb19-5" tabindex="-1"></a></span>
<span id="cb19-6"><a href="#cb19-6" tabindex="-1"></a><span class="co">    :param n: integer</span></span>
<span id="cb19-7"><a href="#cb19-7" tabindex="-1"></a><span class="co">    :raises ValueError: raised if n is less than zero</span></span>
<span id="cb19-8"><a href="#cb19-8" tabindex="-1"></a><span class="co">    :returns: Fibonacci number</span></span>
<span id="cb19-9"><a href="#cb19-9" tabindex="-1"></a><span class="co">    """</span></span>
<span id="cb19-10"><a href="#cb19-10" tabindex="-1"></a>    <span class="cf">if</span> n <span class="op">&lt;</span> <span class="dv">0</span>:</span>
<span id="cb19-11"><a href="#cb19-11" tabindex="-1"></a>        <span class="cf">raise</span> <span class="pp">ValueError</span>(<span class="st">'Fibonacci is not defined for N &lt; 0'</span>)</span>
<span id="cb19-12"><a href="#cb19-12" tabindex="-1"></a>    <span class="cf">if</span> n <span class="op">==</span> <span class="dv">0</span>:</span>
<span id="cb19-13"><a href="#cb19-13" tabindex="-1"></a>        <span class="cf">return</span> <span class="dv">0</span></span>
<span id="cb19-14"><a href="#cb19-14" tabindex="-1"></a>    <span class="cf">if</span> n <span class="op">==</span> <span class="dv">1</span>:</span>
<span id="cb19-15"><a href="#cb19-15" tabindex="-1"></a>        <span class="cf">return</span> <span class="dv">1</span></span>
<span id="cb19-16"><a href="#cb19-16" tabindex="-1"></a></span>
<span id="cb19-17"><a href="#cb19-17" tabindex="-1"></a>    <span class="cf">return</span> fibonacci(n <span class="op">-</span> <span class="dv">1</span>) <span class="op">+</span> fibonacci(n <span class="op">-</span> <span class="dv">2</span>)</span></code></pre>
</div>
<p>Note here we are explicitly documenting our input variables, what is
returned by the function, and also when the <code>ValueError</code>
exception is raised. Along with a helpful description of what the
function does, this information can act as a <em>contract</em> for
readers to understand what to expect in terms of behaviour when using
the function, as well as how to use it.</p>
<p>A special comment string like this is called a
<strong>docstring</strong>. We do not need to use triple quotes when
writing one, but if we do, we can break the text across multiple lines.
Docstrings can also be used at the start of a Python module (a file
containing a number of Python functions) or at the start of a Python
class (containing a number of methods) to list their contents as a
reference. You should not confuse docstrings with comments though -
docstrings are context-dependent and should only be used in specific
locations (e.g. at the top of a module and immediately after
<code>class</code> and <code>def</code> keywords as mentioned). Using
triple quoted strings in locations where they will not be interpreted as
docstrings or using triple quotes as a way to ‘quickly’ comment out an
entire block of code is considered bad practice.</p>
<p>In our example case, we used the <a href="https://sphinx-rtd-tutorial.readthedocs.io/en/latest/docstrings.html" class="external-link">Sphinx/ReadTheDocs
docstring style</a> formatting for the <code>param</code>,
<code>raises</code> and <code>returns</code> - other docstring formats
exist as well.</p>
<div id="python-pep-257---recommendations-for-docstrings" class="callout">
<div class="callout-square">
<i class="callout-icon" data-feather="bell"></i>
</div>
<div id="python-pep-257---recommendations-for-docstrings" class="callout-inner">
<h3 class="callout-title">Python PEP 257 - Recommendations for Docstrings</h3>
<div class="callout-content">
<p><a href="https://peps.python.org/pep-0257/" class="external-link">PEP 257</a> is another
one of Python Enhancement Proposals and this one deals with docstring
conventions to standardise how they are used. For example, on the
subject of module-level docstrings, PEP 257 says:</p>
<pre><code>The docstring for a module should generally list
the classes,
exceptions
and functions
(and any other objects)
that are exported by the module, with a one-line summary of each.
(These summaries generally give less detail than the summary line in the object's docstring.)
The docstring for a package
(i.e., the docstring of the package's `__init__.py` module)
should also list the modules and subpackages exported by the package.</code></pre>
<p>Note that <code>__init__.py</code> file used to be a required part of
a package (pre Python 3.3) where a package was typically implemented as
a directory containing an <code>__init__.py</code> file which got
implicitly executed when a package was imported.</p>
</div>
</div>
</div>
<p>So, at the beginning of a module file we can just add a docstring
explaining the nature of a module. For example, if
<code>fibonacci()</code> was included in a module with other functions,
our module could have at the start of it:</p>
<div class="codewrapper sourceCode" id="cb21">
<h3 class="code-label">PYTHON<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="sourceCode python" tabindex="0"><code class="sourceCode python"><span id="cb21-1"><a href="#cb21-1" tabindex="-1"></a><span class="co">"""A module for generating numerical sequences of numbers that occur in nature.</span></span>
<span id="cb21-2"><a href="#cb21-2" tabindex="-1"></a></span>
<span id="cb21-3"><a href="#cb21-3" tabindex="-1"></a><span class="co">Functions:</span></span>
<span id="cb21-4"><a href="#cb21-4" tabindex="-1"></a><span class="co">  fibonacci - returns the Fibonacci number for a given integer</span></span>
<span id="cb21-5"><a href="#cb21-5" tabindex="-1"></a><span class="co">  golden_ratio - returns the golden ratio number to a given Fibonacci iteration</span></span>
<span id="cb21-6"><a href="#cb21-6" tabindex="-1"></a><span class="co">  ...</span></span>
<span id="cb21-7"><a href="#cb21-7" tabindex="-1"></a><span class="co">"""</span></span>
<span id="cb21-8"><a href="#cb21-8" tabindex="-1"></a>...</span></code></pre>
</div>
<p>The docstring for a function or a module is returned when calling the
<code>help</code> function and passing its name - for example from the
interactive Python console/terminal available from the command line or
when rendering code documentation online (e.g. see <a href="https://docs.python.org/3.11/library/index.html" class="external-link">Python
documentation</a>). PyCharm also displays the docstring for a
function/module in a little help popup window when using
tab-completion.</p>
<div class="codewrapper sourceCode" id="cb22">
<h3 class="code-label">PYTHON<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="sourceCode python" tabindex="0"><code class="sourceCode python"><span id="cb22-1"><a href="#cb22-1" tabindex="-1"></a><span class="bu">help</span>(fibonacci)</span></code></pre>
</div>
<div id="exercise-fix-the-docstrings" class="callout challenge">
<div class="callout-square">
<i class="callout-icon" data-feather="zap"></i>
</div>
<div id="exercise-fix-the-docstrings" class="callout-inner">
<h3 class="callout-title">Exercise: Fix the Docstrings</h3>
<div class="callout-content">
<p>Look into <code>models.py</code> in PyCharm and improve docstrings
for functions <code>daily_mean</code> , <code>daily_min</code>,
<code>daily_max</code>. Commit those changes to feature branch
<code>style-fixes</code>.</p>
</div>
</div>
</div>
<div id="accordionSolution2" class="accordion challenge-accordion accordion-flush">
<div class="accordion-item">
<button class="accordion-button solution-button collapsed" type="button" data-bs-toggle="collapse" data-bs-target="#collapseSolution2" aria-expanded="false" aria-controls="collapseSolution2">
  <h4 class="accordion-header" id="headingSolution2"> Show me the solution </h4>
</button>
<div id="collapseSolution2" class="accordion-collapse collapse" data-bs-parent="#accordionSolution2" aria-labelledby="headingSolution2">
<div class="accordion-body">
<p>For example, the improved docstrings for the above functions would
contain explanations for parameters and return values.</p>
<div class="codewrapper sourceCode" id="cb23">
<h3 class="code-label">PYTHON<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="sourceCode python" tabindex="0"><code class="sourceCode python"><span id="cb23-1"><a href="#cb23-1" tabindex="-1"></a><span class="kw">def</span> daily_mean(data):</span>
<span id="cb23-2"><a href="#cb23-2" tabindex="-1"></a>   <span class="co">"""Calculate the daily mean of a 2D inflammation data array for each day.</span></span>
<span id="cb23-3"><a href="#cb23-3" tabindex="-1"></a></span>
<span id="cb23-4"><a href="#cb23-4" tabindex="-1"></a><span class="co">   :param data: A 2D data array with inflammation data (each row contains measurements for a single patient across all days).</span></span>
<span id="cb23-5"><a href="#cb23-5" tabindex="-1"></a><span class="co">   :returns: An array of mean values of measurements for each day.</span></span>
<span id="cb23-6"><a href="#cb23-6" tabindex="-1"></a><span class="co">   """</span></span>
<span id="cb23-7"><a href="#cb23-7" tabindex="-1"></a>   <span class="cf">return</span> np.mean(data, axis<span class="op">=</span><span class="dv">0</span>)</span></code></pre>
</div>
<div class="codewrapper sourceCode" id="cb24">
<h3 class="code-label">PYTHON<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="sourceCode python" tabindex="0"><code class="sourceCode python"><span id="cb24-1"><a href="#cb24-1" tabindex="-1"></a><span class="kw">def</span> daily_max(data):</span>
<span id="cb24-2"><a href="#cb24-2" tabindex="-1"></a>   <span class="co">"""Calculate the daily maximum of a 2D inflammation data array for each day.</span></span>
<span id="cb24-3"><a href="#cb24-3" tabindex="-1"></a></span>
<span id="cb24-4"><a href="#cb24-4" tabindex="-1"></a><span class="co">   :param data: A 2D data array with inflammation data (each row contains measurements for a single patient across all days).</span></span>
<span id="cb24-5"><a href="#cb24-5" tabindex="-1"></a><span class="co">   :returns: An array of max values of measurements for each day.</span></span>
<span id="cb24-6"><a href="#cb24-6" tabindex="-1"></a><span class="co">   """</span></span>
<span id="cb24-7"><a href="#cb24-7" tabindex="-1"></a>   <span class="cf">return</span> np.<span class="bu">max</span>(data, axis<span class="op">=</span><span class="dv">0</span>)</span></code></pre>
</div>
<div class="codewrapper sourceCode" id="cb25">
<h3 class="code-label">PYTHON<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="sourceCode python" tabindex="0"><code class="sourceCode python"><span id="cb25-1"><a href="#cb25-1" tabindex="-1"></a><span class="kw">def</span> daily_min(data):</span>
<span id="cb25-2"><a href="#cb25-2" tabindex="-1"></a>   <span class="co">"""Calculate the daily minimum of a 2D inflammation data array for each day.</span></span>
<span id="cb25-3"><a href="#cb25-3" tabindex="-1"></a></span>
<span id="cb25-4"><a href="#cb25-4" tabindex="-1"></a><span class="co">   :param data: A 2D data array with inflammation data (each row contains measurements for a single patient across all days).</span></span>
<span id="cb25-5"><a href="#cb25-5" tabindex="-1"></a><span class="co">   :returns: An array of minimum values of measurements for each day.</span></span>
<span id="cb25-6"><a href="#cb25-6" tabindex="-1"></a><span class="co">   """</span></span>
<span id="cb25-7"><a href="#cb25-7" tabindex="-1"></a>   <span class="cf">return</span> np.<span class="bu">min</span>(data, axis<span class="op">=</span><span class="dv">0</span>)</span></code></pre>
</div>
<p>Once we are happy with modifications, as usual before staging and
commit our changes, we check the status of our working directory:</p>
<div class="codewrapper sourceCode" id="cb26">
<h3 class="code-label">BASH<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="sourceCode bash" tabindex="0"><code class="sourceCode bash"><span id="cb26-1"><a href="#cb26-1" tabindex="-1"></a><span class="ex">$</span> git status</span></code></pre>
</div>
<div class="codewrapper">
<h3 class="code-label">OUTPUT<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="output" tabindex="0"><code>On branch style-fixes
Changes not staged for commit:
(use "git add &lt;file&gt;..." to update what will be committed)
(use "git restore &lt;file&gt;..." to discard changes in working directory)
modified:   inflammation/models.py

no changes added to commit (use "git add" and/or "git commit -a")</code></pre>
</div>
<p>As expected, Git tells us we are on branch <code>style-fixes</code>
and that we have unstaged and uncommited changes to
<code>inflammation/models.py</code>. Let us commit them to the local
repository.</p>
<div class="codewrapper sourceCode" id="cb28">
<h3 class="code-label">BASH<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="sourceCode bash" tabindex="0"><code class="sourceCode bash"><span id="cb28-1"><a href="#cb28-1" tabindex="-1"></a><span class="ex">$</span> git add inflammation/models.py</span>
<span id="cb28-2"><a href="#cb28-2" tabindex="-1"></a><span class="ex">$</span> git commit <span class="at">-m</span> <span class="st">"Docstring improvements."</span></span></code></pre>
</div>
</div>
</div>
</div>
</div>
<p>In the previous exercises, we made some code improvements on feature
branch <code>style-fixes</code>. We have committed our changes locally
but have not pushed this branch remotely for others to have a look at
our code before we merge it onto the <code>develop</code> branch. Let us
do that now, namely:</p>
<ul>
<li>push <code>style-fixes</code> to GitHub</li>
<li>merge <code>style-fixes</code> into <code>develop</code> (once we
are happy with the changes)</li>
<li>push updates to <code>develop</code> branch to GitHub (to keep it up
to date with the latest developments)</li>
<li>finally, merge <code>develop</code> branch into the stable
<code>main</code> branch</li>
</ul>
<p>Here is a set commands that will achieve the above set of actions
(remember to use <code>git status</code> often in between other Git
commands to double check which branch you are on and its status):</p>
<div class="codewrapper sourceCode" id="cb29">
<h3 class="code-label">BASH<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="sourceCode bash" tabindex="0"><code class="sourceCode bash"><span id="cb29-1"><a href="#cb29-1" tabindex="-1"></a><span class="ex">$</span> git push <span class="at">-u</span> origin style-fixes</span>
<span id="cb29-2"><a href="#cb29-2" tabindex="-1"></a><span class="ex">$</span> git switch develop</span>
<span id="cb29-3"><a href="#cb29-3" tabindex="-1"></a><span class="ex">$</span> git merge style-fixes</span>
<span id="cb29-4"><a href="#cb29-4" tabindex="-1"></a><span class="ex">$</span> git push origin develop</span>
<span id="cb29-5"><a href="#cb29-5" tabindex="-1"></a><span class="ex">$</span> git switch main</span>
<span id="cb29-6"><a href="#cb29-6" tabindex="-1"></a><span class="ex">$</span> git merge develop</span>
<span id="cb29-7"><a href="#cb29-7" tabindex="-1"></a><span class="ex">$</span> git push origin main</span></code></pre>
</div>
<div id="typical-code-development-cycle" class="callout testimonial">
<div class="callout-square">
<i class="callout-icon" data-feather="heart"></i>
</div>
<div id="typical-code-development-cycle" class="callout-inner">
<h3 class="callout-title">Typical Code Development Cycle</h3>
<div class="callout-content">
<p>What you have done in the exercises in this episode mimics a typical
software development workflow - you work locally on code on a feature
branch, test it to make sure it works correctly and as expected, then
record your changes using version control and share your work with
others via a centrally backed-up repository. Other team members work on
their feature branches in parallel and similarly share their work with
colleagues for discussions. Different feature branches from around the
team get merged onto the development branch, often in small and quick
development cycles. After further testing and verifying that no code has
been broken by the new features - the development branch gets merged
onto the stable main branch, where new features finally resurface to
end-users in bigger “software release” cycles.</p>
</div>
</div>
</div>
<div id="keypoints1" class="callout keypoints">
<div class="callout-square">
<i class="callout-icon" data-feather="key"></i>
</div>
<div class="callout-inner">
<h3 class="callout-title">Key Points</h3>
<div class="callout-content">
<ul>
<li>Always assume that someone else will read your code at a later date,
including yourself.</li>
<li>Community coding conventions help you create more readable software
projects that are easier to contribute to.</li>
<li>Python Enhancement Proposals (or PEPs) describe a recommended
convention or specification for how to do something in Python.</li>
<li>Style checking to ensure code conforms to coding conventions is
often part of IDEs.</li>
<li>Consistency with the style guide is important - whichever style you
choose.</li>
</ul>
</div>
</div>
</div>
</div>
</section></section><section id="aio-16-verifying-code-style-linters"><p>Content from <a href="16-verifying-code-style-linters.html">1.6 Verifying Code Style Using Linters</a></p>
<hr>
<p>Last updated on 2025-03-07 |

        <a href="https://github.com/carpentries-incubator/python-intermediate-development/edit/main/episodes/16-verifying-code-style-linters.md" class="external-link">Edit this page <i aria-hidden="true" data-feather="edit"></i></a></p>
<p>Estimated time: <i aria-hidden="true" data-feather="clock"></i> 20 minutes</p>
<div class="text-end">
          <button role="button" aria-pressed="false" tabindex="0" id="expand-code" class="pull-right" data-expand="Expand All Solutions " data-collapse="Collapse All Solutions "> Expand All Solutions <i aria-hidden="true" data-feather="plus"></i></button>
        </div>
<div class="overview card">
<h2 class="card-header">Overview</h2>
<div class="row g-0">
<div class="col-md-4">
<div class="card-body">
<div class="inner">
<h3 class="card-title">Questions</h3>
<ul>
<li>What tools can help with maintaining a consistent code style?</li>
<li>How can we automate code style checking?</li>
</ul>
</div>
</div>
</div>
<div class="col-md-8">
<div class="card-body">
<div class="inner bordered">
<h3 class="card-title">Objectives</h3>
<ul>
<li>Use code linting tools to verify a program’s adherence to a Python
coding style convention.</li>
</ul>
</div>
</div>
</div>
</div>
</div>
<section><h2 class="section-heading" id="verifying-code-style-using-linters">Verifying Code Style Using Linters<a class="anchor" aria-label="anchor" href="#verifying-code-style-using-linters"></a>
</h2>
<hr class="half-width">
<p>We have seen how we can use PyCharm to help us format our Python code
in a consistent style. This aids reusability, since consistent-looking
code is easier to modify since it is easier to read and understand. We
can also use tools, called <a href="https://en.wikipedia.org/wiki/Lint_%28software%29" class="external-link"><strong>code
linters</strong></a>, to identify consistency issues in a report-style.
Linters analyse source code to identify and report on stylistic and even
programming errors. Let us look at a very well used one of these called
<code>pylint</code>.</p>
<p>First, let us ensure we are on the <code>style-fixes</code> branch
once again.</p>
<div class="codewrapper sourceCode" id="cb1">
<h3 class="code-label">BASH<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="sourceCode bash" tabindex="0"><code class="sourceCode bash"><span id="cb1-1"><a href="#cb1-1" tabindex="-1"></a><span class="ex">$</span> git switch style-fixes</span></code></pre>
</div>
<p>Pylint is just a Python package so we can install it in our virtual
environment using:</p>
<div class="codewrapper sourceCode" id="cb2">
<h3 class="code-label">BASH<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="sourceCode bash" tabindex="0"><code class="sourceCode bash"><span id="cb2-1"><a href="#cb2-1" tabindex="-1"></a><span class="ex">$</span> python3 <span class="at">-m</span> pip install pylint</span></code></pre>
</div>
<p>We should also update our <code>requirements.txt</code> with this new
addition:</p>
<div class="codewrapper sourceCode" id="cb3">
<h3 class="code-label">BASH<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="sourceCode bash" tabindex="0"><code class="sourceCode bash"><span id="cb3-1"><a href="#cb3-1" tabindex="-1"></a><span class="ex">$</span> python3 <span class="at">-m</span> pip freeze <span class="at">--exclude-editable</span> <span class="op">&gt;</span> requirements.txt</span></code></pre>
</div>
<p>Pylint is a command-line tool that can help our code in many
ways:</p>
<ul>
<li>
<strong>Check PEP 8 compliance:</strong> whilst in-IDE
context-sensitive highlighting such as that provided via PyCharm helps
us stay consistent with PEP 8 as we write code, this tool provides a
full report</li>
<li>
<strong>Perform basic error detection:</strong> Pylint can look for
certain Python type errors</li>
<li>
<strong>Check variable naming conventions</strong>: Pylint often
goes beyond PEP 8 to include other common conventions, such as naming
variables outside of functions in upper case</li>
<li>
<strong>Customisation</strong>: you can specify which errors and
conventions you wish to check for, and those you wish to ignore</li>
</ul>
<p>Pylint can also identify <strong>code smells</strong>.</p>
<div id="how-does-code-smell" class="callout">
<div class="callout-square">
<i class="callout-icon" data-feather="bell"></i>
</div>
<div id="how-does-code-smell" class="callout-inner">
<h3 class="callout-title">How Does Code Smell?</h3>
<div class="callout-content">
<p>There are many ways that code can exhibit bad design whilst not
breaking any rules and working correctly. A <em>code smell</em> is a
characteristic that indicates that there is an underlying problem with
source code, e.g. large classes or methods, methods with too many
parameters, duplicated statements in both if and else blocks of
conditionals, etc. They aren’t functional errors in the code, but rather
are certain structures that violate principles of good design and impact
design quality. They can also indicate that code is in need of
maintenance and refactoring.</p>
<p>The phrase has its origins in Chapter 3 “Bad smells in code” by Kent
Beck and Martin Fowler in <a href="https://www.amazon.com/Refactoring-Improving-Design-Existing-Code/dp/0201485672/" class="external-link">Fowler,
Martin (1999). Refactoring. Improving the Design of Existing Code.
Addison-Wesley. ISBN 0-201-48567-2</a>.</p>
</div>
</div>
</div>
<p>Pylint recommendations are given as warnings or errors, and Pylint
also scores the code with an overall mark. We can look at a specific
file (e.g. <code>inflammation-analysis.py</code>), or a package
(e.g. <code>inflammation</code>). Let us look at our
<code>inflammation</code> package and code inside it (namely
<code>models.py</code> and <code>views.py</code>). From the project root
do:</p>
<div class="codewrapper sourceCode" id="cb4">
<h3 class="code-label">BASH<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="sourceCode bash" tabindex="0"><code class="sourceCode bash"><span id="cb4-1"><a href="#cb4-1" tabindex="-1"></a><span class="ex">$</span> pylint inflammation</span></code></pre>
</div>
<p>You should see an output similar to the following:</p>
<div class="codewrapper">
<h3 class="code-label">OUTPUT<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="output" tabindex="0"><code>************* Module inflammation.models
inflammation/models.py:13:23: C0303: Trailing whitespace (trailing-whitespace)
inflammation/models.py:34:0: C0305: Trailing newlines (trailing-newlines)
************* Module inflammation.views
inflammation/views.py:4:0: W0611: Unused numpy imported as np (unused-import)

------------------------------------------------------------------
Your code has been rated at 8.50/10 (previous run: 8.50/10, +0.00)</code></pre>
</div>
<p>Your own outputs of the above commands may vary depending on how you
have implemented and fixed the code in previous exercises and the coding
style you have used.</p>
<p>The five digit codes, such as <code>C0303</code>, are unique
identifiers for warnings, with the first character indicating the type
of warning. There are five different types of warnings that Pylint looks
for, and you can get a summary of them by doing:</p>
<div class="codewrapper sourceCode" id="cb6">
<h3 class="code-label">BASH<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="sourceCode bash" tabindex="0"><code class="sourceCode bash"><span id="cb6-1"><a href="#cb6-1" tabindex="-1"></a><span class="ex">$</span> pylint <span class="at">--long-help</span></span></code></pre>
</div>
<p>Near the end you’ll see:</p>
<div class="codewrapper">
<h3 class="code-label">OUTPUT<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="output" tabindex="0"><code>  Output:
    Using the default text output, the message format is :
    MESSAGE_TYPE: LINE_NUM:[OBJECT:] MESSAGE
    There are 5 kind of message types :
    * (C) convention, for programming standard violation
    * (R) refactor, for bad code smell
    * (W) warning, for python specific problems
    * (E) error, for probable bugs in the code
    * (F) fatal, if an error occurred which prevented pylint from doing
    further processing.</code></pre>
</div>
<p>So for an example of a Pylint Python-specific <code>warning</code>,
see the “W0611: Unused numpy imported as np (unused-import)”
warning.</p>
<p>It is important to note that while tools such as Pylint are great at
giving you a starting point to consider how to improve your code, they
will not find everything that may be wrong with it.</p>
<div id="how-does-pylint-calculate-the-score" class="callout">
<div class="callout-square">
<i class="callout-icon" data-feather="bell"></i>
</div>
<div id="how-does-pylint-calculate-the-score" class="callout-inner">
<h3 class="callout-title">How Does Pylint Calculate the Score?</h3>
<div class="callout-content">
<p>The Python formula used is (with the variables representing numbers
of each type of infraction and <code>statement</code> indicating the
total number of statements):</p>
<div class="codewrapper sourceCode" id="cb8">
<h3 class="code-label">BASH<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="sourceCode bash" tabindex="0"><code class="sourceCode bash"><span id="cb8-1"><a href="#cb8-1" tabindex="-1"></a><span class="ex">10.0</span> <span class="at">-</span> <span class="er">(</span><span class="kw">(</span><span class="ex">float</span><span class="er">(</span><span class="ex">5</span> <span class="pp">*</span> error + warning + refactor + convention<span class="kw">)</span> <span class="ex">/</span> statement<span class="kw">)</span> <span class="ex">*</span> 10<span class="kw">)</span></span></code></pre>
</div>
<p>For example, with a total of 31 statements of models.py and views.py,
with a count of the errors shown above, we get a score of 8.00. Note
whilst there is a maximum score of 10, given the formula, there is no
minimum score - it is quite possible to get a negative score!</p>
</div>
</div>
</div>
<div id="exercise-further-improve-code-style-of-our-project" class="callout discussion">
<div class="callout-square">
<i class="callout-icon" data-feather="message-circle"></i>
</div>
<div id="exercise-further-improve-code-style-of-our-project" class="callout-inner">
<h3 class="callout-title">Exercise: Further Improve Code Style of Our Project</h3>
<div class="callout-content">
<p>Select and fix a few of the issues with our code that Pylint
detected. Make sure you do not break the rest of the code in the process
and that the code still runs. After making any changes, run Pylint again
to verify you have resolved these issues.</p>
</div>
</div>
</div>
<p>Make sure you commit and push <code>requirements.txt</code> and any
file with further code style improvements you did on to
<code>style-fixes</code> branch and then merge all these changes into
your development branch.</p>
<p>For the time being, we will not merge the development branch onto
<code>main</code> until we finish testing our code a bit further and
automating those tests with GitHub’s Continuous Integration service
called GitHub Actions (to be covered in the next section). Note that it
is also possible to automate the linting kinds of code checks with
GitHub Actions - we will come back to automated linting in the episode
on <a href="24-diagnosing-issues-improving-robustness.html">“Diagnosing
Issues and Improving Robustness”</a>.</p>
<div class="codewrapper sourceCode" id="cb9">
<h3 class="code-label">BASH<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="sourceCode bash" tabindex="0"><code class="sourceCode bash"><span id="cb9-1"><a href="#cb9-1" tabindex="-1"></a><span class="ex">$</span> git add requirements.txt</span>
<span id="cb9-2"><a href="#cb9-2" tabindex="-1"></a><span class="ex">$</span> git commit <span class="at">-m</span> <span class="st">"Added Pylint library"</span></span>
<span id="cb9-3"><a href="#cb9-3" tabindex="-1"></a><span class="ex">$</span> git push origin style-fixes</span>
<span id="cb9-4"><a href="#cb9-4" tabindex="-1"></a><span class="ex">$</span> git switch develop</span>
<span id="cb9-5"><a href="#cb9-5" tabindex="-1"></a><span class="ex">$</span> git merge style-fixes</span>
<span id="cb9-6"><a href="#cb9-6" tabindex="-1"></a><span class="ex">$</span> git push origin develop</span></code></pre>
</div>
<div id="optional-exercise-improve-code-style-of-your-other-python-projects" class="callout discussion">
<div class="callout-square">
<i class="callout-icon" data-feather="message-circle"></i>
</div>
<div id="optional-exercise-improve-code-style-of-your-other-python-projects" class="callout-inner">
<h3 class="callout-title">Optional Exercise: Improve Code Style of Your Other Python Projects</h3>
<div class="callout-content">
<p>If you have a Python project you are working on or you worked on in
the past, run it past Pylint to see what issues with your code are
detected, if any.</p>
</div>
</div>
</div>
<div id="optional-exercise-more-on-pylint" class="callout discussion">
<div class="callout-square">
<i class="callout-icon" data-feather="message-circle"></i>
</div>
<div id="optional-exercise-more-on-pylint" class="callout-inner">
<h3 class="callout-title">Optional Exercise: More on Pylint</h3>
<div class="callout-content">
<p>Checkout <a href="17-section1-optional-exercises.html">this optional
exercise</a> to learn more about <code>pylint</code>.</p>
</div>
</div>
</div>
<div id="keypoints1" class="callout keypoints">
<div class="callout-square">
<i class="callout-icon" data-feather="key"></i>
</div>
<div class="callout-inner">
<h3 class="callout-title">Key Points</h3>
<div class="callout-content">
<ul>
<li>Use linting tools on the command line (or via continuous
integration) to automatically check your code style.</li>
</ul>
</div>
</div>
</div>
</section></section><section id="aio-17-section1-optional-exercises"><p>Content from <a href="17-section1-optional-exercises.html">1.7 Optional Exercises</a></p>
<hr>
<p>Last updated on 2025-04-01 |

        <a href="https://github.com/carpentries-incubator/python-intermediate-development/edit/main/episodes/17-section1-optional-exercises.md" class="external-link">Edit this page <i aria-hidden="true" data-feather="edit"></i></a></p>
<p>Estimated time: <i aria-hidden="true" data-feather="clock"></i> 45 minutes</p>
<div class="text-end">
          <button role="button" aria-pressed="false" tabindex="0" id="expand-code" class="pull-right" data-expand="Expand All Solutions " data-collapse="Collapse All Solutions "> Expand All Solutions <i aria-hidden="true" data-feather="plus"></i></button>
        </div>
<div class="overview card">
<h2 class="card-header">Overview</h2>
<div class="row g-0">
<div class="col-md-4">
<div class="card-body">
<div class="inner">
<h3 class="card-title">Questions</h3>
<ul>
<li>How can I further fine-tune my coding environment?</li>
</ul>
</div>
</div>
</div>
<div class="col-md-8">
<div class="card-body">
<div class="inner bordered">
<h3 class="card-title">Objectives</h3>
<ul>
<li>Explore different options for your coding environment.</li>
</ul>
</div>
</div>
</div>
</div>
</div>
<p>This episode has some optional exercises for Section 1. The exercises
have an explorative nature, so feel free to go off in any direction that
interests you. You will be looking at some tools that either complement
or are alternatives to those already introduced. Even if you find
something that you really like, for the sake of following through with
the course, we still recommend sticking with the tools that we
introduced prior to this episode and then switching to something else
afterwards.</p>
<div id="exercise-apply-to-your-own-projects" class="callout discussion">
<div class="callout-square">
<i class="callout-icon" data-feather="message-circle"></i>
</div>
<div id="exercise-apply-to-your-own-projects" class="callout-inner">
<h3 class="callout-title">Exercise: Apply to your own project(s)</h3>
<div class="callout-content">
<p>Apply what you learned in this section to your own project(s). This
is the time to ask any questions of your instructors, helpers or fellow
learners. Everyone has different preferences for tooling, so getting
input from experienced developers is a great opportunity to learn new
things or different perspectives.</p>
</div>
</div>
</div>
<div id="exercise-try-out-different-integrated-development-environments" class="callout discussion">
<div class="callout-square">
<i class="callout-icon" data-feather="message-circle"></i>
</div>
<div id="exercise-try-out-different-integrated-development-environments" class="callout-inner">
<h3 class="callout-title">Exercise: Try out different Integrated
Development Environments</h3>
<div class="callout-content">
<p>Install different Integrated Development Environments (IDEs) and test
them out. Which one do you like the most and why?</p>
<p>Some suggestions to try:</p>
<ul>
<li>
<a href="https://code.visualstudio.com/" class="external-link">Visual Studio Code</a>,
with setup instructions <a href="vscode.html">in the Extras of this
course</a>
</li>
<li><a href="https://atom-editor.cc/" class="external-link">Atom</a></li>
<li><a href="https://www.sublimetext.com/" class="external-link">Sublime Text</a></li>
<li><a href="https://posit.co/download/rstudio-desktop/" class="external-link">RStudio</a></li>
</ul>
<p>When compared to PyCharm, the IDEs listed above are advanced source
code editors capable of functioning as IDEs. To function as an IDE, you
have to manually install plugins for these tools to obtain more advanced
features - such as support for a specific programming language or unit
testing.</p>
<p>What do you prefer, a lot of tooling out of the box or a lightweight
editor with optional extensions?</p>
<p>If you want an even more lightweight setup you can try out these
configurable source code editors:</p>
<ul>
<li><a href="https://www.gnu.org/software/emacs/" class="external-link">Emacs</a></li>
<li><a href="https://www.vim.org/" class="external-link">Vim</a></li>
</ul>
</div>
</div>
</div>
<div id="exercise-customise-the-command-line-tool" class="callout discussion">
<div class="callout-square">
<i class="callout-icon" data-feather="message-circle"></i>
</div>
<div id="exercise-customise-the-command-line-tool" class="callout-inner">
<h3 class="callout-title">Exercise: Customise the command line tool</h3>
<div class="callout-content">
<p>You can customise the command line tool or use alternatives to
<code>bash</code>, such as:</p>
<ul>
<li>
<a href="https://bash-prompt-generator.org/" class="external-link">Bash Prompt
Generator</a> - it lets you try out different prompts, depending on the
information you want displayed.</li>
<li>
<a href="https://github.com/rupa/z" class="external-link">z, a simple tool to more quickly
move around directories</a>.</li>
<li>
<a href="https://zsh.sourceforge.io/" class="external-link">Z shell (zsh)</a>, a shell
designed for interactive use.</li>
<li>
<a href="https://ohmyz.sh/" class="external-link">Oh My ZSH</a>, which is a theming and
package manager of the <code>zsh</code> terminal.</li>
<li>
<a href="https://fishshell.com/" class="external-link">fish</a>, a smart and user-friendly
command line shell.</li>
</ul>
</div>
</div>
</div>
<div id="exercise-try-out-different-virtual-environment-managers" class="callout discussion">
<div class="callout-square">
<i class="callout-icon" data-feather="message-circle"></i>
</div>
<div id="exercise-try-out-different-virtual-environment-managers" class="callout-inner">
<h3 class="callout-title">Exercise: Try out different virtual
environment managers</h3>
<div class="callout-content">
<p>So far we have used <code>venv</code>, but there are other virtual
environment managers for Python:</p>
<ul>
<li>
<a href="https://python-poetry.org/" class="external-link">Poetry</a>, which we will
explore using in <a href="43-software-release.html">Section 4</a>.</li>
<li>
<code>conda</code>, which is part of <a href="https://www.anaconda.com/download" class="external-link">Anaconda Distribution</a>.</li>
</ul>
<p>Anaconda is widely used in academia, but the current license does not
allow use for research in most circumstances. An open-source alternative
is <a href="https://github.com/conda-forge/miniforge" class="external-link">mini-forge</a>.</p>
</div>
</div>
</div>
<div id="exercise-customise-pylint" class="callout challenge">
<div class="callout-square">
<i class="callout-icon" data-feather="zap"></i>
</div>
<div id="exercise-customise-pylint" class="callout-inner">
<h3 class="callout-title">Exercise: Customise <code>pylint</code>
</h3>
<div class="callout-content">
<p>Tell <code>pylint</code> to accept the maximum line length of 100
characters instead of the default 80.</p>
<p>Hint: find out different ways in which you can configure
<code>pylint</code> (e.g. via <code>pylint</code> command line interface
or its configuration file).</p>
</div>
</div>
</div>
<div id="accordionSolution1" class="accordion challenge-accordion accordion-flush">
<div class="accordion-item">
<button class="accordion-button solution-button collapsed" type="button" data-bs-toggle="collapse" data-bs-target="#collapseSolution1" aria-expanded="false" aria-controls="collapseSolution1">
  <h4 class="accordion-header" id="headingSolution1"> Show me the solution </h4>
</button>
<div id="collapseSolution1" class="accordion-collapse collapse" aria-labelledby="headingSolution1" data-bs-parent="#accordionSolution1">
<div class="accordion-body">
<div class="section level3">
<h3 id="by-passing-an-argument-to-pylint-in-the-command-line">By passing an argument to <code>pylint</code> in the command
line<a class="anchor" aria-label="anchor" href="#by-passing-an-argument-to-pylint-in-the-command-line"></a>
</h3>
<p>Specify the max line length as an argument:
<code>pylint --max-line-length=100</code></p>
</div>
<div class="section level3">
<h3 id="using-a-configuration-file">Using a configuration file<a class="anchor" aria-label="anchor" href="#using-a-configuration-file"></a>
</h3>
<p>You can create a file <code>.pylintrc</code> in the root of your
project folder to overwrite <code>pylint</code> settings:</p>
<pre><code>[FORMAT]
max-line-length=100</code></pre>
</div>
</div>
</div>
</div>
</div></section><section id="aio-20-section2-intro"><p>Content from <a href="20-section2-intro.html">Section 2: Ensuring Correctness of Software at Scale</a></p>
<hr>
<p>Last updated on 2024-12-06 |

        <a href="https://github.com/carpentries-incubator/python-intermediate-development/edit/main/episodes/20-section2-intro.md" class="external-link">Edit this page <i aria-hidden="true" data-feather="edit"></i></a></p>
<p>Estimated time: <i aria-hidden="true" data-feather="clock"></i> 5 minutes</p>
<div class="text-end">
          <button role="button" aria-pressed="false" tabindex="0" id="expand-code" class="pull-right" data-expand="Expand All Solutions " data-collapse="Collapse All Solutions "> Expand All Solutions <i aria-hidden="true" data-feather="plus"></i></button>
        </div>
<div class="overview card">
<h2 class="card-header">Overview</h2>
<div class="row g-0">
<div class="col-md-4">
<div class="card-body">
<div class="inner">
<h3 class="card-title">Questions</h3>
<ul>
<li>What should we do to ensure our code is correct?</li>
</ul>
</div>
</div>
</div>
<div class="col-md-8">
<div class="card-body">
<div class="inner bordered">
<h3 class="card-title">Objectives</h3>
<ul>
<li>Introduce the testing tools, techniques, and infrastructure that
will be used in this section.</li>
</ul>
</div>
</div>
</div>
</div>
</div>
<p>We have just set up a suitable environment for the development of our
software project and are ready to start coding. However, we want to make
sure that the new code we contribute to the project is actually correct
and is not breaking any of the existing code. So, in this section, we
will look at testing approaches that can help us ensure that the
software we write is behaving as intended, and how we can diagnose and
fix issues once faults are found. Using such approaches requires us to
change our practice of development. This can take time, but potentially
saves us considerable time in the medium to long term by allowing us to
more comprehensively and rapidly find such faults, as well as giving us
greater confidence in the correctness of our code - so we should try and
employ such practices early on. We will also make use of techniques and
infrastructure that allow us to do this in a scalable, automated and
more performant way as our codebase grows.</p>
<figure><img src="../fig/section2-overview.svg" alt="Tools for scaled software testing" class="figure mx-auto d-block"><div class="figcaption">Section 2 Overview</div>
</figure><p>In this section we will:</p>
<ul>
<li>Make use of a <strong>test framework</strong> called Pytest, a free
and open source Python library to help us structure and run automated
tests.</li>
<li>Design, write and run <strong>unit tests</strong> using Pytest to
verify the correct behaviour of code and identify faults, making use of
test <strong>parameterisation</strong> to increase the number of
different test cases we can run.</li>
<li>Automatically run a set of unit tests using <strong>GitHub
Actions</strong> - a <strong>Continuous Integration</strong>
infrastructure that allows us to automate tasks when things happen to
our code, such as running those tests when a new commit is made to a
code repository.</li>
<li>Use PyCharm’s integrated <strong>debugger</strong> to help us locate
a fault in our code while it is running, and then fix it.</li>
</ul>
<div id="keypoints1" class="callout keypoints">
<div class="callout-square">
<i class="callout-icon" data-feather="key"></i>
</div>
<div class="callout-inner">
<h3 class="callout-title">Key Points</h3>
<div class="callout-content">
<ul>
<li>Using testing requires us to change our practice of code
development, but saves time in the long run by allowing us to more
comprehensively and rapidly find faults in code, as well as giving us
greater confidence in the correctness of our code.</li>
<li>The use of test techniques and infrastructures such as
<strong>parameterisation</strong> and <strong>Continuous
Integration</strong> can help scale and further automate our testing
process.</li>
</ul>
</div>
</div>
</div></section><section id="aio-21-automatically-testing-software"><p>Content from <a href="21-automatically-testing-software.html">2.1 Automatically Testing Software</a></p>
<hr>
<p>Last updated on 2025-04-01 |

        <a href="https://github.com/carpentries-incubator/python-intermediate-development/edit/main/episodes/21-automatically-testing-software.md" class="external-link">Edit this page <i aria-hidden="true" data-feather="edit"></i></a></p>
<p>Estimated time: <i aria-hidden="true" data-feather="clock"></i> 45 minutes</p>
<div class="text-end">
          <button role="button" aria-pressed="false" tabindex="0" id="expand-code" class="pull-right" data-expand="Expand All Solutions " data-collapse="Collapse All Solutions "> Expand All Solutions <i aria-hidden="true" data-feather="plus"></i></button>
        </div>
<div class="overview card">
<h2 class="card-header">Overview</h2>
<div class="row g-0">
<div class="col-md-4">
<div class="card-body">
<div class="inner">
<h3 class="card-title">Questions</h3>
<ul>
<li>Does the code we develop work the way it should do?</li>
<li>Can we (and others) verify these assertions for themselves?</li>
<li>To what extent are we confident of the accuracy of results that are
generated by code and appear in publications?</li>
</ul>
</div>
</div>
</div>
<div class="col-md-8">
<div class="card-body">
<div class="inner bordered">
<h3 class="card-title">Objectives</h3>
<ul>
<li>Explain the reasons why testing is important</li>
<li>Describe the three main types of tests and what each are used
for</li>
<li>Implement and run unit tests to verify the correct behaviour of
program functions</li>
</ul>
</div>
</div>
</div>
</div>
</div>
<section><h2 class="section-heading" id="introduction">Introduction<a class="anchor" aria-label="anchor" href="#introduction"></a>
</h2>
<hr class="half-width">
<p>Being able to demonstrate that a process generates the right results
is important in any field of research, whether it is software generating
those results or not. So when writing software we need to ask ourselves
some key questions:</p>
<ul>
<li>Does the code we develop work the way it should do?</li>
<li>Can we (and others) verify these assertions for themselves?</li>
<li>Perhaps most importantly, to what extent are we confident of the
accuracy of results that software produces?</li>
</ul>
<p>If we are unable to demonstrate that our software fulfills these
criteria, why would anyone use it? Having well-defined tests for our
software is useful for this, but manually testing software can prove an
expensive process.</p>
<p>Automation can help, and automation where possible is a good thing -
it enables us to define a potentially complex process in a repeatable
way that is far less prone to error than manual approaches. Once
defined, automation can also save us a lot of effort, particularly in
the long run. In this episode we will look into techniques of automated
testing to improve the predictability of a software change, make
development more productive, and help us produce code that works as
expected and produces desired results.</p>
<div id="activate-your-virtual-environment" class="callout">
<div class="callout-square">
<i class="callout-icon" data-feather="bell"></i>
</div>
<div id="activate-your-virtual-environment" class="callout-inner">
<h3 class="callout-title">Activate your virtual environment</h3>
<div class="callout-content">
<p>If it is not already active, make sure to activate your virtual
environment, called <code>venv</code>, from the root of the software
project directory:</p>
<div class="codewrapper sourceCode" id="cb1">
<h3 class="code-label">BASH<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="sourceCode bash" tabindex="0"><code class="sourceCode bash"><span id="cb1-1"><a href="#cb1-1" tabindex="-1"></a><span class="ex">$</span> source venv/bin/activate <span class="co"># Mac or Linux</span></span>
<span id="cb1-2"><a href="#cb1-2" tabindex="-1"></a><span class="ex">$</span> source venv/Scripts/activate <span class="co"># Windows</span></span>
<span id="cb1-3"><a href="#cb1-3" tabindex="-1"></a><span class="kw">(</span><span class="ex">venv</span><span class="kw">)</span> <span class="ex">$</span></span></code></pre>
</div>
</div>
</div>
</div>
</section><section><h2 class="section-heading" id="what-is-software-testing">What Is Software Testing?<a class="anchor" aria-label="anchor" href="#what-is-software-testing"></a>
</h2>
<hr class="half-width">
<p>For the sake of argument, if each line we write has a 99% chance of
being right, then a 70-line program will be wrong more than half the
time. We need to do better than that, which means we need to test our
software to catch these mistakes.</p>
<p>We can and should extensively test our software manually, and manual
testing is well-suited to testing aspects such as graphical user
interfaces and reconciling visual outputs against inputs. However, even
with a good test plan, manual testing is very time consuming and prone
to error. Another style of testing is automated testing, where we write
code that tests the functions of our software. Since computers are very
good and efficient at automating repetitive tasks, we should take
advantage of this wherever possible.</p>
<p>There are three main types of automated tests:</p>
<ul>
<li>
<strong>Unit tests</strong> are tests for fairly small and specific
units of functionality, e.g. determining that a particular function
returns output as expected given specific inputs.</li>
<li>
<strong>Functional or integration tests</strong> work at a higher
level, and test functional paths through your code, e.g. given some
specific inputs, a set of interconnected functions across a number of
modules (or the entire code) produce the expected result. These are
particularly useful for exposing faults in how functional units
interact.</li>
<li>
<strong>Regression tests</strong> make sure that your program’s
output hasn’t changed, for example after making changes your code to add
new functionality or fix a bug.</li>
</ul>
<p>For the purposes of this course, we will focus on unit tests. But the
principles and practices we will talk about can be built on and applied
to the other types of tests too.</p>
</section><section><h2 class="section-heading" id="set-up-a-new-feature-branch-for-writing-tests">Set Up a New Feature Branch for Writing Tests<a class="anchor" aria-label="anchor" href="#set-up-a-new-feature-branch-for-writing-tests"></a>
</h2>
<hr class="half-width">
<p>We are going to look at how to run some existing tests and also write
some new ones, so let us ensure we are initially on our
<code>develop</code> branch. We will create a new feature branch called
<code>test-suite</code> off the <code>develop</code> branch - a common
term we use to refer to sets of tests - that we will use for our test
writing work:</p>
<div class="codewrapper sourceCode" id="cb2">
<h3 class="code-label">BASH<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="sourceCode bash" tabindex="0"><code class="sourceCode bash"><span id="cb2-1"><a href="#cb2-1" tabindex="-1"></a><span class="ex">$</span> git switch develop</span>
<span id="cb2-2"><a href="#cb2-2" tabindex="-1"></a><span class="ex">$</span> git switch <span class="at">-c</span> test-suite</span></code></pre>
</div>
<p>Good practice is to write our tests around the same time we write our
code on a feature branch. But since the code already exists, we are
creating a feature branch for just these extra tests. Git branches are
designed to be lightweight, and where necessary, transient, and use of
branches for even small bits of work is encouraged.</p>
<p>Later on, once we have finished writing these tests and are convinced
they work properly, we will merge our <code>test-suite</code> branch
back into <code>develop</code>. Once bigger code changes are completed,
merged to <code>develop</code> from various feature branches and tested
<em>together</em> with existing code - which of course may also have
been changed by other developers in the meantime - we will merge all of
the work into <code>main</code>.</p>
</section><section><h2 class="section-heading" id="inflammation-data-analysis">Inflammation Data Analysis<a class="anchor" aria-label="anchor" href="#inflammation-data-analysis"></a>
</h2>
<hr class="half-width">
<p>Let us go back to our <a href="11-software-project.html">patient
inflammation software project</a>. Recall that it is based on a clinical
trial of inflammation in patients who have been given a new treatment
for arthritis. There are a number of datasets in the <code>data</code>
directory recording inflammation information in patients (each file
representing a different trial), and are each stored in comma-separated
values (CSV) format: each row holds information for a single patient,
and the columns represent successive days when inflammation was measured
in patients.</p>
<p>Let us take a quick look at the data now from within the Python
command line console. Change directory to the repository root (which
should be in your home directory
<code>~/python-intermediate-inflammation</code>), ensure you have your
virtual environment activated in your command line terminal
(particularly if opening a new one), and then start the Python console
by invoking the Python interpreter without any parameters, e.g.:</p>
<div class="codewrapper sourceCode" id="cb3">
<h3 class="code-label">BASH<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="sourceCode bash" tabindex="0"><code class="sourceCode bash"><span id="cb3-1"><a href="#cb3-1" tabindex="-1"></a><span class="ex">$</span> cd ~/python-intermediate-inflammation</span>
<span id="cb3-2"><a href="#cb3-2" tabindex="-1"></a><span class="ex">$</span> source venv/bin/activate</span>
<span id="cb3-3"><a href="#cb3-3" tabindex="-1"></a><span class="ex">$</span> python3</span></code></pre>
</div>
<p>The last command will start the Python console within your shell,
which enables us to execute Python commands interactively. Inside the
console enter the following:</p>
<div class="codewrapper sourceCode" id="cb4">
<h3 class="code-label">PYTHON<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="sourceCode python" tabindex="0"><code class="sourceCode python"><span id="cb4-1"><a href="#cb4-1" tabindex="-1"></a><span class="im">import</span> numpy <span class="im">as</span> np</span>
<span id="cb4-2"><a href="#cb4-2" tabindex="-1"></a>data <span class="op">=</span> np.loadtxt(fname<span class="op">=</span><span class="st">'data/inflammation-01.csv'</span>, delimiter<span class="op">=</span><span class="st">','</span>)</span>
<span id="cb4-3"><a href="#cb4-3" tabindex="-1"></a>data.shape</span></code></pre>
</div>
<div class="codewrapper">
<h3 class="code-label">OUTPUT<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="output" tabindex="0"><code>(60, 40)</code></pre>
</div>
<p>The data in this case is two-dimensional - it has 60 rows (one for
each patient) and 40 columns (one for each day). Each cell in the data
represents an inflammation reading on a given day for a patient.</p>
<p>Our patient inflammation application has a number of statistical
functions held in <code>inflammation/models.py</code>:
<code>daily_mean()</code>, <code>daily_max()</code> and
<code>daily_min()</code>, for calculating the mean average, the maximum,
and the minimum values for a given number of rows in our data. For
example, the <code>daily_mean()</code> function looks like this:</p>
<div class="codewrapper sourceCode" id="cb6">
<h3 class="code-label">PYTHON<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="sourceCode python" tabindex="0"><code class="sourceCode python"><span id="cb6-1"><a href="#cb6-1" tabindex="-1"></a><span class="kw">def</span> daily_mean(data):</span>
<span id="cb6-2"><a href="#cb6-2" tabindex="-1"></a>    <span class="co">"""Calculate the daily mean of a 2D inflammation data array for each day.</span></span>
<span id="cb6-3"><a href="#cb6-3" tabindex="-1"></a></span>
<span id="cb6-4"><a href="#cb6-4" tabindex="-1"></a><span class="co">    :param data: A 2D data array with inflammation data (each row contains measurements for a single patient across all days).</span></span>
<span id="cb6-5"><a href="#cb6-5" tabindex="-1"></a><span class="co">    :returns: An array of mean values of measurements for each day.</span></span>
<span id="cb6-6"><a href="#cb6-6" tabindex="-1"></a><span class="co">    """</span></span>
<span id="cb6-7"><a href="#cb6-7" tabindex="-1"></a>    <span class="cf">return</span> np.mean(data, axis<span class="op">=</span><span class="dv">0</span>)</span></code></pre>
</div>
<p>Here, we use NumPy’s <code>np.mean()</code> function to calculate the
mean <em>vertically</em> across the data (denoted by
<code>axis=0</code>), which is then returned from the function. So, if
<code>data</code> was a NumPy array of three rows like…</p>
<div class="codewrapper sourceCode" id="cb7">
<h3 class="code-label">PYTHON<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="sourceCode python" tabindex="0"><code class="sourceCode python"><span id="cb7-1"><a href="#cb7-1" tabindex="-1"></a>[[<span class="dv">1</span>, <span class="dv">2</span>],</span>
<span id="cb7-2"><a href="#cb7-2" tabindex="-1"></a> [<span class="dv">3</span>, <span class="dv">4</span>],</span>
<span id="cb7-3"><a href="#cb7-3" tabindex="-1"></a> [<span class="dv">5</span>, <span class="dv">6</span>]]</span></code></pre>
</div>
<p>…the function would return a 1D NumPy array of <code>[3, 4]</code> -
each value representing the mean of each column (which are,
coincidentally, the same values as the second row in the above data
array).</p>
<p>To show this working with our patient data, we can use the function
like this, passing the first four patient rows to the function in the
Python console:</p>
<div class="codewrapper sourceCode" id="cb8">
<h3 class="code-label">PYTHON<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="sourceCode python" tabindex="0"><code class="sourceCode python"><span id="cb8-1"><a href="#cb8-1" tabindex="-1"></a><span class="im">from</span> inflammation.models <span class="im">import</span> daily_mean</span>
<span id="cb8-2"><a href="#cb8-2" tabindex="-1"></a></span>
<span id="cb8-3"><a href="#cb8-3" tabindex="-1"></a>daily_mean(data[<span class="dv">0</span>:<span class="dv">4</span>])</span></code></pre>
</div>
<p>Note we use a different form of <code>import</code> here - only
importing the <code>daily_mean</code> function from our
<code>models</code> instead of everything. This also has the effect that
we can refer to the function using only its name, without needing to
include the module name too
(i.e. <code>inflammation.models.daily_mean()</code>).</p>
<p>The above code will return the mean inflammation for each day column
across the first four patients (as a 1D NumPy array of shape (40,
0)):</p>
<div class="codewrapper">
<h3 class="code-label">OUTPUT<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="output" tabindex="0"><code>array([ 0.  ,  0.5 ,  1.5 ,  1.75,  2.5 ,  1.75,  3.75,  3.  ,  5.25,
        6.25,  7.  ,  7.  ,  7.  ,  8.  ,  5.75,  7.75,  8.5 , 11.  ,
        9.75, 10.25, 15.  ,  8.75,  9.75, 10.  ,  8.  , 10.25,  8.  ,
        5.5 ,  8.  ,  6.  ,  5.  ,  4.75,  4.75,  4.  ,  3.25,  4.  ,
        1.75,  2.25,  0.75,  0.75])</code></pre>
</div>
<p>The other statistical functions are similar. Note that in real
situations functions we write are often likely to be more complicated
than these, but simplicity here allows us to reason about what’s
happening - and what we need to test - more easily.</p>
<p>Let us now look into how we can test each of our application’s
statistical functions to ensure they are functioning correctly.</p>
</section><section><h2 class="section-heading" id="writing-tests-to-verify-correct-behaviour">Writing Tests to Verify Correct Behaviour<a class="anchor" aria-label="anchor" href="#writing-tests-to-verify-correct-behaviour"></a>
</h2>
<hr class="half-width">
<div class="section level3">
<h3 id="one-way-to-do-it">One Way to Do It<a class="anchor" aria-label="anchor" href="#one-way-to-do-it"></a>
</h3>
<p>One way to test our functions would be to write a series of checks or
tests, each executing a function we want to test with known inputs
against known valid results, and throw an error if we encounter a result
that is incorrect. So, referring back to our simple
<code>daily_mean()</code> example above, we could use
<code>[[1, 2], [3, 4], [5, 6]]</code> as an input to that function and
check whether the result equals <code>[3, 4]</code>:</p>
<div class="codewrapper sourceCode" id="cb10">
<h3 class="code-label">PYTHON<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="sourceCode python" tabindex="0"><code class="sourceCode python"><span id="cb10-1"><a href="#cb10-1" tabindex="-1"></a><span class="im">import</span> numpy.testing <span class="im">as</span> npt</span>
<span id="cb10-2"><a href="#cb10-2" tabindex="-1"></a></span>
<span id="cb10-3"><a href="#cb10-3" tabindex="-1"></a>test_input <span class="op">=</span> np.array([[<span class="dv">1</span>, <span class="dv">2</span>], [<span class="dv">3</span>, <span class="dv">4</span>], [<span class="dv">5</span>, <span class="dv">6</span>]])</span>
<span id="cb10-4"><a href="#cb10-4" tabindex="-1"></a>test_result <span class="op">=</span> np.array([<span class="dv">3</span>, <span class="dv">4</span>])</span>
<span id="cb10-5"><a href="#cb10-5" tabindex="-1"></a>npt.assert_array_equal(daily_mean(test_input), test_result)</span></code></pre>
</div>
<p>So we use the <code>assert_array_equal()</code> function - part of
NumPy’s testing library - to test that our calculated result is the same
as our expected result. This function explicitly checks the array’s
shape and elements are the same, and throws an
<code>AssertionError</code> if they are not. In particular, note that we
cannot just use <code>==</code> or other Python equality methods, since
these will not work properly with NumPy arrays in all cases.</p>
<p>We could then add to this with other tests that use and test against
other values, and end up with something like:</p>
<div class="codewrapper sourceCode" id="cb11">
<h3 class="code-label">PYTHON<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="sourceCode python" tabindex="0"><code class="sourceCode python"><span id="cb11-1"><a href="#cb11-1" tabindex="-1"></a>test_input <span class="op">=</span> np.array([[<span class="dv">2</span>, <span class="dv">0</span>], [<span class="dv">4</span>, <span class="dv">0</span>]])</span>
<span id="cb11-2"><a href="#cb11-2" tabindex="-1"></a>test_result <span class="op">=</span> np.array([<span class="dv">2</span>, <span class="dv">0</span>])</span>
<span id="cb11-3"><a href="#cb11-3" tabindex="-1"></a>npt.assert_array_equal(daily_mean(test_input), test_result)</span>
<span id="cb11-4"><a href="#cb11-4" tabindex="-1"></a></span>
<span id="cb11-5"><a href="#cb11-5" tabindex="-1"></a>test_input <span class="op">=</span> np.array([[<span class="dv">0</span>, <span class="dv">0</span>], [<span class="dv">0</span>, <span class="dv">0</span>], [<span class="dv">0</span>, <span class="dv">0</span>]])</span>
<span id="cb11-6"><a href="#cb11-6" tabindex="-1"></a>test_result <span class="op">=</span> np.array([<span class="dv">0</span>, <span class="dv">0</span>])</span>
<span id="cb11-7"><a href="#cb11-7" tabindex="-1"></a>npt.assert_array_equal(daily_mean(test_input), test_result)</span>
<span id="cb11-8"><a href="#cb11-8" tabindex="-1"></a></span>
<span id="cb11-9"><a href="#cb11-9" tabindex="-1"></a>test_input <span class="op">=</span> np.array([[<span class="dv">1</span>, <span class="dv">2</span>], [<span class="dv">3</span>, <span class="dv">4</span>], [<span class="dv">5</span>, <span class="dv">6</span>]])</span>
<span id="cb11-10"><a href="#cb11-10" tabindex="-1"></a>test_result <span class="op">=</span> np.array([<span class="dv">3</span>, <span class="dv">4</span>])</span>
<span id="cb11-11"><a href="#cb11-11" tabindex="-1"></a>npt.assert_array_equal(daily_mean(test_input), test_result)</span></code></pre>
</div>
<p>However, if we were to enter these in this order, we will find we get
the following after the first test:</p>
<div class="codewrapper">
<h3 class="code-label">OUTPUT<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="output" tabindex="0"><code>...
AssertionError:
Arrays are not equal

Mismatched elements: 1 / 2 (50%)
Max absolute difference: 1.
Max relative difference: 0.5
 x: array([3., 0.])
 y: array([2, 0])</code></pre>
</div>
<p>This tells us that one element between our generated and expected
arrays does not match, and shows us the different arrays.</p>
<p>We could put these tests in a separate script to automate the running
of these tests. But a Python script halts at the first failed assertion,
so the second and third tests aren’t run at all. It would be more
helpful if we could get data from all of our tests every time they are
run, since the more information we have, the faster we are likely to be
able to track down bugs. It would also be helpful to have some kind of
summary report: if our set of tests - known as a <strong>test
suite</strong> - includes thirty or forty tests (as it well might for a
complex function or library that’s widely used), we would like to know
how many passed or failed.</p>
<p>Going back to our failed first test, what was the issue? As it turns
out, the test itself was incorrect, and should have read:</p>
<div class="codewrapper sourceCode" id="cb13">
<h3 class="code-label">PYTHON<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="sourceCode python" tabindex="0"><code class="sourceCode python"><span id="cb13-1"><a href="#cb13-1" tabindex="-1"></a>test_input <span class="op">=</span> np.array([[<span class="dv">2</span>, <span class="dv">0</span>], [<span class="dv">4</span>, <span class="dv">0</span>]])</span>
<span id="cb13-2"><a href="#cb13-2" tabindex="-1"></a>test_result <span class="op">=</span> np.array([<span class="dv">3</span>, <span class="dv">0</span>])</span>
<span id="cb13-3"><a href="#cb13-3" tabindex="-1"></a>npt.assert_array_equal(daily_mean(test_input), test_result)</span></code></pre>
</div>
<p>Which highlights an important point: as well as making sure our code
is returning correct answers, we also need to ensure the tests
themselves are also correct. Otherwise, we may go on to fix our code
only to return an incorrect result that <em>appears</em> to be correct.
So a good rule is to make tests simple enough to understand so we can
reason about both the correctness of our tests as well as our code.
Otherwise, our tests hold little value.</p>
</div>
<div class="section level3">
<h3 id="using-a-testing-framework">Using a Testing Framework<a class="anchor" aria-label="anchor" href="#using-a-testing-framework"></a>
</h3>
<p>Keeping these things in mind, here’s a different approach that builds
on the ideas we have seen so far but uses a <strong>unit testing
framework</strong>. In such a framework we define our tests we want to
run as functions, and the framework automatically runs each of these
functions in turn, summarising the outputs. And unlike our previous
approach, it will run every test regardless of any encountered test
failures.</p>
<p>Most people do not enjoy writing tests, so if we want them to
actually do it, it must be easy to:</p>
<ul>
<li>Add or change tests,</li>
<li>Understand the tests that have already been written,</li>
<li>Run those tests, and</li>
<li>Understand those tests’ results</li>
</ul>
<p>Test results must also be reliable. If a testing tool says that code
is working when it is not, or reports problems when there actually
aren’t any, people will lose faith in it and stop using it.</p>
<p>Look at <code>tests/test_models.py</code>:</p>
<div class="codewrapper sourceCode" id="cb14">
<h3 class="code-label">PYTHON<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="sourceCode python" tabindex="0"><code class="sourceCode python"><span id="cb14-1"><a href="#cb14-1" tabindex="-1"></a><span class="co">"""Tests for statistics functions within the Model layer."""</span></span>
<span id="cb14-2"><a href="#cb14-2" tabindex="-1"></a></span>
<span id="cb14-3"><a href="#cb14-3" tabindex="-1"></a><span class="im">import</span> numpy <span class="im">as</span> np</span>
<span id="cb14-4"><a href="#cb14-4" tabindex="-1"></a><span class="im">import</span> numpy.testing <span class="im">as</span> npt</span>
<span id="cb14-5"><a href="#cb14-5" tabindex="-1"></a></span>
<span id="cb14-6"><a href="#cb14-6" tabindex="-1"></a><span class="im">from</span> inflammation.models <span class="im">import</span> daily_mean</span>
<span id="cb14-7"><a href="#cb14-7" tabindex="-1"></a></span>
<span id="cb14-8"><a href="#cb14-8" tabindex="-1"></a><span class="kw">def</span> test_daily_mean_zeros():</span>
<span id="cb14-9"><a href="#cb14-9" tabindex="-1"></a>    <span class="co">"""Test that mean function works for an array of zeros."""</span></span>
<span id="cb14-10"><a href="#cb14-10" tabindex="-1"></a></span>
<span id="cb14-11"><a href="#cb14-11" tabindex="-1"></a>    test_input <span class="op">=</span> np.array([[<span class="dv">0</span>, <span class="dv">0</span>],</span>
<span id="cb14-12"><a href="#cb14-12" tabindex="-1"></a>                           [<span class="dv">0</span>, <span class="dv">0</span>],</span>
<span id="cb14-13"><a href="#cb14-13" tabindex="-1"></a>                           [<span class="dv">0</span>, <span class="dv">0</span>]])</span>
<span id="cb14-14"><a href="#cb14-14" tabindex="-1"></a>    test_result <span class="op">=</span> np.array([<span class="dv">0</span>, <span class="dv">0</span>])</span>
<span id="cb14-15"><a href="#cb14-15" tabindex="-1"></a></span>
<span id="cb14-16"><a href="#cb14-16" tabindex="-1"></a>    <span class="co"># Need to use NumPy testing functions to compare arrays</span></span>
<span id="cb14-17"><a href="#cb14-17" tabindex="-1"></a>    npt.assert_array_equal(daily_mean(test_input), test_result)</span>
<span id="cb14-18"><a href="#cb14-18" tabindex="-1"></a></span>
<span id="cb14-19"><a href="#cb14-19" tabindex="-1"></a></span>
<span id="cb14-20"><a href="#cb14-20" tabindex="-1"></a><span class="kw">def</span> test_daily_mean_integers():</span>
<span id="cb14-21"><a href="#cb14-21" tabindex="-1"></a>    <span class="co">"""Test that mean function works for an array of positive integers."""</span></span>
<span id="cb14-22"><a href="#cb14-22" tabindex="-1"></a></span>
<span id="cb14-23"><a href="#cb14-23" tabindex="-1"></a>    test_input <span class="op">=</span> np.array([[<span class="dv">1</span>, <span class="dv">2</span>],</span>
<span id="cb14-24"><a href="#cb14-24" tabindex="-1"></a>                           [<span class="dv">3</span>, <span class="dv">4</span>],</span>
<span id="cb14-25"><a href="#cb14-25" tabindex="-1"></a>                           [<span class="dv">5</span>, <span class="dv">6</span>]])</span>
<span id="cb14-26"><a href="#cb14-26" tabindex="-1"></a>    test_result <span class="op">=</span> np.array([<span class="dv">3</span>, <span class="dv">4</span>])</span>
<span id="cb14-27"><a href="#cb14-27" tabindex="-1"></a></span>
<span id="cb14-28"><a href="#cb14-28" tabindex="-1"></a>    <span class="co"># Need to use NumPy testing functions to compare arrays</span></span>
<span id="cb14-29"><a href="#cb14-29" tabindex="-1"></a>    npt.assert_array_equal(daily_mean(test_input), test_result)</span>
<span id="cb14-30"><a href="#cb14-30" tabindex="-1"></a>...</span></code></pre>
</div>
<p>Here, although we have specified two of our previous manual tests as
separate functions, they run the same assertions. Each of these test
functions, in a general sense, are called <strong>test cases</strong> -
these are a specification of:</p>
<ul>
<li>Inputs, e.g. the <code>test_input</code> NumPy array</li>
<li>Execution conditions - what we need to do to set up the testing
environment to run our test, e.g. importing the
<code>daily_mean()</code> function so we can use it. Note that for
clarity of testing environment, we only import the necessary library
function we want to test within each test function</li>
<li>Testing procedure, e.g. running <code>daily_mean()</code> with our
<code>test_input</code> array and using
<code>assert_array_equal()</code> to test its validity</li>
<li>Expected outputs, e.g. our <code>test_result</code> NumPy array that
we test against</li>
</ul>
<p>Also, we are defining each of these things for a test case we can run
independently that requires no manual intervention.</p>
<p>Going back to our list of requirements, how easy is it to run these
tests? We can do this using a Python package called <code>pytest</code>.
Pytest is a testing framework that allows you to write test cases using
Python. You can use it to test things like Python functions, database
operations, or even things like service APIs - essentially anything that
has inputs and expected outputs. We will be using Pytest to write unit
tests, but what you learn can scale to more complex functional testing
for applications or libraries.</p>
<div id="what-about-unit-testing-frameworks-in-python-and-other-languages" class="callout">
<div class="callout-square">
<i class="callout-icon" data-feather="bell"></i>
</div>
<div id="what-about-unit-testing-frameworks-in-python-and-other-languages" class="callout-inner">
<h3 class="callout-title">What About Unit Testing Frameworks in Python and Other Languages?</h3>
<div class="callout-content">
<p>Other unit testing frameworks exist for Python, including Nose2 and
Unittest, with Unittest supplied as part of the standard Python library.
It is also worth noting that Pytest supports tests written for Unittest,
a useful feature if you wish to prioritise use of the standard library
initially, but retain the option to move Pytest in the future.</p>
<p>The unit testing approach can be translated to (and is supported
within) other languages as well, e.g. pFUnit for Fortran, JUnit for Java
(the original unit testing framework), Catch or gtest for C++, etc.</p>
</div>
</div>
</div>
<div id="why-use-pytest-over-unittest" class="callout">
<div class="callout-square">
<i class="callout-icon" data-feather="bell"></i>
</div>
<div id="why-use-pytest-over-unittest" class="callout-inner">
<h3 class="callout-title">Why Use pytest over unittest?</h3>
<div class="callout-content">
<p>We could alternatively use another Python unit test framework, <a href="https://docs.python.org/3/library/unittest.html" class="external-link">unittest</a>,
which has the advantage of being installed by default as part of Python.
This is certainly a solid and established option, however <a href="https://realpython.com/pytest-python-testing/#what-makes-pytest-so-useful" class="external-link">pytest
has many distinct advantages</a>, particularly for learning,
including:</p>
<ul>
<li>unittest requires additional knowledge of object-oriented frameworks
(covered later in the course) to write unit tests, whereas in pytest
these are written in simpler functions so is easier to learn</li>
<li>Being written using simpler functions, pytest’s scripts are more
concise and contain less boilerplate, and thus are easier to read</li>
<li>pytest output, particularly in regard to test failure output, is
generally considered more helpful and readable</li>
<li>pytest has a vast ecosystem of plugins available if ever you need
additional testing functionality</li>
<li>unittest-style unit tests can be run from pytest out of the
box!</li>
</ul>
<p>A common challenge, particularly at the intermediate level, is the
selection of a suitable tool from many alternatives for a given task.
Once you have become accustomed to object-oriented programming you may
find unittest a better fit for a particular project or team, so you may
want to revisit it at a later date.</p>
</div>
</div>
</div>
</div>
<div class="section level3">
<h3 id="installing-pytest">Installing Pytest<a class="anchor" aria-label="anchor" href="#installing-pytest"></a>
</h3>
<p>If you have already installed <code>pytest</code> package in your
virtual environment, you can skip this step. Otherwise, as we have seen,
we have a couple of options for installing external libraries:</p>
<ol style="list-style-type: decimal">
<li>via PyCharm (see <a href="13-ides.html">“Adding an External
Library”</a> section in <a href="13-ides.html">“Integrated Software
Development Environments”</a> episode), or</li>
<li>via the command line (see <a href="12-virtual-environments.html">“Installing External Libraries in an
Environment With <code>pip</code>”</a> section in <a href="12-virtual-environments.html">“Virtual Environments For Software
Development”</a> episode).</li>
</ol>
<p>To do it via the command line - exit the Python console first (either
with <code>Ctrl-D</code> or by typing <code>exit()</code>), then do:</p>
<div class="codewrapper sourceCode" id="cb15">
<h3 class="code-label">BASH<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="sourceCode bash" tabindex="0"><code class="sourceCode bash"><span id="cb15-1"><a href="#cb15-1" tabindex="-1"></a><span class="ex">$</span> python3 <span class="at">-m</span> pip install pytest</span></code></pre>
</div>
<p>Whether we do this via PyCharm or the command line, the results are
exactly the same: our virtual environment will now have the
<code>pytest</code> package installed for use.</p>
</div>
<div class="section level3">
<h3 id="running-tests">Running Tests<a class="anchor" aria-label="anchor" href="#running-tests"></a>
</h3>
<p>Now we can run these tests using <code>pytest</code>:</p>
<div class="codewrapper sourceCode" id="cb16">
<h3 class="code-label">BASH<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="sourceCode bash" tabindex="0"><code class="sourceCode bash"><span id="cb16-1"><a href="#cb16-1" tabindex="-1"></a><span class="ex">$</span> python3 <span class="at">-m</span> pytest tests/test_models.py</span></code></pre>
</div>
<p>Here, we use <code>-m</code> flag of the <code>python3</code> command
to invoke the <code>pytest</code> module, and specify the
<code>tests/test_models.py</code> file to run the tests in that file
explicitly.</p>
<div id="why-run-pytest-using-python3--m-pytest-and-not-pytest" class="callout">
<div class="callout-square">
<i class="callout-icon" data-feather="bell"></i>
</div>
<div id="why-run-pytest-using-python3--m-pytest-and-not-pytest" class="callout-inner">
<h3 class="callout-title">Why Run Pytest Using
<code>python3 -m pytest</code> and Not <code>pytest</code>?</h3>
<div class="callout-content">
<p><code>pytest</code> is another Python module that can be run via its
own command but this is a good example why invoking Python modules via
<code>python3 -m</code> may be better (recall the <a href="12-virtual-environments.html">explanation of Python interpreter’s
<code>-m</code> flag</a>). Had we used
<code>pytest tests/test_models.py</code> command directly, this would
have led to a “ModuleNotFoundError: No module named ‘inflammation’”
error. This is because <code>pytest</code> command (unlike
<code>python3 -m pytest</code>) does not add the current directory to
its list of directories to search for modules, hence the
<code>inflammation</code> subdirectory’s contents are not being ‘seen’
by <code>pytest</code> causing the <code>ModuleNotFoundError</code>.
There are ways to work around this problem but
<code>python3 -m pytest</code> ensures it does not happen in the first
place.</p>
</div>
</div>
</div>
<div class="codewrapper">
<h3 class="code-label">OUTPUT<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="output" tabindex="0"><code>============================================== test session starts =================================
platform darwin -- Python 3.11.4, pytest-7.4.3, pluggy-1.3.0
rootdir: /Users/alex/work/SSI/training/lessons/python-intermediate-inflammation
plugins: anyio-4.0.0
collected 2 items

tests/test_models.py ..                                                                       [100%]

=============================================== 2 passed in 0.79s ==================================</code></pre>
</div>
<p>Pytest looks for functions whose names also start with the letters
‘test_’ and runs each one. Notice the <code>..</code> after our test
script:</p>
<ul>
<li>If the function completes without an assertion being triggered, we
count the test as a success (indicated as <code>.</code>).</li>
<li>If an assertion fails, or we encounter an error, we count the test
as a failure (indicated as <code>F</code>). The error is included in the
output so we can see what went wrong.</li>
</ul>
<p>So if we have many tests, we essentially get a report indicating
which tests succeeded or failed. Going back to our list of requirements
(the bullet points under <a href="#using-a-testing-framework">Using a
Testing Framework</a> section), do we think these results are easy to
understand?</p>
<div id="exercise-write-some-unit-tests" class="callout challenge">
<div class="callout-square">
<i class="callout-icon" data-feather="zap"></i>
</div>
<div id="exercise-write-some-unit-tests" class="callout-inner">
<h3 class="callout-title">Exercise: Write Some Unit Tests</h3>
<div class="callout-content">
<p>We already have a couple of test cases in
<code>test/test_models.py</code> that test the <code>daily_mean()</code>
function. Looking at <code>inflammation/models.py</code>, write at least
two new test cases that test the <code>daily_max()</code> and
<code>daily_min()</code> functions, adding them to
<code>test/test_models.py</code>. Here are some hints:</p>
<ul>
<li>You could choose to format your functions very similarly to
<code>daily_mean()</code>, defining test input and expected result
arrays followed by the equality assertion.</li>
<li>Try to choose cases that are suitably different, and remember that
these functions take a 2D array and return a 1D array with each element
the result of analysing each <em>column</em> of the data.</li>
</ul>
<p>Once added, run all the tests again with
<code>python -m pytest tests/test_models.py</code>, and you should also
see your new tests pass.</p>
</div>
</div>
</div>
<div id="accordionSolution1" class="accordion challenge-accordion accordion-flush">
<div class="accordion-item">
<button class="accordion-button solution-button collapsed" type="button" data-bs-toggle="collapse" data-bs-target="#collapseSolution1" aria-expanded="false" aria-controls="collapseSolution1">
  <h4 class="accordion-header" id="headingSolution1"> Show me the solution </h4>
</button>
<div id="collapseSolution1" class="accordion-collapse collapse" aria-labelledby="headingSolution1" data-bs-parent="#accordionSolution1">
<div class="accordion-body">
<div class="codewrapper sourceCode" id="cb18">
<h3 class="code-label">PYTHON<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="sourceCode python" tabindex="0"><code class="sourceCode python"><span id="cb18-1"><a href="#cb18-1" tabindex="-1"></a><span class="im">from</span> inflammation.models <span class="im">import</span> daily_max, daily_mean, daily_min</span>
<span id="cb18-2"><a href="#cb18-2" tabindex="-1"></a>...</span>
<span id="cb18-3"><a href="#cb18-3" tabindex="-1"></a><span class="kw">def</span> test_daily_max():</span>
<span id="cb18-4"><a href="#cb18-4" tabindex="-1"></a>    <span class="co">"""Test that max function works for an array of positive integers."""</span></span>
<span id="cb18-5"><a href="#cb18-5" tabindex="-1"></a></span>
<span id="cb18-6"><a href="#cb18-6" tabindex="-1"></a>    test_input <span class="op">=</span> np.array([[<span class="dv">4</span>, <span class="dv">2</span>, <span class="dv">5</span>],</span>
<span id="cb18-7"><a href="#cb18-7" tabindex="-1"></a>                           [<span class="dv">1</span>, <span class="dv">6</span>, <span class="dv">2</span>],</span>
<span id="cb18-8"><a href="#cb18-8" tabindex="-1"></a>                           [<span class="dv">4</span>, <span class="dv">1</span>, <span class="dv">9</span>]])</span>
<span id="cb18-9"><a href="#cb18-9" tabindex="-1"></a>    test_result <span class="op">=</span> np.array([<span class="dv">4</span>, <span class="dv">6</span>, <span class="dv">9</span>])</span>
<span id="cb18-10"><a href="#cb18-10" tabindex="-1"></a></span>
<span id="cb18-11"><a href="#cb18-11" tabindex="-1"></a>    npt.assert_array_equal(daily_max(test_input), test_result)</span>
<span id="cb18-12"><a href="#cb18-12" tabindex="-1"></a></span>
<span id="cb18-13"><a href="#cb18-13" tabindex="-1"></a></span>
<span id="cb18-14"><a href="#cb18-14" tabindex="-1"></a><span class="kw">def</span> test_daily_min():</span>
<span id="cb18-15"><a href="#cb18-15" tabindex="-1"></a>    <span class="co">"""Test that min function works for an array of positive and negative integers."""</span></span>
<span id="cb18-16"><a href="#cb18-16" tabindex="-1"></a></span>
<span id="cb18-17"><a href="#cb18-17" tabindex="-1"></a>    test_input <span class="op">=</span> np.array([[ <span class="dv">4</span>, <span class="op">-</span><span class="dv">2</span>, <span class="dv">5</span>],</span>
<span id="cb18-18"><a href="#cb18-18" tabindex="-1"></a>                           [ <span class="dv">1</span>, <span class="op">-</span><span class="dv">6</span>, <span class="dv">2</span>],</span>
<span id="cb18-19"><a href="#cb18-19" tabindex="-1"></a>                           [<span class="op">-</span><span class="dv">4</span>, <span class="op">-</span><span class="dv">1</span>, <span class="dv">9</span>]])</span>
<span id="cb18-20"><a href="#cb18-20" tabindex="-1"></a>    test_result <span class="op">=</span> np.array([<span class="op">-</span><span class="dv">4</span>, <span class="op">-</span><span class="dv">6</span>, <span class="dv">2</span>])</span>
<span id="cb18-21"><a href="#cb18-21" tabindex="-1"></a></span>
<span id="cb18-22"><a href="#cb18-22" tabindex="-1"></a>    npt.assert_array_equal(daily_min(test_input), test_result)</span>
<span id="cb18-23"><a href="#cb18-23" tabindex="-1"></a>...</span></code></pre>
</div>
</div>
</div>
</div>
</div>
<p>The big advantage is that as our code develops we can update our test
cases and commit them back, ensuring that ourselves (and others) always
have a set of tests to verify our code at each step of development. This
way, when we implement a new feature, we can check a) that the feature
works using a test we write for it, and b) that the development of the
new feature does not break any existing functionality.</p>
</div>
<div class="section level3">
<h3 id="what-about-testing-for-errors">What About Testing for Errors?<a class="anchor" aria-label="anchor" href="#what-about-testing-for-errors"></a>
</h3>
<p>There are some cases where seeing an error is actually the correct
behaviour, and Python allows us to test for exceptions. Add this test in
<code>tests/test_models.py</code>:</p>
<div class="codewrapper sourceCode" id="cb19">
<h3 class="code-label">PYTHON<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="sourceCode python" tabindex="0"><code class="sourceCode python"><span id="cb19-1"><a href="#cb19-1" tabindex="-1"></a><span class="im">import</span> pytest</span>
<span id="cb19-2"><a href="#cb19-2" tabindex="-1"></a><span class="im">from</span> inflammation.models <span class="im">import</span> daily_min</span>
<span id="cb19-3"><a href="#cb19-3" tabindex="-1"></a>...</span>
<span id="cb19-4"><a href="#cb19-4" tabindex="-1"></a><span class="kw">def</span> test_daily_min_string():</span>
<span id="cb19-5"><a href="#cb19-5" tabindex="-1"></a>    <span class="co">"""Test for TypeError when passing strings"""</span></span>
<span id="cb19-6"><a href="#cb19-6" tabindex="-1"></a></span>
<span id="cb19-7"><a href="#cb19-7" tabindex="-1"></a>    <span class="cf">with</span> pytest.raises(<span class="pp">TypeError</span>):</span>
<span id="cb19-8"><a href="#cb19-8" tabindex="-1"></a>        error_expected <span class="op">=</span> daily_min([[<span class="st">'Hello'</span>, <span class="st">'there'</span>], [<span class="st">'General'</span>, <span class="st">'Kenobi'</span>]])</span></code></pre>
</div>
<p>Note that you need to import the <code>pytest</code> library at the
top of our <code>test_models.py</code> file with
<code>import pytest</code> so that we can use <code>pytest</code>’s
<code>raises()</code> function.</p>
<p>Run all your tests as before.</p>
<p>Since we have installed <code>pytest</code> to our environment, we
should also regenerate our <code>requirements.txt</code>:</p>
<div class="codewrapper sourceCode" id="cb20">
<h3 class="code-label">BASH<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="sourceCode bash" tabindex="0"><code class="sourceCode bash"><span id="cb20-1"><a href="#cb20-1" tabindex="-1"></a><span class="ex">$</span> python3 <span class="at">-m</span> pip freeze <span class="at">--exclude-editable</span> <span class="op">&gt;</span> requirements.txt</span></code></pre>
</div>
<p>Finally, let us commit our new <code>test_models.py</code> file,
<code>requirements.txt</code> file, and test cases to our
<code>test-suite</code> branch, and push this new branch and all its
commits to GitHub:</p>
<div class="codewrapper sourceCode" id="cb21">
<h3 class="code-label">BASH<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="sourceCode bash" tabindex="0"><code class="sourceCode bash"><span id="cb21-1"><a href="#cb21-1" tabindex="-1"></a><span class="ex">$</span> git add requirements.txt tests/test_models.py</span>
<span id="cb21-2"><a href="#cb21-2" tabindex="-1"></a><span class="ex">$</span> git commit <span class="at">-m</span> <span class="st">"Add initial test cases for daily_max() and daily_min()"</span></span>
<span id="cb21-3"><a href="#cb21-3" tabindex="-1"></a><span class="ex">$</span> git push <span class="at">-u</span> origin test-suite</span></code></pre>
</div>
<div id="why-should-we-test-invalid-input-data" class="callout">
<div class="callout-square">
<i class="callout-icon" data-feather="bell"></i>
</div>
<div id="why-should-we-test-invalid-input-data" class="callout-inner">
<h3 class="callout-title">Why Should We Test Invalid Input Data?</h3>
<div class="callout-content">
<p>Testing the behaviour of inputs, both valid and invalid, is a really
good idea and is known as <em>data validation</em>. Even if you are
developing command line software that cannot be exploited by malicious
data entry, testing behaviour against invalid inputs prevents generation
of erroneous results that could lead to serious misinterpretation (as
well as saving time and compute cycles which may be expensive for
longer-running applications). It is generally best not to assume your
user’s inputs will always be rational.</p>
</div>
</div>
</div>
<div id="keypoints1" class="callout keypoints">
<div class="callout-square">
<i class="callout-icon" data-feather="key"></i>
</div>
<div class="callout-inner">
<h3 class="callout-title">Key Points</h3>
<div class="callout-content">
<ul>
<li>The three main types of automated tests are <strong>unit
tests</strong>, <strong>functional tests</strong> and <strong>regression
tests</strong>.</li>
<li>We can write unit tests to verify that functions generate expected
output given a set of specific inputs.</li>
<li>It should be easy to add or change tests, understand and run them,
and understand their results.</li>
<li>We can use a unit testing framework like Pytest to structure and
simplify the writing of tests in Python.</li>
<li>We should test for expected errors in our code.</li>
<li>Testing program behaviour against both valid and invalid inputs is
important and is known as <strong>data validation</strong>.</li>
</ul>
</div>
</div>
</div>
</div>
</section></section><section id="aio-22-scaling-up-unit-testing"><p>Content from <a href="22-scaling-up-unit-testing.html">2.2 Scaling Up Unit Testing</a></p>
<hr>
<p>Last updated on 2025-03-07 |

        <a href="https://github.com/carpentries-incubator/python-intermediate-development/edit/main/episodes/22-scaling-up-unit-testing.md" class="external-link">Edit this page <i aria-hidden="true" data-feather="edit"></i></a></p>
<p>Estimated time: <i aria-hidden="true" data-feather="clock"></i> 15 minutes</p>
<div class="text-end">
          <button role="button" aria-pressed="false" tabindex="0" id="expand-code" class="pull-right" data-expand="Expand All Solutions " data-collapse="Collapse All Solutions "> Expand All Solutions <i aria-hidden="true" data-feather="plus"></i></button>
        </div>
<div class="overview card">
<h2 class="card-header">Overview</h2>
<div class="row g-0">
<div class="col-md-4">
<div class="card-body">
<div class="inner">
<h3 class="card-title">Questions</h3>
<ul>
<li>How can we make it easier to write lots of tests?</li>
<li>How can we know how much of our code is being tested?</li>
</ul>
</div>
</div>
</div>
<div class="col-md-8">
<div class="card-body">
<div class="inner bordered">
<h3 class="card-title">Objectives</h3>
<ul>
<li>Use parameterisation to automatically run tests over a set of
inputs</li>
<li>Use code coverage to understand how much of our code is being tested
using unit tests</li>
</ul>
</div>
</div>
</div>
</div>
</div>
<section><h2 class="section-heading" id="introduction">Introduction<a class="anchor" aria-label="anchor" href="#introduction"></a>
</h2>
<hr class="half-width">
<p>We are starting to build up a number of tests that test the same
function, but just with different parameters. However, continuing to
write a new function for every single test case is not likely to scale
well as our development progresses. How can we make our job of writing
tests more efficient? And importantly, as the number of tests increases,
how can we determine how much of our code base is actually being
tested?</p>
</section><section><h2 class="section-heading" id="parameterising-our-unit-tests">Parameterising Our Unit Tests<a class="anchor" aria-label="anchor" href="#parameterising-our-unit-tests"></a>
</h2>
<hr class="half-width">
<p>So far, we have been writing a single function for every new test we
need. But when we simply want to use the same test code but with
different data for another test, it would be great to be able to specify
multiple sets of data to use with the same test code. Test
<strong>parameterisation</strong> gives us this.</p>
<p>So instead of writing a separate function for each different test, we
can <strong>parameterise</strong> the tests with multiple test inputs.
For example, in <code>tests/test_models.py</code> let us rewrite the
<code>test_daily_mean_zeros()</code> and
<code>test_daily_mean_integers()</code> into a single test function:</p>
<div class="codewrapper sourceCode" id="cb1">
<h3 class="code-label">PYTHON<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="sourceCode python" tabindex="0"><code class="sourceCode python"><span id="cb1-1"><a href="#cb1-1" tabindex="-1"></a><span class="im">from</span> inflammation.models <span class="im">import</span> daily_mean</span>
<span id="cb1-2"><a href="#cb1-2" tabindex="-1"></a></span>
<span id="cb1-3"><a href="#cb1-3" tabindex="-1"></a><span class="at">@pytest.mark.parametrize</span>(</span>
<span id="cb1-4"><a href="#cb1-4" tabindex="-1"></a>    <span class="st">"test, expected"</span>,</span>
<span id="cb1-5"><a href="#cb1-5" tabindex="-1"></a>    [</span>
<span id="cb1-6"><a href="#cb1-6" tabindex="-1"></a>        ([ [<span class="dv">0</span>, <span class="dv">0</span>], [<span class="dv">0</span>, <span class="dv">0</span>], [<span class="dv">0</span>, <span class="dv">0</span>] ], [<span class="dv">0</span>, <span class="dv">0</span>]),</span>
<span id="cb1-7"><a href="#cb1-7" tabindex="-1"></a>        ([ [<span class="dv">1</span>, <span class="dv">2</span>], [<span class="dv">3</span>, <span class="dv">4</span>], [<span class="dv">5</span>, <span class="dv">6</span>] ], [<span class="dv">3</span>, <span class="dv">4</span>]),</span>
<span id="cb1-8"><a href="#cb1-8" tabindex="-1"></a>    ])</span>
<span id="cb1-9"><a href="#cb1-9" tabindex="-1"></a><span class="kw">def</span> test_daily_mean(test, expected):</span>
<span id="cb1-10"><a href="#cb1-10" tabindex="-1"></a>    <span class="co">"""Test mean function works for array of zeroes and positive integers."""</span></span>
<span id="cb1-11"><a href="#cb1-11" tabindex="-1"></a>    npt.assert_array_equal(daily_mean(np.array(test)), np.array(expected))</span></code></pre>
</div>
<p>Here, we use Pytest’s <strong>mark</strong> capability to add
metadata to this specific test - in this case, marking that it is a
parameterised test. <code>parameterize()</code> function is actually a
<a href="https://www.programiz.com/python-programming/decorator" class="external-link">Python
<strong>decorator</strong></a>. A decorator, when applied to a function,
adds some functionality to it when it is called, and here, what we want
to do is specify multiple input and expected output test cases so the
function is called over each of these inputs automatically when this
test is called.</p>
<p>We specify these as arguments to the <code>parameterize()</code>
decorator, firstly indicating the names of these arguments that will be
passed to the function (<code>test</code>, <code>expected</code>), and
secondly the actual arguments themselves that correspond to each of
these names - the input data (the <code>test</code> argument), and the
expected result (the <code>expected</code> argument). In this case, we
are passing in two tests to <code>test_daily_mean()</code> which will be
run sequentially.</p>
<p>So our first test will run <code>daily_mean()</code> on
<code>[ [0, 0], [0, 0], [0, 0] ]</code> (our <code>test</code>
argument), and check to see if it equals <code>[0, 0]</code> (our
<code>expected</code> argument). Similarly, our second test will run
<code>daily_mean()</code> with <code>[ [1, 2], [3, 4], [5, 6] ]</code>
and check it produces <code>[3, 4]</code>.</p>
<p>The big plus here is that we do not need to write separate functions
for each of the tests - our test code can remain compact and readable as
we write more tests and adding more tests scales better as our code
becomes more complex.</p>
<div id="exercise-write-parameterised-unit-tests" class="callout challenge">
<div class="callout-square">
<i class="callout-icon" data-feather="zap"></i>
</div>
<div id="exercise-write-parameterised-unit-tests" class="callout-inner">
<h3 class="callout-title">Exercise: Write Parameterised Unit Tests</h3>
<div class="callout-content">
<p>Rewrite your test functions for <code>daily_max()</code> and
<code>daily_min()</code> to be parameterised, adding in new test cases
for each of them.</p>
</div>
</div>
</div>
<div id="accordionSolution1" class="accordion challenge-accordion accordion-flush">
<div class="accordion-item">
<button class="accordion-button solution-button collapsed" type="button" data-bs-toggle="collapse" data-bs-target="#collapseSolution1" aria-expanded="false" aria-controls="collapseSolution1">
  <h4 class="accordion-header" id="headingSolution1"> Show me the solution </h4>
</button>
<div id="collapseSolution1" class="accordion-collapse collapse" aria-labelledby="headingSolution1" data-bs-parent="#accordionSolution1">
<div class="accordion-body">
<div class="codewrapper sourceCode" id="cb2">
<h3 class="code-label">PYTHON<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="sourceCode python" tabindex="0"><code class="sourceCode python"><span id="cb2-1"><a href="#cb2-1" tabindex="-1"></a><span class="im">from</span> inflammation.models <span class="im">import</span> daily_max, daily_min</span>
<span id="cb2-2"><a href="#cb2-2" tabindex="-1"></a>...</span>
<span id="cb2-3"><a href="#cb2-3" tabindex="-1"></a><span class="at">@pytest.mark.parametrize</span>(</span>
<span id="cb2-4"><a href="#cb2-4" tabindex="-1"></a>    <span class="st">"test, expected"</span>,</span>
<span id="cb2-5"><a href="#cb2-5" tabindex="-1"></a>    [</span>
<span id="cb2-6"><a href="#cb2-6" tabindex="-1"></a>        ([ [<span class="dv">0</span>, <span class="dv">0</span>, <span class="dv">0</span>], [<span class="dv">0</span>, <span class="dv">0</span>, <span class="dv">0</span>], [<span class="dv">0</span>, <span class="dv">0</span>, <span class="dv">0</span>] ], [<span class="dv">0</span>, <span class="dv">0</span>, <span class="dv">0</span>]),</span>
<span id="cb2-7"><a href="#cb2-7" tabindex="-1"></a>        ([ [<span class="dv">4</span>, <span class="dv">2</span>, <span class="dv">5</span>], [<span class="dv">1</span>, <span class="dv">6</span>, <span class="dv">2</span>], [<span class="dv">4</span>, <span class="dv">1</span>, <span class="dv">9</span>] ], [<span class="dv">4</span>, <span class="dv">6</span>, <span class="dv">9</span>]),</span>
<span id="cb2-8"><a href="#cb2-8" tabindex="-1"></a>        ([ [<span class="dv">4</span>, <span class="op">-</span><span class="dv">2</span>, <span class="dv">5</span>], [<span class="dv">1</span>, <span class="op">-</span><span class="dv">6</span>, <span class="dv">2</span>], [<span class="op">-</span><span class="dv">4</span>, <span class="op">-</span><span class="dv">1</span>, <span class="dv">9</span>] ], [<span class="dv">4</span>, <span class="op">-</span><span class="dv">1</span>, <span class="dv">9</span>]),</span>
<span id="cb2-9"><a href="#cb2-9" tabindex="-1"></a>    ])</span>
<span id="cb2-10"><a href="#cb2-10" tabindex="-1"></a><span class="kw">def</span> test_daily_max(test, expected):</span>
<span id="cb2-11"><a href="#cb2-11" tabindex="-1"></a>    <span class="co">"""Test max function works for zeroes, positive integers, mix of positive/negative integers."""</span></span>
<span id="cb2-12"><a href="#cb2-12" tabindex="-1"></a>    npt.assert_array_equal(daily_max(np.array(test)), np.array(expected))</span>
<span id="cb2-13"><a href="#cb2-13" tabindex="-1"></a></span>
<span id="cb2-14"><a href="#cb2-14" tabindex="-1"></a></span>
<span id="cb2-15"><a href="#cb2-15" tabindex="-1"></a><span class="at">@pytest.mark.parametrize</span>(</span>
<span id="cb2-16"><a href="#cb2-16" tabindex="-1"></a>    <span class="st">"test, expected"</span>,</span>
<span id="cb2-17"><a href="#cb2-17" tabindex="-1"></a>    [</span>
<span id="cb2-18"><a href="#cb2-18" tabindex="-1"></a>        ([ [<span class="dv">0</span>, <span class="dv">0</span>, <span class="dv">0</span>], [<span class="dv">0</span>, <span class="dv">0</span>, <span class="dv">0</span>], [<span class="dv">0</span>, <span class="dv">0</span>, <span class="dv">0</span>] ], [<span class="dv">0</span>, <span class="dv">0</span>, <span class="dv">0</span>]),</span>
<span id="cb2-19"><a href="#cb2-19" tabindex="-1"></a>        ([ [<span class="dv">4</span>, <span class="dv">2</span>, <span class="dv">5</span>], [<span class="dv">1</span>, <span class="dv">6</span>, <span class="dv">2</span>], [<span class="dv">4</span>, <span class="dv">1</span>, <span class="dv">9</span>] ], [<span class="dv">1</span>, <span class="dv">1</span>, <span class="dv">2</span>]),</span>
<span id="cb2-20"><a href="#cb2-20" tabindex="-1"></a>        ([ [<span class="dv">4</span>, <span class="op">-</span><span class="dv">2</span>, <span class="dv">5</span>], [<span class="dv">1</span>, <span class="op">-</span><span class="dv">6</span>, <span class="dv">2</span>], [<span class="op">-</span><span class="dv">4</span>, <span class="op">-</span><span class="dv">1</span>, <span class="dv">9</span>] ], [<span class="op">-</span><span class="dv">4</span>, <span class="op">-</span><span class="dv">6</span>, <span class="dv">2</span>]),</span>
<span id="cb2-21"><a href="#cb2-21" tabindex="-1"></a>    ])</span>
<span id="cb2-22"><a href="#cb2-22" tabindex="-1"></a><span class="kw">def</span> test_daily_min(test, expected):</span>
<span id="cb2-23"><a href="#cb2-23" tabindex="-1"></a>    <span class="co">"""Test min function works for zeroes, positive integers, mix of positive/negative integers."""</span></span>
<span id="cb2-24"><a href="#cb2-24" tabindex="-1"></a>    npt.assert_array_equal(daily_min(np.array(test)), np.array(expected))</span>
<span id="cb2-25"><a href="#cb2-25" tabindex="-1"></a>...</span></code></pre>
</div>
</div>
</div>
</div>
</div>
<p>Try them out!</p>
<p>Let us commit our revised <code>test_models.py</code> file and test
cases to our <code>test-suite</code> branch (but do not push them to the
remote repository just yet!):</p>
<div class="codewrapper sourceCode" id="cb3">
<h3 class="code-label">BASH<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="sourceCode bash" tabindex="0"><code class="sourceCode bash"><span id="cb3-1"><a href="#cb3-1" tabindex="-1"></a><span class="ex">$</span> git add tests/test_models.py</span>
<span id="cb3-2"><a href="#cb3-2" tabindex="-1"></a><span class="ex">$</span> git commit <span class="at">-m</span> <span class="st">"Add parameterisation mean, min, max test cases"</span></span></code></pre>
</div>
</section><section><h2 class="section-heading" id="code-coverage---how-much-of-our-code-is-tested">Code Coverage - How Much of Our Code is Tested?<a class="anchor" aria-label="anchor" href="#code-coverage---how-much-of-our-code-is-tested"></a>
</h2>
<hr class="half-width">
<p>Pytest cannot think of test cases for us. We still have to decide
what to test and how many tests to run. Our best guide here is
economics: we want the tests that are most likely to give us useful
information that we do not already have. For example, if
<code>daily_mean(np.array([[2, 0], [4, 0]])))</code> works, there is
probably not much point testing
<code>daily_mean(np.array([[3, 0], [4, 0]])))</code>, since it is hard
to think of a bug that would show up in one case but not in the
other.</p>
<p>Now, we should try to choose tests that are as different from each
other as possible, so that we force the code we are testing to execute
in all the different ways it can - to ensure our tests have a high
degree of <strong>code coverage</strong>.</p>
<p>A simple way to check the code coverage for a set of tests is to
install an additional package <code>pytest-cov</code> to our virtual
environment, which is used by <code>pytest</code> to tell us how many
statements in our code are being tested.</p>
<div class="codewrapper sourceCode" id="cb4">
<h3 class="code-label">BASH<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="sourceCode bash" tabindex="0"><code class="sourceCode bash"><span id="cb4-1"><a href="#cb4-1" tabindex="-1"></a><span class="ex">$</span> python3 <span class="at">-m</span> pip install pytest-cov</span>
<span id="cb4-2"><a href="#cb4-2" tabindex="-1"></a><span class="ex">$</span> python3 <span class="at">-m</span> pytest <span class="at">--cov</span><span class="op">=</span>inflammation.models tests/test_models.py</span></code></pre>
</div>
<p>So here, we specify the additional named argument <code>--cov</code>
to <code>pytest</code> specifying the code to analyse for test
coverage.</p>
<div class="codewrapper">
<h3 class="code-label">OUTPUT<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="output" tabindex="0"><code>============================= test session starts ==============================
platform darwin -- Python 3.11.4, pytest-7.4.3, pluggy-1.3.0
rootdir: /Users/alex/work/SSI/training/lessons/python-intermediate-inflammation
plugins: cov-4.1.0
collected 9 items

tests/test_models.py .........                                            [100%]

---------- coverage: platform darwin, python 3.11.4-final-0 ----------
Name                     Stmts   Miss  Cover
--------------------------------------------
inflammation/models.py       9      1    89%
--------------------------------------------
TOTAL                        9      1    89%

============================== 9 passed in 0.26s ===============================</code></pre>
</div>
<p>Here we can see that our tests are doing very well - 89% of
statements in <code>inflammation/models.py</code> have been executed.
But which statements are not being tested? The additional argument
<code>--cov-report term-missing</code> can tell us:</p>
<div class="codewrapper sourceCode" id="cb6">
<h3 class="code-label">BASH<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="sourceCode bash" tabindex="0"><code class="sourceCode bash"><span id="cb6-1"><a href="#cb6-1" tabindex="-1"></a><span class="ex">$</span> python3 <span class="at">-m</span> pytest <span class="at">--cov</span><span class="op">=</span>inflammation.models <span class="at">--cov-report</span> term-missing tests/test_models.py</span></code></pre>
</div>
<div class="codewrapper">
<h3 class="code-label">OUTPUT<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="output" tabindex="0"><code>...
Name                     Stmts   Miss  Cover   Missing
------------------------------------------------------
inflammation/models.py       9      1    89%   18
------------------------------------------------------
TOTAL                        9      1    89%
...</code></pre>
</div>
<p>So there is still one statement not being tested at line 18, and it
turns out it is in the function <code>load_csv()</code>. Here we should
consider whether or not to write a test for this function, and, in
general, any other functions that may not be tested. Of course, if there
are hundreds or thousands of lines that are not covered it may not be
feasible to write tests for them all. But we should prioritise the ones
for which we write tests, considering how often they are used, how
complex they are, and importantly, the extent to which they affect our
program’s results.</p>
<p>Again, we should also update our <code>requirements.txt</code> file
with our latest package environment, which now also includes
<code>pytest-cov</code>, and commit it:</p>
<div class="codewrapper sourceCode" id="cb8">
<h3 class="code-label">BASH<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="sourceCode bash" tabindex="0"><code class="sourceCode bash"><span id="cb8-1"><a href="#cb8-1" tabindex="-1"></a><span class="ex">$</span> python3 <span class="at">-m</span> pip freeze <span class="at">--exclude-editable</span> <span class="op">&gt;</span> requirements.txt</span>
<span id="cb8-2"><a href="#cb8-2" tabindex="-1"></a><span class="ex">$</span> cat requirements.txt</span></code></pre>
</div>
<p>You’ll notice <code>pytest-cov</code> and <code>coverage</code> have
been added. Let us commit this file and push our new branch to
GitHub:</p>
<div class="codewrapper sourceCode" id="cb9">
<h3 class="code-label">BASH<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="sourceCode bash" tabindex="0"><code class="sourceCode bash"><span id="cb9-1"><a href="#cb9-1" tabindex="-1"></a><span class="ex">$</span> git add requirements.txt</span>
<span id="cb9-2"><a href="#cb9-2" tabindex="-1"></a><span class="ex">$</span> git commit <span class="at">-m</span> <span class="st">"Add coverage support"</span></span>
<span id="cb9-3"><a href="#cb9-3" tabindex="-1"></a><span class="ex">$</span> git push origin test-suite</span></code></pre>
</div>
<div id="what-about-testing-against-indeterminate-output" class="callout">
<div class="callout-square">
<i class="callout-icon" data-feather="bell"></i>
</div>
<div id="what-about-testing-against-indeterminate-output" class="callout-inner">
<h3 class="callout-title">What about Testing Against Indeterminate Output?</h3>
<div class="callout-content">
<p>What if your implementation depends on a degree of random behaviour?
This can be desired within a number of applications, particularly in
simulations (for example, molecular simulations) or other stochastic
behavioural models of complex systems. So how can you test against such
systems if the outputs are different when given the same inputs?</p>
<p>One way is to <em>remove the randomness</em> during testing. For
those portions of your code that use a language feature or library to
generate a random number, you can instead produce a known sequence of
numbers instead when testing, to make the results deterministic and
hence easier to test against. You could encapsulate this different
behaviour in separate functions, methods, or classes and call the
appropriate one depending on whether you are testing or not. This is
essentially a type of <strong>mocking</strong>, where you are creating a
“mock” version that mimics some behaviour for the purposes of
testing.</p>
<p>Another way is to <em>control the randomness</em> during testing to
provide results that are deterministic - the same each time.
Implementations of randomness in computing languages, including Python,
are actually never truly random - they are
<strong>pseudorandom</strong>: the sequence of ‘random’ numbers are
typically generated using a mathematical algorithm. A
<strong>seed</strong> value is used to initialise an implementation’s
random number generator, and from that point, the sequence of numbers is
actually deterministic. Many implementations just use the system time as
the default seed, but you can set your own. By doing so, the generated
sequence of numbers is the same, e.g. using Python’s <code>random</code>
library to randomly select a sample of ten numbers from a sequence
between 0-99:</p>
<div class="codewrapper sourceCode" id="cb10">
<h3 class="code-label">PYTHON<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="sourceCode python" tabindex="0"><code class="sourceCode python"><span id="cb10-1"><a href="#cb10-1" tabindex="-1"></a><span class="im">import</span> random</span>
<span id="cb10-2"><a href="#cb10-2" tabindex="-1"></a></span>
<span id="cb10-3"><a href="#cb10-3" tabindex="-1"></a>random.seed(<span class="dv">1</span>)</span>
<span id="cb10-4"><a href="#cb10-4" tabindex="-1"></a><span class="bu">print</span>(random.sample(<span class="bu">range</span>(<span class="dv">0</span>, <span class="dv">100</span>), <span class="dv">10</span>))</span>
<span id="cb10-5"><a href="#cb10-5" tabindex="-1"></a>random.seed(<span class="dv">1</span>)</span>
<span id="cb10-6"><a href="#cb10-6" tabindex="-1"></a><span class="bu">print</span>(random.sample(<span class="bu">range</span>(<span class="dv">0</span>, <span class="dv">100</span>), <span class="dv">10</span>))</span></code></pre>
</div>
<p>Will produce:</p>
<div class="codewrapper">
<h3 class="code-label">OUTPUT<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="output" tabindex="0"><code>[17, 72, 97, 8, 32, 15, 63, 57, 60, 83]
[17, 72, 97, 8, 32, 15, 63, 57, 60, 83]</code></pre>
</div>
<p>So since your program’s randomness is essentially eliminated, your
tests can be written to test against the known output. The trick of
course, is to ensure that the output being testing against is
definitively correct!</p>
<p>The other thing you can do while keeping the random behaviour, is to
<em>test the output data against expected constraints</em> of that
output. For example, if you know that all data should be within
particular ranges, or within a particular statistical distribution type
(e.g. normal distribution over time), you can test against that,
conducting multiple test runs that take advantage of the randomness to
fill the known “space” of expected results. Note that this is not as
precise or complete, and bear in mind this could mean you need to run
<em>a lot</em> of tests which may take considerable time.</p>
</div>
</div>
</div>
</section><section><h2 class="section-heading" id="test-driven-development">Test Driven Development<a class="anchor" aria-label="anchor" href="#test-driven-development"></a>
</h2>
<hr class="half-width">
<p>In the <a href="21-automatically-testing-software.html">previous
episode</a> we learnt how to create <em>unit tests</em> to make sure our
code is behaving as we intended. <strong>Test Driven
Development</strong> (TDD) is an extension of this. If we can define a
set of tests for everything our code needs to do, then why not treat
those tests as the specification.</p>
<p>When doing Test Driven Development, we write our tests first and only
write enough code to make the tests pass. We tend to do this at the
level of individual features - define the feature, write the tests,
write the code. The main advantages are:</p>
<ul>
<li>It forces us to think about how our code will be used before we
write it</li>
<li>It prevents us from doing work that we do not need to do, e.g. “I
might need this later…”</li>
<li>It forces us to test that the tests <em>fail</em> before we have
implemented the code, meaning we do not inadvertently forget to add the
correct asserts.</li>
</ul>
<p>You may also see this process called <strong>Red, Green,
Refactor</strong>: ‘Red’ for the failing tests, ‘Green’ for the code
that makes them pass, then ‘Refactor’ (tidy up) the result.</p>
<p>For the challenges from here on, try to first convert the
specification into a unit test, then try writing the code to pass the
test.</p>
</section><section><h2 class="section-heading" id="limits-to-testing">Limits to Testing<a class="anchor" aria-label="anchor" href="#limits-to-testing"></a>
</h2>
<hr class="half-width">
<p>Like any other piece of experimental apparatus, a complex program
requires a much higher investment in testing than a simple one. Putting
it another way, a small script that is only going to be used once, to
produce one figure, probably does not need separate testing: its output
is either correct or not. A linear algebra library that will be used by
thousands of people in twice that number of applications over the course
of a decade, on the other hand, definitely does. The key is identify and
prioritise against what will most affect the code’s ability to generate
accurate results.</p>
<p>it is also important to remember that unit testing cannot catch every
bug in an application, no matter how many tests you write. To mitigate
this manual testing is also important. Also remember to test using as
much input data as you can, since very often code is developed and
tested against the same small sets of data. Increasing the amount of
data you test against - from numerous sources - gives you greater
confidence that the results are correct.</p>
<p>Our software will inevitably increase in complexity as it develops.
Using automated testing where appropriate can save us considerable time,
especially in the long term, and allows others to verify against correct
behaviour.</p>
</section><section><h2 class="section-heading" id="optional-exercises">Optional exercises<a class="anchor" aria-label="anchor" href="#optional-exercises"></a>
</h2>
<hr class="half-width">
<p>Checkout <a href="25-section2-optional-exercises.html">these optional
exercises</a> to learn more about code coverage.</p>
<div id="keypoints1" class="callout keypoints">
<div class="callout-square">
<i class="callout-icon" data-feather="key"></i>
</div>
<div class="callout-inner">
<h3 class="callout-title">Key Points</h3>
<div class="callout-content">
<ul>
<li>We can assign multiple inputs to tests using parametrisation.</li>
<li>it is important to understand the <strong>coverage</strong> of our
tests across our code.</li>
<li>Writing unit tests takes time, so apply them where it makes the most
sense.</li>
</ul>
</div>
</div>
</div>
</section></section><section id="aio-23-continuous-integration-automated-testing"><p>Content from <a href="23-continuous-integration-automated-testing.html">2.3 Continuous Integration for Automated Testing</a></p>
<hr>
<p>Last updated on 2025-05-30 |

        <a href="https://github.com/carpentries-incubator/python-intermediate-development/edit/main/episodes/23-continuous-integration-automated-testing.md" class="external-link">Edit this page <i aria-hidden="true" data-feather="edit"></i></a></p>
<p>Estimated time: <i aria-hidden="true" data-feather="clock"></i> 45 minutes</p>
<div class="text-end">
          <button role="button" aria-pressed="false" tabindex="0" id="expand-code" class="pull-right" data-expand="Expand All Solutions " data-collapse="Collapse All Solutions "> Expand All Solutions <i aria-hidden="true" data-feather="plus"></i></button>
        </div>
<div class="overview card">
<h2 class="card-header">Overview</h2>
<div class="row g-0">
<div class="col-md-4">
<div class="card-body">
<div class="inner">
<h3 class="card-title">Questions</h3>
<ul>
<li>How can I automate the testing of my repository’s code in a way that
scales well?</li>
<li>What can I do to make testing across multiple platforms easier?</li>
</ul>
</div>
</div>
</div>
<div class="col-md-8">
<div class="card-body">
<div class="inner bordered">
<h3 class="card-title">Objectives</h3>
<ul>
<li>Describe the benefits of using Continuous Integration for further
automation of testing</li>
<li>Enable GitHub Actions Continuous Integration for public open source
repositories</li>
<li>Use continuous integration to automatically run unit tests and code
coverage when changes are committed to a version control repository</li>
<li>Use a build matrix to specify combinations of operating systems and
Python versions to run tests over</li>
</ul>
</div>
</div>
</div>
</div>
</div>
<section><h2 class="section-heading" id="introduction">Introduction<a class="anchor" aria-label="anchor" href="#introduction"></a>
</h2>
<hr class="half-width">
<p>So far we have been manually running our tests as we require. Once we
have made a change, or added a new feature with accompanying tests, we
can re-run our tests, giving ourselves (and others who wish to run them)
increased confidence that everything is working as expected. Now we are
going to take further advantage of automation in a way that helps
testing scale across a development team with very little overhead, using
<strong>Continuous Integration</strong>.</p>
</section><section><h2 class="section-heading" id="what-is-continuous-integration">What is Continuous Integration?<a class="anchor" aria-label="anchor" href="#what-is-continuous-integration"></a>
</h2>
<hr class="half-width">
<p>The automated testing we have done so far only takes into account the
state of the repository we have on our own machines. In a software
project involving multiple developers working and pushing changes on a
repository, it would be great to know holistically how all these changes
are affecting our codebase without everyone having to pull down all the
changes and test them. If we also take into account the testing required
on different target user platforms for our software and the changes
being made to many repository branches, the effort required to conduct
testing at this scale can quickly become intractable for a research
project to sustain.</p>
<p>Continuous Integration (CI) aims to reduce this burden by further
automation, and automation - wherever possible - helps us to reduce
errors and makes predictable processes more efficient. The idea is that
when a new change is committed to a repository, CI clones the
repository, builds it if necessary, and runs any tests. Once complete,
it presents a report to let you see what happened.</p>
<p>There are many CI infrastructures and services, free and paid for,
and subject to change as they evolve their features. We will be looking
at <a href="https://github.com/features/actions" class="external-link">GitHub Actions</a> -
which unsurprisingly is available as part of GitHub.</p>
</section><section><h2 class="section-heading" id="continuous-integration-with-github-actions">Continuous Integration with GitHub Actions<a class="anchor" aria-label="anchor" href="#continuous-integration-with-github-actions"></a>
</h2>
<hr class="half-width">
<div class="section level3">
<h3 id="a-quick-look-at-yaml">A Quick Look at YAML<a class="anchor" aria-label="anchor" href="#a-quick-look-at-yaml"></a>
</h3>
<p>YAML is a text format used by GitHub Action workflow files. It is
also increasingly used for configuration files and storing other types
of data, so it is worth taking a bit of time looking into this file
format.</p>
<p><a href="https://www.commonwl.org/user_guide/yaml/" class="external-link">YAML</a> (a
recursive acronym which stands for “YAML Ain’t Markup Language”) is a
language designed to be human readable. A few basic things you need to
know about YAML to get started with GitHub Actions are key-value pairs,
arrays, maps and multi-line strings.</p>
<p>So firstly, YAML files are essentially made up of
<strong>key-value</strong> pairs, in the form <code>key: value</code>,
for example:</p>
<div class="codewrapper sourceCode" id="cb1">
<h3 class="code-label">YAML<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="sourceCode yaml" tabindex="0"><code class="sourceCode yaml"><span id="cb1-1"><a href="#cb1-1" tabindex="-1"></a><span class="fu">name</span><span class="kw">:</span><span class="at"> Kilimanjaro</span></span>
<span id="cb1-2"><a href="#cb1-2" tabindex="-1"></a><span class="fu">height_metres</span><span class="kw">:</span><span class="at"> </span><span class="dv">5892</span></span>
<span id="cb1-3"><a href="#cb1-3" tabindex="-1"></a><span class="fu">first_scaled_by</span><span class="kw">:</span><span class="at"> Hans Meyer</span></span></code></pre>
</div>
<p>In general, you do not need quotes for strings, but you can use them
when you want to explicitly distinguish between numbers and strings,
e.g. <code>height_metres: "5892"</code> would be a string, but in the
above example it is an integer. It turns out Hans Meyer is not the only
first ascender of Kilimanjaro, so one way to add this person as another
value to this key is by using YAML <strong>arrays</strong>, like
this:</p>
<div class="codewrapper sourceCode" id="cb2">
<h3 class="code-label">YAML<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="sourceCode yaml" tabindex="0"><code class="sourceCode yaml"><span id="cb2-1"><a href="#cb2-1" tabindex="-1"></a><span class="fu">first_scaled_by</span><span class="kw">:</span></span>
<span id="cb2-2"><a href="#cb2-2" tabindex="-1"></a><span class="kw">-</span><span class="at"> Hans Meyer</span></span>
<span id="cb2-3"><a href="#cb2-3" tabindex="-1"></a><span class="kw">-</span><span class="at"> Ludwig Purtscheller</span></span></code></pre>
</div>
<p>An alternative to this format for arrays is the following, which
would have the same meaning:</p>
<div class="codewrapper sourceCode" id="cb3">
<h3 class="code-label">YAML<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="sourceCode yaml" tabindex="0"><code class="sourceCode yaml"><span id="cb3-1"><a href="#cb3-1" tabindex="-1"></a><span class="fu">first_scaled_by</span><span class="kw">:</span><span class="at"> </span><span class="kw">[</span><span class="at">Hans Meyer</span><span class="kw">,</span><span class="at"> Ludwig Purtscheller</span><span class="kw">]</span></span></code></pre>
</div>
<p>If we wanted to express more information for one of these values we
could use a feature known as <strong>maps</strong>
(dictionaries/hashes), which allow us to define nested, hierarchical
data structures, e.g.</p>
<div class="codewrapper sourceCode" id="cb4">
<h3 class="code-label">YAML<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="sourceCode yaml" tabindex="0"><code class="sourceCode yaml"><span id="cb4-1"><a href="#cb4-1" tabindex="-1"></a><span class="co">...</span></span>
<span id="cb4-2"><a href="#cb4-2" tabindex="-1"></a><span class="co">height:</span></span>
<span id="cb4-3"><a href="#cb4-3" tabindex="-1"></a><span class="co">  value: 5892</span></span>
<span id="cb4-4"><a href="#cb4-4" tabindex="-1"></a><span class="co">  unit: metres</span></span>
<span id="cb4-5"><a href="#cb4-5" tabindex="-1"></a><span class="co">  measured:</span></span>
<span id="cb4-6"><a href="#cb4-6" tabindex="-1"></a><span class="co">    year: 2008</span></span>
<span id="cb4-7"><a href="#cb4-7" tabindex="-1"></a><span class="co">    by: Kilimanjaro 2008 Precise Height Measurement Expedition</span></span>
<span id="cb4-8"><a href="#cb4-8" tabindex="-1"></a><span class="co">...</span></span></code></pre>
</div>
<p>So here, <code>height</code> itself is made up of three keys
<code>value</code>, <code>unit</code>, and <code>measured</code>, with
the last of these being another nested key with the keys
<code>year</code> and <code>by</code>. Note the convention of using two
spaces for tabs, instead of Python’s four.</p>
<p>We can also combine maps and arrays to describe more complex data.
Let us say we want to add more detail to our list of initial
ascenders:</p>
<div class="codewrapper sourceCode" id="cb5">
<h3 class="code-label">YAML<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="sourceCode yaml" tabindex="0"><code class="sourceCode yaml"><span id="cb5-1"><a href="#cb5-1" tabindex="-1"></a><span class="co">...</span></span>
<span id="cb5-2"><a href="#cb5-2" tabindex="-1"></a><span class="co">first_scaled_by:</span></span>
<span id="cb5-3"><a href="#cb5-3" tabindex="-1"></a><span class="co">- name: Hans Meyer</span></span>
<span id="cb5-4"><a href="#cb5-4" tabindex="-1"></a><span class="co">  date_of_birth: 1858-03-22</span></span>
<span id="cb5-5"><a href="#cb5-5" tabindex="-1"></a><span class="co">  nationality: German</span></span>
<span id="cb5-6"><a href="#cb5-6" tabindex="-1"></a><span class="co">- name: Ludwig Purtscheller</span></span>
<span id="cb5-7"><a href="#cb5-7" tabindex="-1"></a><span class="co">  date_of_birth: 1849-10-06</span></span>
<span id="cb5-8"><a href="#cb5-8" tabindex="-1"></a><span class="co">  nationality: Austrian</span></span></code></pre>
</div>
<p>So here we have a YAML array of our two mountaineers, each with
additional keys offering more information.</p>
<p>GitHub Actions also makes use of <code>|</code> symbol to indicate a
multi-line string that preserves new lines. For example:</p>
<div class="codewrapper sourceCode" id="cb6">
<h3 class="code-label">YAML<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="sourceCode yaml" tabindex="0"><code class="sourceCode yaml"><span id="cb6-1"><a href="#cb6-1" tabindex="-1"></a><span class="fu">shakespeare_couplet</span><span class="kw">: </span><span class="ch">|</span></span>
<span id="cb6-2"><a href="#cb6-2" tabindex="-1"></a>  Good night, good night. Parting is such sweet sorrow</span>
<span id="cb6-3"><a href="#cb6-3" tabindex="-1"></a>  That I shall say good night till it be morrow.</span></code></pre>
</div>
<p>They key <code>shakespeare_couplet</code> would hold the full two
line string, preserving the new line after sorrow.</p>
<p>As we will see shortly, GitHub Actions workflows will use all of
these.</p>
</div>
<div class="section level3">
<h3 id="defining-our-workflow">Defining Our Workflow<a class="anchor" aria-label="anchor" href="#defining-our-workflow"></a>
</h3>
<p>With a GitHub repository there is a way we can set up CI to run our
tests automatically when we commit changes. Let us do this now by adding
a new file to our repository whilst on the <code>test-suite</code>
branch. First, create the new directories
<code>.github/workflows</code>:</p>
<div class="codewrapper sourceCode" id="cb7">
<h3 class="code-label">BASH<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="sourceCode bash" tabindex="0"><code class="sourceCode bash"><span id="cb7-1"><a href="#cb7-1" tabindex="-1"></a><span class="ex">$</span> mkdir <span class="at">-p</span> .github/workflows</span></code></pre>
</div>
<p>This directory is used specifically for GitHub Actions, allowing us
to specify any number of workflows that can be run under a variety of
conditions, which is also written using YAML. So let us add a new YAML
file called <code>main.yml</code> (note its extension is
<code>.yml</code> without the <code>a</code>) within the new
<code>.github/workflows</code> directory:</p>
<div class="codewrapper sourceCode" id="cb8">
<h3 class="code-label">YAML<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="sourceCode yaml" tabindex="0"><code class="sourceCode yaml"><span id="cb8-1"><a href="#cb8-1" tabindex="-1"></a><span class="fu">name</span><span class="kw">:</span><span class="at"> CI</span></span>
<span id="cb8-2"><a href="#cb8-2" tabindex="-1"></a></span>
<span id="cb8-3"><a href="#cb8-3" tabindex="-1"></a><span class="co"># We can specify which Github events will trigger a CI build</span></span>
<span id="cb8-4"><a href="#cb8-4" tabindex="-1"></a><span class="fu">on</span><span class="kw">:</span><span class="at"> push</span></span>
<span id="cb8-5"><a href="#cb8-5" tabindex="-1"></a></span>
<span id="cb8-6"><a href="#cb8-6" tabindex="-1"></a><span class="co"># now define a single job 'build' (but could define more)</span></span>
<span id="cb8-7"><a href="#cb8-7" tabindex="-1"></a><span class="fu">jobs</span><span class="kw">:</span></span>
<span id="cb8-8"><a href="#cb8-8" tabindex="-1"></a></span>
<span id="cb8-9"><a href="#cb8-9" tabindex="-1"></a><span class="at">  </span><span class="fu">build</span><span class="kw">:</span></span>
<span id="cb8-10"><a href="#cb8-10" tabindex="-1"></a></span>
<span id="cb8-11"><a href="#cb8-11" tabindex="-1"></a><span class="co">    # we can also specify the OS to run tests on</span></span>
<span id="cb8-12"><a href="#cb8-12" tabindex="-1"></a><span class="at">    </span><span class="fu">runs-on</span><span class="kw">:</span><span class="at"> ubuntu-latest</span></span>
<span id="cb8-13"><a href="#cb8-13" tabindex="-1"></a></span>
<span id="cb8-14"><a href="#cb8-14" tabindex="-1"></a><span class="co">    # a job is a seq of steps</span></span>
<span id="cb8-15"><a href="#cb8-15" tabindex="-1"></a><span class="at">    </span><span class="fu">steps</span><span class="kw">:</span></span>
<span id="cb8-16"><a href="#cb8-16" tabindex="-1"></a></span>
<span id="cb8-17"><a href="#cb8-17" tabindex="-1"></a><span class="co">    # Next we need to checkout out repository, and set up Python</span></span>
<span id="cb8-18"><a href="#cb8-18" tabindex="-1"></a><span class="co">    # A 'name' is just an optional label shown in the log - helpful to clarify progress - and can be anything</span></span>
<span id="cb8-19"><a href="#cb8-19" tabindex="-1"></a><span class="at">    </span><span class="kw">-</span><span class="at"> </span><span class="fu">name</span><span class="kw">:</span><span class="at"> Checkout repository</span></span>
<span id="cb8-20"><a href="#cb8-20" tabindex="-1"></a><span class="at">      </span><span class="fu">uses</span><span class="kw">:</span><span class="at"> actions/checkout@v4</span></span>
<span id="cb8-21"><a href="#cb8-21" tabindex="-1"></a></span>
<span id="cb8-22"><a href="#cb8-22" tabindex="-1"></a><span class="at">    </span><span class="kw">-</span><span class="at"> </span><span class="fu">name</span><span class="kw">:</span><span class="at"> Set up Python 3.11</span></span>
<span id="cb8-23"><a href="#cb8-23" tabindex="-1"></a><span class="at">      </span><span class="fu">uses</span><span class="kw">:</span><span class="at"> actions/setup-python@v5</span></span>
<span id="cb8-24"><a href="#cb8-24" tabindex="-1"></a><span class="at">      </span><span class="fu">with</span><span class="kw">:</span></span>
<span id="cb8-25"><a href="#cb8-25" tabindex="-1"></a><span class="at">        </span><span class="fu">python-version</span><span class="kw">:</span><span class="at"> </span><span class="st">"3.11"</span></span>
<span id="cb8-26"><a href="#cb8-26" tabindex="-1"></a></span>
<span id="cb8-27"><a href="#cb8-27" tabindex="-1"></a><span class="at">    </span><span class="kw">-</span><span class="at"> </span><span class="fu">name</span><span class="kw">:</span><span class="at"> Install Python dependencies</span></span>
<span id="cb8-28"><a href="#cb8-28" tabindex="-1"></a><span class="fu">      run</span><span class="kw">: </span><span class="ch">|</span></span>
<span id="cb8-29"><a href="#cb8-29" tabindex="-1"></a>        python3 -m pip install --upgrade pip</span>
<span id="cb8-30"><a href="#cb8-30" tabindex="-1"></a>        python3 -m pip install -r requirements.txt .</span>
<span id="cb8-31"><a href="#cb8-31" tabindex="-1"></a></span>
<span id="cb8-32"><a href="#cb8-32" tabindex="-1"></a><span class="at">    </span><span class="kw">-</span><span class="at"> </span><span class="fu">name</span><span class="kw">:</span><span class="at"> Test with PyTest</span></span>
<span id="cb8-33"><a href="#cb8-33" tabindex="-1"></a><span class="fu">      run</span><span class="kw">: </span><span class="ch">|</span></span>
<span id="cb8-34"><a href="#cb8-34" tabindex="-1"></a>        python3 -m pytest --cov=inflammation.models tests/test_models.py</span></code></pre>
</div>
<p><em><strong>Note</strong>: be sure to create this file as
<code>main.yml</code> within the newly created
<code>.github/workflows</code> directory, or it will not work!</em></p>
<p>So as well as giving our workflow a name - CI - we indicate with
<code>on</code> that we want this workflow to run when we
<code>push</code> commits to our repository. The workflow itself is made
of a single <code>job</code> named <code>build</code>, and we could
define any number of jobs after this one if we wanted, and each one
would run in parallel.</p>
<p>Next, we define what our build job will do. With <code>runs-on</code>
we first state which operating systems we want to use, in this case just
Ubuntu for now. We will be looking at ways we can scale this up to
testing on more systems later.</p>
<p>Lastly, we define the <code>step</code>s that our job will undertake
in turn, to set up the job’s environment and run our tests. You can
think of the job’s environment initially as a blank slate: much like a
freshly installed machine (albeit virtual) with very little installed on
it, we need to prepare it with what it needs to be able to run our
tests. Each of these steps are:</p>
<ul>
<li>
<strong>Checkout repository for the job:</strong> <code>uses</code>
indicates that want to use a GitHub Action called <code>checkout</code>
that does this</li>
<li>
<strong>Set up Python version:</strong> here we use the
<code>setup-python</code> Action, indicating that we want Python version
3.11. Note we specify the version within quotes, to ensure that this is
interpreted as a complete string. Otherwise, if we wanted to test
against for example Python 3.10, by specifying <code>3.10</code> without
the quotes, it would be interpreted as the number <code>3.1</code> which
- although it is the same number as <code>3.10</code> - would be
interpreted as the wrong version!</li>
<li>
<strong>Install latest version of pip, dependencies, and our
inflammation package:</strong> In order to locally install our
<code>inflammation</code> package it is good practice to upgrade the
version of pip that is present first, then we use pip to install our
package dependencies. Notice that it is fine to omit the
<code>--editable</code> flag in this case because the source code will
be static and therefore we don’t need this to be an “editable” install
like when we are developing locally. We use <code>run</code> here to run
theses commands in the CI shell environment</li>
<li>
<strong>Test with PyTest:</strong> lastly, we run
<code>python3 -m pytest</code>, with the same arguments we used manually
before</li>
</ul>
<div id="what-about-other-actions" class="callout">
<div class="callout-square">
<i class="callout-icon" data-feather="bell"></i>
</div>
<div id="what-about-other-actions" class="callout-inner">
<h3 class="callout-title">What about other Actions?</h3>
<div class="callout-content">
<p>Our workflow here uses standard GitHub Actions (indicated by
<code>actions/*</code>). Beyond the standard set of actions, others are
available via the <a href="https://docs.github.com/en/developers/github-marketplace/github-marketplace-overview" class="external-link">GitHub
Marketplace</a>. It contains many third-party actions (as well as apps)
that you can use with GitHub for many tasks across many programming
languages, particularly for setting up environments for running tests,
code analysis and other tools, setting up and using infrastructure (for
things like Docker or Amazon’s AWS cloud), or even managing repository
issues. You can even contribute your own.</p>
</div>
</div>
</div>
</div>
<div class="section level3">
<h3 id="triggering-a-build-on-github-actions">Triggering a Build on GitHub Actions<a class="anchor" aria-label="anchor" href="#triggering-a-build-on-github-actions"></a>
</h3>
<p>Now if we commit and push this change a CI run will be triggered:</p>
<div class="codewrapper sourceCode" id="cb9">
<h3 class="code-label">BASH<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="sourceCode bash" tabindex="0"><code class="sourceCode bash"><span id="cb9-1"><a href="#cb9-1" tabindex="-1"></a><span class="ex">$</span> git add .github</span>
<span id="cb9-2"><a href="#cb9-2" tabindex="-1"></a><span class="ex">$</span> git commit <span class="at">-m</span> <span class="st">"Add GitHub Actions configuration"</span></span>
<span id="cb9-3"><a href="#cb9-3" tabindex="-1"></a><span class="ex">$</span> git push origin test-suite</span></code></pre>
</div>
<p>Since we are only committing the GitHub Actions configuration file to
the <code>test-suite</code> branch for the moment, only the contents of
this branch will be used for CI. We can pass this file upstream into
other branches (i.e. via merges) when we are happy it works, which will
then allow the process to run automatically on these other branches.
This again highlights the usefulness of the feature-branch model - we
can work in isolation on a feature until it is ready to be passed
upstream without disrupting development on other branches, and in the
case of CI, we are starting to see its scaling benefits across a larger
scale development team working across potentially many branches.</p>
</div>
<div class="section level3">
<h3 id="checking-build-progress-and-reports">Checking Build Progress and Reports<a class="anchor" aria-label="anchor" href="#checking-build-progress-and-reports"></a>
</h3>
<p>Handily, we can see the progress of the build from our repository on
GitHub by selecting the <code>test-suite</code> branch from the dropdown
menu (which currently says <code>main</code>), and then selecting
<code>commits</code> (located just above the code directory listing on
the right, alongside the last commit message and a small image of a
timer).</p>
<figure><img src="../fig/ci-initial-ga-build.png" class="image-with-shadow figure mx-auto d-block" alt="Continuous Integration with GitHub Actions - Initial Build" width="1000"></figure><p>You’ll see a list of commits for this branch, and likely see an
orange marker next to the latest commit (clicking on it yields
<code>Some checks haven't completed yet</code>) meaning the build is
still in progress. This is a useful view, as over time, it will give you
a history of commits, who did them, and whether the commit resulted in a
successful build or not.</p>
<p>Hopefully after a while, the marker will turn into a green tick
indicating a successful build. Clicking it gives you even more
information about the build, and selecting <code>Details</code> link
takes you to a complete log of the build and its output.</p>
<figure><img src="../fig/ci-initial-ga-build-log.png" class="image-with-shadow figure mx-auto d-block" alt="Continuous Integration with GitHub Actions - Build Log" width="1000"></figure><p>The logs are actually truncated; selecting the arrows next to the
entries - which are the <code>name</code> labels we specified in the
<code>main.yml</code> file - will expand them with more detail,
including the output from the actions performed.</p>
<figure><img src="../fig/ci-initial-ga-build-details.png" class="image-with-shadow figure mx-auto d-block" alt="Continuous Integration with GitHub Actions - Build Details" width="1000"></figure><p>GitHub Actions offers these continuous integration features as a
completely free service for public repositories, and supplies 2000 build
minutes a month on as many private repositories that you like. Paid
levels are available too.</p>
</div>
</section><section><h2 class="section-heading" id="scaling-up-testing-using-build-matrices">Scaling Up Testing Using Build Matrices<a class="anchor" aria-label="anchor" href="#scaling-up-testing-using-build-matrices"></a>
</h2>
<hr class="half-width">
<p>Now we have our CI configured and building, we can use a feature
called <strong>build matrices</strong> which really shows the value of
using CI to test at scale.</p>
<p>Suppose the intended users of our software use either Ubuntu, Mac OS,
or Windows, and have Python versions 3.10 through 3.12 installed, and we
want to support all of these. Assuming we have a suitable test suite, it
would take a considerable amount of time to set up testing platforms to
run our tests across all these platform combinations. Fortunately, CI
can do the hard work for us very easily.</p>
<p>Using a build matrix we can specify testing environments and
parameters (such as operating system, Python version, etc.) and new jobs
will be created that run our tests for each permutation of these.</p>
<p>Let us see how this is done using GitHub Actions. To support this, we
define a <code>strategy</code> as a <code>matrix</code> of operating
systems and Python versions within <code>build</code>. We then use
<code>matrix.os</code> and <code>matrix.python-version</code> to
reference these configuration possibilities instead of using hardcoded
values - replacing the <code>runs-on</code> and
<code>python-version</code> parameters to refer to the values from the
matrix. So, our <code>.github/workflows/main.yml</code> should look like
the following:</p>
<div class="codewrapper sourceCode" id="cb10">
<h3 class="code-label">YAML<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="sourceCode yaml" tabindex="0"><code class="sourceCode yaml"><span id="cb10-1"><a href="#cb10-1" tabindex="-1"></a><span class="co"># Same key-value pairs as in "Defining Our Workflow" section</span></span>
<span id="cb10-2"><a href="#cb10-2" tabindex="-1"></a><span class="fu">name</span><span class="kw">:</span><span class="at"> CI</span></span>
<span id="cb10-3"><a href="#cb10-3" tabindex="-1"></a><span class="fu">on</span><span class="kw">:</span><span class="at"> push</span></span>
<span id="cb10-4"><a href="#cb10-4" tabindex="-1"></a><span class="fu">jobs</span><span class="kw">:</span></span>
<span id="cb10-5"><a href="#cb10-5" tabindex="-1"></a><span class="at">  </span><span class="fu">build</span><span class="kw">:</span></span>
<span id="cb10-6"><a href="#cb10-6" tabindex="-1"></a></span>
<span id="cb10-7"><a href="#cb10-7" tabindex="-1"></a><span class="co">    # Here we add the matrices definition:</span></span>
<span id="cb10-8"><a href="#cb10-8" tabindex="-1"></a><span class="at">    </span><span class="fu">strategy</span><span class="kw">:</span></span>
<span id="cb10-9"><a href="#cb10-9" tabindex="-1"></a><span class="at">      </span><span class="fu">matrix</span><span class="kw">:</span></span>
<span id="cb10-10"><a href="#cb10-10" tabindex="-1"></a><span class="at">        </span><span class="fu">os</span><span class="kw">:</span><span class="at"> </span><span class="kw">[</span><span class="st">"ubuntu-latest"</span><span class="kw">,</span><span class="at"> </span><span class="st">"macos-latest"</span><span class="kw">,</span><span class="at"> </span><span class="st">"windows-latest"</span><span class="kw">]</span></span>
<span id="cb10-11"><a href="#cb10-11" tabindex="-1"></a><span class="at">        </span><span class="fu">python-version</span><span class="kw">:</span><span class="at"> </span><span class="kw">[</span><span class="st">"3.10"</span><span class="kw">,</span><span class="at"> </span><span class="st">"3.11"</span><span class="kw">,</span><span class="at"> </span><span class="st">"3.12"</span><span class="kw">]</span></span>
<span id="cb10-12"><a href="#cb10-12" tabindex="-1"></a></span>
<span id="cb10-13"><a href="#cb10-13" tabindex="-1"></a><span class="co">    # Here we add the reference to the os matrix values</span></span>
<span id="cb10-14"><a href="#cb10-14" tabindex="-1"></a><span class="at">    </span><span class="fu">runs-on</span><span class="kw">:</span><span class="at"> ${{ matrix.os }}</span></span>
<span id="cb10-15"><a href="#cb10-15" tabindex="-1"></a></span>
<span id="cb10-16"><a href="#cb10-16" tabindex="-1"></a><span class="co">    # Same key-value pairs as in "Defining Our Workflow" section</span></span>
<span id="cb10-17"><a href="#cb10-17" tabindex="-1"></a><span class="at">    </span><span class="fu">steps</span><span class="kw">:</span></span>
<span id="cb10-18"><a href="#cb10-18" tabindex="-1"></a></span>
<span id="cb10-19"><a href="#cb10-19" tabindex="-1"></a><span class="at">    </span><span class="kw">-</span><span class="at"> </span><span class="fu">name</span><span class="kw">:</span><span class="at"> Checkout repository</span></span>
<span id="cb10-20"><a href="#cb10-20" tabindex="-1"></a><span class="at">      </span><span class="fu">uses</span><span class="kw">:</span><span class="at"> actions/checkout@v4</span></span>
<span id="cb10-21"><a href="#cb10-21" tabindex="-1"></a></span>
<span id="cb10-22"><a href="#cb10-22" tabindex="-1"></a><span class="at">    </span><span class="kw">-</span><span class="at"> </span><span class="fu">name</span><span class="kw">:</span><span class="at"> Set up Python ${{ matrix.python-version }}</span></span>
<span id="cb10-23"><a href="#cb10-23" tabindex="-1"></a><span class="at">      </span><span class="fu">uses</span><span class="kw">:</span><span class="at"> actions/setup-python@v5</span></span>
<span id="cb10-24"><a href="#cb10-24" tabindex="-1"></a><span class="at">      </span><span class="fu">with</span><span class="kw">:</span></span>
<span id="cb10-25"><a href="#cb10-25" tabindex="-1"></a><span class="co">        # Here we add the reference to the python-version matrix values</span></span>
<span id="cb10-26"><a href="#cb10-26" tabindex="-1"></a><span class="at">        </span><span class="fu">python-version</span><span class="kw">:</span><span class="at"> ${{ matrix.python-version }}</span></span>
<span id="cb10-27"><a href="#cb10-27" tabindex="-1"></a><span class="co">    # Same steps as in "Defining Our Workflow" section</span></span>
<span id="cb10-28"><a href="#cb10-28" tabindex="-1"></a><span class="at">    </span><span class="kw">-</span><span class="at"> </span><span class="fu">name</span><span class="kw">:</span><span class="at"> Install Python dependencies</span></span>
<span id="cb10-29"><a href="#cb10-29" tabindex="-1"></a><span class="fu">      run</span><span class="kw">: </span><span class="ch">|</span></span>
<span id="cb10-30"><a href="#cb10-30" tabindex="-1"></a>        python3 -m pip install --upgrade pip</span>
<span id="cb10-31"><a href="#cb10-31" tabindex="-1"></a>        python3 -m pip install -r requirements.txt .</span>
<span id="cb10-32"><a href="#cb10-32" tabindex="-1"></a><span class="at">    </span><span class="kw">-</span><span class="at"> </span><span class="fu">name</span><span class="kw">:</span><span class="at"> Test with PyTest</span></span>
<span id="cb10-33"><a href="#cb10-33" tabindex="-1"></a><span class="fu">      run</span><span class="kw">: </span><span class="ch">|</span></span>
<span id="cb10-34"><a href="#cb10-34" tabindex="-1"></a>        python3 -m pytest --cov=inflammation.models tests/test_models.py</span></code></pre>
</div>
<p>The <code>{{ }}</code> are used as a means to reference configuration
values from the matrix. This way, every possible permutation of Python
versions 3.10 through 3.12 with the latest versions of Ubuntu, Mac OS
and Windows operating systems will be tested, and we can expect 9 build
jobs in total. We can also use this in the <code>name</code> key of the
step to accurately reflect what it is doing (e.g. which Python version
is being setup). This will be reflected in the GitHub Action output,
making parsing those logs easier.</p>
<p>Let us commit and push this change and see what happens:</p>
<div class="codewrapper sourceCode" id="cb11">
<h3 class="code-label">BASH<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="sourceCode bash" tabindex="0"><code class="sourceCode bash"><span id="cb11-1"><a href="#cb11-1" tabindex="-1"></a><span class="ex">$</span> git add .github/workflows/main.yml</span>
<span id="cb11-2"><a href="#cb11-2" tabindex="-1"></a><span class="ex">$</span> git commit <span class="at">-m</span> <span class="st">"Add GA build matrix for os and Python version"</span></span>
<span id="cb11-3"><a href="#cb11-3" tabindex="-1"></a><span class="ex">$</span> git push origin test-suite</span></code></pre>
</div>
<p>If we go to our GitHub build now, we can see that a new job has been
created for each permutation.</p>
<figure><img src="../fig/ci-ga-build-matrix.png" class="image-with-shadow figure mx-auto d-block" alt="Continuous Integration with GitHub Actions - Build Matrix" width="1000"></figure><p>Note all jobs running in parallel (up to the limit allowed by our
account) which potentially saves us a lot of time waiting for testing
results. Overall, this approach allows us to massively scale our
automated testing across platforms we wish to test.</p>
<div id="failed-ci-builds" class="callout">
<div class="callout-square">
<i class="callout-icon" data-feather="bell"></i>
</div>
<div id="failed-ci-builds" class="callout-inner">
<h3 class="callout-title">Failed CI Builds</h3>
<div class="callout-content">
<p>A CI build can fail when, e.g. a used Python package no longer
supports a particular version of Python indicated in a GitHub Actions CI
build matrix. In this case, the solution is either to upgrade the Python
version in the build matrix (when possible) or downgrade the package
version (and not use the latest one like we have been doing in this
course).</p>
<p>Also note that, if one job fails in the build for any reason - all
subsequent jobs will get cancelled because of the default behavior of
GitHub Actions. From <a href="https://docs.github.com/en/actions/using-jobs/using-a-matrix-for-your-jobs#handling-failures" class="external-link">GitHub’s
documentation</a>:</p>
<p><em>GitHub will cancel all in-progress and queued jobs in the matrix
if any job in the matrix fails.</em> This behaviour can be controlled by
changing the value of the <code>fail-fast</code> property:</p>
<div class="codewrapper sourceCode" id="cb12">
<h3 class="code-label">YAML<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="sourceCode yaml" tabindex="0"><code class="sourceCode yaml"><span id="cb12-1"><a href="#cb12-1" tabindex="-1"></a><span class="co">...</span></span>
<span id="cb12-2"><a href="#cb12-2" tabindex="-1"></a><span class="co">   strategy:</span></span>
<span id="cb12-3"><a href="#cb12-3" tabindex="-1"></a><span class="co">     fail-fast: false</span></span>
<span id="cb12-4"><a href="#cb12-4" tabindex="-1"></a><span class="co">     matrix:</span></span>
<span id="cb12-5"><a href="#cb12-5" tabindex="-1"></a><span class="co">...</span></span></code></pre>
</div>
</div>
</div>
</div>
<div id="keypoints1" class="callout keypoints">
<div class="callout-square">
<i class="callout-icon" data-feather="key"></i>
</div>
<div class="callout-inner">
<h3 class="callout-title">Key Points</h3>
<div class="callout-content">
<ul>
<li>Continuous Integration can run tests automatically to verify changes
as code develops in our repository.</li>
<li>CI builds are typically triggered by commits pushed to a
repository.</li>
<li>We need to write a configuration file to inform a CI service what to
do for a build.</li>
<li>We can specify a build matrix to specify multiple platforms and
programming language versions to test against</li>
<li>Builds can be enabled and configured separately for each
branch.</li>
<li>We can run - and get reports from - different CI infrastructure
builds simultaneously.</li>
</ul>
</div>
</div>
</div>
</section></section><section id="aio-24-diagnosing-issues-improving-robustness"><p>Content from <a href="24-diagnosing-issues-improving-robustness.html">2.4 Diagnosing Issues and Improving Robustness</a></p>
<hr>
<p>Last updated on 2025-05-27 |

        <a href="https://github.com/carpentries-incubator/python-intermediate-development/edit/main/episodes/24-diagnosing-issues-improving-robustness.md" class="external-link">Edit this page <i aria-hidden="true" data-feather="edit"></i></a></p>
<p>Estimated time: <i aria-hidden="true" data-feather="clock"></i> 45 minutes</p>
<div class="text-end">
          <button role="button" aria-pressed="false" tabindex="0" id="expand-code" class="pull-right" data-expand="Expand All Solutions " data-collapse="Collapse All Solutions "> Expand All Solutions <i aria-hidden="true" data-feather="plus"></i></button>
        </div>
<div class="overview card">
<h2 class="card-header">Overview</h2>
<div class="row g-0">
<div class="col-md-4">
<div class="card-body">
<div class="inner">
<h3 class="card-title">Questions</h3>
<ul>
<li>Once we know our program has errors, how can we locate them in the
code?</li>
<li>How can we make our programs more resilient to failure?</li>
</ul>
</div>
</div>
</div>
<div class="col-md-8">
<div class="card-body">
<div class="inner bordered">
<h3 class="card-title">Objectives</h3>
<ul>
<li>Use a debugger to explore behaviour of a running program</li>
<li>Describe and identify edge and corner test cases and explain why
they are important</li>
<li>Apply error handling and defensive programming techniques to improve
robustness of a program</li>
<li>Integrate linting tool style checking into a continuous integration
job</li>
</ul>
</div>
</div>
</div>
</div>
</div>
<section><h2 class="section-heading" id="introduction">Introduction<a class="anchor" aria-label="anchor" href="#introduction"></a>
</h2>
<hr class="half-width">
<p>Unit testing can tell us something is wrong in our code and give a
rough idea of where the error is by which test(s) are failing. But it
does not tell us exactly where the problem is (i.e. what line of code),
or how it came about. To give us a better idea of what is going on, we
can:</p>
<ul>
<li>output program state at various points, e.g. by using print
statements to output the contents of variables,</li>
<li>use a logging capability to output the state of everything as the
program progresses, or</li>
<li>look at intermediately generated files.</li>
</ul>
<p>But such approaches are often time consuming and sometimes not enough
to fully pinpoint the issue. In complex programs, like simulation codes,
we often need to get inside the code while it is running and explore.
This is where using a <strong>debugger</strong> can be useful.</p>
</section><section><h2 class="section-heading" id="setting-the-scene">Setting the Scene<a class="anchor" aria-label="anchor" href="#setting-the-scene"></a>
</h2>
<hr class="half-width">
<p>Let us add a new function called <code>patient_normalise()</code> to
our inflammation example to normalise a given inflammation data array so
that all entries fall between 0 and 1. (Make sure you create a new
feature branch for this work off your <code>develop</code> branch.) To
normalise each patient’s inflammation data we need to divide it by the
maximum inflammation experienced by that patient. To do so, we can add
the following code to <code>inflammation/models.py</code>:</p>
<div class="codewrapper sourceCode" id="cb1">
<h3 class="code-label">PYTHON<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="sourceCode python" tabindex="0"><code class="sourceCode python"><span id="cb1-1"><a href="#cb1-1" tabindex="-1"></a><span class="kw">def</span> patient_normalise(data):</span>
<span id="cb1-2"><a href="#cb1-2" tabindex="-1"></a>    <span class="co">"""Normalise patient data from a 2D inflammation data array."""</span></span>
<span id="cb1-3"><a href="#cb1-3" tabindex="-1"></a>    <span class="bu">max</span> <span class="op">=</span> np.<span class="bu">max</span>(data, axis<span class="op">=</span><span class="dv">0</span>)</span>
<span id="cb1-4"><a href="#cb1-4" tabindex="-1"></a>    <span class="cf">return</span> data <span class="op">/</span> <span class="bu">max</span>[:, np.newaxis]</span></code></pre>
</div>
<p><em><strong>Note:</strong> there are intentional mistakes in the
above code, which will be detected by further testing and code style
checking below so bear with us for the moment.</em></p>
<p>In the code above, we first go row by row and find the maximum
inflammation value for each patient and store these values in a
1-dimensional NumPy array <code>max</code>. We then want to use NumPy’s
element-wise division, to divide each value in every row of inflammation
data (belonging to the same patient) by the maximum value for that
patient stored in the 1D array <code>max</code>. However, we cannot do
that division automatically as <code>data</code> is a 2D array (of shape
<code>(60, 40)</code>) and <code>max</code> is a 1D array (of shape
<code>(60, )</code>), which means that their shapes are not
compatible.</p>
<figure><img src="../fig/numpy-incompatible-shapes.png" class="image-with-shadow figure mx-auto d-block" alt="NumPy arrays of incompatible shapes" width="800"></figure><p>Hence, to make sure that we can perform this division and get the
expected result, we need to convert <code>max</code> to be a 2D array by
using the <code>newaxis</code> index operator to insert a new axis into
<code>max</code>, making it a 2D array of shape
<code>(60, 1)</code>.</p>
<figure><img src="../fig/numpy-shapes-after-new-axis.png" class="image-with-shadow figure mx-auto d-block" alt="NumPy arrays' shapes after adding a new_axis" width="800"></figure><p>Now the division will give us the expected result. Even though the
shapes are not identical, NumPy’s automatic <code>broadcasting</code>
(adjustment of shapes) will make sure that the shape of the 2D
<code>max</code> array is now “stretched” (“broadcast”) to match that of
<code>data</code> - i.e. <code>(60, 40)</code>, and element-wise
division can be performed.</p>
<figure><img src="../fig/numpy-shapes-after-broadcasting.png" class="image-with-shadow figure mx-auto d-block" alt="NumPy arrays' shapes after broadcasting" width="800"></figure><div id="broadcasting" class="callout">
<div class="callout-square">
<i class="callout-icon" data-feather="bell"></i>
</div>
<div id="broadcasting" class="callout-inner">
<h3 class="callout-title">Broadcasting</h3>
<div class="callout-content">
<p>The term broadcasting describes how NumPy treats arrays with
different shapes during arithmetic operations. Subject to certain
constraints, the smaller array is “broadcast” across the larger array so
that they have compatible shapes. Be careful, though, to understand how
the arrays get stretched to avoid getting unexpected results.</p>
</div>
</div>
</div>
<p>Note there is an assumption in this calculation that the minimum
value we want is always zero. This is a sensible assumption for this
particular application, since the zero value is a special case
indicating that a patient experienced no inflammation on a particular
day.</p>
<p>Let us now add a new test in <code>tests/test_models.py</code> to
check that the normalisation function is correct for some test data.</p>
<div class="codewrapper sourceCode" id="cb2">
<h3 class="code-label">PYTHON<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="sourceCode python" tabindex="0"><code class="sourceCode python"><span id="cb2-1"><a href="#cb2-1" tabindex="-1"></a><span class="im">from</span> inflammation.models <span class="im">import</span> patient_normalise</span>
<span id="cb2-2"><a href="#cb2-2" tabindex="-1"></a></span>
<span id="cb2-3"><a href="#cb2-3" tabindex="-1"></a><span class="at">@pytest.mark.parametrize</span>(</span>
<span id="cb2-4"><a href="#cb2-4" tabindex="-1"></a>    <span class="st">"test, expected"</span>,</span>
<span id="cb2-5"><a href="#cb2-5" tabindex="-1"></a>    [</span>
<span id="cb2-6"><a href="#cb2-6" tabindex="-1"></a>        ([[<span class="dv">1</span>, <span class="dv">2</span>, <span class="dv">3</span>], [<span class="dv">4</span>, <span class="dv">5</span>, <span class="dv">6</span>], [<span class="dv">7</span>, <span class="dv">8</span>, <span class="dv">9</span>]], [[<span class="fl">0.33</span>, <span class="fl">0.67</span>, <span class="dv">1</span>], [<span class="fl">0.67</span>, <span class="fl">0.83</span>, <span class="dv">1</span>], [<span class="fl">0.78</span>, <span class="fl">0.89</span>, <span class="dv">1</span>]])</span>
<span id="cb2-7"><a href="#cb2-7" tabindex="-1"></a>    ])</span>
<span id="cb2-8"><a href="#cb2-8" tabindex="-1"></a><span class="kw">def</span> test_patient_normalise(test, expected):</span>
<span id="cb2-9"><a href="#cb2-9" tabindex="-1"></a>    <span class="co">"""Test normalisation works for arrays of one and positive integers.</span></span>
<span id="cb2-10"><a href="#cb2-10" tabindex="-1"></a><span class="co">       Test with a relative and absolute tolerance of 0.01."""</span></span>
<span id="cb2-11"><a href="#cb2-11" tabindex="-1"></a></span>
<span id="cb2-12"><a href="#cb2-12" tabindex="-1"></a>    result <span class="op">=</span> patient_normalise(np.array(test))</span>
<span id="cb2-13"><a href="#cb2-13" tabindex="-1"></a>    npt.assert_allclose(result, np.array(expected), rtol<span class="op">=</span><span class="fl">1e-2</span>, atol<span class="op">=</span><span class="fl">1e-2</span>)</span></code></pre>
</div>
<p>Note that we are using the <code>assert_allclose()</code> Numpy
testing function instead of <code>assert_array_equal()</code>, since it
allows us to test against values that are <strong>close</strong> to each
other. This is very useful when we have numbers with arbitrary decimal
places and are only concerned with a certain degree of precision, like
the test case above.</p>
<div id="relative-and-absolute-tolerance" class="callout">
<div class="callout-square">
<i class="callout-icon" data-feather="bell"></i>
</div>
<div id="relative-and-absolute-tolerance" class="callout-inner">
<h3 class="callout-title">Relative and absolute tolerance</h3>
<div class="callout-content">
<p><strong>Relative tolerance</strong> in unit testing means that the
acceptable difference between the expected and actual results depends on
the size of the expected result itself. So, if your expected result is
100, a relative tolerance of 0.1 (or 10%) means the actual result can be
anywhere from 90 to 110 and still be considered correct.</p>
<p><strong>Absolute tolerance</strong>, on the other hand, sets a fixed
allowable difference regardless of the magnitude of the expected result.
For example, if you set an absolute tolerance of 5, it means the actual
result can be within 5 units of the expected result, regardless of
whether the expected result is 10 or 1000.</p>
</div>
</div>
</div>
<p>Run the tests again using
<code>python -m pytest tests/test_models.py</code> and you will note
that the new test is failing, with an error message that does not give
many clues as to what went wrong.</p>
<div class="codewrapper">
<h3 class="code-label">OUTPUT<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="output" tabindex="0"><code>E           AssertionError:
E           Not equal to tolerance rtol=0.01, atol=0.01
E
E           Mismatched elements: 6 / 9 (66.7%)
E           Max absolute difference: 0.57142857
E           Max relative difference: 0.57356077
E            x: array([[0.142857, 0.285714, 0.428571],
E                  [0.5     , 0.625   , 0.75    ],
E                  [0.777778, 0.888889, 1.      ]])
E            y: array([[0.33, 0.67, 1.  ],
E                  [0.67, 0.83, 1.  ],
E                  [0.78, 0.89, 1.  ]])

tests/test_models.py:53: AssertionError</code></pre>
</div>
<p>Let us use a debugger at this point to see what is going on and why
the function failed.</p>
</section><section><h2 class="section-heading" id="debugging-in-pycharm">Debugging in PyCharm<a class="anchor" aria-label="anchor" href="#debugging-in-pycharm"></a>
</h2>
<hr class="half-width">
<p>Think of debugging like performing exploratory surgery - on code!
Debuggers allow us to peer at the internal workings of a program, such
as variables and other state, as it performs its functions.</p>
<div class="section level3">
<h3 id="running-tests-within-pycharm">Running Tests Within PyCharm<a class="anchor" aria-label="anchor" href="#running-tests-within-pycharm"></a>
</h3>
<p>Firstly, to make it easier to track what’s going on, we can set up
PyCharm to run and debug our tests instead of running them from the
command line. If you have not done so already, you will first need to
enable the Pytest framework in PyCharm. You can do this by:</p>
<ol style="list-style-type: decimal">
<li>Select either <code>PyCharm</code> &gt; <code>Preferences</code>
(Mac) or <code>File</code> &gt; <code>Settings</code> (Linux,
Windows).</li>
<li>Then, in the preferences window that appears, select
<code>Tools</code> -&gt; <code>Python integrated tools</code> &gt; from
the left.</li>
<li>Under <code>Testing</code>, for <code>Default test runner</code>
select <code>pytest</code>.</li>
<li>Select <code>OK</code>.</li>
</ol>
<figure><img src="../fig/pycharm-test-framework.png" class="image-with-shadow figure mx-auto d-block" alt="Setting up test framework in PyCharm" width="1000"></figure><p>We can now run <code>pytest</code> over our tests in PyCharm,
similarly to how we ran our <code>inflammation-analysis.py</code> script
before. Right-click the <code>test_models.py</code> file under the
<code>tests</code> directory in the file navigation window on the left,
and select <code>Run 'pytest in test_model...'</code>. You’ll see the
results of the tests appear in PyCharm in a bottom panel. If you scroll
down in that panel you should see the failed
<code>test_patient_normalise()</code> test result looking something like
the following:</p>
<figure><img src="../fig/pytest-pycharm-run-tests.png" class="image-with-shadow figure mx-auto d-block" alt="Running pytest in PyCharm" width="1000"></figure><p>We can also run our test functions individually. First, let us check
that our PyCharm running and testing configurations are correct. Select
<code>Run</code> &gt; <code>Edit Configurations...</code> from the
PyCharm menu, and you should see something like the following:</p>
<figure><img src="../fig/pytest-pycharm-check-config.png" class="image-with-shadow figure mx-auto d-block" alt="Ensuring testing configurations in PyCharm are correct" width="800"></figure><p>PyCharm allows us to configure multiple ways of running our code.
Looking at the figure above, the first of these -
<code>inflammation-analysis</code> under <code>Python</code> - was
configured when we set up how to run our script from within PyCharm. The
second - <code>pytest in test_models.py</code> under
<code>Python tests</code> - is our recent test configuration. If you see
just these, you are good to go. We do not need any others, so select any
others you see and click the <code>-</code> button at the top to remove
them. This will avoid any confusion when running our tests separately.
Click <code>OK</code> when done.</p>
<div id="buffered-output" class="callout">
<div class="callout-square">
<i class="callout-icon" data-feather="bell"></i>
</div>
<div id="buffered-output" class="callout-inner">
<h3 class="callout-title">Buffered Output</h3>
<div class="callout-content">
<p>Whenever a Python program prints text to the terminal or to a file,
it first stores this text in an <strong>output buffer</strong>. When the
buffer becomes full or is <strong>flushed</strong>, the contents of the
buffer are written to the terminal / file in one go and the buffer is
cleared. This is usually done to increase performance by effectively
converting multiple output operations into just one. Printing text to
the terminal is a relatively slow operation, so in some cases this can
make quite a big difference to the total execution time of a
program.</p>
<p>However, using buffered output can make debugging more difficult, as
we can no longer be quite sure when a log message will be displayed. In
order to make debugging simpler, PyCharm automatically adds the
environment variable <code>PYTHONUNBUFFERED</code> we see in the
screenshot above, which disables output buffering.</p>
</div>
</div>
</div>
<p>Now, if you select the green arrow next to a test function in our
<code>test_models.py</code> script in PyCharm, and select
<code>Run 'pytest in test_model...'</code>, we can run just that
test:</p>
<figure><img src="../fig/pytest-pycharm-run-single-test.png" class="image-with-shadow figure mx-auto d-block" alt="Running a single test in PyCharm" width="800"></figure><p>Click on the “run” button next to
<code>test_patient_normalise</code>, and you will be able to see that
PyCharm runs just that test function, and we see the same
<code>AssertionError</code> that we saw before.</p>
</div>
<div class="section level3">
<h3 id="running-the-debugger">Running the Debugger<a class="anchor" aria-label="anchor" href="#running-the-debugger"></a>
</h3>
<p>Now we want to use the debugger to investigate what is happening
inside the <code>patient_normalise</code> function. To do this we will
add a <em>breakpoint</em> in the code. A breakpoint will pause execution
at that point allowing us to explore the state of the program.</p>
<p>To set a breakpoint, navigate to the <code>models.py</code> file and
move your mouse to the <code>return</code> statement of the
<code>patient_normalise</code> function. Click to just to the right of
the line number for that line and a small red dot will appear,
indicating that you have placed a breakpoint on that line.</p>
<figure><img src="../fig/pytest-pycharm-set-breakpoint.png" class="image-with-shadow figure mx-auto d-block" alt="Setting a breakpoint in PyCharm" width="600"></figure><p>Now if you select the green arrow next to the
<code>test_patient_normalise</code> function and instead select
<code>Debug 'pytest in test_model...'</code>, you will notice that
execution will be paused at the <code>return</code> statement of
<code>patient_normalise</code>. In the debug panel that appears below,
we can now investigate the exact state of the program prior to it
executing this line of code.</p>
<p>In the debug panel below, in the <code>Debugger</code> tab you will
be able to see two sections that looks something like the following:</p>
<figure><img src="../fig/pytest-pycharm-debug.png" class="image-with-shadow figure mx-auto d-block" alt="Debugging in PyCharm" width="1000"></figure><ul>
<li>The <code>Frames</code> section on the left, which shows the
<strong>call stack</strong> (the chain of functions that have been
executed to lead to this point). We can traverse this chain of functions
if we wish, to observe the state of each function.</li>
<li>The <code>Variables</code> section on the right, which displays the
local and global variables currently in memory. You will be able to see
the <code>data</code> array that is input to the
<code>patient_normalise</code> function, as well as the <code>max</code>
local array that was created to hold the maximum inflammation values for
each patient.</li>
</ul>
<p>We also have the ability run any Python code we wish at this point to
explore the state of the program even further! This is useful if you
want to view a particular combination of variables, or perhaps a single
element or slice of an array to see what went wrong. Select the
<code>Console</code> tab in the panel (next to the <code>Debugger</code>
tab), and you’ll be presented with a Python prompt. Try putting in the
expression <code>max[:, np.newaxis]</code> into the console, and you
will be able to see the column vector that we are dividing
<code>data</code> by in the return line of the function.</p>
<figure><img src="../fig/pytest-pycharm-console.png" class="image-with-shadow figure mx-auto d-block" alt="Debugging in PyCharm" width="1000"></figure><p>Now, looking at the <code>max</code> variable, we can see that
something looks wrong, as the maximum values for each patient do not
correspond to the <code>data</code> array. Recall that the input
<code>data</code> array we are using for the function is</p>
<div class="codewrapper sourceCode" id="cb4">
<h3 class="code-label">PYTHON<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="sourceCode python" tabindex="0"><code class="sourceCode python"><span id="cb4-1"><a href="#cb4-1" tabindex="-1"></a>  [[<span class="dv">1</span>, <span class="dv">2</span>, <span class="dv">3</span>],</span>
<span id="cb4-2"><a href="#cb4-2" tabindex="-1"></a>   [<span class="dv">4</span>, <span class="dv">5</span>, <span class="dv">6</span>],</span>
<span id="cb4-3"><a href="#cb4-3" tabindex="-1"></a>   [<span class="dv">7</span>, <span class="dv">8</span>, <span class="dv">9</span>]]</span></code></pre>
</div>
<p>So the maximum inflammation for each patient should be
<code>[3, 6, 9]</code>, whereas the debugger shows
<code>[7, 8, 9]</code>. You can see that the latter corresponds exactly
to the last column of <code>data</code>, and we can immediately conclude
that we took the maximum along the wrong axis of <code>data</code>. Now
we have our answer, stop the debugging process by selecting the red
square at the top right of the main PyCharm window.</p>
<p>So to fix the <code>patient_normalise</code> function in
<code>models.py</code>, change <code>axis=0</code> in the first line of
the function to <code>axis=1</code>. With this fix in place, running all
the tests again should result in all tests passing. Navigate back to
<code>test_models.py</code> in PyCharm, right click
<code>test_models.py</code> and select
<code>Run 'pytest in test_model...'</code>. You should be rewarded
with:</p>
<figure><img src="../fig/pytest-pycharm-all-tests-pass.png" class="image-with-shadow figure mx-auto d-block" alt="All tests in PyCharm are successful" width="1000"></figure><div id="numpy-axis" class="callout">
<div class="callout-square">
<i class="callout-icon" data-feather="bell"></i>
</div>
<div id="numpy-axis" class="callout-inner">
<h3 class="callout-title">NumPy Axis</h3>
<div class="callout-content">
<p>Getting the axes right in NumPy is not trivial - the <a href="https://www.sharpsightlabs.com/blog/numpy-axes-explained/#:~:text=NumPy%20axes%20are%20the%20directions,along%20the%20rows%20and%20columns" class="external-link">following
tutorial</a> offers a good explanation on how axes work when applying
NumPy functions to arrays.</p>
</div>
</div>
</div>
<div id="debugging-outside-of-an-ide" class="callout">
<div class="callout-square">
<i class="callout-icon" data-feather="bell"></i>
</div>
<div id="debugging-outside-of-an-ide" class="callout-inner">
<h3 class="callout-title">Debugging Outside of an IDE</h3>
<div class="callout-content">
<p>It is worth being aware of the fact that you do not need to use an
IDE to debug code, although it does certainly make it easier! The Python
standard library comes with a command-line capable debugger built in,
called <a href="https://docs.python.org/3/library/pdb.html" class="external-link">pdb</a>. The
easiest way to use it is to put one of these lines anywhere in your code
you would like the debugger to stop:
<code>import pdb; pdb.set_trace()</code> or <code>breakpoint()</code>.
Then you are able to run your Python program from the command line like
you normally would, but instead of completing or erroring out, a
different prompt for the debugger will come up in your terminal. The
debugger has its own commands that you can read about in <a href="https://docs.python.org/3/library/pdb.html#debugger-commands" class="external-link">the
documentation for pdb</a>.</p>
</div>
</div>
</div>
</div>
</section><section><h2 class="section-heading" id="corner-or-edge-cases">Corner or Edge Cases<a class="anchor" aria-label="anchor" href="#corner-or-edge-cases"></a>
</h2>
<hr class="half-width">
<p>The test case that we have currently written for
<code>patient_normalise</code> is parameterised with a fairly standard
data array. However, when writing your test cases, it is important to
consider parameterising them by unusual or extreme values, in order to
test all the edge or corner cases that your code could be exposed to in
practice. Generally speaking, it is at these extreme cases that you will
find your code failing, so it is beneficial to test them beforehand.</p>
<p>What is considered an “edge case” for a given component depends on
what that component is meant to do. In the case of
<code>patient_normalise</code> function, the goal is to normalise a
numeric array of numbers. For numerical values, extreme cases could be
zeros, very large or small values, not-a-number (<code>NaN</code>) or
infinity values. Since we are specifically considering an <em>array</em>
of values, an edge case could be that all the numbers of the array are
equal.</p>
<p>For all the given edge cases you might come up with, you should also
consider their likelihood of occurrence. It is often too much effort to
exhaustively test a given function against every possible input, so you
should prioritise edge cases that are likely to occur. For our
<code>patient_normalise</code> function, some common edge cases might be
the occurrence of zeros, and the case where all the values of the array
are the same.</p>
<p>When you are considering edge cases to test for, try also to think
about what might break your code. For <code>patient_normalise</code> we
can see that there is a division by the maximum inflammation value for
each patient, so this will clearly break if we are dividing by zero
here, resulting in <code>NaN</code> values in the normalised array.</p>
<p>With all this in mind, let us add a few edge cases to our
parametrisation of <code>test_patient_normalise</code>. We will add two
extra tests, corresponding to an input array of all 0, and an input
array of all 1.</p>
<div class="codewrapper sourceCode" id="cb5">
<h3 class="code-label">PYTHON<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="sourceCode python" tabindex="0"><code class="sourceCode python"><span id="cb5-1"><a href="#cb5-1" tabindex="-1"></a><span class="at">@pytest.mark.parametrize</span>(</span>
<span id="cb5-2"><a href="#cb5-2" tabindex="-1"></a>    <span class="st">"test, expected"</span>,</span>
<span id="cb5-3"><a href="#cb5-3" tabindex="-1"></a>    [</span>
<span id="cb5-4"><a href="#cb5-4" tabindex="-1"></a>        ([[<span class="dv">0</span>, <span class="dv">0</span>, <span class="dv">0</span>], [<span class="dv">0</span>, <span class="dv">0</span>, <span class="dv">0</span>], [<span class="dv">0</span>, <span class="dv">0</span>, <span class="dv">0</span>]], [[<span class="dv">0</span>, <span class="dv">0</span>, <span class="dv">0</span>], [<span class="dv">0</span>, <span class="dv">0</span>, <span class="dv">0</span>], [<span class="dv">0</span>, <span class="dv">0</span>, <span class="dv">0</span>]]),</span>
<span id="cb5-5"><a href="#cb5-5" tabindex="-1"></a>        ([[<span class="dv">1</span>, <span class="dv">1</span>, <span class="dv">1</span>], [<span class="dv">1</span>, <span class="dv">1</span>, <span class="dv">1</span>], [<span class="dv">1</span>, <span class="dv">1</span>, <span class="dv">1</span>]], [[<span class="dv">1</span>, <span class="dv">1</span>, <span class="dv">1</span>], [<span class="dv">1</span>, <span class="dv">1</span>, <span class="dv">1</span>], [<span class="dv">1</span>, <span class="dv">1</span>, <span class="dv">1</span>]]),</span>
<span id="cb5-6"><a href="#cb5-6" tabindex="-1"></a>        ([[<span class="dv">1</span>, <span class="dv">2</span>, <span class="dv">3</span>], [<span class="dv">4</span>, <span class="dv">5</span>, <span class="dv">6</span>], [<span class="dv">7</span>, <span class="dv">8</span>, <span class="dv">9</span>]], [[<span class="fl">0.33</span>, <span class="fl">0.67</span>, <span class="dv">1</span>], [<span class="fl">0.67</span>, <span class="fl">0.83</span>, <span class="dv">1</span>], [<span class="fl">0.78</span>, <span class="fl">0.89</span>, <span class="dv">1</span>]]),</span>
<span id="cb5-7"><a href="#cb5-7" tabindex="-1"></a>    ])</span></code></pre>
</div>
<p>Running the tests now from the command line results in the following
assertion error, due to the division by zero as we predicted.</p>
<div class="codewrapper">
<h3 class="code-label">OUTPUT<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="output" tabindex="0"><code>E           AssertionError:
E           Not equal to tolerance rtol=0.01, atol=0.01
E
E           x and y nan location mismatch:
E            x: array([[nan, nan, nan],
E                  [nan, nan, nan],
E                  [nan, nan, nan]])
E            y: array([[0, 0, 0],
E                  [0, 0, 0],
E                  [0, 0, 0]])

tests/test_models.py:88: AssertionError</code></pre>
</div>
<p>How can we fix this? Luckily, there is a NumPy function that is
useful here, <a href="https://numpy.org/doc/stable/reference/generated/numpy.isnan.html" class="external-link"><code>np.isnan()</code></a>,
which we can use to replace all the NaN’s with our desired result, which
is 0. We can also silence the run-time warning using <a href="https://numpy.org/doc/stable/reference/generated/numpy.errstate.html" class="external-link"><code>np.errstate</code></a>:</p>
<div class="codewrapper sourceCode" id="cb7">
<h3 class="code-label">PYTHON<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="sourceCode python" tabindex="0"><code class="sourceCode python"><span id="cb7-1"><a href="#cb7-1" tabindex="-1"></a>...</span>
<span id="cb7-2"><a href="#cb7-2" tabindex="-1"></a><span class="kw">def</span> patient_normalise(data):</span>
<span id="cb7-3"><a href="#cb7-3" tabindex="-1"></a>    <span class="co">"""</span></span>
<span id="cb7-4"><a href="#cb7-4" tabindex="-1"></a><span class="co">    Normalise patient data from a 2D inflammation data array.</span></span>
<span id="cb7-5"><a href="#cb7-5" tabindex="-1"></a></span>
<span id="cb7-6"><a href="#cb7-6" tabindex="-1"></a><span class="co">    NaN values are ignored, and normalised to 0.</span></span>
<span id="cb7-7"><a href="#cb7-7" tabindex="-1"></a></span>
<span id="cb7-8"><a href="#cb7-8" tabindex="-1"></a><span class="co">    Negative values are rounded to 0.</span></span>
<span id="cb7-9"><a href="#cb7-9" tabindex="-1"></a><span class="co">    """</span></span>
<span id="cb7-10"><a href="#cb7-10" tabindex="-1"></a>    <span class="bu">max</span> <span class="op">=</span> np.nanmax(data, axis<span class="op">=</span><span class="dv">1</span>)</span>
<span id="cb7-11"><a href="#cb7-11" tabindex="-1"></a>    <span class="cf">with</span> np.errstate(invalid<span class="op">=</span><span class="st">'ignore'</span>, divide<span class="op">=</span><span class="st">'ignore'</span>):</span>
<span id="cb7-12"><a href="#cb7-12" tabindex="-1"></a>        normalised <span class="op">=</span> data <span class="op">/</span> <span class="bu">max</span>[:, np.newaxis]</span>
<span id="cb7-13"><a href="#cb7-13" tabindex="-1"></a>    normalised[np.isnan(normalised)] <span class="op">=</span> <span class="dv">0</span></span>
<span id="cb7-14"><a href="#cb7-14" tabindex="-1"></a>    normalised[normalised <span class="op">&lt;</span> <span class="dv">0</span>] <span class="op">=</span> <span class="dv">0</span></span>
<span id="cb7-15"><a href="#cb7-15" tabindex="-1"></a>    <span class="cf">return</span> normalised</span>
<span id="cb7-16"><a href="#cb7-16" tabindex="-1"></a>...</span></code></pre>
</div>
<div id="exercise-exploring-tests-for-edge-cases" class="callout challenge">
<div class="callout-square">
<i class="callout-icon" data-feather="zap"></i>
</div>
<div id="exercise-exploring-tests-for-edge-cases" class="callout-inner">
<h3 class="callout-title">Exercise: Exploring Tests for Edge Cases</h3>
<div class="callout-content">
<p>Think of some more suitable edge cases to test our
<code>patient_normalise()</code> function and add them to the
parametrised tests. After you have finished remember to commit your
changes.</p>
</div>
</div>
</div>
<div id="accordionSolution1" class="accordion challenge-accordion accordion-flush">
<div class="accordion-item">
<button class="accordion-button solution-button collapsed" type="button" data-bs-toggle="collapse" data-bs-target="#collapseSolution1" aria-expanded="false" aria-controls="collapseSolution1">
  <h4 class="accordion-header" id="headingSolution1"> Possible Solution </h4>
</button>
<div id="collapseSolution1" class="accordion-collapse collapse" data-bs-parent="#accordionSolution1" aria-labelledby="headingSolution1">
<div class="accordion-body">
<div class="codewrapper sourceCode" id="cb8">
<h3 class="code-label">PYTHON<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="sourceCode python" tabindex="0"><code class="sourceCode python"><span id="cb8-1"><a href="#cb8-1" tabindex="-1"></a><span class="im">from</span> inflammation.models <span class="im">import</span> patient_normalise</span>
<span id="cb8-2"><a href="#cb8-2" tabindex="-1"></a></span>
<span id="cb8-3"><a href="#cb8-3" tabindex="-1"></a><span class="at">@pytest.mark.parametrize</span>(</span>
<span id="cb8-4"><a href="#cb8-4" tabindex="-1"></a>    <span class="st">"test, expected"</span>,</span>
<span id="cb8-5"><a href="#cb8-5" tabindex="-1"></a>    [</span>
<span id="cb8-6"><a href="#cb8-6" tabindex="-1"></a>        (</span>
<span id="cb8-7"><a href="#cb8-7" tabindex="-1"></a>            [[<span class="dv">0</span>, <span class="dv">0</span>, <span class="dv">0</span>], [<span class="dv">0</span>, <span class="dv">0</span>, <span class="dv">0</span>], [<span class="dv">0</span>, <span class="dv">0</span>, <span class="dv">0</span>]],</span>
<span id="cb8-8"><a href="#cb8-8" tabindex="-1"></a>            [[<span class="dv">0</span>, <span class="dv">0</span>, <span class="dv">0</span>], [<span class="dv">0</span>, <span class="dv">0</span>, <span class="dv">0</span>], [<span class="dv">0</span>, <span class="dv">0</span>, <span class="dv">0</span>]],</span>
<span id="cb8-9"><a href="#cb8-9" tabindex="-1"></a>        ),</span>
<span id="cb8-10"><a href="#cb8-10" tabindex="-1"></a>        (</span>
<span id="cb8-11"><a href="#cb8-11" tabindex="-1"></a>            [[<span class="dv">1</span>, <span class="dv">1</span>, <span class="dv">1</span>], [<span class="dv">1</span>, <span class="dv">1</span>, <span class="dv">1</span>], [<span class="dv">1</span>, <span class="dv">1</span>, <span class="dv">1</span>]],</span>
<span id="cb8-12"><a href="#cb8-12" tabindex="-1"></a>            [[<span class="dv">1</span>, <span class="dv">1</span>, <span class="dv">1</span>], [<span class="dv">1</span>, <span class="dv">1</span>, <span class="dv">1</span>], [<span class="dv">1</span>, <span class="dv">1</span>, <span class="dv">1</span>]],</span>
<span id="cb8-13"><a href="#cb8-13" tabindex="-1"></a>        ),</span>
<span id="cb8-14"><a href="#cb8-14" tabindex="-1"></a>        (</span>
<span id="cb8-15"><a href="#cb8-15" tabindex="-1"></a>            [[<span class="bu">float</span>(<span class="st">'nan'</span>), <span class="dv">1</span>, <span class="dv">1</span>], [<span class="dv">1</span>, <span class="dv">1</span>, <span class="dv">1</span>], [<span class="dv">1</span>, <span class="dv">1</span>, <span class="dv">1</span>]],</span>
<span id="cb8-16"><a href="#cb8-16" tabindex="-1"></a>            [[<span class="dv">0</span>, <span class="dv">1</span>, <span class="dv">1</span>], [<span class="dv">1</span>, <span class="dv">1</span>, <span class="dv">1</span>], [<span class="dv">1</span>, <span class="dv">1</span>, <span class="dv">1</span>]],</span>
<span id="cb8-17"><a href="#cb8-17" tabindex="-1"></a>        ),</span>
<span id="cb8-18"><a href="#cb8-18" tabindex="-1"></a>        (</span>
<span id="cb8-19"><a href="#cb8-19" tabindex="-1"></a>            [[<span class="dv">1</span>, <span class="dv">2</span>, <span class="dv">3</span>], [<span class="dv">4</span>, <span class="dv">5</span>, <span class="bu">float</span>(<span class="st">'nan'</span>)], [<span class="dv">7</span>, <span class="dv">8</span>, <span class="dv">9</span>]],</span>
<span id="cb8-20"><a href="#cb8-20" tabindex="-1"></a>            [[<span class="fl">0.33</span>, <span class="fl">0.67</span>, <span class="dv">1</span>], [<span class="fl">0.8</span>, <span class="dv">1</span>, <span class="dv">0</span>], [<span class="fl">0.78</span>, <span class="fl">0.89</span>, <span class="dv">1</span>]],</span>
<span id="cb8-21"><a href="#cb8-21" tabindex="-1"></a>        ),</span>
<span id="cb8-22"><a href="#cb8-22" tabindex="-1"></a>        (</span>
<span id="cb8-23"><a href="#cb8-23" tabindex="-1"></a>            [[<span class="op">-</span><span class="dv">1</span>, <span class="dv">2</span>, <span class="dv">3</span>], [<span class="dv">4</span>, <span class="dv">5</span>, <span class="dv">6</span>], [<span class="dv">7</span>, <span class="dv">8</span>, <span class="dv">9</span>]],</span>
<span id="cb8-24"><a href="#cb8-24" tabindex="-1"></a>            [[<span class="dv">0</span>, <span class="fl">0.67</span>, <span class="dv">1</span>], [<span class="fl">0.67</span>, <span class="fl">0.83</span>, <span class="dv">1</span>], [<span class="fl">0.78</span>, <span class="fl">0.89</span>, <span class="dv">1</span>]],</span>
<span id="cb8-25"><a href="#cb8-25" tabindex="-1"></a>        ),</span>
<span id="cb8-26"><a href="#cb8-26" tabindex="-1"></a>        (</span>
<span id="cb8-27"><a href="#cb8-27" tabindex="-1"></a>            [[<span class="dv">1</span>, <span class="dv">2</span>, <span class="dv">3</span>], [<span class="dv">4</span>, <span class="dv">5</span>, <span class="dv">6</span>], [<span class="dv">7</span>, <span class="dv">8</span>, <span class="dv">9</span>]],</span>
<span id="cb8-28"><a href="#cb8-28" tabindex="-1"></a>            [[<span class="fl">0.33</span>, <span class="fl">0.67</span>, <span class="dv">1</span>], [<span class="fl">0.67</span>, <span class="fl">0.83</span>, <span class="dv">1</span>], [<span class="fl">0.78</span>, <span class="fl">0.89</span>, <span class="dv">1</span>]],</span>
<span id="cb8-29"><a href="#cb8-29" tabindex="-1"></a>        )</span>
<span id="cb8-30"><a href="#cb8-30" tabindex="-1"></a>    ])</span>
<span id="cb8-31"><a href="#cb8-31" tabindex="-1"></a><span class="kw">def</span> test_patient_normalise(test, expected):</span>
<span id="cb8-32"><a href="#cb8-32" tabindex="-1"></a>    <span class="co">"""Test normalisation works for arrays of one and positive integers."""</span></span>
<span id="cb8-33"><a href="#cb8-33" tabindex="-1"></a></span>
<span id="cb8-34"><a href="#cb8-34" tabindex="-1"></a>    result <span class="op">=</span> patient_normalise(np.array(test))</span>
<span id="cb8-35"><a href="#cb8-35" tabindex="-1"></a>    npt.assert_allclose(result, np.array(expected), rtol<span class="op">=</span><span class="fl">1e-2</span>, atol<span class="op">=</span><span class="fl">1e-2</span>)</span>
<span id="cb8-36"><a href="#cb8-36" tabindex="-1"></a>...</span></code></pre>
</div>
<p>You could also, for example, test and handle the case of a whole row
of NaNs.</p>
</div>
</div>
</div>
</div>
</section><section><h2 class="section-heading" id="defensive-programming">Defensive Programming<a class="anchor" aria-label="anchor" href="#defensive-programming"></a>
</h2>
<hr class="half-width">
<p>In the previous section, we made a few design choices for our
<code>patient_normalise</code> function:</p>
<ol style="list-style-type: decimal">
<li>We are implicitly converting any <code>NaN</code> and negative
values to 0,</li>
<li>Normalising a constant 0 array of inflammation results in an
identical array of 0s,</li>
<li>We do not warn the user of any of these situations.</li>
</ol>
<p>This could have be handled differently. We might decide that we do
not want to silently make these changes to the data, but instead to
explicitly check that the input data satisfies a given set of
assumptions (e.g. no negative values) and raise an error if this is not
the case. Then we can proceed with the normalisation, confident that our
normalisation function will work correctly.</p>
<p>Checking that input to a function is valid via a set of preconditions
is one of the simplest forms of <strong>defensive programming</strong>
which is used as a way of avoiding potential errors. Preconditions are
checked at the beginning of the function to make sure that all
assumptions are satisfied. These assumptions are often based on the
<em>value</em> of the arguments, like we have already discussed.
However, in a dynamic language like Python one of the more common
preconditions is to check that the arguments of a function are of the
correct <em>type</em>. Currently there is nothing stopping someone from
calling <code>patient_normalise</code> with a string, a dictionary, or
another object that is not an <code>ndarray</code>.</p>
<p>As an example, let us change the behaviour of the
<code>patient_normalise()</code> function to raise an error on negative
inflammation values. Edit the <code>inflammation/models.py</code> file,
and add a precondition check to the beginning of the
<code>patient_normalise()</code> function like so:</p>
<div class="codewrapper sourceCode" id="cb9">
<h3 class="code-label">PYTHON<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="sourceCode python" tabindex="0"><code class="sourceCode python"><span id="cb9-1"><a href="#cb9-1" tabindex="-1"></a>...</span>
<span id="cb9-2"><a href="#cb9-2" tabindex="-1"></a>    <span class="cf">if</span> np.<span class="bu">any</span>(data <span class="op">&lt;</span> <span class="dv">0</span>):</span>
<span id="cb9-3"><a href="#cb9-3" tabindex="-1"></a>        <span class="cf">raise</span> <span class="pp">ValueError</span>(<span class="st">'Inflammation values should not be negative'</span>)</span>
<span id="cb9-4"><a href="#cb9-4" tabindex="-1"></a>...</span></code></pre>
</div>
<p>We can then modify our test function in
<code>tests/test_models.py</code> to check that the function raises the
correct exception - a <code>ValueError</code> - when input to the test
contains negative values (i.e. input case
<code>[[-1, 2, 3], [4, 5, 6], [7, 8, 9]]</code>). The <a href="https://docs.python.org/3/library/exceptions.html#ValueError" class="external-link"><code>ValueError</code></a>
exception is part of the standard Python library and is used to indicate
that the function received an argument of the right type, but of an
inappropriate value.</p>
<div class="codewrapper sourceCode" id="cb10">
<h3 class="code-label">PYTHON<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="sourceCode python" tabindex="0"><code class="sourceCode python"><span id="cb10-1"><a href="#cb10-1" tabindex="-1"></a><span class="im">from</span> inflammation.models <span class="im">import</span> patient_normalise</span>
<span id="cb10-2"><a href="#cb10-2" tabindex="-1"></a></span>
<span id="cb10-3"><a href="#cb10-3" tabindex="-1"></a><span class="at">@pytest.mark.parametrize</span>(</span>
<span id="cb10-4"><a href="#cb10-4" tabindex="-1"></a>    <span class="st">"test, expected, expect_raises"</span>,</span>
<span id="cb10-5"><a href="#cb10-5" tabindex="-1"></a>    [</span>
<span id="cb10-6"><a href="#cb10-6" tabindex="-1"></a>        ... <span class="co"># previous test cases here, with None for expect_raises, except for the next one - add ValueError</span></span>
<span id="cb10-7"><a href="#cb10-7" tabindex="-1"></a>        ... <span class="co"># as an expected exception (since it has a negative input value)</span></span>
<span id="cb10-8"><a href="#cb10-8" tabindex="-1"></a>        (</span>
<span id="cb10-9"><a href="#cb10-9" tabindex="-1"></a>            [[<span class="op">-</span><span class="dv">1</span>, <span class="dv">2</span>, <span class="dv">3</span>], [<span class="dv">4</span>, <span class="dv">5</span>, <span class="dv">6</span>], [<span class="dv">7</span>, <span class="dv">8</span>, <span class="dv">9</span>]],</span>
<span id="cb10-10"><a href="#cb10-10" tabindex="-1"></a>            [[<span class="dv">0</span>, <span class="fl">0.67</span>, <span class="dv">1</span>], [<span class="fl">0.67</span>, <span class="fl">0.83</span>, <span class="dv">1</span>], [<span class="fl">0.78</span>, <span class="fl">0.89</span>, <span class="dv">1</span>]],</span>
<span id="cb10-11"><a href="#cb10-11" tabindex="-1"></a>            <span class="pp">ValueError</span>,</span>
<span id="cb10-12"><a href="#cb10-12" tabindex="-1"></a>        ),</span>
<span id="cb10-13"><a href="#cb10-13" tabindex="-1"></a>        (</span>
<span id="cb10-14"><a href="#cb10-14" tabindex="-1"></a>            [[<span class="dv">1</span>, <span class="dv">2</span>, <span class="dv">3</span>], [<span class="dv">4</span>, <span class="dv">5</span>, <span class="dv">6</span>], [<span class="dv">7</span>, <span class="dv">8</span>, <span class="dv">9</span>]],</span>
<span id="cb10-15"><a href="#cb10-15" tabindex="-1"></a>            [[<span class="fl">0.33</span>, <span class="fl">0.67</span>, <span class="dv">1</span>], [<span class="fl">0.67</span>, <span class="fl">0.83</span>, <span class="dv">1</span>], [<span class="fl">0.78</span>, <span class="fl">0.89</span>, <span class="dv">1</span>]],</span>
<span id="cb10-16"><a href="#cb10-16" tabindex="-1"></a>            <span class="va">None</span>,</span>
<span id="cb10-17"><a href="#cb10-17" tabindex="-1"></a>        ),</span>
<span id="cb10-18"><a href="#cb10-18" tabindex="-1"></a>    ])</span>
<span id="cb10-19"><a href="#cb10-19" tabindex="-1"></a><span class="kw">def</span> test_patient_normalise(test, expected, expect_raises):</span>
<span id="cb10-20"><a href="#cb10-20" tabindex="-1"></a>    <span class="co">"""Test normalisation works for arrays of one and positive integers."""</span></span>
<span id="cb10-21"><a href="#cb10-21" tabindex="-1"></a>        </span>
<span id="cb10-22"><a href="#cb10-22" tabindex="-1"></a>    <span class="cf">if</span> expect_raises <span class="kw">is</span> <span class="kw">not</span> <span class="va">None</span>:</span>
<span id="cb10-23"><a href="#cb10-23" tabindex="-1"></a>        <span class="cf">with</span> pytest.raises(expect_raises):</span>
<span id="cb10-24"><a href="#cb10-24" tabindex="-1"></a>            patient_normalise(np.array(test))</span>
<span id="cb10-25"><a href="#cb10-25" tabindex="-1"></a>    <span class="cf">else</span>:</span>
<span id="cb10-26"><a href="#cb10-26" tabindex="-1"></a>        result <span class="op">=</span> patient_normalise(np.array(test))</span>
<span id="cb10-27"><a href="#cb10-27" tabindex="-1"></a>        npt.assert_allclose(result, np.array(expected), rtol<span class="op">=</span><span class="fl">1e-2</span>, atol<span class="op">=</span><span class="fl">1e-2</span>)</span></code></pre>
</div>
<p>Notice that under the <code>pytest.raises</code> context manager, it
isn’t necessary to perform the <code>npt.assert_allclose</code> because
just the call to <code>patient_normalise()</code> will raise the
<code>ValueError</code>.</p>
<p>Be sure to commit your changes so far and push them to GitHub.</p>
<div id="optional-exercise-add-a-precondition-to-check-the-correct-type-and-shape-of-data" class="callout challenge">
<div class="callout-square">
<i class="callout-icon" data-feather="zap"></i>
</div>
<div id="optional-exercise-add-a-precondition-to-check-the-correct-type-and-shape-of-data" class="callout-inner">
<h3 class="callout-title">Optional Exercise: Add a Precondition to Check the Correct Type and Shape of Data</h3>
<div class="callout-content">
<p>Add preconditions to check that data is an <code>ndarray</code>
object and that it is of the correct shape. Add corresponding tests to
check that the function raises the correct exception. You will find the
Python function <a href="https://docs.python.org/3/library/functions.html#isinstance" class="external-link"><code>isinstance</code></a>
useful here, as well as the Python exception <a href="https://docs.python.org/3/library/exceptions.html#TypeError" class="external-link"><code>TypeError</code></a>.</p>
<p>You can take this even further if your solution code involves
multiple <code>ValueError</code>s or <code>TypeError</code>’s being
raised at different locations. In this case, you want to make sure the
function is raising the precise <code>Exception</code> that occurs at a
specific point in your function. You might have noticed that
<code>Exception</code>s can take a string argument corresponding to a
message / description of the exception that has occurred. The <a href="https://docs.pytest.org/en/stable/reference/reference.html#pytest.raises" class="external-link"><code>pytest.raises()</code></a>
context manager can query this message with its <code>match=</code>
argument. See if you can use that to more precisely test the exceptions
raised by your function.</p>
<p>Once you are done, commit your new files, and push the new commits to
your remote repository on GitHub.</p>
</div>
</div>
</div>
<div id="accordionSolution2" class="accordion challenge-accordion accordion-flush">
<div class="accordion-item">
<button class="accordion-button solution-button collapsed" type="button" data-bs-toggle="collapse" data-bs-target="#collapseSolution2" aria-expanded="false" aria-controls="collapseSolution2">
  <h4 class="accordion-header" id="headingSolution2"> Show me the solution </h4>
</button>
<div id="collapseSolution2" class="accordion-collapse collapse" data-bs-parent="#accordionSolution2" aria-labelledby="headingSolution2">
<div class="accordion-body">
<p>In <code>inflammation/models.py</code>:</p>
<div class="codewrapper sourceCode" id="cb11">
<h3 class="code-label">PYTHON<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="sourceCode python" tabindex="0"><code class="sourceCode python"><span id="cb11-1"><a href="#cb11-1" tabindex="-1"></a>...</span>
<span id="cb11-2"><a href="#cb11-2" tabindex="-1"></a><span class="kw">def</span> patient_normalise(data):</span>
<span id="cb11-3"><a href="#cb11-3" tabindex="-1"></a>    <span class="co">"""</span></span>
<span id="cb11-4"><a href="#cb11-4" tabindex="-1"></a><span class="co">    Normalise patient data between 0 and 1 of a 2D inflammation data array.</span></span>
<span id="cb11-5"><a href="#cb11-5" tabindex="-1"></a></span>
<span id="cb11-6"><a href="#cb11-6" tabindex="-1"></a><span class="co">    Any NaN values are ignored, and normalised to 0</span></span>
<span id="cb11-7"><a href="#cb11-7" tabindex="-1"></a></span>
<span id="cb11-8"><a href="#cb11-8" tabindex="-1"></a><span class="co">    :param data: 2D array of inflammation data</span></span>
<span id="cb11-9"><a href="#cb11-9" tabindex="-1"></a><span class="co">    :type data: ndarray</span></span>
<span id="cb11-10"><a href="#cb11-10" tabindex="-1"></a></span>
<span id="cb11-11"><a href="#cb11-11" tabindex="-1"></a><span class="co">    """</span></span>
<span id="cb11-12"><a href="#cb11-12" tabindex="-1"></a>    <span class="cf">if</span> <span class="kw">not</span> <span class="bu">isinstance</span>(data, np.ndarray):</span>
<span id="cb11-13"><a href="#cb11-13" tabindex="-1"></a>        <span class="cf">raise</span> <span class="pp">TypeError</span>(<span class="st">'data input should be ndarray'</span>)</span>
<span id="cb11-14"><a href="#cb11-14" tabindex="-1"></a>    <span class="cf">if</span> <span class="bu">len</span>(data.shape) <span class="op">!=</span> <span class="dv">2</span>:</span>
<span id="cb11-15"><a href="#cb11-15" tabindex="-1"></a>        <span class="cf">raise</span> <span class="pp">ValueError</span>(<span class="st">'inflammation array should be 2-dimensional'</span>)</span>
<span id="cb11-16"><a href="#cb11-16" tabindex="-1"></a>    <span class="cf">if</span> np.<span class="bu">any</span>(data <span class="op">&lt;</span> <span class="dv">0</span>):</span>
<span id="cb11-17"><a href="#cb11-17" tabindex="-1"></a>        <span class="cf">raise</span> <span class="pp">ValueError</span>(<span class="st">'inflammation values should be non-negative'</span>)</span>
<span id="cb11-18"><a href="#cb11-18" tabindex="-1"></a>    <span class="bu">max</span> <span class="op">=</span> np.nanmax(data, axis<span class="op">=</span><span class="dv">1</span>)</span>
<span id="cb11-19"><a href="#cb11-19" tabindex="-1"></a>    <span class="cf">with</span> np.errstate(invalid<span class="op">=</span><span class="st">'ignore'</span>, divide<span class="op">=</span><span class="st">'ignore'</span>):</span>
<span id="cb11-20"><a href="#cb11-20" tabindex="-1"></a>        normalised <span class="op">=</span> data <span class="op">/</span> <span class="bu">max</span>[:, np.newaxis]</span>
<span id="cb11-21"><a href="#cb11-21" tabindex="-1"></a>    normalised[np.isnan(normalised)] <span class="op">=</span> <span class="dv">0</span></span>
<span id="cb11-22"><a href="#cb11-22" tabindex="-1"></a>    <span class="cf">return</span> normalised</span>
<span id="cb11-23"><a href="#cb11-23" tabindex="-1"></a>...</span></code></pre>
</div>
<p>In <code>test/test_models.py</code>:</p>
<div class="codewrapper sourceCode" id="cb12">
<h3 class="code-label">PYTHON<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="sourceCode python" tabindex="0"><code class="sourceCode python"><span id="cb12-1"><a href="#cb12-1" tabindex="-1"></a><span class="im">from</span> inflammation.models <span class="im">import</span> patient_normalise</span>
<span id="cb12-2"><a href="#cb12-2" tabindex="-1"></a>...</span>
<span id="cb12-3"><a href="#cb12-3" tabindex="-1"></a><span class="at">@pytest.mark.parametrize</span>(</span>
<span id="cb12-4"><a href="#cb12-4" tabindex="-1"></a>    <span class="st">"test, expected, expect_raises"</span>,</span>
<span id="cb12-5"><a href="#cb12-5" tabindex="-1"></a>    [</span>
<span id="cb12-6"><a href="#cb12-6" tabindex="-1"></a>        ...</span>
<span id="cb12-7"><a href="#cb12-7" tabindex="-1"></a>        (</span>
<span id="cb12-8"><a href="#cb12-8" tabindex="-1"></a>            <span class="st">'hello'</span>,</span>
<span id="cb12-9"><a href="#cb12-9" tabindex="-1"></a>            <span class="va">None</span>,</span>
<span id="cb12-10"><a href="#cb12-10" tabindex="-1"></a>            <span class="pp">TypeError</span>,</span>
<span id="cb12-11"><a href="#cb12-11" tabindex="-1"></a>        ),</span>
<span id="cb12-12"><a href="#cb12-12" tabindex="-1"></a>        (</span>
<span id="cb12-13"><a href="#cb12-13" tabindex="-1"></a>            <span class="dv">3</span>,</span>
<span id="cb12-14"><a href="#cb12-14" tabindex="-1"></a>            <span class="va">None</span>,</span>
<span id="cb12-15"><a href="#cb12-15" tabindex="-1"></a>            <span class="pp">TypeError</span>,</span>
<span id="cb12-16"><a href="#cb12-16" tabindex="-1"></a>        ),</span>
<span id="cb12-17"><a href="#cb12-17" tabindex="-1"></a>        (</span>
<span id="cb12-18"><a href="#cb12-18" tabindex="-1"></a>            [<span class="dv">4</span>, <span class="dv">5</span>, <span class="dv">6</span>],</span>
<span id="cb12-19"><a href="#cb12-19" tabindex="-1"></a>            <span class="va">None</span>,</span>
<span id="cb12-20"><a href="#cb12-20" tabindex="-1"></a>            <span class="pp">ValueError</span>,</span>
<span id="cb12-21"><a href="#cb12-21" tabindex="-1"></a>        ),</span>
<span id="cb12-22"><a href="#cb12-22" tabindex="-1"></a>        (</span>
<span id="cb12-23"><a href="#cb12-23" tabindex="-1"></a>            [[<span class="dv">1</span>, <span class="dv">2</span>, <span class="dv">3</span>], [<span class="dv">4</span>, <span class="dv">5</span>, <span class="dv">6</span>], [<span class="dv">7</span>, <span class="dv">8</span>, <span class="dv">9</span>]],</span>
<span id="cb12-24"><a href="#cb12-24" tabindex="-1"></a>            [[<span class="fl">0.33</span>, <span class="fl">0.67</span>, <span class="dv">1</span>], [<span class="fl">0.67</span>, <span class="fl">0.83</span>, <span class="dv">1</span>], [<span class="fl">0.78</span>, <span class="fl">0.89</span>, <span class="dv">1</span>]],</span>
<span id="cb12-25"><a href="#cb12-25" tabindex="-1"></a>            <span class="va">None</span>,</span>
<span id="cb12-26"><a href="#cb12-26" tabindex="-1"></a>        )</span>
<span id="cb12-27"><a href="#cb12-27" tabindex="-1"></a>    ])</span>
<span id="cb12-28"><a href="#cb12-28" tabindex="-1"></a><span class="kw">def</span> test_patient_normalise(test, expected, expect_raises):</span>
<span id="cb12-29"><a href="#cb12-29" tabindex="-1"></a>    <span class="co">"""Test normalisation works for arrays of one and positive integers."""</span></span>
<span id="cb12-30"><a href="#cb12-30" tabindex="-1"></a>    <span class="cf">if</span> <span class="bu">isinstance</span>(test, <span class="bu">list</span>):</span>
<span id="cb12-31"><a href="#cb12-31" tabindex="-1"></a>        test <span class="op">=</span> np.array(test)</span>
<span id="cb12-32"><a href="#cb12-32" tabindex="-1"></a>    <span class="cf">if</span> expect_raises <span class="kw">is</span> <span class="kw">not</span> <span class="va">None</span>:</span>
<span id="cb12-33"><a href="#cb12-33" tabindex="-1"></a>        <span class="cf">with</span> pytest.raises(expect_raises):</span>
<span id="cb12-34"><a href="#cb12-34" tabindex="-1"></a>          patient_normalise(test)</span>
<span id="cb12-35"><a href="#cb12-35" tabindex="-1"></a></span>
<span id="cb12-36"><a href="#cb12-36" tabindex="-1"></a>    <span class="cf">else</span>:</span>
<span id="cb12-37"><a href="#cb12-37" tabindex="-1"></a>        result <span class="op">=</span> patient_normalise(test)</span>
<span id="cb12-38"><a href="#cb12-38" tabindex="-1"></a>        npt.assert_allclose(result, np.array(expected), rtol<span class="op">=</span><span class="fl">1e-2</span>, atol<span class="op">=</span><span class="fl">1e-2</span>)</span>
<span id="cb12-39"><a href="#cb12-39" tabindex="-1"></a>...</span></code></pre>
</div>
<p>Or, if you decided to match the specific exceptions in
<code>test/test_models.py</code>:</p>
<div class="codewrapper sourceCode" id="cb13">
<h3 class="code-label">PYTHON<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="sourceCode python" tabindex="0"><code class="sourceCode python"><span id="cb13-1"><a href="#cb13-1" tabindex="-1"></a><span class="im">from</span> inflammation.models <span class="im">import</span> patient_normalise</span>
<span id="cb13-2"><a href="#cb13-2" tabindex="-1"></a>...</span>
<span id="cb13-3"><a href="#cb13-3" tabindex="-1"></a><span class="at">@pytest.mark.parametrize</span>(</span>
<span id="cb13-4"><a href="#cb13-4" tabindex="-1"></a>    <span class="st">"test, expected, expect_raises"</span>,</span>
<span id="cb13-5"><a href="#cb13-5" tabindex="-1"></a>    [</span>
<span id="cb13-6"><a href="#cb13-6" tabindex="-1"></a>        ...</span>
<span id="cb13-7"><a href="#cb13-7" tabindex="-1"></a>        (</span>
<span id="cb13-8"><a href="#cb13-8" tabindex="-1"></a>            [[<span class="op">-</span><span class="dv">1</span>, <span class="dv">2</span>, <span class="dv">3</span>], [<span class="dv">4</span>, <span class="dv">5</span>, <span class="dv">6</span>], [<span class="dv">7</span>, <span class="dv">8</span>, <span class="dv">9</span>]],</span>
<span id="cb13-9"><a href="#cb13-9" tabindex="-1"></a>            <span class="va">None</span>,</span>
<span id="cb13-10"><a href="#cb13-10" tabindex="-1"></a>            <span class="pp">ValueError</span>(<span class="st">'inflammation values should be non-negative'</span>),</span>
<span id="cb13-11"><a href="#cb13-11" tabindex="-1"></a>        ),</span>
<span id="cb13-12"><a href="#cb13-12" tabindex="-1"></a>        (</span>
<span id="cb13-13"><a href="#cb13-13" tabindex="-1"></a>            [<span class="dv">4</span>, <span class="dv">5</span>, <span class="dv">6</span>],</span>
<span id="cb13-14"><a href="#cb13-14" tabindex="-1"></a>            <span class="va">None</span>,</span>
<span id="cb13-15"><a href="#cb13-15" tabindex="-1"></a>            <span class="pp">ValueError</span>(<span class="st">'inflammation array should be 2-dimensional'</span>),</span>
<span id="cb13-16"><a href="#cb13-16" tabindex="-1"></a>        ),</span>
<span id="cb13-17"><a href="#cb13-17" tabindex="-1"></a>        (</span>
<span id="cb13-18"><a href="#cb13-18" tabindex="-1"></a>            <span class="st">'hello'</span>,</span>
<span id="cb13-19"><a href="#cb13-19" tabindex="-1"></a>            <span class="va">None</span>,</span>
<span id="cb13-20"><a href="#cb13-20" tabindex="-1"></a>            <span class="pp">TypeError</span>(<span class="st">'data input should be ndarray'</span>),</span>
<span id="cb13-21"><a href="#cb13-21" tabindex="-1"></a>        ),</span>
<span id="cb13-22"><a href="#cb13-22" tabindex="-1"></a>        (</span>
<span id="cb13-23"><a href="#cb13-23" tabindex="-1"></a>            <span class="dv">3</span>,</span>
<span id="cb13-24"><a href="#cb13-24" tabindex="-1"></a>            <span class="va">None</span>,</span>
<span id="cb13-25"><a href="#cb13-25" tabindex="-1"></a>            <span class="pp">TypeError</span>(<span class="st">'data input should be ndarray'</span>),</span>
<span id="cb13-26"><a href="#cb13-26" tabindex="-1"></a>        ),</span>
<span id="cb13-27"><a href="#cb13-27" tabindex="-1"></a>        (</span>
<span id="cb13-28"><a href="#cb13-28" tabindex="-1"></a>            [[<span class="dv">1</span>, <span class="dv">2</span>, <span class="dv">3</span>], [<span class="dv">4</span>, <span class="dv">5</span>, <span class="dv">6</span>], [<span class="dv">7</span>, <span class="dv">8</span>, <span class="dv">9</span>]],</span>
<span id="cb13-29"><a href="#cb13-29" tabindex="-1"></a>            [[<span class="fl">0.33</span>, <span class="fl">0.67</span>, <span class="dv">1</span>], [<span class="fl">0.67</span>, <span class="fl">0.83</span>, <span class="dv">1</span>], [<span class="fl">0.78</span>, <span class="fl">0.89</span>, <span class="dv">1</span>]],</span>
<span id="cb13-30"><a href="#cb13-30" tabindex="-1"></a>            <span class="va">None</span>,</span>
<span id="cb13-31"><a href="#cb13-31" tabindex="-1"></a>        )</span>
<span id="cb13-32"><a href="#cb13-32" tabindex="-1"></a>    ])</span>
<span id="cb13-33"><a href="#cb13-33" tabindex="-1"></a><span class="kw">def</span> test_patient_normalise(test, expected, expect_raises):</span>
<span id="cb13-34"><a href="#cb13-34" tabindex="-1"></a>    <span class="co">"""Test normalisation works for arrays of one and positive integers."""</span></span>
<span id="cb13-35"><a href="#cb13-35" tabindex="-1"></a>    <span class="cf">if</span> <span class="bu">isinstance</span>(test, <span class="bu">list</span>):</span>
<span id="cb13-36"><a href="#cb13-36" tabindex="-1"></a>        test <span class="op">=</span> np.array(test)</span>
<span id="cb13-37"><a href="#cb13-37" tabindex="-1"></a>    <span class="cf">if</span> expect_raises <span class="kw">is</span> <span class="kw">not</span> <span class="va">None</span>:</span>
<span id="cb13-38"><a href="#cb13-38" tabindex="-1"></a>        <span class="cf">with</span> pytest.raises(expect_raises, match<span class="op">=</span><span class="bu">str</span>(expect_raises)):</span>
<span id="cb13-39"><a href="#cb13-39" tabindex="-1"></a>          patient_normalise(test)</span>
<span id="cb13-40"><a href="#cb13-40" tabindex="-1"></a></span>
<span id="cb13-41"><a href="#cb13-41" tabindex="-1"></a>    <span class="cf">else</span>:</span>
<span id="cb13-42"><a href="#cb13-42" tabindex="-1"></a>        result <span class="op">=</span> patient_normalise(test)</span>
<span id="cb13-43"><a href="#cb13-43" tabindex="-1"></a>        npt.assert_allclose(result, np.array(expected), rtol<span class="op">=</span><span class="fl">1e-2</span>, atol<span class="op">=</span><span class="fl">1e-2</span>)</span>
<span id="cb13-44"><a href="#cb13-44" tabindex="-1"></a>...</span></code></pre>
</div>
<p>Note the conversion from <code>list</code> to <code>np.array</code>
has been moved out of the call to <code>npt.assert_allclose()</code>
within the test function, and is now only applied to list items (rather
than all items). This allows for greater flexibility with our test
inputs, since this wouldn’t work in the test case that uses a
string.</p>
</div>
</div>
</div>
</div>
<p>If you do the challenge, again, be sure to commit your changes and
push them to GitHub.</p>
<p>You should not take it too far by trying to code preconditions for
every conceivable eventuality. You should aim to strike a balance
between making sure you secure your function against incorrect use, and
writing an overly complicated and expensive function that handles cases
that are likely never going to occur. For example, it would be sensible
to validate the shape of your inflammation data array when it is
actually read from the csv file (in <code>load_csv</code>), and
therefore there is no reason to test this again in
<code>patient_normalise</code>. You can also decide against adding
explicit preconditions in your code, and instead state the assumptions
and limitations of your code for users of your code in the docstring and
rely on them to invoke your code correctly. This approach is useful when
explicitly checking the precondition is too costly.</p>
</section><section><h2 class="section-heading" id="improving-robustness-with-automated-code-style-checks">Improving Robustness with Automated Code Style Checks<a class="anchor" aria-label="anchor" href="#improving-robustness-with-automated-code-style-checks"></a>
</h2>
<hr class="half-width">
<p>Let us re-run Pylint over our project after having added some more
code to it. From the project root do:</p>
<div class="codewrapper sourceCode" id="cb14">
<h3 class="code-label">BASH<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="sourceCode bash" tabindex="0"><code class="sourceCode bash"><span id="cb14-1"><a href="#cb14-1" tabindex="-1"></a><span class="ex">$</span> pylint inflammation</span></code></pre>
</div>
<p>You may see something like the following in Pylint’s output:</p>
<div class="codewrapper sourceCode" id="cb15">
<h3 class="code-label">BASH<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="sourceCode bash" tabindex="0"><code class="sourceCode bash"><span id="cb15-1"><a href="#cb15-1" tabindex="-1"></a><span class="ex">*************</span> Module inflammation.models</span>
<span id="cb15-2"><a href="#cb15-2" tabindex="-1"></a><span class="ex">...</span></span>
<span id="cb15-3"><a href="#cb15-3" tabindex="-1"></a><span class="ex">inflammation/models.py:60:4:</span> W0622: Redefining built-in <span class="st">'max'</span> <span class="er">(</span><span class="ex">redefined-builtin</span><span class="kw">)</span></span>
<span id="cb15-4"><a href="#cb15-4" tabindex="-1"></a><span class="ex">...</span></span></code></pre>
</div>
<p>The above output indicates that by using the local variable called
<code>max</code> in the <code>patient_normalise</code> function, we have
redefined a built-in Python function called <code>max</code>. This is
not a good idea and may have some undesired effects (e.g. if you
redefine a built-in name in a global scope you may cause yourself some
trouble which may be difficult to trace).</p>
<div id="exercise-fix-code-style-errors" class="callout discussion">
<div class="callout-square">
<i class="callout-icon" data-feather="message-circle"></i>
</div>
<div id="exercise-fix-code-style-errors" class="callout-inner">
<h3 class="callout-title">Exercise: Fix Code Style Errors</h3>
<div class="callout-content">
<p>Rename our local variable <code>max</code> to something else
(e.g. call it <code>max_data</code>), then rerun your tests and commit
these latest changes and push them to GitHub using our usual feature
branch workflow.</p>
</div>
</div>
</div>
<p>It may be hard to remember to run linter tools every now and then.
Luckily, we can now add this Pylint execution to our continuous
integration builds as one of the extra tasks. To add Pylint to our CI
workflow, we can add the following step to our <code>steps</code> in
<code>.github/workflows/main.yml</code>:</p>
<div class="codewrapper sourceCode" id="cb16">
<h3 class="code-label">BASH<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="sourceCode bash" tabindex="0"><code class="sourceCode bash"><span id="cb16-1"><a href="#cb16-1" tabindex="-1"></a><span class="ex">...</span></span>
<span id="cb16-2"><a href="#cb16-2" tabindex="-1"></a>    <span class="ex">-</span> name: Check style with Pylint</span>
<span id="cb16-3"><a href="#cb16-3" tabindex="-1"></a>      <span class="ex">run:</span> <span class="kw">|</span></span>
<span id="cb16-4"><a href="#cb16-4" tabindex="-1"></a>        <span class="ex">python3</span> <span class="at">-m</span> pylint <span class="at">--fail-under</span><span class="op">=</span>0 <span class="at">--reports</span><span class="op">=</span>y inflammation</span>
<span id="cb16-5"><a href="#cb16-5" tabindex="-1"></a><span class="ex">...</span></span></code></pre>
</div>
<p>Note we need to add <code>--fail-under=0</code> otherwise the builds
will fail if we do not get a ‘perfect’ score of 10! This seems unlikely,
so let us be more pessimistic. We have also added
<code>--reports=y</code> which will give us a more detailed report of
the code analysis.</p>
<p>Then we can just add this to our repo and trigger a build:</p>
<div class="codewrapper sourceCode" id="cb17">
<h3 class="code-label">BASH<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="sourceCode bash" tabindex="0"><code class="sourceCode bash"><span id="cb17-1"><a href="#cb17-1" tabindex="-1"></a><span class="ex">$</span> git add .github/workflows/main.yml</span>
<span id="cb17-2"><a href="#cb17-2" tabindex="-1"></a><span class="ex">$</span> git commit <span class="at">-m</span> <span class="st">"Add Pylint run to build"</span></span>
<span id="cb17-3"><a href="#cb17-3" tabindex="-1"></a><span class="ex">$</span> git push origin test-suite</span></code></pre>
</div>
<p>Then once complete, under the build(s) reports you should see an
entry with the output from Pylint as before, but with an extended
breakdown of the infractions by category as well as other metrics for
the code, such as the number and line percentages of code, docstrings,
comments, and empty lines.</p>
<p>So we specified a score of 0 as a minimum which is very low. If we
decide as a team on a suitable minimum score for our codebase, we can
specify this instead. There are also ways to specify specific style
rules that shouldn’t be broken which will cause Pylint to fail, which
could be even more useful if we want to mandate a consistent style.</p>
<p>We can specify overrides to Pylint’s rules in a file called
<code>.pylintrc</code> which Pylint can helpfully generate for us. In
our repository root directory:</p>
<div class="codewrapper sourceCode" id="cb18">
<h3 class="code-label">BASH<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="sourceCode bash" tabindex="0"><code class="sourceCode bash"><span id="cb18-1"><a href="#cb18-1" tabindex="-1"></a><span class="ex">$</span> pylint <span class="at">--generate-rcfile</span> <span class="op">&gt;</span> .pylintrc</span></code></pre>
</div>
<p>Looking at this file, you’ll see it is already pre-populated. No
behaviour is currently changed from the default by generating this file,
but we can amend it to suit our team’s coding style. For example, a
typical rule to customise - favoured by many projects - is the one
involving line length. You’ll see it is set to 100, so let us set that
to a more reasonable 120. While we are at it, let us also set our
<code>fail-under</code> in this file:</p>
<div class="codewrapper sourceCode" id="cb19">
<h3 class="code-label">BASH<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="sourceCode bash" tabindex="0"><code class="sourceCode bash"><span id="cb19-1"><a href="#cb19-1" tabindex="-1"></a><span class="ex">...</span></span>
<span id="cb19-2"><a href="#cb19-2" tabindex="-1"></a><span class="co"># Specify a score threshold to be exceeded before program exits with error.</span></span>
<span id="cb19-3"><a href="#cb19-3" tabindex="-1"></a><span class="ex">fail-under=0</span></span>
<span id="cb19-4"><a href="#cb19-4" tabindex="-1"></a><span class="ex">...</span></span>
<span id="cb19-5"><a href="#cb19-5" tabindex="-1"></a><span class="co"># Maximum number of characters on a single line.</span></span>
<span id="cb19-6"><a href="#cb19-6" tabindex="-1"></a><span class="ex">max-line-length=120</span></span>
<span id="cb19-7"><a href="#cb19-7" tabindex="-1"></a><span class="ex">...</span></span></code></pre>
</div>
<p>do not forget to remove the <code>--fail-under</code> argument to
Pytest in our GitHub Actions configuration file too, since we do not
need it anymore.</p>
<p>Now when we run Pylint we will not be penalised for having a
reasonable line length. For some further hints and tips on how to
approach using Pylint for a project, see <a href="https://pythonspeed.com/articles/pylint/" class="external-link">this article</a>.</p>
</section><section><h2 class="section-heading" id="merging-to-develop-branch">Merging to <code>develop</code> Branch<a class="anchor" aria-label="anchor" href="#merging-to-develop-branch"></a>
</h2>
<hr class="half-width">
<p>Now we are happy with our test suite, we can merge this work (which
currently only exist on our <code>test-suite</code> branch) with our
parent <code>develop</code> branch. Again, this reflects us working with
impunity on a logical unit of work, involving multiple commits, on a
separate feature branch until it is ready to be escalated to the
<code>develop</code> branch.</p>
<p>Be sure to commit all your changes to <code>test-suite</code> and
then merge to the <code>develop</code> branch in the usual manner.</p>
<div class="codewrapper sourceCode" id="cb20">
<h3 class="code-label">BASH<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="sourceCode bash" tabindex="0"><code class="sourceCode bash"><span id="cb20-1"><a href="#cb20-1" tabindex="-1"></a><span class="ex">$</span> git switch develop</span>
<span id="cb20-2"><a href="#cb20-2" tabindex="-1"></a><span class="ex">$</span> git merge test-suite</span></code></pre>
</div>
<p>Then, assuming there are no conflicts, we can push these changes back
to the remote repository as we have done before:</p>
<div class="codewrapper sourceCode" id="cb21">
<h3 class="code-label">BASH<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="sourceCode bash" tabindex="0"><code class="sourceCode bash"><span id="cb21-1"><a href="#cb21-1" tabindex="-1"></a><span class="ex">$</span> git push origin develop</span></code></pre>
</div>
<p>Now these changes have migrated to our parent <code>develop</code>
branch, <code>develop</code> will also inherit the configuration to run
CI builds, so these will run automatically on this branch as well.</p>
<p>This highlights a big benefit of CI when you perform merges (and
apply pull requests). As new branch code is merged into upstream
branches like <code>develop</code> and <code>main</code> these newly
integrated code changes are automatically tested <em>together</em> with
existing code - which of course may also have been changed by other
developers working on the code at the same time.</p>
<div id="keypoints1" class="callout keypoints">
<div class="callout-square">
<i class="callout-icon" data-feather="key"></i>
</div>
<div class="callout-inner">
<h3 class="callout-title">Key Points</h3>
<div class="callout-content">
<ul>
<li>Unit testing can show us what does not work, but does not help us
locate problems in code.</li>
<li>Use a <strong>debugger</strong> to help you locate problems in
code.</li>
<li>A <strong>debugger</strong> allows us to pause code execution and
examine its state by adding <strong>breakpoints</strong> to lines in
code.</li>
<li>Use <strong>preconditions</strong> to ensure correct behaviour of
code.</li>
<li>Ensure that unit tests check for <strong>edge</strong> and
<strong>corner cases</strong> too.</li>
<li>Using linting tools to automatically flag suspicious programming
language constructs and stylistic errors can help improve code
robustness.</li>
</ul>
</div>
</div>
</div>
</section></section><section id="aio-25-section2-optional-exercises"><p>Content from <a href="25-section2-optional-exercises.html">2.5 Optional Exercises for Section 2</a></p>
<hr>
<p>Last updated on 2024-12-06 |

        <a href="https://github.com/carpentries-incubator/python-intermediate-development/edit/main/episodes/25-section2-optional-exercises.md" class="external-link">Edit this page <i aria-hidden="true" data-feather="edit"></i></a></p>
<p>Estimated time: <i aria-hidden="true" data-feather="clock"></i> 45 minutes</p>
<div class="text-end">
          <button role="button" aria-pressed="false" tabindex="0" id="expand-code" class="pull-right" data-expand="Expand All Solutions " data-collapse="Collapse All Solutions "> Expand All Solutions <i aria-hidden="true" data-feather="plus"></i></button>
        </div>
<div class="overview card">
<h2 class="card-header">Overview</h2>
<div class="row g-0">
<div class="col-md-4">
<div class="card-body">
<div class="inner">
<h3 class="card-title">Questions</h3>
<ul>
<li>What is a desirable way to measure and use test coverage?</li>
</ul>
</div>
</div>
</div>
<div class="col-md-8">
<div class="card-body">
<div class="inner bordered">
<h3 class="card-title">Objectives</h3>
<ul>
<li>Further explore how to measure and use test coverage.</li>
</ul>
</div>
</div>
</div>
</div>
</div>
<p>This episode holds some optional exercises for section 2. The
exercises have an explorative nature, so feel free to go off in any
direction that interests you. You will be looking at some tools that
either complement or are alternatives to those already introduced. Even
if you find something that you really like, we still recommend sticking
with the tools that were introduced prior to this episode when you move
onto other sections of the course.</p>
<div id="exercise-apply-to-your-own-projects" class="callout discussion">
<div class="callout-square">
<i class="callout-icon" data-feather="message-circle"></i>
</div>
<div id="exercise-apply-to-your-own-projects" class="callout-inner">
<h3 class="callout-title">Exercise: Apply to your own project(s)</h3>
<div class="callout-content">
<p>Apply what you learned in this section to your own project(s). You
can think of adding unit tests, add continuous integration pipelines, or
measure the test coverage of your project(s) This is the time to ask any
questions to your instructors or helpers.</p>
</div>
</div>
</div>
<div id="exercise-branch-coverage-versus-line-coverage" class="callout discussion">
<div class="callout-square">
<i class="callout-icon" data-feather="message-circle"></i>
</div>
<div id="exercise-branch-coverage-versus-line-coverage" class="callout-inner">
<h3 class="callout-title">Exercise: Branch coverage versus line
coverage</h3>
<div class="callout-content">
<p>For your test coverage, have a look at the concept of <a href="https://about.codecov.io/blog/line-or-branch-coverage-which-type-is-right-for-you/" class="external-link">branch
coverage</a> as opposed to just line coverage. Which do you prefer and
why?</p>
</div>
</div>
</div>
<div id="exercise-desirable-test-coverage" class="callout discussion">
<div class="callout-square">
<i class="callout-icon" data-feather="message-circle"></i>
</div>
<div id="exercise-desirable-test-coverage" class="callout-inner">
<h3 class="callout-title">Exercise: Desirable test coverage</h3>
<div class="callout-content">
<p>Look at the projects below and see how much test coverage they have.
Should 100% line (or branch) coverage always be the goal? Why or why
not?</p>
<ul>
<li><a href="https://github.com/pytest-dev/pytest" class="external-link">pytest</a></li>
<li><a href="https://github.com/pyjokes/pyjokes" class="external-link">pyjokes</a></li>
<li><a href="https://github.com/scikit-learn/scikit-learn" class="external-link">scikit-learn</a></li>
</ul>
</div>
</div>
</div>
<div id="exercise-coverage-badges" class="callout discussion">
<div class="callout-square">
<i class="callout-icon" data-feather="message-circle"></i>
</div>
<div id="exercise-coverage-badges" class="callout-inner">
<h3 class="callout-title">Exercise: Coverage badges</h3>
<div class="callout-content">
<p>Try to add a <a href="https://github.com/marketplace/actions/coverage-badge" class="external-link">coverage
badge</a> to the inflammation project.</p>
</div>
</div>
</div></section><section id="aio-30-section3-intro"><p>Content from <a href="30-section3-intro.html">Section 3: Software Development as a Process</a></p>
<hr>
<p>Last updated on 2024-12-06 |

        <a href="https://github.com/carpentries-incubator/python-intermediate-development/edit/main/episodes/30-section3-intro.md" class="external-link">Edit this page <i aria-hidden="true" data-feather="edit"></i></a></p>
<p>Estimated time: <i aria-hidden="true" data-feather="clock"></i> 10 minutes</p>
<div class="text-end">
          <button role="button" aria-pressed="false" tabindex="0" id="expand-code" class="pull-right" data-expand="Expand All Solutions " data-collapse="Collapse All Solutions "> Expand All Solutions <i aria-hidden="true" data-feather="plus"></i></button>
        </div>
<div class="overview card">
<h2 class="card-header">Overview</h2>
<div class="row g-0">
<div class="col-md-4">
<div class="card-body">
<div class="inner">
<h3 class="card-title">Questions</h3>
<ul>
<li>How can we design and write ‘good’ software that meets its goals and
requirements?</li>
</ul>
</div>
</div>
</div>
<div class="col-md-8">
<div class="card-body">
<div class="inner bordered">
<h3 class="card-title">Objectives</h3>
<ul>
<li>Describe the differences between writing code and engineering
software.</li>
<li>Define the fundamental stages in a software development
process.</li>
<li>List the benefits of following a process of software
development.</li>
</ul>
</div>
</div>
</div>
</div>
</div>
<p>In this section, we will take a step back from coding development
practices and tools and look at the bigger picture of software as a
<em>process</em> of development.</p>
<blockquote>
<p><em>“If you fail to plan, you are planning to fail.”</em></p>
<p>— Benjamin Franklin</p>
</blockquote>
<figure><img src="../fig/section3-overview.svg" alt="Software design and architecture overview flowchart" class="figure mx-auto d-block"></figure><section><h2 class="section-heading" id="writing-code-vs-engineering-software">Writing Code vs Engineering Software<a class="anchor" aria-label="anchor" href="#writing-code-vs-engineering-software"></a>
</h2>
<hr class="half-width">
<p>Traditionally in academia, software - and the process of writing it -
is often seen as a necessary but throwaway artefact in research. For
example, there may be research questions for a given research project,
code is created to answer those questions, the code is run over some
data and analysed, and finally a publication is written based on those
results. These steps are often taken informally.</p>
<p>The terms <em>programming</em> (or even <em>coding</em>) and
<em>software engineering</em> are often used interchangeably. They are
not. Programmers or coders tend to focus on one part of software
development: implementation, more than any other. In academic research,
often they are writing software for themselves, where they are their own
stakeholders. And ideally, they write software from a design, that
fulfils a research goal to publish research papers.</p>
<p>Someone who is engineering software takes a wider view:</p>
<ul>
<li>The <em>lifecycle</em> of software: recognises that software
development is a <em>process</em> that proceeds from understanding what
is needed, to writing the software and using/releasing it, to what
happens afterwards.</li>
<li>Who will (or may) be involved: software is written for
<em>stakeholders</em>. This may only be the researcher initially, but
there is an understanding that others may become involved later (even if
that is not evident yet). A good rule of thumb is to always assume that
code will be read and used by others later on, which includes
yourself!</li>
<li>Software (or code) is an asset: software inherently contains value -
for example, in terms of what it can do, the lessons learned throughout
its development, and as an implementation of a research approach (i.e. a
particular research algorithm, process, or technical approach).</li>
<li>As an asset, it could be reused: again, it may not be evident
initially that the software will have use beyond its initial purpose or
project, but there is an assumption that the software - or even just a
part of it - could be reused in the future.</li>
</ul></section><section><h2 class="section-heading" id="software-development-process">Software Development Process<a class="anchor" aria-label="anchor" href="#software-development-process"></a>
</h2>
<hr class="half-width">
<p>The typical stages of a software development process can be
categorised as follows:</p>
<ul>
<li>
<strong>Requirements gathering:</strong> the process of identifying
and recording the exact requirements for a software project before it
begins. This helps maintain a clear direction throughout development,
and sets clear targets for what the software needs to do.</li>
<li>
<strong>Design:</strong> where the requirements are translated into
an overall design for the software. It covers what will be the basic
software ‘components’ and how they will fit together, as well as the
tools and technologies that will be used, which will together address
the requirements identified in the first stage.</li>
<li>
<strong>Implementation:</strong> the software is developed according
to the design, implementing the solution that meets the requirements set
out in the requirements gathering stage.</li>
<li>
<strong>Testing:</strong> the software is tested with the intent to
discover and rectify any defects, and also to ensure that the software
meets its defined requirements, i.e. does it actually do what it should
do reliably?</li>
<li>
<strong>Deployment:</strong> where the software is deployed or in
some way released, and used for its intended purpose within its intended
environment.</li>
<li>
<strong>Maintenance:</strong> where updates are made to the software
to ensure it remains fit for purpose, which typically involves fixing
any further discovered issues and evolving it to meet new or changing
requirements.</li>
</ul>
<p>The process of following these stages, particularly when undertaken
in this order, is referred to as the <em>waterfall</em> model of
software development: each stage’s outputs flow into the next stage
sequentially.</p>
<p>Whether projects or people that develop software are aware of them or
not, these stages are followed implicitly or explicitly in every
software project. What is required for a project (during requirements
gathering) is always considered, for example, even if it is not explored
sufficiently or well understood.</p>
<p>Following a <strong>process</strong> of development offers some major
benefits:</p>
<ul>
<li>
<strong>Stage gating:</strong> a quality <em>gate</em> at the end of
each stage, where stakeholders review the stage’s outcomes to decide if
that stage has completed successfully before proceeding to the next one
(and even if the next stage is not warranted at all - for example, it
may be discovered during requirements of design that development of the
software is not practical or even required).</li>
<li>
<strong>Predictability:</strong> each stage is given attention in a
logical sequence; the next stage should not begin until prior stages
have completed. Returning to a prior stage is possible and may be
needed, but may prove expensive, particularly if an implementation has
already been attempted. However, at least this is an explicit and
planned action.</li>
<li>
<strong>Transparency:</strong> essentially, each stage generates
output(s) into subsequent stages, which presents opportunities for them
to be published as part of an open development process.</li>
<li>
<strong>Time saving:</strong> a well-known result from <a href="https://web.archive.org/web/20160731150816/http://superwebdeveloper.com/2009/11/25/the-incredible-rate-of-diminishing-returns-of-fixing-software-bugs/" class="external-link">empirical
software engineering studies</a> is that fixing software mistakes is
exponentially more expensive in later software development stages. For
example, if a mistake takes 1 hour to fix in the requirements stage, it
may take 5 times that during design, and perhaps as much as 20 times
that to fix if discovered during testing.</li>
</ul>
<p>In this section we will place the actual writing of software
(implementation) within the context of a typical software development
process:</p>
<ul>
<li>Explore the <strong>importance of software requirements</strong>,
different classes of requirements, and how we can interpret and capture
them.</li>
<li>How requirements inform and drive the <strong>design of
software</strong>, the importance, role, and examples of
<strong>software architecture</strong>, and the ways we can describe a
software design.</li>
<li>How to <strong>improve</strong> existing code to be more
<strong>readable</strong>, <strong>testable</strong> and
<strong>maintainable</strong>.</li>
<li>Consider different strategies for writing well designed code,
including using <strong>pure functions</strong>,
<strong>classes</strong> and <strong>abstractions</strong>.</li>
<li>How to create, assess and improve <strong>software
design</strong>.</li>
</ul>
<div id="keypoints1" class="callout keypoints">
<div class="callout-square">
<i class="callout-icon" data-feather="key"></i>
</div>
<div class="callout-inner">
<h3 class="callout-title">Key Points</h3>
<div class="callout-content">
<ul>
<li>Software engineering takes a wider view of software development
beyond programming (or coding).</li>
<li>Ensuring requirements are sufficiently captured is critical to the
success of any project.</li>
<li>Following a process makes software development predictable, saves
time in the long run, and helps ensure each stage of development is
given sufficient consideration before proceeding to the next.</li>
<li>Once you get the hang of a programming language, writing code to do
what you want is relatively easy. The hard part is writing code that is
easy to adapt when your requirements change.</li>
</ul>
</div>
</div>
</div>
</section></section><section id="aio-31-software-requirements"><p>Content from <a href="31-software-requirements.html">3.1 Software Requirements</a></p>
<hr>
<p>Last updated on 2025-02-25 |

        <a href="https://github.com/carpentries-incubator/python-intermediate-development/edit/main/episodes/31-software-requirements.md" class="external-link">Edit this page <i aria-hidden="true" data-feather="edit"></i></a></p>
<p>Estimated time: <i aria-hidden="true" data-feather="clock"></i> 40 minutes</p>
<div class="text-end">
          <button role="button" aria-pressed="false" tabindex="0" id="expand-code" class="pull-right" data-expand="Expand All Solutions " data-collapse="Collapse All Solutions "> Expand All Solutions <i aria-hidden="true" data-feather="plus"></i></button>
        </div>
<div class="overview card">
<h2 class="card-header">Overview</h2>
<div class="row g-0">
<div class="col-md-4">
<div class="card-body">
<div class="inner">
<h3 class="card-title">Questions</h3>
<ul>
<li>Where do we start when beginning a new software project?</li>
<li>How can we capture and organise what is required for software to
function as intended?</li>
</ul>
</div>
</div>
</div>
<div class="col-md-8">
<div class="card-body">
<div class="inner bordered">
<h3 class="card-title">Objectives</h3>
<ul>
<li>Describe the different types of software requirements.</li>
<li>Explain the difference between functional and non-functional
requirements.</li>
<li>Describe some of the different kinds of software and explain how the
environment in which software is used constrains its design.</li>
<li>Derive new user and solution requirements from business
requirements.</li>
</ul>
</div>
</div>
</div>
</div>
</div>
<section><h2 class="section-heading" id="introduction">Introduction<a class="anchor" aria-label="anchor" href="#introduction"></a>
</h2>
<hr class="half-width">
<p>The requirements of our software are the basis on which the whole
project rests - if we get the requirements wrong, we will build the
wrong software. However, it is unlikely that we will be able to
determine all of the requirements upfront. Especially when working in a
research context, requirements are flexible and may change as we develop
our software.</p>
<div id="activate-your-virtual-environment" class="callout">
<div class="callout-square">
<i class="callout-icon" data-feather="bell"></i>
</div>
<div id="activate-your-virtual-environment" class="callout-inner">
<h3 class="callout-title">Activate your virtual environment</h3>
<div class="callout-content">
<p>If it is not already active, make sure to activate your virtual
environment, called <code>venv</code>, from the root of the software
project directory:</p>
<div class="codewrapper sourceCode" id="cb1">
<h3 class="code-label">BASH<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="sourceCode bash" tabindex="0"><code class="sourceCode bash"><span id="cb1-1"><a href="#cb1-1" tabindex="-1"></a><span class="ex">$</span> source venv/bin/activate <span class="co"># Mac or Linux</span></span>
<span id="cb1-2"><a href="#cb1-2" tabindex="-1"></a><span class="ex">$</span> source venv/Scripts/activate <span class="co"># Windows</span></span>
<span id="cb1-3"><a href="#cb1-3" tabindex="-1"></a><span class="kw">(</span><span class="ex">venv</span><span class="kw">)</span> <span class="ex">$</span></span></code></pre>
</div>
</div>
</div>
</div>
</section><section><h2 class="section-heading" id="types-of-requirements">Types of Requirements<a class="anchor" aria-label="anchor" href="#types-of-requirements"></a>
</h2>
<hr class="half-width">
<p>Requirements can be categorised in many ways, but at a high level a
useful way to split them is into <em>business requirements</em>,
<em>user requirements</em>, and <em>solution requirements</em>. Let us
take a look at these now.</p>
<div class="section level3">
<h3 id="business-requirements">Business Requirements<a class="anchor" aria-label="anchor" href="#business-requirements"></a>
</h3>
<p>Business requirements describe what is needed from the perspective of
the organisation, and define the strategic path of the project, e.g. to
increase profit margin or market share, or embark on a new research area
or collaborative partnership. These are captured in something like a
Business Requirements Specification.</p>
<p>For adapting our inflammation software project, example business
requirements could include:</p>
<ul>
<li>BR1: improving the statistical quality of clinical trial reporting
to meet the needs of external audits</li>
<li>BR2: increasing the throughput of trial analyses to meet higher
demand during peak periods</li>
</ul>
<div id="exercise-new-business-requirements" class="callout challenge">
<div class="callout-square">
<i class="callout-icon" data-feather="zap"></i>
</div>
<div id="exercise-new-business-requirements" class="callout-inner">
<h3 class="callout-title">Exercise: New Business Requirements</h3>
<div class="callout-content">
<p>Think of a new hypothetical business-level requirements for this
software. This can be anything you like, but be sure to keep it at the
high-level of the business itself.</p>
</div>
</div>
</div>
<div id="accordionSolution1" class="accordion challenge-accordion accordion-flush">
<div class="accordion-item">
<button class="accordion-button solution-button collapsed" type="button" data-bs-toggle="collapse" data-bs-target="#collapseSolution1" aria-expanded="false" aria-controls="collapseSolution1">
  <h4 class="accordion-header" id="headingSolution1"> Show me the solution </h4>
</button>
<div id="collapseSolution1" class="accordion-collapse collapse" aria-labelledby="headingSolution1" data-bs-parent="#accordionSolution1">
<div class="accordion-body">
<p>One hypothetical new business requirement (BR3) could be extending
our clinical trial system to keep track of doctors who are being
involved in the project.</p>
<p>Another hypothetical new business requirement (BR4) may be adding a
new parameter to the treatment and checking if it improves the effect of
the drug being tested - e.g. taking it in conjunction with omega-3 fatty
acids and/or increasing physical activity while taking the drug
therapy.</p>
</div>
</div>
</div>
</div>
</div>
<div class="section level3">
<h3 id="user-or-stakeholder-requirements">User (or Stakeholder) Requirements<a class="anchor" aria-label="anchor" href="#user-or-stakeholder-requirements"></a>
</h3>
<p>These define what particular stakeholder groups each expect from an
eventual solution, essentially acting as a bridge between the
higher-level business requirements and specific solution requirements.
These are typically captured in a User Requirements Specification.</p>
<p>For our inflammation project, they could include things for trial
managers such as (building on the business requirements):</p>
<ul>
<li>UR1.1 (from BR1): add support for statistical measures in generated
trial reports as required by revised auditing standards (standard
deviation, …)</li>
<li>UR1.2 (from BR1): add support for producing textual representations
of statistics in trial reports as required by revised auditing
standards</li>
<li>UR2.1 (from BR2): ability to have an individual trial report
processed and generated in under 30 seconds (if we assume it usually
takes longer than that)</li>
</ul>
<div id="exercise-new-user-requirements" class="callout challenge">
<div class="callout-square">
<i class="callout-icon" data-feather="zap"></i>
</div>
<div id="exercise-new-user-requirements" class="callout-inner">
<h3 class="callout-title">Exercise: New User Requirements</h3>
<div class="callout-content">
<p>Break down your new business requirements from the <a href="31-software-requirements.html">previous exercise</a> into a number
of logical user requirements, ensuring they stay above the level and
detail of implementation.</p>
</div>
</div>
</div>
<div id="accordionSolution2" class="accordion challenge-accordion accordion-flush">
<div class="accordion-item">
<button class="accordion-button solution-button collapsed" type="button" data-bs-toggle="collapse" data-bs-target="#collapseSolution2" aria-expanded="false" aria-controls="collapseSolution2">
  <h4 class="accordion-header" id="headingSolution2"> Show me the solution </h4>
</button>
<div id="collapseSolution2" class="accordion-collapse collapse" aria-labelledby="headingSolution2" data-bs-parent="#accordionSolution2">
<div class="accordion-body">
<p>For our business requirement BR3 from the previous exercise, the new
user/stakeholder requirements may be the ability to see all the patients
a doctor is being responsible for (UR3.1), and to find out a doctor
looking after any individual patient (UR3.2).</p>
<p>For our business requirement BR4 from the previous exercise, the new
user/stakeholder requirements may be the ability to see the effect of
the drug with and without the additional parameters in all reports and
graphs (UR4.1).</p>
</div>
</div>
</div>
</div>
</div>
<div class="section level3">
<h3 id="solution-requirements">Solution Requirements<a class="anchor" aria-label="anchor" href="#solution-requirements"></a>
</h3>
<p>Solution (or product) requirements describe characteristics that
software must have to satisfy the stakeholder requirements. They fall
into two key categories:</p>
<ul>
<li>
<em>Functional requirements</em> focus on functions and features of
a solution. For our software, building on our user requirements, e.g.:
<ul>
<li>SR1.1.1 (from UR1.1): add standard deviation to data model and
include a graph visualisation view</li>
<li>SR1.2.1 (from UR1.2): add a new view to generate a textual
representation of statistics, which is invoked by an optional command
line argument</li>
</ul>
</li>
<li>
<em>Non-functional requirements</em> focus on <em>how</em> the
behaviour of a solution is expressed or constrained, e.g. performance,
security, usability, or portability. These are also known as <em>quality
of service</em> requirements. For our project, e.g.:
<ul>
<li>SR2.1.1 (from UR2.1): generate graphical statistics report on
clinical workstation configuration in under 30 seconds</li>
</ul>
</li>
</ul>
<div id="labelling-requirements" class="callout">
<div class="callout-square">
<i class="callout-icon" data-feather="bell"></i>
</div>
<div id="labelling-requirements" class="callout-inner">
<h3 class="callout-title">Labelling Requirements</h3>
<div class="callout-content">
<p>Note that the naming scheme we used for labelling our requirements is
quite arbitrary - you should reference them in a way that is consistent
and makes sense within your project and team.</p>
</div>
</div>
</div>
<div class="section level4">
<h4 id="the-importance-of-non-functional-requirements">The Importance of Non-functional Requirements<a class="anchor" aria-label="anchor" href="#the-importance-of-non-functional-requirements"></a>
</h4>
<p>When considering software requirements, it is <em>very</em> tempting
to just think about the features users need. However, many design
choices in a software project quite rightly depend on the users
themselves and the environment in which the software is expected to run,
and these aspects should be considered as part of the software’s
non-functional requirements.</p>
<div id="exercise-types-of-software" class="callout challenge">
<div class="callout-square">
<i class="callout-icon" data-feather="zap"></i>
</div>
<div id="exercise-types-of-software" class="callout-inner">
<h3 class="callout-title">Exercise: Types of Software</h3>
<div class="callout-content">
<p>Think about some software you are familiar with (could be software
you have written yourself or by someone else) and how the environment it
is used in have affected its design or development. Here are some
examples of questions you can use to get started:</p>
<ul>
<li>What environment does the software run in?</li>
<li>How do people interact with it?</li>
<li>Why do people use it?</li>
<li>What features of the software have been affected by these
factors?</li>
<li>If the software needed to be used in a different environment, what
difficulties might there be?</li>
</ul>
<p>Some examples of design / development choices constrained by
environment might be:</p>
<ul>
<li>Mobile Apps
<ul>
<li>Must have graphical interface suitable for a touch display</li>
<li>Usually distributed via a controlled app store</li>
<li>Users will not (usually) modify / compile the software
themselves</li>
<li>Should work on a range of hardware specifications with a range of
Operating System (OS) versions
<ul>
<li>But OS is unlikely to be anything other than Android or iOS</li>
</ul>
</li>
<li>Documentation probably in the software itself or on a Web page</li>
<li>Typically written in one of the platform preferred languages
(e.g. Java, Kotlin, Swift)</li>
</ul>
</li>
<li>Embedded Software
<ul>
<li>May have no user interface - user interface may be physical
buttons</li>
<li>Usually distributed pre-installed on a physical device</li>
<li>Often runs on low power device with limited memory and CPU
performance - must take care to use these resources efficiently</li>
<li>Exact specification of hardware is known - often not necessary to
support multiple devices</li>
<li>Documentation probably in a technical manual with a separate user
manual</li>
<li>May need to run continuously for the lifetime of the device</li>
<li>Typically written in a lower-level language (e.g. C) for better
control of resources</li>
</ul>
</li>
</ul>
</div>
</div>
</div>
<div id="accordionSolution3" class="accordion challenge-accordion accordion-flush">
<div class="accordion-item">
<button class="accordion-button solution-button collapsed" type="button" data-bs-toggle="collapse" data-bs-target="#collapseSolution3" aria-expanded="false" aria-controls="collapseSolution3">
  <h4 class="accordion-header" id="headingSolution3"> Some More Examples </h4>
</button>
<div id="collapseSolution3" class="accordion-collapse collapse" aria-labelledby="headingSolution3" data-bs-parent="#accordionSolution3">
<div class="accordion-body">
<ul>
<li>Desktop Application
<ul>
<li>Has a graphical interface for use with mouse and keyboard</li>
<li>May need to work on multiple, very different operating systems</li>
<li>May be intended for users to modify / compile themselves</li>
<li>Should work on a wide range of hardware configurations</li>
<li>Documentation probably either in a manual or in the software
itself</li>
</ul>
</li>
<li>Command-line Application - UNIX Tool
<ul>
<li>User interface is text based, probably via command-line
arguments</li>
<li>Intended to be modified / compiled by users - though most will
choose not to</li>
<li>Documentation has standard formats - also accessible from the
command line</li>
<li>Should be usable as part of a pipeline</li>
</ul>
</li>
<li>Command-line Application - High Performance Computing
<ul>
<li>Similar to a UNIX Tool</li>
<li>Usually supports running across multiple networked machines
simultaneously</li>
<li>Usually operated via a scheduler - interface should be
scriptable</li>
<li>May need to run on a wide range of hardware (e.g. different CPU
architectures)</li>
<li>May need to process large amounts of data</li>
<li>Often entirely or partially written in a lower-level language for
performance (e.g. C, C++, Fortran)</li>
</ul>
</li>
<li>Web Application
<ul>
<li>Usually has components which run on server and components which run
on the user’s device</li>
<li>Graphical interface should usually support both Desktop and Mobile
devices</li>
<li>Client-side component should run on a range of browsers and
operating systems</li>
<li>Documentation probably part of the software itself</li>
<li>Client-side component typically written in JavaScript</li>
</ul>
</li>
</ul>
</div>
</div>
</div>
</div>
<div id="exercise-new-solution-requirements" class="callout challenge">
<div class="callout-square">
<i class="callout-icon" data-feather="zap"></i>
</div>
<div id="exercise-new-solution-requirements" class="callout-inner">
<h3 class="callout-title">Exercise: New Solution Requirements</h3>
<div class="callout-content">
<p>Now break down your new user requirements from the <a href="31-software-requirements.html">earlier exercise</a> into a number
of logical solution requirements (functional and non-functional), that
address the detail required to be able to implement them in the
software.</p>
</div>
</div>
</div>
<div id="accordionSolution4" class="accordion challenge-accordion accordion-flush">
<div class="accordion-item">
<button class="accordion-button solution-button collapsed" type="button" data-bs-toggle="collapse" data-bs-target="#collapseSolution4" aria-expanded="false" aria-controls="collapseSolution4">
  <h4 class="accordion-header" id="headingSolution4"> Show me the solution </h4>
</button>
<div id="collapseSolution4" class="accordion-collapse collapse" aria-labelledby="headingSolution4" data-bs-parent="#accordionSolution4">
<div class="accordion-body">
<p>For our new hypothetical business requirement BR3, new functional
solution requirements could be extending the clinical trial system to
keep track of:</p>
<ul>
<li>the names of all patients (SR3.1.1) and doctors (SR3.1.2) involved
in the trial</li>
<li>the name of the doctor for a particular patient (SR3.1.3)</li>
<li>a group of patients being administered by a particular doctor
(SR3.2.1).</li>
</ul>
</div>
</div>
</div>
</div>
<div id="optional-exercise-requirements-for-your-software-project" class="callout discussion">
<div class="callout-square">
<i class="callout-icon" data-feather="message-circle"></i>
</div>
<div id="optional-exercise-requirements-for-your-software-project" class="callout-inner">
<h3 class="callout-title">Optional Exercise: Requirements for Your Software Project</h3>
<div class="callout-content">
<p>Think back to a piece of code or software (either small or large) you
have written, or which you have experience using. First, try to
formulate a few of its key business requirements, then derive these into
user and then solution requirements.</p>
</div>
</div>
</div>
</div>
</div>
<div class="section level3">
<h3 id="long--or-short-lived-code">Long- or Short-Lived Code?<a class="anchor" aria-label="anchor" href="#long--or-short-lived-code"></a>
</h3>
<p>Along with requirements, here is something to consider early on. You,
perhaps with others, may be developing open-source software with the
intent that it will live on after your project completes. It could be
important to you that your software is adopted and used by other
projects as this may help you get future funding. It can make your
software more attractive to potential users if they have the confidence
that they can fix bugs that arise or add new features they need, if they
can be assured that the evolution of the software is not dependant upon
the lifetime of your project. The intended longevity and post-project
role of software should be reflected in its requirements - particularly
within its non-functional requirements - so be sure to consider these
aspects.</p>
<p>On the other hand, you might want to knock together some code to
prove a concept or to perform a quick calculation and then just discard
it. But can you be sure you will never want to use it again? Maybe a few
months from now you will realise you need it after all, or you’ll have a
colleague say “I wish I had a…” and realise you have already made one. A
little effort now could save you a lot in the future.</p>
</div>
</section><section><h2 class="section-heading" id="from-requirements-to-implementation-via-design">From Requirements to Implementation, via Design<a class="anchor" aria-label="anchor" href="#from-requirements-to-implementation-via-design"></a>
</h2>
<hr class="half-width">
<p>In practice, these different types of requirements are sometimes
confused and conflated when different classes of stakeholder are
discussing them, which is understandable: each group of stakeholders has
a different view of <em>what is required</em> from a project. The key is
to understand the stakeholder’s perspective as to how their requirements
should be classified and interpreted, and for that to be made explicit.
A related misconception is that each of these types are simply
requirements specified at different levels of detail. At each level, not
only are the perspectives different, but so are the nature of the
objectives and the language used to describe them, since they each
reflect the perspective and language of their stakeholder group.</p>
<p>It is often tempting to go right ahead and implement requirements
within existing software, but this neglects a crucial step: do these new
requirements fit within our existing design, or does our design need to
be revisited? It may not need any changes at all, but if it does not fit
logically our design will need a bigger rethink so the new requirement
can be implemented in a sensible way. We will look at this a bit later
in this section, but simply adding new code without considering how the
design and implementation need to change at a high level can make our
software increasingly messy and difficult to change in the future.</p>
<div id="keypoints1" class="callout keypoints">
<div class="callout-square">
<i class="callout-icon" data-feather="key"></i>
</div>
<div class="callout-inner">
<h3 class="callout-title">Key Points</h3>
<div class="callout-content">
<ul>
<li>When writing software used for research, requirements will almost
<em>always</em> change.</li>
<li>Consider non-functional requirements (<em>how</em> the software will
behave) as well as functional requirements (<em>what</em> the software
is supposed to do).</li>
<li>The environment in which users run our software has an effect on
many design choices we might make.</li>
<li>Consider the expected longevity of any code before you write
it.</li>
<li>The perspective and language of a particular requirement stakeholder
group should be reflected in requirements for that group.</li>
</ul>
</div>
</div>
</div>
</section></section><section id="aio-32-software-architecture-design"><p>Content from <a href="32-software-architecture-design.html">3.2 Software Architecture and Design</a></p>
<hr>
<p>Last updated on 2025-05-27 |

        <a href="https://github.com/carpentries-incubator/python-intermediate-development/edit/main/episodes/32-software-architecture-design.md" class="external-link">Edit this page <i aria-hidden="true" data-feather="edit"></i></a></p>
<p>Estimated time: <i aria-hidden="true" data-feather="clock"></i> 50 minutes</p>
<div class="text-end">
          <button role="button" aria-pressed="false" tabindex="0" id="expand-code" class="pull-right" data-expand="Expand All Solutions " data-collapse="Collapse All Solutions "> Expand All Solutions <i aria-hidden="true" data-feather="plus"></i></button>
        </div>
<div class="overview card">
<h2 class="card-header">Overview</h2>
<div class="row g-0">
<div class="col-md-4">
<div class="card-body">
<div class="inner">
<h3 class="card-title">Questions</h3>
<ul>
<li>Why should we invest time in software design?</li>
<li>What should we consider when designing software?</li>
<li>What is software architecture?</li>
</ul>
</div>
</div>
</div>
<div class="col-md-8">
<div class="card-body">
<div class="inner bordered">
<h3 class="card-title">Objectives</h3>
<ul>
<li>List the common aspects of software architecture and design.</li>
<li>Describe the term technical debt and how it impacts software.</li>
<li>Understand the goals and principles of designing ‘good’
software.</li>
<li>Use a diagramming technique to describe a software
architecture.</li>
<li>What are the components of Model-View-Controller (MVC)
architecture?</li>
<li>Understand the use of common design patterns to improve the
extensibility, reusability and overall quality of software.</li>
<li>List some best practices when designing software.</li>
</ul>
</div>
</div>
</div>
</div>
</div>
<section><h2 class="section-heading" id="introduction">Introduction<a class="anchor" aria-label="anchor" href="#introduction"></a>
</h2>
<hr class="half-width">
<p>Ideally, we should have at least a rough design of our software
sketched out before we write a single line of code. This design should
be based around the requirements and the structure of the problem we are
trying to solve: what are the concepts we need to represent in our code
and what are the relationships between them. And importantly, who will
be using our software and how will they interact with it.</p>
<p>As a piece of software grows, it will reach a point where there is
too much code for us to keep in mind at once. At this point, it becomes
particularly important to think of the overall design and structure of
our software, how should all the pieces of functionality fit together,
and how should we work towards fulfilling this overall design throughout
development. Even if you did not think about the design of your software
from the very beginning - it is not too late to start now.</p>
<p>It is not easy to come up with a complete definition for the term
<strong>software design</strong>, but some of the common aspects
are:</p>
<ul>
<li>
<strong>Software architecture</strong> - what components will the
software have and how will they cooperate?</li>
<li>
<strong>System architecture</strong> - what other things will this
software have to interact with and how will it do this?</li>
<li>
<strong>UI/UX</strong> (User Interface / User Experience) - how will
users interact with the software?</li>
<li>
<strong>Algorithm design</strong> - what method are we going to use
to solve the core research/business problem?</li>
</ul>
<p>There is literature on each of the above software design aspects - we
will not go into details of them all here. Instead, we will learn some
techniques to structure our code better to satisfy some of the
requirements of ‘good’ software and revisit our software’s <a href="11-software-project.html">MVC architecture</a> in the context of
software design.</p>
</section><section><h2 class="section-heading" id="poor-design-choices-technical-debt">Poor Design Choices &amp; Technical Debt<a class="anchor" aria-label="anchor" href="#poor-design-choices-technical-debt"></a>
</h2>
<hr class="half-width">
<p>When faced with a problem that you need to solve by writing code - it
may be tempted to skip the design phase and dive straight into coding.
What happens if you do not follow the good software design and
development best practices? It can lead to accumulated ‘technical debt’,
which (according to <a href="https://en.wikipedia.org/wiki/Technical_debt" class="external-link">Wikipedia</a>), is
the “cost of additional rework caused by choosing an easy (limited)
solution now instead of using a better approach that would take longer”.
The pressure to achieve project goals can sometimes lead to quick and
easy solutions, which make the software become more messy, more complex,
and more difficult to understand and maintain. The extra effort required
to make changes in the future is the interest paid on the (technical)
debt. It is natural for software to accrue some technical debt, but it
is important to pay off that debt during a maintenance phase -
simplifying, clarifying the code, making it easier to understand - to
keep these interest payments on making changes manageable.</p>
<p>There is only so much time available in a project. How much effort
should we spend on designing our code properly and using good
development practices? The following <a href="https://xkcd.com/844/" class="external-link">XKCD comic</a> summarises this tension:</p>
<figure><img src="../fig/xkcd-good-code-comic.png" class="image-with-shadow figure mx-auto d-block" alt="Writing good code comic" width="400"></figure><p>At an intermediate level there are a wealth of practices that
<em>could</em> be used, and applying suitable design and coding
practices is what separates an <em>intermediate developer</em> from
someone who has just started coding. The key for an intermediate
developer is to balance these concerns for each software project
appropriately, and employ design and development practices
<em>enough</em> so that progress can be made. It is very easy to
under-design software, but remember it is also possible to over-design
software too.</p>
</section><section><h2 class="section-heading" id="good-software-design-goals">Good Software Design Goals<a class="anchor" aria-label="anchor" href="#good-software-design-goals"></a>
</h2>
<hr class="half-width">
<p>Aspirationally, what makes good code can be summarised in the
following quote from the <a href="https://intenthq.com/blog/it-audience/what-is-good-code-a-scientific-definition/" class="external-link">Intent
HG blog</a>:</p>
<blockquote>
<p><em>“Good code is written so that is readable, understandable,
covered by automated tests, not over complicated and does well what is
intended to do.”</em></p>
</blockquote>
<p>Software has become a crucial aspect of reproducible research, as
well as an asset that can be reused or repurposed. Thus, it is even more
important to take time to design the software to be easily
<em>modifiable</em> and <em>extensible</em>, to save ourselves and our
team a lot of time later on when we have to fix a problem or the
software’s requirements change.</p>
<p>Satisfying the above properties will lead to an overall software
design goal of having <em>maintainable</em> code, which is:</p>
<ul>
<li>
<strong>Understandable</strong> by developers who did not develop
the code, by having a clear and well-considered high-level design (or
<em>architecture</em>) that separates out the different components and
aspects of its function logically and in a modular way, and having the
interactions between these different parts clear, simple, and
sufficiently high-level that they do not contravene this design. This is
known as <em>separation of concerns</em>, and is a key principle in good
software design.
<ul>
<li>Moving this forward into implementation, <em>understandable</em>
would mean being consistent in coding style, using sensible naming
conventions for functions, classes and variables, documenting and
commenting code, having a simple control flow, and having small
functions and methods focused on single tasks.</li>
</ul>
</li>
<li>
<strong>Adaptable</strong> by designing the code to be easily
modifiable and extensible to satisfy new requirements, by incorporating
points in the modular design where new behaviour can be added in a clear
and straightforward manner (e.g. as individual functions in existing
modules, or perhaps at a higher-level as plugins).
<ul>
<li>In an implementation sense, this means writing low-coupled/decoupled
code where each part of the code has a separate concern, and has the
lowest possible dependency on other parts of the code. This makes it
easier to test, update or replace.</li>
</ul>
</li>
<li>
<strong>Testable</strong> by designing the code in a sufficiently
modular way to make it easier to test the functionality within a modular
design, either as a whole or in terms of its individual functions.
<ul>
<li>This would carry forward in an implementation sense in two ways.
Firstly, having functions sufficiently small to be amenable to
individual (ideally automated) test cases, e.g. by writing unit,
regression tests to verify the code produces the expected outputs from
controlled inputs and exhibits the expected behavior over time as the
code changes. Secondly, at a higher-level in implementation, this would
allow functional tests to be written to create tests to verify entire
pathways through the code, from initial software input to testing
eventual output.</li>
</ul>
</li>
</ul>
<p>Now that we know what goals we should aspire to, let us take a
critical look at the code in our software project and try to identify
ways in which it can be improved.</p>
</section><section><h2 class="section-heading" id="designing-a-new-feature-for-our-project">Designing a New Feature for Our Project<a class="anchor" aria-label="anchor" href="#designing-a-new-feature-for-our-project"></a>
</h2>
<hr class="half-width">
<p>Our software project contains a pre-existing branch
<code>full-data-analysis</code> which contains code for a new feature of
our inflammation analysis software, which we will consider as a
contribution by another developer. Recall that you can see all your
branches as follows:</p>
<div class="codewrapper sourceCode" id="cb1">
<h3 class="code-label">BASH<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="sourceCode bash" tabindex="0"><code class="sourceCode bash"><span id="cb1-1"><a href="#cb1-1" tabindex="-1"></a><span class="ex">$</span> git branch <span class="at">--all</span></span></code></pre>
</div>
<p>Once you have saved and committed any current changes, checkout this
<code>full-data-analysis</code> branch:</p>
<div class="codewrapper sourceCode" id="cb2">
<h3 class="code-label">BASH<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="sourceCode bash" tabindex="0"><code class="sourceCode bash"><span id="cb2-1"><a href="#cb2-1" tabindex="-1"></a><span class="fu">git</span> switch full-data-analysis</span></code></pre>
</div>
<p>This new feature enables user to pass a new command-line parameter
<code>--full-data-analysis</code> causing the software to find the
directory containing the first input data file (provided via command
line parameter <code>infiles</code>) and invoke the data analysis over
all the data files in that directory. This bit of functionality is
handled by <code>inflammation-analysis.py</code> in the project
root.</p>
<p>The new data analysis code is located in <code>compute_data.py</code>
file within the <code>inflammation</code> directory in a function called
<code>analyse_data()</code>. This function loads all the data files for
a given a directory path, then calculates and compares standard
deviation across all the data by day and finally plots a graph.</p>
<div id="exercise-identify-how-can-code-be-improved" class="callout challenge">
<div class="callout-square">
<i class="callout-icon" data-feather="zap"></i>
</div>
<div id="exercise-identify-how-can-code-be-improved" class="callout-inner">
<h3 class="callout-title">Exercise: Identify How Can Code be Improved?</h3>
<div class="callout-content">
<p>Critically examine the code in <code>analyse_data()</code> function
in <code>compute_data.py</code> file.</p>
<p>In what ways does this code not live up to the ideal properties of
‘good’ code? Think about ways in which you find it hard to read and
understand. Think about the kinds of changes you might want to make to
it, and what would make those changes challenging.</p>
</div>
</div>
</div>
<div id="accordionSolution1" class="accordion challenge-accordion accordion-flush">
<div class="accordion-item">
<button class="accordion-button solution-button collapsed" type="button" data-bs-toggle="collapse" data-bs-target="#collapseSolution1" aria-expanded="false" aria-controls="collapseSolution1">
  <h4 class="accordion-header" id="headingSolution1"> Show me the solution </h4>
</button>
<div id="collapseSolution1" class="accordion-collapse collapse" data-bs-parent="#accordionSolution1" aria-labelledby="headingSolution1">
<div class="accordion-body">
<p>You may have found others, but here are some of the things that make
the code hard to read, test and maintain.</p>
<ul>
<li>
<strong>Hard to read:</strong> everything is implemented in a single
function. In order to understand it, you need to understand how file
loading works at the same time as the analysis itself.</li>
<li>
<strong>Hard to read:</strong> using the
<code>--full-data-analysis</code> flag changes the meaning of the
<code>infiles</code> argument to indicate a single data directory,
instead of a set of data files, which may cause confusion.</li>
<li>
<strong>Hard to modify:</strong> if you wanted to use the data for
some other purpose and not just plotting the graph you would have to
change the <code>analysis_data()</code> function.</li>
<li>
<strong>Hard to modify or test:</strong> it only analyses a set of
CSV data files matching a very particular hardcoded
<code>inflammation*.csv</code> pattern, which seems an unreasonable
assumption. What if someone wanted to use files which do not match this
naming convention?</li>
<li>
<strong>Hard to modify:</strong> it does not have any tests so we
cannot be 100% confident the code does what it claims to do; any changes
to the code may break something and it would be harder and more
time-consuming to figure out what.</li>
</ul>
<p>Make sure to keep the list you have created in the exercise above.
For the remainder of this section, we will work on improving this code.
At the end, we will revisit your list to check that you have learnt ways
to address each of the problems you had found.</p>
<p>There may be other things to improve with the code on this branch,
e.g. how command line parameters are being handled in
<code>inflammation-analysis.py</code>, but we are focussing on
<code>analyse_data()</code> function for the time being.</p>
</div>
</div>
</div>
</div>
</section><section><h2 class="section-heading" id="software-architecture">Software Architecture<a class="anchor" aria-label="anchor" href="#software-architecture"></a>
</h2>
<hr class="half-width">
<p>A software architecture is the fundamental structure of a software
system that is typically decided at the beginning of project development
based on its requirements and is not that easy to change once
implemented. It refers to a “bigger picture” of a software system that
describes high-level components (modules) of the system, what their
functionality/roles are and how they interact.</p>
<p>The basic idea with software architecture design is that you draw
boxes that will represent different units of code, as well as other
components of the system (such as users, databases, etc). Then connect
these boxes with lines where information or control will be exchanged.
These lines represent the interfaces in your system.</p>
<p>As well as helping to visualise the work, doing this sketch can
troubleshoot potential issues. For example, if there is a circular
dependency between two sections of the design. It can also help with
estimating how long the work will take, as it forces you to consider all
the components that need to be made.</p>
<p>Diagrams are not flawless, but are a great starting point to break
down the different responsibilities and think about the kinds of
information different parts of the system will need.</p>
<div id="exercise-design-a-high-level-architecture-for-a-new-requirement" class="callout challenge">
<div class="callout-square">
<i class="callout-icon" data-feather="zap"></i>
</div>
<div id="exercise-design-a-high-level-architecture-for-a-new-requirement" class="callout-inner">
<h3 class="callout-title">Exercise: Design a High-Level Architecture for a New Requirement</h3>
<div class="callout-content">
<p>Sketch out an architectural design for a new feature requested by a
user.</p>
<p><em>“I want there to be a Google Drive folder such that when I upload
new inflammation data to it, the software automatically pulls it down
and updates the analysis. The new result should be added to a database
with a timestamp. An email should then be sent to a group mailing list
notifying them of the change.”</em></p>
<p>You can draw by hand on a piece of paper or whiteboard, or use an
online drawing tool such as <a href="https://excalidraw.com/" class="external-link">Excalidraw</a>.</p>
</div>
</div>
</div>
<div id="accordionSolution2" class="accordion challenge-accordion accordion-flush">
<div class="accordion-item">
<button class="accordion-button solution-button collapsed" type="button" data-bs-toggle="collapse" data-bs-target="#collapseSolution2" aria-expanded="false" aria-controls="collapseSolution2">
  <h4 class="accordion-header" id="headingSolution2"> Show me the solution </h4>
</button>
<div id="collapseSolution2" class="accordion-collapse collapse" data-bs-parent="#accordionSolution2" aria-labelledby="headingSolution2">
<div class="accordion-body">
<figure><img src="../fig/example-architecture-diagram.svg" alt="Diagram showing proposed architecture of the problem" width="600" class="figure mx-auto d-block"></figure>
</div>
</div>
</div>
</div>
<p>We have been developing our software using the
<strong>Model-View-Controller</strong> (MVC) architecture, but MVC is
just one of the common <a href="software-architecture-extra.html">software architectural
patterns</a> and is not the only choice we could have made.</p>
<div class="section level3">
<h3 id="model-view-controller-mvc-architecture">Model-View-Controller (MVC) Architecture<a class="anchor" aria-label="anchor" href="#model-view-controller-mvc-architecture"></a>
</h3>
<p>Recall that the MVC architecture divides the related program logic
into three interconnected components or modules:</p>
<ul>
<li>
<strong>Model</strong> (data)</li>
<li>
<strong>View</strong> (client interface), and</li>
<li>
<strong>Controller</strong> (processes that handle input/output and
manipulate the data).</li>
</ul>
<p>The <em>Model</em> represents the data used by a program and also
contains operations/rules for manipulating and changing the data in the
model. This may be a database, a file, a single data object or a series
of objects - for example a table representing patients’ data.</p>
<p>The <em>View</em> is the means of displaying data to users/clients
within an application (i.e. provides visualisation of the state of the
model). For example, displaying a window with input fields and buttons
(Graphical User Interface, GUI) or textual options within a command line
(Command Line Interface, CLI) are examples of Views. They include
anything that the user can see from the application. While building GUIs
is not the topic of this course, we do cover building CLIs (handling
command line arguments) in Python to a certain extent.</p>
<p>The <em>Controller</em> manipulates both the Model and the View. It
accepts input from the View and performs the corresponding action on the
Model (changing the state of the model) and then updates the View
accordingly. For example, on user request, Controller updates a picture
on a user’s GitHub profile and then modifies the View by displaying the
updated profile back to the user.</p>
</div>
<div class="section level3">
<h3 id="limitations-to-architectural-design">Limitations to Architectural Design<a class="anchor" aria-label="anchor" href="#limitations-to-architectural-design"></a>
</h3>
<p>There are limits to everything - and MVC architecture is no
exception. The Controller often transcends into the Model and View, and
a clear separation is sometimes difficult to maintain. For example, the
Command Line Interface provides both the View (what user sees and how
they interact with the command line) and the Controller (invoking of a
command) aspects of a CLI application. In Web applications, Controller
often manipulates the data (received from the Model) before displaying
it to the user or passing it from the user to the Model.</p>
<p>There are many variants of an MVC-like pattern (such as <a href="https://en.wikipedia.org/wiki/Model%E2%80%93view%E2%80%93presenter" class="external-link">Model-View-Presenter</a>
(MVP), <a href="https://en.wikipedia.org/wiki/Model%E2%80%93view%E2%80%93viewmodel" class="external-link">Model-View-Viewmodel</a>
(MVVM), etc.), where the Controller role is handled slightly
differently, but in most cases, the distinction between these patterns
is not particularly important. What really matters is that we are making
conscious decisions about the architecture of our software that suit the
way in which we expect to use it. We should reuse and be consistent with
these established ideas where we can, but we do not need to stick to
them exactly.</p>
<p>The key thing to take away is the distinction between the Model and
the View code, while the View and the Controller can be more or less
coupled together (e.g. the code that specifies there is a button on the
screen, might be the same code that specifies what that button does).
The View may be hard to test, or use special libraries to draw the UI,
but should not contain any complex logic, and is really just a
presentation layer on top of the Model. The Model, conversely, should
not care how the data is displayed. For example, the View may present
dates as “Monday 24th July 2023”, but the Model stores it using a
<code>Date</code> object rather than its string representation.</p>
<div id="reusable-patterns-of-architecture" class="callout">
<div class="callout-square">
<i class="callout-icon" data-feather="bell"></i>
</div>
<div id="reusable-patterns-of-architecture" class="callout-inner">
<h3 class="callout-title">Reusable “Patterns” of Architecture</h3>
<div class="callout-content">
<p><a href="https://www.redhat.com/architect/14-software-architecture-patterns" class="external-link">Architectural</a>
and <a href="https://refactoring.guru/design-patterns/catalog" class="external-link">programming
patterns</a> are reusable templates for software systems and code that
provide solutions for some common software design challenges. MVC is one
architectural pattern. Patterns are a useful starting point for how to
design your software and also provide a common vocabulary for discussing
software designs with other developers. They may not always provide a
full design solution as some problems may require a bespoke design that
maps cleanly on to the specific problem you are trying to solve.</p>
</div>
</div>
</div>
</div>
<div class="section level3">
<h3 id="architectural-design-guidelines">Architectural Design Guidelines<a class="anchor" aria-label="anchor" href="#architectural-design-guidelines"></a>
</h3>
<p>Creating good software architecture is not about applying any rules
or patterns blindly, but instead practise and taking care to:</p>
<ul>
<li>Discuss design with your colleagues before writing the code.</li>
<li>Separate different concerns into different sections of the
code.</li>
<li>Avoid duplication of code or data.</li>
<li>Keep how much a person has to understand at once to a minimum.</li>
<li>Try not to have too many abstractions (if you have to jump around a
lot when reading the code that is a clue that your code may be too
abstract).</li>
<li>Think about how will your components interface other components and
external systems.</li>
<li>Not try to design a future-proof solution or to anticipate future
requirements or adaptations of the software - design the simplest
solution that solves the problem at hand.</li>
<li>(When working on a less well-structured part of the code), start by
refactoring it so that your change fits in cleanly.</li>
<li>Try to leave the code in a better state that you found it.</li>
</ul>
</div>
</section><section><h2 class="section-heading" id="techniques-for-good-software-design">Techniques for Good Software Design<a class="anchor" aria-label="anchor" href="#techniques-for-good-software-design"></a>
</h2>
<hr class="half-width">
<p>Once we have a good high-level architectural design, it is important
to follow this philosophy through to the process of developing the code
itself, and there are some key techniques to keep in mind that will
help.</p>
<p>As we have discussed, how code is structured is important for helping
people who are developing and maintaining it to understand and update
it. By breaking down our software into modular components with a single
responsibility, we avoid having to rewrite it all when requirements
change. This also means that these smaller components can be understood
individually without having to understand the entire codebase at once.
The following techniques build on this concept of modularity:</p>
<ul>
<li><p><em>Abstraction</em> is the process of hiding the implementation
details of a piece of code (typically behind an interface) - i.e. the
details of <em>how</em> something works are hidden away, leaving code
developers to deal only with <em>what</em> it does. This allows
developers to work with the code at a higher level of abstraction,
without needing to understand fully (or keep in mind) all the underlying
details at any given time and thereby reducing the cognitive load when
programming. Abstraction can be achieved through techniques such as
<em>encapsulation</em>, <em>inheritance</em>, and <em>polymorphism</em>,
which we will explore in the next episodes. There are other <a href="https://en.wikipedia.org/wiki/Abstraction_(computer_science)" class="external-link">abstraction
techniques</a> available too.</p></li>
<li><p><em>Code decoupling</em> is a code design technique that involves
breaking a (complex) software system into smaller, more manageable
parts, and reducing the interdependence between these different parts of
the system. This means that a change in one part of the code usually
does not require a change in the other, thereby making its development
more efficient and less error prone.</p></li>
<li><p><em>Code refactoring</em> is the process of improving the design
of an existing code - changing the internal structure of code without
changing its external behavior, with the goal of making the code more
readable, maintainable, efficient or easier to test. This can include
things such as renaming variables, reorganising functions to avoid code
duplication and increase reuse, and simplifying conditional
statements.</p></li>
</ul>
<p>Writing good code is hard and takes practise. You may also be faced
with an existing piece of code that breaks some (or all) of the good
code principles, and your job will be to improve/refactor it so that it
can evolve further. We will now look into some examples of these
techniques that can help us redesign our code and incrementally improve
its quality.</p>
<div id="keypoints1" class="callout keypoints">
<div class="callout-square">
<i class="callout-icon" data-feather="key"></i>
</div>
<div class="callout-inner">
<h3 class="callout-title">Key Points</h3>
<div class="callout-content">
<ul>
<li>‘Good’ code is designed to be maintainable: readable by people who
did not author the code, testable through a set of automated tests,
adaptable to new requirements.</li>
<li>Use abstraction and decoupling to logically separate the different
aspects of your software within design as well as implementation.</li>
<li>Use refactoring to improve existing code to improve its consistency
internally and within its overall architecture.</li>
<li>Include software design as a key stage in the lifecycle of your
project so that development and maintenance becomes easier.</li>
</ul>
</div>
</div>
</div>
</section></section><section id="aio-33-code-decoupling-abstractions"><p>Content from <a href="33-code-decoupling-abstractions.html">3.3 Code Decoupling &amp; Abstractions</a></p>
<hr>
<p>Last updated on 2025-03-10 |

        <a href="https://github.com/carpentries-incubator/python-intermediate-development/edit/main/episodes/33-code-decoupling-abstractions.md" class="external-link">Edit this page <i aria-hidden="true" data-feather="edit"></i></a></p>
<p>Estimated time: <i aria-hidden="true" data-feather="clock"></i> 75 minutes</p>
<div class="text-end">
          <button role="button" aria-pressed="false" tabindex="0" id="expand-code" class="pull-right" data-expand="Expand All Solutions " data-collapse="Collapse All Solutions "> Expand All Solutions <i aria-hidden="true" data-feather="plus"></i></button>
        </div>
<div class="overview card">
<h2 class="card-header">Overview</h2>
<div class="row g-0">
<div class="col-md-4">
<div class="card-body">
<div class="inner">
<h3 class="card-title">Questions</h3>
<ul>
<li>What is decoupled code?</li>
<li>What are commonly used code abstractions?</li>
<li>When is it useful to use classes to structure code?</li>
<li>How can we make sure the components of our software are
reusable?</li>
</ul>
</div>
</div>
</div>
<div class="col-md-8">
<div class="card-body">
<div class="inner bordered">
<h3 class="card-title">Objectives</h3>
<ul>
<li>Understand the benefits of code decoupling.</li>
<li>Introduce appropriate abstractions to simplify code.</li>
<li>Understand the principles of encapsulation, polymorphism and
interfaces.</li>
<li>Use mocks to replace a class in test code.</li>
</ul>
</div>
</div>
</div>
</div>
</div>
<section><h2 class="section-heading" id="introduction">Introduction<a class="anchor" aria-label="anchor" href="#introduction"></a>
</h2>
<hr class="half-width">
<p><strong>Code decoupling</strong> refers to breaking up the software
into smaller components and reducing the interdependence between these
components so that they can be tested and maintained independently. Two
components of code can be considered <em>decoupled</em> if a change in
one does not necessitate a change in the other. While two connected
units cannot always be totally decoupled, <em>loose coupling</em> is
something we should aim for.</p>
<p><strong>Code abstraction</strong> is the process of hiding the
implementation details of a piece of code behind an interface - i.e. the
details of <em>how</em> something works are hidden away, leaving us to
deal only with <em>what</em> it does. This allows developers to work
with the code at a higher level of abstraction, without needing to
understand fully (or keep in mind) all the underlying details and
thereby reducing the cognitive load when programming.</p>
<p>Abstractions can aid decoupling of code. If one part of the code only
uses another part through an appropriate abstraction then it becomes
easier for these parts to change independently. Benefits of using these
techniques include having the codebase that is:</p>
<ul>
<li>easier to read as you only need to understand the details of the
(smaller) component you are looking at and not the whole monolithic
codebase.</li>
<li>easier to test, as one of the components can be replaced by a test
or a mock version of it.</li>
<li>easier to maintain, as changes can be isolated from other parts of
the code.</li>
</ul>
<p>Let us start redesigning our code by introducing some of the
abstraction techniques to incrementally decouple it into smaller
components to improve its overall design.</p>
<p>In the code from our current branch <code>full-data-analysis</code>,
you may have noticed that loading data from CSV files from a
<code>data</code> directory is “hardcoded” into the
<code>analyse_data()</code> function. Data loading is a functionality
separate from data analysis, so firstly let us decouple the data loading
part into a separate component (function).</p>
<div id="exercise-decouple-data-loading-from-data-analysis" class="callout challenge">
<div class="callout-square">
<i class="callout-icon" data-feather="zap"></i>
</div>
<div id="exercise-decouple-data-loading-from-data-analysis" class="callout-inner">
<h3 class="callout-title">Exercise: Decouple Data Loading from Data Analysis</h3>
<div class="callout-content">
<p>Modify <code>compute_data.py</code> to separate out the data loading
functionality from <code>analyse_data()</code> into a new function
<code>load_inflammation_data()</code>, that returns a list of 2D NumPy
arrays with inflammation data loaded from all inflammation CSV files
found in a specified directory path. Then, change your
<code>analyse_data()</code> function to make use of this new function
instead.</p>
</div>
</div>
</div>
<div id="accordionSolution1" class="accordion challenge-accordion accordion-flush">
<div class="accordion-item">
<button class="accordion-button solution-button collapsed" type="button" data-bs-toggle="collapse" data-bs-target="#collapseSolution1" aria-expanded="false" aria-controls="collapseSolution1">
  <h4 class="accordion-header" id="headingSolution1"> Show me the solution </h4>
</button>
<div id="collapseSolution1" class="accordion-collapse collapse" data-bs-parent="#accordionSolution1" aria-labelledby="headingSolution1">
<div class="accordion-body">
<p>The new function <code>load_inflammation_data()</code> that reads all
the inflammation data into the format needed for the analysis could look
something like: .</p>
<div class="codewrapper sourceCode" id="cb1">
<h3 class="code-label">PYTHON<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="sourceCode python" tabindex="0"><code class="sourceCode python"><span id="cb1-1"><a href="#cb1-1" tabindex="-1"></a><span class="kw">def</span> load_inflammation_data(dir_path):</span>
<span id="cb1-2"><a href="#cb1-2" tabindex="-1"></a>    data_file_paths <span class="op">=</span> glob.glob(os.path.join(dir_path, <span class="st">'inflammation*.csv'</span>))</span>
<span id="cb1-3"><a href="#cb1-3" tabindex="-1"></a>    <span class="cf">if</span> <span class="bu">len</span>(data_file_paths) <span class="op">==</span> <span class="dv">0</span>:</span>
<span id="cb1-4"><a href="#cb1-4" tabindex="-1"></a>        <span class="cf">raise</span> <span class="pp">ValueError</span>(<span class="ss">f"No inflammation CSV files found in path </span><span class="sc">{</span>dir_path<span class="sc">}</span><span class="ss">"</span>)</span>
<span id="cb1-5"><a href="#cb1-5" tabindex="-1"></a>    data <span class="op">=</span> <span class="bu">map</span>(models.load_csv, data_file_paths) <span class="co"># Load inflammation data from each CSV file</span></span>
<span id="cb1-6"><a href="#cb1-6" tabindex="-1"></a>    <span class="cf">return</span> <span class="bu">list</span>(data) <span class="co"># Return the list of 2D NumPy arrays with inflammation data</span></span></code></pre>
</div>
<p>The new function <code>analyse_data()</code> could then look
like:</p>
<div class="codewrapper sourceCode" id="cb2">
<h3 class="code-label">PYTHON<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="sourceCode python" tabindex="0"><code class="sourceCode python"><span id="cb2-1"><a href="#cb2-1" tabindex="-1"></a><span class="kw">def</span> analyse_data(data_dir):</span>
<span id="cb2-2"><a href="#cb2-2" tabindex="-1"></a>    data <span class="op">=</span> load_inflammation_data(data_dir)</span>
<span id="cb2-3"><a href="#cb2-3" tabindex="-1"></a></span>
<span id="cb2-4"><a href="#cb2-4" tabindex="-1"></a>    means_by_day <span class="op">=</span> <span class="bu">map</span>(models.daily_mean, data)</span>
<span id="cb2-5"><a href="#cb2-5" tabindex="-1"></a>    means_by_day_matrix <span class="op">=</span> np.stack(<span class="bu">list</span>(means_by_day))</span>
<span id="cb2-6"><a href="#cb2-6" tabindex="-1"></a></span>
<span id="cb2-7"><a href="#cb2-7" tabindex="-1"></a>    daily_standard_deviation <span class="op">=</span> np.std(means_by_day_matrix, axis<span class="op">=</span><span class="dv">0</span>)</span>
<span id="cb2-8"><a href="#cb2-8" tabindex="-1"></a></span>
<span id="cb2-9"><a href="#cb2-9" tabindex="-1"></a>    graph_data <span class="op">=</span> {</span>
<span id="cb2-10"><a href="#cb2-10" tabindex="-1"></a>        <span class="st">'standard deviation by day'</span>: daily_standard_deviation,</span>
<span id="cb2-11"><a href="#cb2-11" tabindex="-1"></a>    }</span>
<span id="cb2-12"><a href="#cb2-12" tabindex="-1"></a>    views.visualize(graph_data)</span></code></pre>
</div>
<p>The code is now easier to follow since we do not need to understand
the data loading part to understand the statistical analysis part, and
vice versa. In most cases, functions work best when they are short!</p>
</div>
</div>
</div>
</div>
<p>However, even with this change, the data loading is still coupled
with the data analysis to a large extent. For example, if we have to
support loading data from different sources (e.g. JSON files or an SQL
database), we would have to pass some kind of a flag into
<code>analyse_data()</code> indicating the type of data we want to read
from. Instead, we would like to decouple the consideration of data
source from the <code>analyse_data()</code> function entirely. One way
we can do this is by using <em>encapsulation</em> and
<em>classes</em>.</p>
</section><section><h2 class="section-heading" id="encapsulation-classes">Encapsulation &amp; Classes<a class="anchor" aria-label="anchor" href="#encapsulation-classes"></a>
</h2>
<hr class="half-width">
<p><strong>Encapsulation</strong> is the process of packing the “data”
and “functions operating on that data” into a single component/object.
It is also provides a mechanism for restricting the access to that data.
Encapsulation means that the internal representation of a component is
generally hidden from view outside of the component’s definition.</p>
<p>Encapsulation allows developers to present a consistent interface to
the component/object that is independent of its internal implementation.
For example, encapsulation can be used to hide the values or state of a
structured data object inside a <strong>class</strong>, preventing
direct access to them that could violate the object’s state maintained
by the class’ methods. Note that object-oriented programming (OOP)
languages support encapsulation, but encapsulation is not unique to
OOP.</p>
<p>So, a class is a way of grouping together data with some methods that
manipulate that data. In Python, you can <em>declare</em> a class as
follows:</p>
<div class="codewrapper sourceCode" id="cb3">
<h3 class="code-label">PYTHON<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="sourceCode python" tabindex="0"><code class="sourceCode python"><span id="cb3-1"><a href="#cb3-1" tabindex="-1"></a><span class="kw">class</span> Circle:</span>
<span id="cb3-2"><a href="#cb3-2" tabindex="-1"></a>  <span class="cf">pass</span></span></code></pre>
</div>
<p>Classes are typically named using “CapitalisedWords” naming
convention - e.g. FileReader, OutputStream, Rectangle.</p>
<p>You can <em>construct</em> an <em>instance</em> of a class elsewhere
in the code by doing the following:</p>
<div class="codewrapper sourceCode" id="cb4">
<h3 class="code-label">PYTHON<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="sourceCode python" tabindex="0"><code class="sourceCode python"><span id="cb4-1"><a href="#cb4-1" tabindex="-1"></a>my_circle <span class="op">=</span> Circle()</span></code></pre>
</div>
<p>When you construct a class in this ways, the class’
<em>constructor</em> method is called. It is also possible to pass
values to the constructor in order to configure the class instance:</p>
<div class="codewrapper sourceCode" id="cb5">
<h3 class="code-label">PYTHON<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="sourceCode python" tabindex="0"><code class="sourceCode python"><span id="cb5-1"><a href="#cb5-1" tabindex="-1"></a><span class="kw">class</span> Circle:</span>
<span id="cb5-2"><a href="#cb5-2" tabindex="-1"></a>  <span class="kw">def</span> <span class="fu">__init__</span>(<span class="va">self</span>, radius):</span>
<span id="cb5-3"><a href="#cb5-3" tabindex="-1"></a>    <span class="va">self</span>.radius <span class="op">=</span> radius</span>
<span id="cb5-4"><a href="#cb5-4" tabindex="-1"></a></span>
<span id="cb5-5"><a href="#cb5-5" tabindex="-1"></a>my_circle <span class="op">=</span> Circle(<span class="dv">10</span>)</span></code></pre>
</div>
<p>The constructor has the special name <code>__init__</code>. Note it
has a special first parameter called <code>self</code> by convention -
it is used to access the current <em>instance</em> of the object being
created.</p>
<p>A class can be thought of as a cookie cutter template, and instances
as the cookies themselves. That is, one class can have many
instances.</p>
<p>Classes can also have other methods defined on them. Like
constructors, they have the special parameter <code>self</code> that
must come first.</p>
<div class="codewrapper sourceCode" id="cb6">
<h3 class="code-label">PYTHON<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="sourceCode python" tabindex="0"><code class="sourceCode python"><span id="cb6-1"><a href="#cb6-1" tabindex="-1"></a><span class="im">import</span> math</span>
<span id="cb6-2"><a href="#cb6-2" tabindex="-1"></a></span>
<span id="cb6-3"><a href="#cb6-3" tabindex="-1"></a><span class="kw">class</span> Circle:</span>
<span id="cb6-4"><a href="#cb6-4" tabindex="-1"></a>  ...</span>
<span id="cb6-5"><a href="#cb6-5" tabindex="-1"></a>  <span class="kw">def</span> get_area(<span class="va">self</span>):</span>
<span id="cb6-6"><a href="#cb6-6" tabindex="-1"></a>    <span class="cf">return</span> math.pi <span class="op">*</span> <span class="va">self</span>.radius <span class="op">*</span> <span class="va">self</span>.radius</span>
<span id="cb6-7"><a href="#cb6-7" tabindex="-1"></a>...</span>
<span id="cb6-8"><a href="#cb6-8" tabindex="-1"></a><span class="bu">print</span>(my_circle.get_area())</span></code></pre>
</div>
<p>On the last line of the code above, the instance of the class,
<code>my_circle</code>, will be automatically passed as the first
parameter (<code>self</code>) when calling the <code>get_area()</code>
method. The <code>get_area()</code> method can then access the variable
<code>radius</code> encapsulated within the object, which is otherwise
invisible to the world outside of the object. The method
<code>get_area()</code> itself can also be accessed via the
object/instance only.</p>
<p>As we can see, internal representation of any instance of class
<code>Circle</code> is hidden outside of this class (encapsulation). In
addition, implementation of the method <code>get_area()</code> is hidden
too (abstraction).</p>
<div id="encapsulation-abstraction" class="callout">
<div class="callout-square">
<i class="callout-icon" data-feather="bell"></i>
</div>
<div id="encapsulation-abstraction" class="callout-inner">
<h3 class="callout-title">Encapsulation &amp; Abstraction</h3>
<div class="callout-content">
<p>Encapsulation provides <strong>information hiding</strong>.
Abstraction provides <strong>implementation hiding</strong>.</p>
</div>
</div>
</div>
<div id="exercise-use-classes-to-abstract-out-data-loading" class="callout challenge">
<div class="callout-square">
<i class="callout-icon" data-feather="zap"></i>
</div>
<div id="exercise-use-classes-to-abstract-out-data-loading" class="callout-inner">
<h3 class="callout-title">Exercise: Use Classes to Abstract out Data Loading</h3>
<div class="callout-content">
<p>Inside <code>compute_data.py</code>, declare a new class
<code>CSVDataSource</code> that contains the
<code>load_inflammation_data()</code> function we wrote in the previous
exercise as a method of this class. The directory path where to load the
files from should be passed in the class’ constructor method. Finally,
construct an instance of the class <code>CSVDataSource</code> outside
the statistical analysis and pass it to <code>analyse_data()</code>
function.</p>
<blockquote>
<h2 id="hint">Hint</h2>
<p>At the end of this exercise, the code in the
<code>analyse_data()</code> function should look like:</p>
<div class="codewrapper sourceCode" id="cb7">
<h3 class="code-label">PYTHON<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="sourceCode python" tabindex="0"><code class="sourceCode python"><span id="cb7-1"><a href="#cb7-1" tabindex="-1"></a><span class="kw">def</span> analyse_data(data_source):</span>
<span id="cb7-2"><a href="#cb7-2" tabindex="-1"></a>    data <span class="op">=</span> data_source.load_inflammation_data()</span>
<span id="cb7-3"><a href="#cb7-3" tabindex="-1"></a>    ...</span></code></pre>
</div>
<p>The controller code should look like:</p>
<div class="codewrapper sourceCode" id="cb8">
<h3 class="code-label">PYTHON<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="sourceCode python" tabindex="0"><code class="sourceCode python"><span id="cb8-1"><a href="#cb8-1" tabindex="-1"></a>data_source <span class="op">=</span> CSVDataSource(os.path.dirname(infiles[<span class="dv">0</span>]))</span>
<span id="cb8-2"><a href="#cb8-2" tabindex="-1"></a>analyse_data(data_source)</span></code></pre>
</div>
</blockquote>
</div>
</div>
</div>
<div id="accordionSolution2" class="accordion challenge-accordion accordion-flush">
<div class="accordion-item">
<button class="accordion-button solution-button collapsed" type="button" data-bs-toggle="collapse" data-bs-target="#collapseSolution2" aria-expanded="false" aria-controls="collapseSolution2">
  <h4 class="accordion-header" id="headingSolution2"> Show me the solution </h4>
</button>
<div id="collapseSolution2" class="accordion-collapse collapse" data-bs-parent="#accordionSolution2" aria-labelledby="headingSolution2">
<div class="accordion-body">
<p>For example, we can declare class <code>CSVDataSource</code> like
this:</p>
<div class="codewrapper sourceCode" id="cb9">
<h3 class="code-label">PYTHON<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="sourceCode python" tabindex="0"><code class="sourceCode python"><span id="cb9-1"><a href="#cb9-1" tabindex="-1"></a><span class="kw">class</span> CSVDataSource:</span>
<span id="cb9-2"><a href="#cb9-2" tabindex="-1"></a>    <span class="co">"""</span></span>
<span id="cb9-3"><a href="#cb9-3" tabindex="-1"></a><span class="co">    Loads all the inflammation CSV files within a specified directory.</span></span>
<span id="cb9-4"><a href="#cb9-4" tabindex="-1"></a><span class="co">    """</span></span>
<span id="cb9-5"><a href="#cb9-5" tabindex="-1"></a>    <span class="kw">def</span> <span class="fu">__init__</span>(<span class="va">self</span>, dir_path):</span>
<span id="cb9-6"><a href="#cb9-6" tabindex="-1"></a>        <span class="va">self</span>.dir_path <span class="op">=</span> dir_path</span>
<span id="cb9-7"><a href="#cb9-7" tabindex="-1"></a></span>
<span id="cb9-8"><a href="#cb9-8" tabindex="-1"></a>    <span class="kw">def</span> load_inflammation_data(<span class="va">self</span>):</span>
<span id="cb9-9"><a href="#cb9-9" tabindex="-1"></a>        data_file_paths <span class="op">=</span> glob.glob(os.path.join(<span class="va">self</span>.dir_path, <span class="st">'inflammation*.csv'</span>))</span>
<span id="cb9-10"><a href="#cb9-10" tabindex="-1"></a>        <span class="cf">if</span> <span class="bu">len</span>(data_file_paths) <span class="op">==</span> <span class="dv">0</span>:</span>
<span id="cb9-11"><a href="#cb9-11" tabindex="-1"></a>            <span class="cf">raise</span> <span class="pp">ValueError</span>(<span class="ss">f"No inflammation CSV files found in path </span><span class="sc">{</span><span class="va">self</span><span class="sc">.</span>dir_path<span class="sc">}</span><span class="ss">"</span>)</span>
<span id="cb9-12"><a href="#cb9-12" tabindex="-1"></a>        data <span class="op">=</span> <span class="bu">map</span>(models.load_csv, data_file_paths)</span>
<span id="cb9-13"><a href="#cb9-13" tabindex="-1"></a>        <span class="cf">return</span> <span class="bu">list</span>(data)</span></code></pre>
</div>
<p>In the controller, we create an instance of CSVDataSource and pass it
into the the statistical analysis function.</p>
<div class="codewrapper sourceCode" id="cb10">
<h3 class="code-label">PYTHON<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="sourceCode python" tabindex="0"><code class="sourceCode python"><span id="cb10-1"><a href="#cb10-1" tabindex="-1"></a>data_source <span class="op">=</span> CSVDataSource(os.path.dirname(infiles[<span class="dv">0</span>]))</span>
<span id="cb10-2"><a href="#cb10-2" tabindex="-1"></a>analyse_data(data_source)</span></code></pre>
</div>
<p>The <code>analyse_data()</code> function is modified to receive any
data source object (that implements the
<code>load_inflammation_data()</code> method) as a parameter.</p>
<div class="codewrapper sourceCode" id="cb11">
<h3 class="code-label">PYTHON<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="sourceCode python" tabindex="0"><code class="sourceCode python"><span id="cb11-1"><a href="#cb11-1" tabindex="-1"></a><span class="kw">def</span> analyse_data(data_source):</span>
<span id="cb11-2"><a href="#cb11-2" tabindex="-1"></a>    data <span class="op">=</span> data_source.load_inflammation_data()</span>
<span id="cb11-3"><a href="#cb11-3" tabindex="-1"></a>    ...</span></code></pre>
</div>
<p>We have now fully decoupled the reading of the data from the
statistical analysis and the analysis is not fixed to reading from a
directory of CSV files. Indeed, we can pass various data sources to this
function now, as long as they implement the
<code>load_inflammation_data()</code> method.</p>
<p>While the overall behaviour of the code and its results are
unchanged, the way we invoke data analysis has changed.</p>
</div>
</div>
</div>
</div>
</section><section><h2 class="section-heading" id="interfaces">Interfaces<a class="anchor" aria-label="anchor" href="#interfaces"></a>
</h2>
<hr class="half-width">
<p>An <strong>interface</strong> is another important concept in
software design related to abstraction and encapsulation. For a software
component, it declares the operations that can be invoked on that
component, along with input arguments and what it returns. By knowing
these details, we can communicate with this component without the need
to know how it implements this interface.</p>
<p>API (Application Programming Interface) is one example of an
interface that allows separate systems (external to one another) to
communicate with each other. For example, a request to Google Maps
service API may get you the latitude and longitude for a given address.
Twitter API may return all tweets that contain a given keyword that have
been posted within a certain date range.</p>
<p>Internal interfaces within software dictate how different parts of
the system interact with each other. Even when these are not explicitly
documented - they still exist.</p>
<p>For example, our <code>Circle</code> class implicitly has an
interface - you can call <code>get_area()</code> method on it and it
will return a number representing its surface area.</p>
<div id="exercise-identify-an-interface-between-csvdatasource-and-analyse_data" class="callout challenge">
<div class="callout-square">
<i class="callout-icon" data-feather="zap"></i>
</div>
<div id="exercise-identify-an-interface-between-csvdatasource-and-analyse_data" class="callout-inner">
<h3 class="callout-title">Exercise: Identify an Interface Between
<code>CSVDataSource</code> and <code>analyse_data</code>
</h3>
<div class="callout-content">
<p>What would you say is the interface between the CSVDataSource class
and <code>analyse_data()</code> function? Think about what functions
<code>analyse_data()</code> needs to be able to call to perform its
duty, what parameters they need and what they return.</p>
</div>
</div>
</div>
<div id="accordionSolution3" class="accordion challenge-accordion accordion-flush">
<div class="accordion-item">
<button class="accordion-button solution-button collapsed" type="button" data-bs-toggle="collapse" data-bs-target="#collapseSolution3" aria-expanded="false" aria-controls="collapseSolution3">
  <h4 class="accordion-header" id="headingSolution3"> Show me the solution </h4>
</button>
<div id="collapseSolution3" class="accordion-collapse collapse" data-bs-parent="#accordionSolution3" aria-labelledby="headingSolution3">
<div class="accordion-body">
<p>The interface is the <code>load_inflammation_data()</code> method,
which takes no parameters and returns a list where each entry is a 2D
NumPy array of patient inflammation data (read from some data
source).</p>
<p>Any object passed into <code>analyse_data()</code> should conform to
this interface.</p>
</div>
</div>
</div>
</div>
</section><section><h2 class="section-heading" id="polymorphism">Polymorphism<a class="anchor" aria-label="anchor" href="#polymorphism"></a>
</h2>
<hr class="half-width">
<p>In general, <strong>polymorphism</strong> is the idea of having
multiple implementations/forms/shapes of the same abstract concept. It
is the provision of a single interface to entities of different types,
or the use of a single symbol to represent multiple different types.</p>
<p>There are <a href="https://www.bmc.com/blogs/polymorphism-programming/" class="external-link">different
versions of polymorphism</a>. For example, method or operator
overloading is one type of polymorphism enabling methods and operators
to take parameters of different types.</p>
<p>We will have a look at the <em>interface-based polymorphism</em>. In
OOP, it is possible to have different object classes that conform to the
same interface. For example, let us have a look at the following class
representing a <code>Rectangle</code>:</p>
<div class="codewrapper sourceCode" id="cb12">
<h3 class="code-label">PYTHON<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="sourceCode python" tabindex="0"><code class="sourceCode python"><span id="cb12-1"><a href="#cb12-1" tabindex="-1"></a><span class="kw">class</span> Rectangle:</span>
<span id="cb12-2"><a href="#cb12-2" tabindex="-1"></a>  <span class="kw">def</span> <span class="fu">__init__</span>(<span class="va">self</span>, width, height):</span>
<span id="cb12-3"><a href="#cb12-3" tabindex="-1"></a>    <span class="va">self</span>.width <span class="op">=</span> width</span>
<span id="cb12-4"><a href="#cb12-4" tabindex="-1"></a>    <span class="va">self</span>.height <span class="op">=</span> height</span>
<span id="cb12-5"><a href="#cb12-5" tabindex="-1"></a>  <span class="kw">def</span> get_area(<span class="va">self</span>):</span>
<span id="cb12-6"><a href="#cb12-6" tabindex="-1"></a>    <span class="cf">return</span> <span class="va">self</span>.width <span class="op">*</span> <span class="va">self</span>.height</span></code></pre>
</div>
<p>Like <code>Circle</code>, this class provides the
<code>get_area()</code> method. The method takes the same number of
parameters (none), and returns a number. However, the implementation is
different. This is interface-based polymorphism.</p>
<p>The word “polymorphism” means “many forms”, and in programming it
refers to methods/functions/operators with the same name that can be
executed on many objects or classes.</p>
<p>Using our <code>Circle</code> and <code>Rectangle</code> classes, we
can create a list of different shapes and iterate through the list to
find their total surface area as follows:</p>
<div class="codewrapper sourceCode" id="cb13">
<h3 class="code-label">PYTHON<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="sourceCode python" tabindex="0"><code class="sourceCode python"><span id="cb13-1"><a href="#cb13-1" tabindex="-1"></a>my_circle <span class="op">=</span> Circle(radius<span class="op">=</span><span class="dv">10</span>)</span>
<span id="cb13-2"><a href="#cb13-2" tabindex="-1"></a>my_rectangle <span class="op">=</span> Rectangle(width<span class="op">=</span><span class="dv">5</span>, height<span class="op">=</span><span class="dv">3</span>)</span>
<span id="cb13-3"><a href="#cb13-3" tabindex="-1"></a>my_shapes <span class="op">=</span> [my_circle, my_rectangle]</span>
<span id="cb13-4"><a href="#cb13-4" tabindex="-1"></a>total_area <span class="op">=</span> <span class="bu">sum</span>(shape.get_area() <span class="cf">for</span> shape <span class="kw">in</span> my_shapes)</span></code></pre>
</div>
<p>Note that we have not created a common superclass or linked the
classes <code>Circle</code> and <code>Rectangle</code> together in any
way. It is possible due to polymorphism. You could also say that, when
we are calculating the total surface area, the method for calculating
the area of each shape is abstracted away to the relevant class.</p>
<p>How can polymorphism be useful in our software project? For example,
we can replace our <code>CSVDataSource</code> with another class that
reads a totally different file format (e.g. JSON), or reads from an
external service or a database. All of these changes can be now be made
without changing the analysis function as we have decoupled the process
of data loading from the data analysis earlier. Conversely, if we wanted
to write a new analysis function, we could support any of these data
sources with no extra work.</p>
<div id="exercise-add-an-additional-datasource" class="callout challenge">
<div class="callout-square">
<i class="callout-icon" data-feather="zap"></i>
</div>
<div id="exercise-add-an-additional-datasource" class="callout-inner">
<h3 class="callout-title">Exercise: Add an Additional DataSource</h3>
<div class="callout-content">
<p>Create another class that supports loading patient data from JSON
files, with the appropriate <code>load_inflammation_data()</code>
method. Here is an example function that you can add to your
<code>models.py</code> file to load observations from a JSON file:</p>
<div class="codewrapper sourceCode" id="cb14">
<h3 class="code-label">PYTHON<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="sourceCode python" tabindex="0"><code class="sourceCode python"><span id="cb14-1"><a href="#cb14-1" tabindex="-1"></a><span class="kw">def</span> load_json(filename):</span>
<span id="cb14-2"><a href="#cb14-2" tabindex="-1"></a>    <span class="co">"""Load a numpy array from a JSON document.</span></span>
<span id="cb14-3"><a href="#cb14-3" tabindex="-1"></a><span class="co">    </span></span>
<span id="cb14-4"><a href="#cb14-4" tabindex="-1"></a><span class="co">    Expected format:</span></span>
<span id="cb14-5"><a href="#cb14-5" tabindex="-1"></a><span class="co">    [</span></span>
<span id="cb14-6"><a href="#cb14-6" tabindex="-1"></a><span class="co">      {</span></span>
<span id="cb14-7"><a href="#cb14-7" tabindex="-1"></a><span class="co">        "observations": [0, 1]</span></span>
<span id="cb14-8"><a href="#cb14-8" tabindex="-1"></a><span class="co">      },</span></span>
<span id="cb14-9"><a href="#cb14-9" tabindex="-1"></a><span class="co">      {</span></span>
<span id="cb14-10"><a href="#cb14-10" tabindex="-1"></a><span class="co">        "observations": [0, 2]</span></span>
<span id="cb14-11"><a href="#cb14-11" tabindex="-1"></a><span class="co">      }    </span></span>
<span id="cb14-12"><a href="#cb14-12" tabindex="-1"></a><span class="co">    ]</span></span>
<span id="cb14-13"><a href="#cb14-13" tabindex="-1"></a><span class="co">    :param filename: Filename of CSV to load</span></span>
<span id="cb14-14"><a href="#cb14-14" tabindex="-1"></a><span class="co">    """</span></span>
<span id="cb14-15"><a href="#cb14-15" tabindex="-1"></a>    <span class="cf">with</span> <span class="bu">open</span>(filename, <span class="st">'r'</span>, encoding<span class="op">=</span><span class="st">'utf-8'</span>) <span class="im">as</span> <span class="bu">file</span>:</span>
<span id="cb14-16"><a href="#cb14-16" tabindex="-1"></a>        data_as_json <span class="op">=</span> json.load(<span class="bu">file</span>)</span>
<span id="cb14-17"><a href="#cb14-17" tabindex="-1"></a>        <span class="cf">return</span> [np.array(entry[<span class="st">'observations'</span>]) <span class="cf">for</span> entry <span class="kw">in</span> data_as_json]</span></code></pre>
</div>
<p>Finally, at run-time, construct an appropriate data source instance
based on the file extension.</p>
</div>
</div>
</div>
<div id="accordionSolution4" class="accordion challenge-accordion accordion-flush">
<div class="accordion-item">
<button class="accordion-button solution-button collapsed" type="button" data-bs-toggle="collapse" data-bs-target="#collapseSolution4" aria-expanded="false" aria-controls="collapseSolution4">
  <h4 class="accordion-header" id="headingSolution4"> Show me the solution </h4>
</button>
<div id="collapseSolution4" class="accordion-collapse collapse" data-bs-parent="#accordionSolution4" aria-labelledby="headingSolution4">
<div class="accordion-body">
<p>The class that reads inflammation data from JSON files could look
something like:</p>
<div class="codewrapper sourceCode" id="cb15">
<h3 class="code-label">PYTHON<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="sourceCode python" tabindex="0"><code class="sourceCode python"><span id="cb15-1"><a href="#cb15-1" tabindex="-1"></a><span class="kw">class</span> JSONDataSource:</span>
<span id="cb15-2"><a href="#cb15-2" tabindex="-1"></a>  <span class="co">"""</span></span>
<span id="cb15-3"><a href="#cb15-3" tabindex="-1"></a><span class="co">  Loads patient data with inflammation values from JSON files within a specified folder.</span></span>
<span id="cb15-4"><a href="#cb15-4" tabindex="-1"></a><span class="co">  """</span></span>
<span id="cb15-5"><a href="#cb15-5" tabindex="-1"></a>  <span class="kw">def</span> <span class="fu">__init__</span>(<span class="va">self</span>, dir_path):</span>
<span id="cb15-6"><a href="#cb15-6" tabindex="-1"></a>    <span class="va">self</span>.dir_path <span class="op">=</span> dir_path</span>
<span id="cb15-7"><a href="#cb15-7" tabindex="-1"></a></span>
<span id="cb15-8"><a href="#cb15-8" tabindex="-1"></a>  <span class="kw">def</span> load_inflammation_data(<span class="va">self</span>):</span>
<span id="cb15-9"><a href="#cb15-9" tabindex="-1"></a>    data_file_paths <span class="op">=</span> glob.glob(os.path.join(<span class="va">self</span>.dir_path, <span class="st">'inflammation*.json'</span>))</span>
<span id="cb15-10"><a href="#cb15-10" tabindex="-1"></a>    <span class="cf">if</span> <span class="bu">len</span>(data_file_paths) <span class="op">==</span> <span class="dv">0</span>:</span>
<span id="cb15-11"><a href="#cb15-11" tabindex="-1"></a>      <span class="cf">raise</span> <span class="pp">ValueError</span>(<span class="ss">f"No inflammation JSON files found in path </span><span class="sc">{</span><span class="va">self</span><span class="sc">.</span>dir_path<span class="sc">}</span><span class="ss">"</span>)</span>
<span id="cb15-12"><a href="#cb15-12" tabindex="-1"></a>    data <span class="op">=</span> <span class="bu">map</span>(models.load_json, data_file_paths)</span>
<span id="cb15-13"><a href="#cb15-13" tabindex="-1"></a>    <span class="cf">return</span> <span class="bu">list</span>(data)</span></code></pre>
</div>
<p>Additionally, in the controller we will need to select an appropriate
DataSource instance to provide to the analysis:</p>
<div class="codewrapper sourceCode" id="cb16">
<h3 class="code-label">PYTHON<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="sourceCode python" tabindex="0"><code class="sourceCode python"><span id="cb16-1"><a href="#cb16-1" tabindex="-1"></a>_, extension <span class="op">=</span> os.path.splitext(infiles[<span class="dv">0</span>])</span>
<span id="cb16-2"><a href="#cb16-2" tabindex="-1"></a><span class="cf">if</span> extension <span class="op">==</span> <span class="st">'.json'</span>:</span>
<span id="cb16-3"><a href="#cb16-3" tabindex="-1"></a>  data_source <span class="op">=</span> JSONDataSource(os.path.dirname(infiles[<span class="dv">0</span>]))</span>
<span id="cb16-4"><a href="#cb16-4" tabindex="-1"></a><span class="cf">elif</span> extension <span class="op">==</span> <span class="st">'.csv'</span>:</span>
<span id="cb16-5"><a href="#cb16-5" tabindex="-1"></a>  data_source <span class="op">=</span> CSVDataSource(os.path.dirname(infiles[<span class="dv">0</span>]))</span>
<span id="cb16-6"><a href="#cb16-6" tabindex="-1"></a><span class="cf">else</span>:</span>
<span id="cb16-7"><a href="#cb16-7" tabindex="-1"></a>  <span class="cf">raise</span> <span class="pp">ValueError</span>(<span class="ss">f'Unsupported data file format: </span><span class="sc">{</span>extension<span class="sc">}</span><span class="ss">'</span>)</span>
<span id="cb16-8"><a href="#cb16-8" tabindex="-1"></a>analyse_data(data_source)</span></code></pre>
</div>
<p>As you can seen, all the above changes have been made made without
modifying the analysis code itself.</p>
</div>
</div>
</div>
</div>
</section><section><h2 class="section-heading" id="testing-using-mock-objects">Testing Using Mock Objects<a class="anchor" aria-label="anchor" href="#testing-using-mock-objects"></a>
</h2>
<hr class="half-width">
<p>We can use a <strong>mock object</strong> abstraction to make testing
more straightforward. Instead of having our tests use real data stored
on a file system, we can provide a mock or dummy implementation instead
of one of the real classes. Providing that what we use as a substitute
conforms to the same interface, the code we are testing should work just
the same. Such mock/dummy implementation could just return some fixed
example data.</p>
<p>An convenient way to do this in Python is using Python’s <a href="https://docs.python.org/3/library/unittest.mock.html" class="external-link">mock object
library</a>. This is a whole topic in itself - but a basic mock can be
constructed using a couple of lines of code:</p>
<div class="codewrapper sourceCode" id="cb17">
<h3 class="code-label">PYTHON<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="sourceCode python" tabindex="0"><code class="sourceCode python"><span id="cb17-1"><a href="#cb17-1" tabindex="-1"></a><span class="im">from</span> unittest.mock <span class="im">import</span> Mock</span>
<span id="cb17-2"><a href="#cb17-2" tabindex="-1"></a></span>
<span id="cb17-3"><a href="#cb17-3" tabindex="-1"></a>mock_version <span class="op">=</span> Mock()</span>
<span id="cb17-4"><a href="#cb17-4" tabindex="-1"></a>mock_version.method_to_mock.return_value <span class="op">=</span> <span class="dv">42</span></span></code></pre>
</div>
<p>Here we construct a mock in the same way you would construct a class.
Then we specify a method that we want to behave a specific way.</p>
<p>Now whenever you call <code>mock_version.method_to_mock()</code> the
return value will be <code>42</code>.</p>
<div id="exercise-test-using-a-mock-implementation" class="callout challenge">
<div class="callout-square">
<i class="callout-icon" data-feather="zap"></i>
</div>
<div id="exercise-test-using-a-mock-implementation" class="callout-inner">
<h3 class="callout-title">Exercise: Test Using a Mock Implementation</h3>
<div class="callout-content">
<p>Add a new test file called <code>test_compute_data.py</code> in the
tests folder and add a test to verify whether we can successfully run
<code>analyse_data()</code> when passing it a data source.</p>
<p>Complete this test for <code>analyse_data()</code>, using a mock
object in place of the <code>data_source</code>:</p>
<div class="codewrapper sourceCode" id="cb18">
<h3 class="code-label">PYTHON<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="sourceCode python" tabindex="0"><code class="sourceCode python"><span id="cb18-1"><a href="#cb18-1" tabindex="-1"></a><span class="im">from</span> unittest.mock <span class="im">import</span> Mock</span>
<span id="cb18-2"><a href="#cb18-2" tabindex="-1"></a></span>
<span id="cb18-3"><a href="#cb18-3" tabindex="-1"></a><span class="kw">def</span> test_analyse_data_mock_source():</span>
<span id="cb18-4"><a href="#cb18-4" tabindex="-1"></a>  <span class="im">from</span> inflammation.compute_data <span class="im">import</span> analyse_data</span>
<span id="cb18-5"><a href="#cb18-5" tabindex="-1"></a>  data_source <span class="op">=</span> Mock()</span>
<span id="cb18-6"><a href="#cb18-6" tabindex="-1"></a></span>
<span id="cb18-7"><a href="#cb18-7" tabindex="-1"></a>  <span class="co"># </span><span class="al">TODO</span><span class="co">: configure data_source mock</span></span>
<span id="cb18-8"><a href="#cb18-8" tabindex="-1"></a></span>
<span id="cb18-9"><a href="#cb18-9" tabindex="-1"></a>  analyse_data(data_source)</span></code></pre>
</div>
<p>Create a mock that returns some fixed data and to use as the
<code>data_source</code> in order to test the <code>analyse_data</code>
method.</p>
<p>Use this mock in the test.</p>
<p>Do not forget to import <code>Mock</code> from the
<code>unittest.mock</code> package.</p>
<p>Note that the <code>analyse_data()</code> function visualizes the
data with <code>views.visualize(graph_data)</code>. You do not have to
assert that this is done correctly. For now, it is fine to just check
that the call to <code>analyse_data()</code> can proceed
successfully.</p>
<p>In the next episode we will adapt the <code>analyse_data()</code>
function so that we can write a test that asserts whether standard
deviation calculations are correct.</p>
</div>
</div>
</div>
<div id="accordionSolution5" class="accordion challenge-accordion accordion-flush">
<div class="accordion-item">
<button class="accordion-button solution-button collapsed" type="button" data-bs-toggle="collapse" data-bs-target="#collapseSolution5" aria-expanded="false" aria-controls="collapseSolution5">
  <h4 class="accordion-header" id="headingSolution5"> Show me the solution </h4>
</button>
<div id="collapseSolution5" class="accordion-collapse collapse" data-bs-parent="#accordionSolution5" aria-labelledby="headingSolution5">
<div class="accordion-body">
<div class="codewrapper sourceCode" id="cb19">
<h3 class="code-label">PYTHON<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="sourceCode python" tabindex="0"><code class="sourceCode python"><span id="cb19-1"><a href="#cb19-1" tabindex="-1"></a><span class="im">from</span> unittest.mock <span class="im">import</span> Mock</span>
<span id="cb19-2"><a href="#cb19-2" tabindex="-1"></a></span>
<span id="cb19-3"><a href="#cb19-3" tabindex="-1"></a><span class="kw">def</span> test_analyse_data_mock_source():</span>
<span id="cb19-4"><a href="#cb19-4" tabindex="-1"></a>  <span class="im">from</span> inflammation.compute_data <span class="im">import</span> analyse_data</span>
<span id="cb19-5"><a href="#cb19-5" tabindex="-1"></a>  data_source <span class="op">=</span> Mock()</span>
<span id="cb19-6"><a href="#cb19-6" tabindex="-1"></a>  mock_data <span class="op">=</span> [[[<span class="dv">0</span>, <span class="dv">2</span>, <span class="dv">0</span>]],</span>
<span id="cb19-7"><a href="#cb19-7" tabindex="-1"></a>              [[<span class="dv">0</span>, <span class="dv">1</span>, <span class="dv">0</span>]]]</span>
<span id="cb19-8"><a href="#cb19-8" tabindex="-1"></a>  data_source.load_inflammation_data.return_value <span class="op">=</span> mock_data</span>
<span id="cb19-9"><a href="#cb19-9" tabindex="-1"></a></span>
<span id="cb19-10"><a href="#cb19-10" tabindex="-1"></a>  analyse_data(data_source)</span></code></pre>
</div>
</div>
</div>
</div>
</div>
</section><section><h2 class="section-heading" id="safe-code-structure-changes">Safe Code Structure Changes<a class="anchor" aria-label="anchor" href="#safe-code-structure-changes"></a>
</h2>
<hr class="half-width">
<p>With the changes to the code structure we have done using code
decoupling and abstractions we have already refactored our code to a
certain extent, but we have not fully tested that the changes work as
intended. We will now look into how to properly refactor code to
guarantee that the code still works as before any modifications.</p>
<div id="keypoints1" class="callout keypoints">
<div class="callout-square">
<i class="callout-icon" data-feather="key"></i>
</div>
<div class="callout-inner">
<h3 class="callout-title">Key Points</h3>
<div class="callout-content">
<ul>
<li>Code decoupling is separating code into smaller components and
reducing the interdependence between them so that the code is easier to
understand, test and maintain.</li>
<li>Abstractions can hide certain details of the code behind classes and
interfaces.</li>
<li>Encapsulation bundles data into a structured component along with
methods that operate on the data, and provides a mechanism for
restricting access to that data, hiding the internal representation of
the component.</li>
<li>Polymorphism describes the provision of a single interface to
entities of different types, or the use of a single symbol to represent
different types.</li>
</ul>
</div>
</div>
</div>
</section></section><section id="aio-34-code-refactoring"><p>Content from <a href="34-code-refactoring.html">3.4 Code Refactoring</a></p>
<hr>
<p>Last updated on 2025-05-27 |

        <a href="https://github.com/carpentries-incubator/python-intermediate-development/edit/main/episodes/34-code-refactoring.md" class="external-link">Edit this page <i aria-hidden="true" data-feather="edit"></i></a></p>
<p>Estimated time: <i aria-hidden="true" data-feather="clock"></i> 50 minutes</p>
<div class="text-end">
          <button role="button" aria-pressed="false" tabindex="0" id="expand-code" class="pull-right" data-expand="Expand All Solutions " data-collapse="Collapse All Solutions "> Expand All Solutions <i aria-hidden="true" data-feather="plus"></i></button>
        </div>
<div class="overview card">
<h2 class="card-header">Overview</h2>
<div class="row g-0">
<div class="col-md-4">
<div class="card-body">
<div class="inner">
<h3 class="card-title">Questions</h3>
<ul>
<li>How do you refactor existing code without breaking it?</li>
<li>What are benefits of using pure functions in code?</li>
</ul>
</div>
</div>
</div>
<div class="col-md-8">
<div class="card-body">
<div class="inner bordered">
<h3 class="card-title">Objectives</h3>
<ul>
<li>Employ code refactoring to improve the structure of existing
code.</li>
<li>Understand the use of regressions tests to avoid breaking existing
code when refactoring.</li>
<li>Understand the use of pure functions in software design to make the
code easier to read, test amd maintain.</li>
<li>Refactor a piece of code to separate out ‘pure’ from ‘impure’
code.</li>
</ul>
</div>
</div>
</div>
</div>
</div>
<section><h2 class="section-heading" id="introduction">Introduction<a class="anchor" aria-label="anchor" href="#introduction"></a>
</h2>
<hr class="half-width">
<p>Code refactoring is the process of improving the design of an
existing codebase - changing the internal structure of code without
changing its external behavior, with the goal of making the code more
readable, maintainable, efficient or easier to test. This can include
introducing things such as code decoupling and abstractions, but also
renaming variables, reorganising functions to avoid code duplication and
increase reuse, and simplifying conditional statements.</p>
<p>In the previous episode, we have already changed the structure of our
code (i.e. refactored it to a certain extent) when we separated out data
loading from data analysis but we have not tested that the new code
works as intended. This is particularly important with bigger code
changes but even a small change can easily break the codebase and
introduce bugs.</p>
<p>When faced with an existing piece of code that needs modifying a good
refactoring process to follow is:</p>
<ol style="list-style-type: decimal">
<li>Make sure you have tests that verify the current behaviour</li>
<li>Refactor the code</li>
<li>Verify that that the behaviour of the code is identical to that
before refactoring.</li>
</ol>
<p>In this episode we will further improve the code from our project in
the following two ways:</p>
<ul>
<li>add more tests so we can be more confident that future changes will
have the intended effect and will not break the existing code.</li>
<li>further split <code>analyse_data()</code> function into a number of
smaller and more decoupled functions (continuing the work from the
previous episode).</li>
</ul></section><section><h2 class="section-heading" id="writing-tests-before-refactoring">Writing Tests Before Refactoring<a class="anchor" aria-label="anchor" href="#writing-tests-before-refactoring"></a>
</h2>
<hr class="half-width">
<p>When refactoring, first we need to make sure there are tests in place
that can verify the code behaviour as it is now (or write them if they
are missing), then refactor the code and, finally, check that the
original tests still pass.</p>
<p>There is a bit of a “chicken and egg” problem here - if the
refactoring is supposed to make it easier to write tests in the future,
how can we write tests before doing the refactoring? The tricks to get
around this trap are:</p>
<ul>
<li>test at a higher level, with coarser accuracy, and</li>
<li>write tests that you intend to replace or remove.</li>
</ul>
<p>The best tests are the ones that test a single bit of functionality
rigorously. However, with our current <code>analyse_data()</code> code
that is not possible because it is a large function doing a little bit
of everything. Instead we will make minimal changes to the code to make
it a bit more testable.</p>
<p>Firstly, we will modify the function to return the data instead of
visualising it because graphs are harder to test automatically
(i.e. they need to be viewed and inspected manually in order to
determine their correctness). Next, we will make the assert statements
verify what the current outcome is, rather than check whether that is
correct or not. Such tests are meant to verify that the behaviour does
not <em>change</em> rather than checking the current behaviour is
correct (there should be another set of tests checking the correctness).
This kind of testing is called <strong>regression testing</strong> as we
are testing for regressions in existing behaviour.</p>
<p>Refactoring code is not meant to change its behaviour, but sometimes
to make it possible to verify you are not changing the important
behaviour you have to make small tweaks to the code to write the tests
at all.</p>
<div id="exercise-write-regression-tests" class="callout challenge">
<div class="callout-square">
<i class="callout-icon" data-feather="zap"></i>
</div>
<div id="exercise-write-regression-tests" class="callout-inner">
<h3 class="callout-title">Exercise: Write Regression Tests</h3>
<div class="callout-content">
<p>Modify the <code>analyse_data()</code> function not to plot a graph
and return the data instead. Then, add a new test file called
<code>test_compute_data.py</code> in the <code>tests</code> folder and
add a regression test to verify the current output of
<code>analyse_data()</code>. We will use this test in the remainder of
this section to verify the output <code>analyse_data()</code> is
unchanged each time we refactor or change code in the future.</p>
<p>Start from the skeleton test code below:</p>
<div class="codewrapper sourceCode" id="cb1">
<h3 class="code-label">PYTHON<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="sourceCode python" tabindex="0"><code class="sourceCode python"><span id="cb1-1"><a href="#cb1-1" tabindex="-1"></a><span class="im">from</span> inflammation.compute_data <span class="im">import</span> analyse_data</span>
<span id="cb1-2"><a href="#cb1-2" tabindex="-1"></a></span>
<span id="cb1-3"><a href="#cb1-3" tabindex="-1"></a><span class="kw">def</span> test_analyse_data():</span>
<span id="cb1-4"><a href="#cb1-4" tabindex="-1"></a>    path <span class="op">=</span> os.path.join( os.getcwd(), <span class="st">"../data"</span>)</span>
<span id="cb1-5"><a href="#cb1-5" tabindex="-1"></a>    data_source <span class="op">=</span> CSVDataSource(path)</span>
<span id="cb1-6"><a href="#cb1-6" tabindex="-1"></a>    result <span class="op">=</span> analyse_data(data_source)</span>
<span id="cb1-7"><a href="#cb1-7" tabindex="-1"></a>    <span class="co"># </span><span class="al">TODO</span><span class="co">: add assert statement(s) to test the result value is as expected</span></span></code></pre>
</div>
<p>Use <code>assert_array_almost_equal</code> from the
<code>numpy.testing</code> library to compare arrays of floating point
numbers.</p>
</div>
</div>
</div>
<div id="accordionSolution1" class="accordion challenge-accordion accordion-flush">
<div class="accordion-item">
<button class="accordion-button solution-button collapsed" type="button" data-bs-toggle="collapse" data-bs-target="#collapseSolution1" aria-expanded="false" aria-controls="collapseSolution1">
  <h4 class="accordion-header" id="headingSolution1"> Hint </h4>
</button>
<div id="collapseSolution1" class="accordion-collapse collapse" aria-labelledby="headingSolution1" data-bs-parent="#accordionSolution1">
<div class="accordion-body">
<p>When determining the correct return data result to use in tests, it
may be helpful to assert the result equals some random made-up data,
observe the test fail initially and then copy and paste the correct
result into the test.</p>
</div>
</div>
</div>
</div>
<div id="accordionSolution2" class="accordion challenge-accordion accordion-flush">
<div class="accordion-item">
<button class="accordion-button solution-button collapsed" type="button" data-bs-toggle="collapse" data-bs-target="#collapseSolution2" aria-expanded="false" aria-controls="collapseSolution2">
  <h4 class="accordion-header" id="headingSolution2"> Show me the solution </h4>
</button>
<div id="collapseSolution2" class="accordion-collapse collapse" aria-labelledby="headingSolution2" data-bs-parent="#accordionSolution2">
<div class="accordion-body">
<p>One approach we can take is to:</p>
<ul>
<li>comment out the visualise method on <code>analyse_data()</code>
(this will cause our test to hang waiting for the result data)</li>
<li>return the data (instead of plotting it on a graph), so we can write
assert statements on the data</li>
<li>see what the calculated result value is, and assert that it is the
same as the expected value</li>
</ul>
<p>Putting this together, our test may look like:</p>
<div class="codewrapper sourceCode" id="cb2">
<h3 class="code-label">PYTHON<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="sourceCode python" tabindex="0"><code class="sourceCode python"><span id="cb2-1"><a href="#cb2-1" tabindex="-1"></a><span class="im">import</span> numpy.testing <span class="im">as</span> npt</span>
<span id="cb2-2"><a href="#cb2-2" tabindex="-1"></a><span class="im">from</span> inflammation.compute_data <span class="im">import</span> analyse_data</span>
<span id="cb2-3"><a href="#cb2-3" tabindex="-1"></a></span>
<span id="cb2-4"><a href="#cb2-4" tabindex="-1"></a><span class="kw">def</span> test_analyse_data():</span>
<span id="cb2-5"><a href="#cb2-5" tabindex="-1"></a>    path <span class="op">=</span> os.path.join( os.getcwd(), <span class="st">"../data"</span>)</span>
<span id="cb2-6"><a href="#cb2-6" tabindex="-1"></a>    data_source <span class="op">=</span> CSVDataSource(path)</span>
<span id="cb2-7"><a href="#cb2-7" tabindex="-1"></a>    result <span class="op">=</span> analyse_data(data_source)</span>
<span id="cb2-8"><a href="#cb2-8" tabindex="-1"></a>    expected_output <span class="op">=</span> [<span class="fl">0.</span>,<span class="fl">0.22510286</span>,<span class="fl">0.18157299</span>,<span class="fl">0.1264423</span>,<span class="fl">0.9495481</span>,<span class="fl">0.27118211</span>,</span>
<span id="cb2-9"><a href="#cb2-9" tabindex="-1"></a>                       <span class="fl">0.25104719</span>,<span class="fl">0.22330897</span>,<span class="fl">0.89680503</span>,<span class="fl">0.21573875</span>,<span class="fl">1.24235548</span>,<span class="fl">0.63042094</span>,</span>
<span id="cb2-10"><a href="#cb2-10" tabindex="-1"></a>                       <span class="fl">1.57511696</span>,<span class="fl">2.18850242</span>,<span class="fl">0.3729574</span>,<span class="fl">0.69395538</span>,<span class="fl">2.52365162</span>,<span class="fl">0.3179312</span>,</span>
<span id="cb2-11"><a href="#cb2-11" tabindex="-1"></a>                       <span class="fl">1.22850657</span>,<span class="fl">1.63149639</span>,<span class="fl">2.45861227</span>,<span class="fl">1.55556052</span>,<span class="fl">2.8214853</span>,<span class="fl">0.92117578</span>,</span>
<span id="cb2-12"><a href="#cb2-12" tabindex="-1"></a>                       <span class="fl">0.76176979</span>,<span class="fl">2.18346188</span>,<span class="fl">0.55368435</span>,<span class="fl">1.78441632</span>,<span class="fl">0.26549221</span>,<span class="fl">1.43938417</span>,</span>
<span id="cb2-13"><a href="#cb2-13" tabindex="-1"></a>                       <span class="fl">0.78959769</span>,<span class="fl">0.64913879</span>,<span class="fl">1.16078544</span>,<span class="fl">0.42417995</span>,<span class="fl">0.36019114</span>,<span class="fl">0.80801707</span>,</span>
<span id="cb2-14"><a href="#cb2-14" tabindex="-1"></a>                       <span class="fl">0.50323031</span>,<span class="fl">0.47574665</span>,<span class="fl">0.45197398</span>,<span class="fl">0.22070227</span>]</span>
<span id="cb2-15"><a href="#cb2-15" tabindex="-1"></a>    npt.assert_array_almost_equal(result, expected_output)</span></code></pre>
</div>
<p>Note that while the above test will detect if we accidentally break
the analysis code and change the output of the analysis, it is still not
a complete test for the following reasons:</p>
<ul>
<li>It is not obvious why the <code>expected_output</code> is
correct</li>
<li>It does not test edge cases</li>
<li>If the data files in the directory change - the test will fail</li>
</ul>
<p>We would need to add additional tests to check the above.</p>
</div>
</div>
</div>
</div>
</section><section><h2 class="section-heading" id="separating-pure-and-impure-code">Separating Pure and Impure Code<a class="anchor" aria-label="anchor" href="#separating-pure-and-impure-code"></a>
</h2>
<hr class="half-width">
<p>Now that we have our regression test for <code>analyse_data()</code>
in place, we are ready to refactor the function further. We would like
to separate out as much of its code as possible as <em>pure
functions</em>.</p>
<div class="section level3">
<h3 id="pure-functions">Pure Functions<a class="anchor" aria-label="anchor" href="#pure-functions"></a>
</h3>
<p>A pure function in programming works like a mathematical function -
it takes in some input and produces an output and that output is always
the same for the same input. That is, the output of a pure function does
not depend on any information which is not present in the input (such as
global variables). Furthermore, pure functions do not cause any <em>side
effects</em> - they do not modify the input data or data that exist
outside the function (such as printing text, writing to a file or
changing a global variable). They perform actions that affect nothing
but the value they return.</p>
</div>
<div class="section level3">
<h3 id="benefits-of-pure-functions">Benefits of Pure Functions<a class="anchor" aria-label="anchor" href="#benefits-of-pure-functions"></a>
</h3>
<p>Pure functions are easier to understand because they eliminate side
effects. The reader only needs to concern themselves with the input
parameters of the function and the function code itself, rather than the
overall context the function is operating in. Similarly, a function that
calls a pure function is also easier to understand - we only need to
understand what the function returns, which will probably be clear from
the context in which the function is called. Finally, pure functions are
easier to reuse as the caller only needs to understand what parameters
to provide, rather than anything else that might need to be configured
prior to the call. For these reasons, you should try and have as much of
the complex, analytical and mathematical code are pure functions.</p>
<p>Some parts of a program are inevitably impure. Programs need to read
input from users, generate a graph, or write results to a file or a
database. Well designed programs separate complex logic from the
necessary impure “glue” code that interacts with users and other
systems. This way, you have easy-to-read and easy-to-test pure code that
contains the complex logic and simplified impure code that reads data
from a file or gathers user input. Impure code may be harder to test
but, when simplified like this, may only require a handful of tests
anyway.</p>
<div id="exercise-refactoring-to-use-a-pure-function" class="callout challenge">
<div class="callout-square">
<i class="callout-icon" data-feather="zap"></i>
</div>
<div id="exercise-refactoring-to-use-a-pure-function" class="callout-inner">
<h3 class="callout-title">Exercise: Refactoring To Use a Pure Function</h3>
<div class="callout-content">
<p>Refactor the <code>analyse_data()</code> function to delegate the
data analysis to a new pure function
<code>compute_standard_deviation_by_day()</code> and separate it from
the impure code that handles the input and output. The pure function
should take in the data, and return the analysis result, as follows:</p>
<div class="codewrapper sourceCode" id="cb3">
<h3 class="code-label">PYTHON<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="sourceCode python" tabindex="0"><code class="sourceCode python"><span id="cb3-1"><a href="#cb3-1" tabindex="-1"></a><span class="kw">def</span> compute_standard_deviation_by_day(data):</span>
<span id="cb3-2"><a href="#cb3-2" tabindex="-1"></a>    <span class="co"># </span><span class="al">TODO</span></span>
<span id="cb3-3"><a href="#cb3-3" tabindex="-1"></a>    <span class="cf">return</span> daily_standard_deviation</span></code></pre>
</div>
</div>
</div>
</div>
<div id="accordionSolution3" class="accordion challenge-accordion accordion-flush">
<div class="accordion-item">
<button class="accordion-button solution-button collapsed" type="button" data-bs-toggle="collapse" data-bs-target="#collapseSolution3" aria-expanded="false" aria-controls="collapseSolution3">
  <h4 class="accordion-header" id="headingSolution3"> Show me the solution </h4>
</button>
<div id="collapseSolution3" class="accordion-collapse collapse" aria-labelledby="headingSolution3" data-bs-parent="#accordionSolution3">
<div class="accordion-body">
<p>The analysis code will be refactored into a separate function that
may look something like:</p>
<div class="codewrapper sourceCode" id="cb4">
<h3 class="code-label">PYTHON<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="sourceCode python" tabindex="0"><code class="sourceCode python"><span id="cb4-1"><a href="#cb4-1" tabindex="-1"></a><span class="kw">def</span> compute_standard_deviation_by_day(data):</span>
<span id="cb4-2"><a href="#cb4-2" tabindex="-1"></a>    means_by_day <span class="op">=</span> <span class="bu">map</span>(models.daily_mean, data)</span>
<span id="cb4-3"><a href="#cb4-3" tabindex="-1"></a>    means_by_day_matrix <span class="op">=</span> np.stack(<span class="bu">list</span>(means_by_day))</span>
<span id="cb4-4"><a href="#cb4-4" tabindex="-1"></a></span>
<span id="cb4-5"><a href="#cb4-5" tabindex="-1"></a>    daily_standard_deviation <span class="op">=</span> np.std(means_by_day_matrix, axis<span class="op">=</span><span class="dv">0</span>)</span>
<span id="cb4-6"><a href="#cb4-6" tabindex="-1"></a>    <span class="cf">return</span> daily_standard_deviation</span></code></pre>
</div>
<p>The <code>analyse_data()</code> function now calls the
<code>compute_standard_deviation_by_day()</code> function, while keeping
all the logic for reading the data, processing it and showing it in a
graph:</p>
<div class="codewrapper sourceCode" id="cb5">
<h3 class="code-label">PYTHON<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="sourceCode python" tabindex="0"><code class="sourceCode python"><span id="cb5-1"><a href="#cb5-1" tabindex="-1"></a><span class="kw">def</span> analyse_data(data_dir):</span>
<span id="cb5-2"><a href="#cb5-2" tabindex="-1"></a>    <span class="co">"""Calculates the standard deviation by day between datasets.</span></span>
<span id="cb5-3"><a href="#cb5-3" tabindex="-1"></a><span class="co">    Gets all the inflammation data from CSV files within a directory, works out the mean</span></span>
<span id="cb5-4"><a href="#cb5-4" tabindex="-1"></a><span class="co">    inflammation value for each day across all datasets, then visualises the</span></span>
<span id="cb5-5"><a href="#cb5-5" tabindex="-1"></a><span class="co">    standard deviation of these means on a graph."""</span></span>
<span id="cb5-6"><a href="#cb5-6" tabindex="-1"></a>    data_file_paths <span class="op">=</span> glob.glob(os.path.join(data_dir, <span class="st">'inflammation*.csv'</span>))</span>
<span id="cb5-7"><a href="#cb5-7" tabindex="-1"></a>    <span class="cf">if</span> <span class="bu">len</span>(data_file_paths) <span class="op">==</span> <span class="dv">0</span>:</span>
<span id="cb5-8"><a href="#cb5-8" tabindex="-1"></a>        <span class="cf">raise</span> <span class="pp">ValueError</span>(<span class="ss">f"No inflammation csv's found in path </span><span class="sc">{</span>data_dir<span class="sc">}</span><span class="ss">"</span>)</span>
<span id="cb5-9"><a href="#cb5-9" tabindex="-1"></a>    data <span class="op">=</span> <span class="bu">map</span>(models.load_csv, data_file_paths)</span>
<span id="cb5-10"><a href="#cb5-10" tabindex="-1"></a>    daily_standard_deviation <span class="op">=</span> compute_standard_deviation_by_day(data)</span>
<span id="cb5-11"><a href="#cb5-11" tabindex="-1"></a></span>
<span id="cb5-12"><a href="#cb5-12" tabindex="-1"></a>    graph_data <span class="op">=</span> {</span>
<span id="cb5-13"><a href="#cb5-13" tabindex="-1"></a>        <span class="st">'standard deviation by day'</span>: daily_standard_deviation,</span>
<span id="cb5-14"><a href="#cb5-14" tabindex="-1"></a>    }</span>
<span id="cb5-15"><a href="#cb5-15" tabindex="-1"></a>    <span class="co"># views.visualize(graph_data)</span></span>
<span id="cb5-16"><a href="#cb5-16" tabindex="-1"></a>    <span class="cf">return</span> daily_standard_deviation</span></code></pre>
</div>
<p>Make sure to re-run the regression test to check this refactoring has
not changed the output of <code>analyse_data()</code>.</p>
</div>
</div>
</div>
</div>
</div>
<div class="section level3">
<h3 id="testing-pure-functions">Testing Pure Functions<a class="anchor" aria-label="anchor" href="#testing-pure-functions"></a>
</h3>
<p>Now we have our analysis implemented as a pure function, we can write
tests that cover all the things we would like to check without depending
on CSVs files. This is another advantage of pure functions - they are
very well suited to automated testing, i.e. their tests are:</p>
<ul>
<li>
<strong>easier to write</strong> - we construct input and assert the
output without having to think about making sure the global state is
correct before or after</li>
<li>
<strong>easier to read</strong> - the reader will not have to open a
CSV file to understand why the test is correct</li>
<li>
<strong>easier to maintain</strong> - if at some point the data
format changes from CSV to JSON, the bulk of the tests need not be
updated</li>
</ul>
<div id="exercise-testing-a-pure-function" class="callout challenge">
<div class="callout-square">
<i class="callout-icon" data-feather="zap"></i>
</div>
<div id="exercise-testing-a-pure-function" class="callout-inner">
<h3 class="callout-title">Exercise: Testing a Pure Function</h3>
<div class="callout-content">
<p>Add tests for <code>compute_standard_deviation_by_data()</code> that
check for situations when there is only one file with multiple rows,
multiple files with one row, and any other cases you can think of that
should be tested.</p>
</div>
</div>
</div>
<div id="accordionSolution4" class="accordion challenge-accordion accordion-flush">
<div class="accordion-item">
<button class="accordion-button solution-button collapsed" type="button" data-bs-toggle="collapse" data-bs-target="#collapseSolution4" aria-expanded="false" aria-controls="collapseSolution4">
  <h4 class="accordion-header" id="headingSolution4"> Show me the solution </h4>
</button>
<div id="collapseSolution4" class="accordion-collapse collapse" aria-labelledby="headingSolution4" data-bs-parent="#accordionSolution4">
<div class="accordion-body">
<p>You might have thought of more tests, but we can easily extend the
test by parametrizing with more inputs and expected outputs:</p>
<div class="codewrapper sourceCode" id="cb6">
<h3 class="code-label">PYTHON<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="sourceCode python" tabindex="0"><code class="sourceCode python"><span id="cb6-1"><a href="#cb6-1" tabindex="-1"></a><span class="at">@pytest.mark.parametrize</span>(<span class="st">'data,expected_output'</span>, [</span>
<span id="cb6-2"><a href="#cb6-2" tabindex="-1"></a>    ([[[<span class="dv">0</span>, <span class="dv">1</span>, <span class="dv">0</span>], [<span class="dv">0</span>, <span class="dv">2</span>, <span class="dv">0</span>]]], [<span class="dv">0</span>, <span class="dv">0</span>, <span class="dv">0</span>]),</span>
<span id="cb6-3"><a href="#cb6-3" tabindex="-1"></a>    ([[[<span class="dv">0</span>, <span class="dv">2</span>, <span class="dv">0</span>]], [[<span class="dv">0</span>, <span class="dv">1</span>, <span class="dv">0</span>]]], [<span class="dv">0</span>, math.sqrt(<span class="fl">0.25</span>), <span class="dv">0</span>]),</span>
<span id="cb6-4"><a href="#cb6-4" tabindex="-1"></a>    ([[[<span class="dv">0</span>, <span class="dv">1</span>, <span class="dv">0</span>], [<span class="dv">0</span>, <span class="dv">2</span>, <span class="dv">0</span>]], [[<span class="dv">0</span>, <span class="dv">1</span>, <span class="dv">0</span>], [<span class="dv">0</span>, <span class="dv">2</span>, <span class="dv">0</span>]]], [<span class="dv">0</span>, <span class="dv">0</span>, <span class="dv">0</span>])</span>
<span id="cb6-5"><a href="#cb6-5" tabindex="-1"></a>],</span>
<span id="cb6-6"><a href="#cb6-6" tabindex="-1"></a>ids<span class="op">=</span>[<span class="st">'Two patients in same file'</span>, <span class="st">'Two patients in different files'</span>, <span class="st">'Two identical patients in two different files'</span>])</span>
<span id="cb6-7"><a href="#cb6-7" tabindex="-1"></a><span class="kw">def</span> test_compute_standard_deviation_by_day(data, expected_output):</span>
<span id="cb6-8"><a href="#cb6-8" tabindex="-1"></a>    <span class="im">from</span> inflammation.compute_data <span class="im">import</span> compute_standard_deviation_by_data</span>
<span id="cb6-9"><a href="#cb6-9" tabindex="-1"></a></span>
<span id="cb6-10"><a href="#cb6-10" tabindex="-1"></a>    result <span class="op">=</span> compute_standard_deviation_by_data(data)</span>
<span id="cb6-11"><a href="#cb6-11" tabindex="-1"></a>    npt.assert_array_almost_equal(result, expected_output)</span></code></pre>
</div>
</div>
</div>
</div>
</div>
<div id="functional-programming" class="callout">
<div class="callout-square">
<i class="callout-icon" data-feather="bell"></i>
</div>
<div id="functional-programming" class="callout-inner">
<h3 class="callout-title">Functional Programming</h3>
<div class="callout-content">
<p><strong>Functional programming</strong> is a programming paradigm
where programs are constructed by applying and composing/chaining pure
functions. Some programming languages, such as Haskell or Lisp, support
writing pure functional code only. Other languages, such as Python,
Java, C++, allow mixing <strong>functional</strong> and
<strong>procedural</strong> programming paradigms. Read more in the <a href="functional-programming.html">extra episode on functional
programming</a> and when it can be very useful to switch to this
paradigm (e.g. to employ MapReduce approach for data processing).</p>
</div>
</div>
</div>
<p>There are no definite rules in software design but making your
complex logic out of composed pure functions is a great place to start
when trying to make your code readable, testable and maintainable. This
is particularly useful for:</p>
<ul>
<li>Data processing and analysis (for example, using <a href="https://pandas.pydata.org/" class="external-link">Python Pandas library</a> for data
manipulation where most of functions appear pure)</li>
<li>Doing simulations (? needs more explanation)</li>
<li>Translating data from one format to another (? an example would be
good)</li>
</ul>
</div>
</section><section><h2 class="section-heading" id="programming-paradigms">Programming Paradigms<a class="anchor" aria-label="anchor" href="#programming-paradigms"></a>
</h2>
<hr class="half-width">
<p>Until this section, we have mainly been writing procedural code. In
the previous episode, we have touched a bit upon classes, encapsulation
and polymorphism, which are characteristics of (but not limited to) the
object-oriented programming (OOP). In this episode, we mentioned <a href="./index.html#pure-functions">pure functions</a> and Functional
Programming.</p>
<p>These are examples of different <a href="programming-paradigms.html">programming paradigms</a> and provide
varied approaches to structuring your code - each with certain strengths
and weaknesses when used to solve particular types of problems. In many
cases, particularly with modern languages, a single language can allow
many different structural approaches and mixing programming paradigms
within your code. Once your software begins to get more complex - it is
common to use aspects of <a href="programming-paradigms.html">different
paradigm</a> to handle different subtasks. Because of this, it is useful
to know about the <a href="programming-paradigms.html">major
paradigms</a>, so you can recognise where it might be useful to switch.
This is outside of scope of this course - we have some extra episodes on
the topics of <a href="procedural-programming.html">procedural
programming</a>, <a href="functional-programming.html">functional
programming</a> and <a href="object-oriented-programming.html">object-oriented programming</a>
if you want to know more.</p>
<div id="so-which-one-is-python" class="callout">
<div class="callout-square">
<i class="callout-icon" data-feather="bell"></i>
</div>
<div id="so-which-one-is-python" class="callout-inner">
<h3 class="callout-title">So Which One is Python?</h3>
<div class="callout-content">
<p>Python is a multi-paradigm and multi-purpose programming language.
You can use it as a procedural language and you can use it in a more
object oriented way. It does tend to land more on the object oriented
side as all its core data types (strings, integers, floats, booleans,
lists, sets, arrays, tuples, dictionaries, files) as well as functions,
modules and classes are objects.</p>
<p>Since functions in Python are also objects that can be passed around
like any other object, Python is also well suited to functional
programming. One of the most popular Python libraries for data
manipulation, <a href="https://pandas.pydata.org/" class="external-link">Pandas</a> (built on
top of NumPy), supports a functional programming style as most of its
functions on data are not changing the data (no side effects) but
producing a new data to reflect the result of the function.</p>
</div>
</div>
</div>
</section><section><h2 class="section-heading" id="software-design-and-architecture">Software Design and Architecture<a class="anchor" aria-label="anchor" href="#software-design-and-architecture"></a>
</h2>
<hr class="half-width">
<p>In this section so far we have been talking about <strong>software
design</strong> - the individual modules and components of the software.
We are now going to have a brief look into <strong>software
architecture</strong> - which is about the overall structure that these
software components fit into, a <em>design pattern</em> with a common
successful use of software components.</p>
<div id="keypoints1" class="callout keypoints">
<div class="callout-square">
<i class="callout-icon" data-feather="key"></i>
</div>
<div class="callout-inner">
<h3 class="callout-title">Key Points</h3>
<div class="callout-content">
<ul>
<li>Code refactoring is a technique for improving the structure of
existing code.</li>
<li>Implementing regression tests before refactoring gives you
confidence that your changes have not broken the code.</li>
<li>Using pure functions that process data without side effects whenever
possible makes the code easier to understand, test and maintain.</li>
</ul>
</div>
</div>
</div>
</section></section><section id="aio-35-software-architecture-revisited"><p>Content from <a href="35-software-architecture-revisited.html">3.5 Software Architecture Revisited</a></p>
<hr>
<p>Last updated on 2024-12-06 |

        <a href="https://github.com/carpentries-incubator/python-intermediate-development/edit/main/episodes/35-software-architecture-revisited.md" class="external-link">Edit this page <i aria-hidden="true" data-feather="edit"></i></a></p>
<p>Estimated time: <i aria-hidden="true" data-feather="clock"></i> 45 minutes</p>
<div class="text-end">
          <button role="button" aria-pressed="false" tabindex="0" id="expand-code" class="pull-right" data-expand="Expand All Solutions " data-collapse="Collapse All Solutions "> Expand All Solutions <i aria-hidden="true" data-feather="plus"></i></button>
        </div>
<div class="overview card">
<h2 class="card-header">Overview</h2>
<div class="row g-0">
<div class="col-md-4">
<div class="card-body">
<div class="inner">
<h3 class="card-title">Questions</h3>
<ul>
<li>How do we handle code contributions that do not fit within our
existing architecture?</li>
</ul>
</div>
</div>
</div>
<div class="col-md-8">
<div class="card-body">
<div class="inner bordered">
<h3 class="card-title">Objectives</h3>
<ul>
<li>Analyse new code to identify Model, View, Controller aspects.</li>
<li>Refactor new code to conform to an MVC architecture.</li>
<li>Adapt our existing code to include the new re-architected code.</li>
</ul>
</div>
</div>
</div>
</div>
</div>
<p>In the previous few episodes we have looked at the importance and
principles of good software architecture and design, and how techniques
such as code abstraction and refactoring fulfil that design within an
implementation, and help us maintain and improve it as our code
evolves.</p>
<p>Let us now return to software architecture and consider how we may
refactor some new code to fit within our existing MVC architectural
design using the techniques we have learnt so far.</p>
<section><h2 class="section-heading" id="revisiting-our-softwares-architecture">Revisiting Our Software’s Architecture<a class="anchor" aria-label="anchor" href="#revisiting-our-softwares-architecture"></a>
</h2>
<hr class="half-width">
<p>Recall that in our software project, the <strong>Controller</strong>
module is in <code>inflammation-analysis.py</code>, and the View and
Model modules are contained in <code>inflammation/views.py</code> and
<code>inflammation/models.py</code>, respectively. Data underlying the
Model is contained within the directory <code>data</code>.</p>
<p>Looking at the code in the branch <code>full-data-analysis</code>
(where we should be currently located), we can notice that the new code
was added in a separate script <code>inflammation/compute_data.py</code>
and contains a mix of Model, View and Controller code.</p>
<div id="exercise-identify-model-view-and-controller-parts-of-the-code" class="callout challenge">
<div class="callout-square">
<i class="callout-icon" data-feather="zap"></i>
</div>
<div id="exercise-identify-model-view-and-controller-parts-of-the-code" class="callout-inner">
<h3 class="callout-title">Exercise: Identify Model, View and Controller Parts of the Code</h3>
<div class="callout-content">
<p>Looking at the code inside <code>compute_data.py</code>, what parts
could be considered Model, View and Controller code?</p>
</div>
</div>
</div>
<div id="accordionSolution1" class="accordion challenge-accordion accordion-flush">
<div class="accordion-item">
<button class="accordion-button solution-button collapsed" type="button" data-bs-toggle="collapse" data-bs-target="#collapseSolution1" aria-expanded="false" aria-controls="collapseSolution1">
  <h4 class="accordion-header" id="headingSolution1"> Show me the solution </h4>
</button>
<div id="collapseSolution1" class="accordion-collapse collapse" data-bs-parent="#accordionSolution1" aria-labelledby="headingSolution1">
<div class="accordion-body">
<ul>
<li>Computing the standard deviation belongs to Model.</li>
<li>Reading the data from CSV files also belongs to Model.</li>
<li>Displaying of the output as a graph is View.</li>
<li>The logic that processes the supplied files is Controller.</li>
</ul>
</div>
</div>
</div>
</div>
<p>Within the Model further separations make sense. For example, as we
did in the before, separating out the impure code that interacts with
the file system from the pure calculations helps with readability and
testability. Nevertheless, the MVC architectural pattern is a great
starting point when thinking about how you should structure your
code.</p>
<div id="exercise-split-out-the-model-view-and-controller-code" class="callout challenge">
<div class="callout-square">
<i class="callout-icon" data-feather="zap"></i>
</div>
<div id="exercise-split-out-the-model-view-and-controller-code" class="callout-inner">
<h3 class="callout-title">Exercise: Split out the Model, View and Controller Code</h3>
<div class="callout-content">
<p>Refactor <code>analyse_data()</code> function so that the Model, View
and Controller code we identified in the previous exercise is moved to
appropriate modules.</p>
</div>
</div>
</div>
<div id="accordionSolution2" class="accordion challenge-accordion accordion-flush">
<div class="accordion-item">
<button class="accordion-button solution-button collapsed" type="button" data-bs-toggle="collapse" data-bs-target="#collapseSolution2" aria-expanded="false" aria-controls="collapseSolution2">
  <h4 class="accordion-header" id="headingSolution2"> Show me the solution </h4>
</button>
<div id="collapseSolution2" class="accordion-collapse collapse" data-bs-parent="#accordionSolution2" aria-labelledby="headingSolution2">
<div class="accordion-body">
<p>The idea here is for the <code>analyse_data()</code> function not to
have any “view” considerations. That is, it should just compute and
return the data and should be located in
<code>inflammation/models.py</code>.</p>
<div class="codewrapper sourceCode" id="cb1">
<h3 class="code-label">PYTHON<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="sourceCode python" tabindex="0"><code class="sourceCode python"><span id="cb1-1"><a href="#cb1-1" tabindex="-1"></a><span class="kw">def</span> analyse_data(data_source):</span>
<span id="cb1-2"><a href="#cb1-2" tabindex="-1"></a>    <span class="co">"""Calculate the standard deviation by day between datasets</span></span>
<span id="cb1-3"><a href="#cb1-3" tabindex="-1"></a><span class="co">    Gets all the inflammation csvs within a directory, works out the mean</span></span>
<span id="cb1-4"><a href="#cb1-4" tabindex="-1"></a><span class="co">    inflammation value for each day across all datasets, then graphs the</span></span>
<span id="cb1-5"><a href="#cb1-5" tabindex="-1"></a><span class="co">    standard deviation of these means."""</span></span>
<span id="cb1-6"><a href="#cb1-6" tabindex="-1"></a>    data <span class="op">=</span> data_source.load_inflammation_data()</span>
<span id="cb1-7"><a href="#cb1-7" tabindex="-1"></a>    daily_standard_deviation <span class="op">=</span> compute_standard_deviation_by_data(data)</span>
<span id="cb1-8"><a href="#cb1-8" tabindex="-1"></a></span>
<span id="cb1-9"><a href="#cb1-9" tabindex="-1"></a>    <span class="cf">return</span> daily_standard_deviation</span></code></pre>
</div>
<p>There can be a separate bit of code in the Controller
<code>inflammation-analysis.py</code> that chooses how data should be
presented, e.g. as a graph:</p>
<div class="codewrapper sourceCode" id="cb2">
<h3 class="code-label">PYTHON<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="sourceCode python" tabindex="0"><code class="sourceCode python"><span id="cb2-1"><a href="#cb2-1" tabindex="-1"></a><span class="cf">if</span> args.full_data_analysis:</span>
<span id="cb2-2"><a href="#cb2-2" tabindex="-1"></a>    _, extension <span class="op">=</span> os.path.splitext(infiles[<span class="dv">0</span>])</span>
<span id="cb2-3"><a href="#cb2-3" tabindex="-1"></a>    <span class="cf">if</span> extension <span class="op">==</span> <span class="st">'.json'</span>:</span>
<span id="cb2-4"><a href="#cb2-4" tabindex="-1"></a>        data_source <span class="op">=</span> JSONDataSource(os.path.dirname(infiles[<span class="dv">0</span>]))</span>
<span id="cb2-5"><a href="#cb2-5" tabindex="-1"></a>    <span class="cf">elif</span> extension <span class="op">==</span> <span class="st">'.csv'</span>:</span>
<span id="cb2-6"><a href="#cb2-6" tabindex="-1"></a>        data_source <span class="op">=</span> CSVDataSource(os.path.dirname(infiles[<span class="dv">0</span>]))</span>
<span id="cb2-7"><a href="#cb2-7" tabindex="-1"></a>    <span class="cf">else</span>:</span>
<span id="cb2-8"><a href="#cb2-8" tabindex="-1"></a>        <span class="cf">raise</span> <span class="pp">ValueError</span>(<span class="ss">f'Unsupported file format: </span><span class="sc">{</span>extension<span class="sc">}</span><span class="ss">'</span>)</span>
<span id="cb2-9"><a href="#cb2-9" tabindex="-1"></a>    data_result <span class="op">=</span> analyse_data(data_source)</span>
<span id="cb2-10"><a href="#cb2-10" tabindex="-1"></a>    graph_data <span class="op">=</span> {</span>
<span id="cb2-11"><a href="#cb2-11" tabindex="-1"></a>        <span class="st">'standard deviation by day'</span>: data_result,</span>
<span id="cb2-12"><a href="#cb2-12" tabindex="-1"></a>    }</span>
<span id="cb2-13"><a href="#cb2-13" tabindex="-1"></a>    views.visualize(graph_data)</span>
<span id="cb2-14"><a href="#cb2-14" tabindex="-1"></a>    <span class="cf">return</span></span></code></pre>
</div>
<p>Note that this is, more or less, the change we did to write our
regression test. This demonstrates that splitting up Model code from
View code can immediately make your code much more testable. Ensure you
re-run our regression test to check this refactoring has not changed the
output of <code>analyse_data()</code>.</p>
</div>
</div>
</div>
</div>
<p>At this point, you have refactored and tested all the code on branch
<code>full-data-analysis</code> and it is working as expected. The
branch is ready to be incorporated into <code>develop</code> and then,
later on, <code>main</code>, which may also have been changed by other
developers working on the code at the same time so make sure to update
accordingly or resolve any conflicts.</p>
<div class="codewrapper sourceCode" id="cb3">
<h3 class="code-label">BASH<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="sourceCode bash" tabindex="0"><code class="sourceCode bash"><span id="cb3-1"><a href="#cb3-1" tabindex="-1"></a><span class="ex">$</span> git switch develop</span>
<span id="cb3-2"><a href="#cb3-2" tabindex="-1"></a><span class="ex">$</span> git merge full-data-analysis</span></code></pre>
</div>
<p>Let us now have a closer look at our Controller, and how can handling
command line arguments in Python (which is something you may find
yourself doing often if you need to run the code from a command line
tool).</p>
<div class="section level3">
<h3 id="controller-structure">Controller Structure<a class="anchor" aria-label="anchor" href="#controller-structure"></a>
</h3>
<p>You will have noticed already that structure of the
<code>inflammation-analysis.py</code> file follows this pattern:</p>
<div class="codewrapper sourceCode" id="cb4">
<h3 class="code-label">PYTHON<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="sourceCode python" tabindex="0"><code class="sourceCode python"><span id="cb4-1"><a href="#cb4-1" tabindex="-1"></a><span class="co"># import modules</span></span>
<span id="cb4-2"><a href="#cb4-2" tabindex="-1"></a></span>
<span id="cb4-3"><a href="#cb4-3" tabindex="-1"></a><span class="kw">def</span> main(args):</span>
<span id="cb4-4"><a href="#cb4-4" tabindex="-1"></a>    <span class="co"># perform some actions</span></span>
<span id="cb4-5"><a href="#cb4-5" tabindex="-1"></a></span>
<span id="cb4-6"><a href="#cb4-6" tabindex="-1"></a><span class="cf">if</span> <span class="va">__name__</span> <span class="op">==</span> <span class="st">"__main__"</span>:</span>
<span id="cb4-7"><a href="#cb4-7" tabindex="-1"></a>    <span class="co"># perform some actions before main()</span></span>
<span id="cb4-8"><a href="#cb4-8" tabindex="-1"></a>    main(args)</span></code></pre>
</div>
<p>In this pattern the actions performed by the script are contained
within the <code>main</code> function (which does not need to be called
<code>main</code>, but using this convention helps others in
understanding your code). The <code>main</code> function is then called
within the <code>if</code> statement
<code>__name__ == "__main__"</code>, after some other actions have been
performed (usually the parsing of command-line arguments, which will be
explained below). <code>__name__</code> is a special dunder variable
which is set, along with a number of other special dunder variables, by
the python interpreter before the execution of any code in the source
file. What value is given by the interpreter to <code>__name__</code> is
determined by the manner in which it is loaded.</p>
<p>If we run the source file directly using the Python interpreter,
e.g.:</p>
<div class="codewrapper sourceCode" id="cb5">
<h3 class="code-label">BASH<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="sourceCode bash" tabindex="0"><code class="sourceCode bash"><span id="cb5-1"><a href="#cb5-1" tabindex="-1"></a><span class="ex">$</span> python3 inflammation-analysis.py</span></code></pre>
</div>
<p>then the interpreter will assign the hard-coded string
<code>"__main__"</code> to the <code>__name__</code> variable:</p>
<div class="codewrapper sourceCode" id="cb6">
<h3 class="code-label">PYTHON<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="sourceCode python" tabindex="0"><code class="sourceCode python"><span id="cb6-1"><a href="#cb6-1" tabindex="-1"></a><span class="va">__name__</span> <span class="op">=</span> <span class="st">"__main__"</span></span>
<span id="cb6-2"><a href="#cb6-2" tabindex="-1"></a>...</span>
<span id="cb6-3"><a href="#cb6-3" tabindex="-1"></a><span class="co"># rest of your code</span></span></code></pre>
</div>
<p>However, if your source file is imported by another Python script,
e.g:</p>
<div class="codewrapper sourceCode" id="cb7">
<h3 class="code-label">PYTHON<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="sourceCode python" tabindex="0"><code class="sourceCode python"><span id="cb7-1"><a href="#cb7-1" tabindex="-1"></a><span class="im">import</span> inflammation<span class="op">-</span>analysis</span></code></pre>
</div>
<p>then the interpreter will assign the name
<code>"inflammation-analysis"</code> from the import statement to the
<code>__name__</code> variable:</p>
<div class="codewrapper sourceCode" id="cb8">
<h3 class="code-label">PYTHON<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="sourceCode python" tabindex="0"><code class="sourceCode python"><span id="cb8-1"><a href="#cb8-1" tabindex="-1"></a><span class="va">__name__</span> <span class="op">=</span> <span class="st">"inflammation-analysis"</span></span>
<span id="cb8-2"><a href="#cb8-2" tabindex="-1"></a>...</span>
<span id="cb8-3"><a href="#cb8-3" tabindex="-1"></a><span class="co"># rest of your code</span></span></code></pre>
</div>
<p>Because of this behaviour of the interpreter, we can put any code
that should only be executed when running the script directly within the
<code>if __name__ == "__main__":</code> structure, allowing the rest of
the code within the script to be safely imported by another script if we
so wish.</p>
<p>While it may not seem very useful to have your controller script
importable by another script, there are a number of situations in which
you would want to do this:</p>
<ul>
<li>for testing of your code, you can have your testing framework import
the main script, and run special test functions which then call the
<code>main</code> function directly;</li>
<li>where you want to not only be able to run your script from the
command-line, but also provide a programmer-friendly application
programming interface (API) for advanced users.</li>
</ul>
</div>
<div class="section level3">
<h3 id="passing-command-line-options-to-controller">Passing Command-line Options to Controller<a class="anchor" aria-label="anchor" href="#passing-command-line-options-to-controller"></a>
</h3>
<p>The standard Python library for reading command line arguments passed
to a script is <a href="https://docs.python.org/3/library/argparse.html" class="external-link"><code>argparse</code></a>.
This module reads arguments passed by the system, and enables the
automatic generation of help and usage messages. These include, as we
saw at the start of this course, the generation of helpful error
messages when users give the program invalid arguments.</p>
<p>The basic usage of <code>argparse</code> can be seen in the
<code>inflammation-analysis.py</code> script. First we import the
library:</p>
<div class="codewrapper sourceCode" id="cb9">
<h3 class="code-label">PYTHON<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="sourceCode python" tabindex="0"><code class="sourceCode python"><span id="cb9-1"><a href="#cb9-1" tabindex="-1"></a><span class="im">import</span> argparse</span></code></pre>
</div>
<p>We then initialise the argument parser class, passing an (optional)
description of the program:</p>
<div class="codewrapper sourceCode" id="cb10">
<h3 class="code-label">PYTHON<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="sourceCode python" tabindex="0"><code class="sourceCode python"><span id="cb10-1"><a href="#cb10-1" tabindex="-1"></a>parser <span class="op">=</span> argparse.ArgumentParser(</span>
<span id="cb10-2"><a href="#cb10-2" tabindex="-1"></a>    description<span class="op">=</span><span class="st">'A basic patient inflammation data management system'</span>)</span></code></pre>
</div>
<p>Once the parser has been initialised we can add the arguments that we
want argparse to look out for. In our basic case, we want only the names
of the file(s) to process:</p>
<div class="codewrapper sourceCode" id="cb11">
<h3 class="code-label">PYTHON<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="sourceCode python" tabindex="0"><code class="sourceCode python"><span id="cb11-1"><a href="#cb11-1" tabindex="-1"></a>parser.add_argument(</span>
<span id="cb11-2"><a href="#cb11-2" tabindex="-1"></a>    <span class="st">'infiles'</span>,</span>
<span id="cb11-3"><a href="#cb11-3" tabindex="-1"></a>    nargs<span class="op">=</span><span class="st">'+'</span>,</span>
<span id="cb11-4"><a href="#cb11-4" tabindex="-1"></a>    <span class="bu">help</span><span class="op">=</span><span class="st">'Input CSV(s) containing inflammation series for each patient'</span>)</span></code></pre>
</div>
<p>Here we have defined what the argument will be called
(<code>'infiles'</code>) when it is read in; the number of arguments to
be expected (<code>nargs='+'</code>, where <code>'+'</code> indicates
that there should be 1 or more arguments passed); and a help string for
the user
(<code>help='Input CSV(s) containing inflammation series for each patient'</code>).</p>
<p>You can add as many arguments as you wish, and these can be either
mandatory (as the one above) or optional. Most of the complexity in
using <code>argparse</code> is in adding the correct argument options,
and we will explain how to do this in more detail below.</p>
<p>Finally we parse the arguments passed to the script using:</p>
<div class="codewrapper sourceCode" id="cb12">
<h3 class="code-label">PYTHON<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="sourceCode python" tabindex="0"><code class="sourceCode python"><span id="cb12-1"><a href="#cb12-1" tabindex="-1"></a>args <span class="op">=</span> parser.parse_args()</span></code></pre>
</div>
<p>This returns an object (that we have called <code>args</code>)
containing all the arguments requested. These can be accessed using the
names that we have defined for each argument,
e.g. <code>args.infiles</code> would return the filenames that have been
input.</p>
<p>The help for the script can be accessed using the <code>-h</code> or
<code>--help</code> optional argument (which <code>argparse</code>
includes by default):</p>
<div class="codewrapper sourceCode" id="cb13">
<h3 class="code-label">BASH<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="sourceCode bash" tabindex="0"><code class="sourceCode bash"><span id="cb13-1"><a href="#cb13-1" tabindex="-1"></a><span class="ex">$</span> python3 inflammation-analysis.py <span class="at">--help</span></span></code></pre>
</div>
<div class="codewrapper">
<h3 class="code-label">OUTPUT<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="output" tabindex="0"><code>usage: inflammation-analysis.py [-h] infiles [infiles ...]

A basic patient inflammation data management system

positional arguments:
  infiles     Input CSV(s) containing inflammation series for each patient

optional arguments:
  -h, --help  show this help message and exit</code></pre>
</div>
<p>The help page starts with the command line usage, illustrating what
inputs can be given (any within <code>[]</code> brackets are optional).
It then lists the <strong>positional</strong> and
<strong>optional</strong> arguments, giving as detailed a description of
each as you have added to the <code>add_argument()</code> command.
Positional arguments are arguments that need to be included in the
proper position or order when calling the script.</p>
<p>Note that optional arguments are indicated by <code>-</code> or
<code>--</code>, followed by the argument name. Positional arguments are
simply inferred by their position. It is possible to have multiple
positional arguments, but usually this is only practical where all (or
all but one) positional arguments contains a clearly defined number of
elements. If more than one option can have an indeterminate number of
entries, then it is better to create them as ‘optional’ arguments. These
can be made a required input though, by setting
<code>required = True</code> within the <code>add_argument()</code>
command.</p>
<div id="positional-and-optional-argument-order" class="callout">
<div class="callout-square">
<i class="callout-icon" data-feather="bell"></i>
</div>
<div id="positional-and-optional-argument-order" class="callout-inner">
<h3 class="callout-title">Positional and Optional Argument Order</h3>
<div class="callout-content">
<p>The usage section of the help page above shows the optional arguments
going before the positional arguments. This is the customary way to
present options, but is not mandatory. Instead there are two rules which
must be followed for these arguments:</p>
<ol style="list-style-type: decimal">
<li>Positional and optional arguments must each be given all together,
and not inter-mixed. For example, the order can be either “optional,
positional” or “positional, optional”, but not “optional, positional,
optional”.</li>
<li>Positional arguments must be given in the order that they are shown
in the usage section of the help page.</li>
</ol>
</div>
</div>
</div>
</div>
<div class="section level3">
<h3 id="additional-reading-material-references">Additional Reading Material &amp; References<a class="anchor" aria-label="anchor" href="#additional-reading-material-references"></a>
</h3>
<p>Now that we have covered and revisited <a href="software-architecture-extra.html">software architecture</a> and <a href="programming-paradigms.html">different programming paradigms</a>
and how we can integrate them into our architecture, there are two
optional extra episodes which you may find interesting.</p>
<p>Both episodes cover the persistence layer of software architectures
and methods of persistently storing data, but take different approaches.
The episode on <a href="persistence.html">persistence with JSON</a>
covers some more advanced concepts in Object Oriented Programming, while
the episode on <a href="databases.html">databases</a> starts to build
towards a true multilayer architecture, which would allow our software
to handle much larger quantities of data.</p>
</div>
</section><section><h2 class="section-heading" id="towards-collaborative-software-development">Towards Collaborative Software Development<a class="anchor" aria-label="anchor" href="#towards-collaborative-software-development"></a>
</h2>
<hr class="half-width">
<p>Having looked at some aspects of software design and architecture, we
are now circling back to implementing our software design and developing
our software to satisfy the requirements collaboratively in a team. At
an intermediate level of software development, there is a wealth of
practices that could be used, and applying suitable design and coding
practices is what separates an intermediate developer from someone who
has just started coding. The key for an intermediate developer is to
balance these concerns for each software project appropriately, and
employ design and development practices enough so that progress can be
made.</p>
<p>One practice that should always be considered, and has been shown to
be very effective in team-based software development, is that of
<em>code review</em>. Code reviews help to ensure the ‘good’ coding
standards are achieved and maintained within a team by having multiple
people have a look and comment on key code changes to see how they fit
within the codebase. Such reviews check the correctness of the new code,
test coverage, functionality changes, and confirm that they follow the
coding guides and best practices. Let us have a look at some code review
techniques available to us.</p>
<div id="keypoints1" class="callout keypoints">
<div class="callout-square">
<i class="callout-icon" data-feather="key"></i>
</div>
<div class="callout-inner">
<h3 class="callout-title">Key Points</h3>
<div class="callout-content">
<ul>
<li>Sometimes new, contributed code needs refactoring for it to fit
within an existing codebase.</li>
<li>Try to leave the code in a better state that you found it.</li>
</ul>
</div>
</div>
</div>
</section></section><section id="aio-40-section4-intro"><p>Content from <a href="40-section4-intro.html">Section 4: Collaborative Software Development for Reuse</a></p>
<hr>
<p>Last updated on 2024-12-06 |

        <a href="https://github.com/carpentries-incubator/python-intermediate-development/edit/main/episodes/40-section4-intro.md" class="external-link">Edit this page <i aria-hidden="true" data-feather="edit"></i></a></p>
<p>Estimated time: <i aria-hidden="true" data-feather="clock"></i> 5 minutes</p>
<div class="text-end">
          <button role="button" aria-pressed="false" tabindex="0" id="expand-code" class="pull-right" data-expand="Expand All Solutions " data-collapse="Collapse All Solutions "> Expand All Solutions <i aria-hidden="true" data-feather="plus"></i></button>
        </div>
<div class="overview card">
<h2 class="card-header">Overview</h2>
<div class="row g-0">
<div class="col-md-4">
<div class="card-body">
<div class="inner">
<h3 class="card-title">Questions</h3>
<ul>
<li>What practices help us develop software collaboratively that will
make it easier for us and others to further develop and reuse it?</li>
</ul>
</div>
</div>
</div>
<div class="col-md-8">
<div class="card-body">
<div class="inner bordered">
<h3 class="card-title">Objectives</h3>
<ul>
<li>Understand the code review process and employ it to improve the
quality of code.</li>
<li>Understand the process and best practices for preparing Python code
for reuse by others.</li>
</ul>
</div>
</div>
</div>
</div>
</div>
<p>When changes - particularly big changes - are made to a codebase, how
can we as a team ensure that these changes are well considered and
represent good solutions? And how can we increase the overall knowledge
of a codebase across a team? Sometimes project goals and time pressures
take precedence and producing maintainable, reusable code is not given
the time it deserves. So, when a change or a new feature is needed -
often the shortest route to making it work is taken as opposed to a more
well thought-out solution. For this reason, it is important not to write
the code alone and in isolation and use other team members to verify
each other’s code and measure our coding standards against. This process
of having multiple team members comment on key code changes is called
<em>code review</em> - this is one of the most important practices of
collaborative software development that helps ensure the ‘good’ coding
standards are achieved and maintained within a team, as well as
increasing knowledge about the codebase across the team. We will thus
look at the benefits of reviewing code, in particular, the value of this
type of activity within a team, and how this can fit within various ways
of team working. We will see how GitHub can support code review
activities via pull requests, and how we can do these ourselves making
use of best practices.</p>
<p>After that, we will look at some general principles of software
maintainability and the benefits that writing maintainable code can give
you. There will also be some practice at identifying problems with
existing code, and some general, established practices you can apply
when writing new code or to the code you have already written. We will
also look at how we can package software for release and distribution,
using <strong>Poetry</strong> to manage our Python dependencies and
produce a code package we can use with a Python package indexing service
to illustrate these principles.</p>
<figure><img src="../fig/section4-overview.svg" class="image-with-shadow figure mx-auto d-block" alt="Software design and architecture" width="1000"></figure><div id="keypoints1" class="callout keypoints">
<div class="callout-square">
<i class="callout-icon" data-feather="key"></i>
</div>
<div class="callout-inner">
<h3 class="callout-title">Key Points</h3>
<div class="callout-content">
<ul>
<li>Agreeing on a set of best practices within a software development
team will help to improve your software’s understandability,
extensibility, testability, reusability and overall sustainability.</li>
</ul>
</div>
</div>
</div></section><section id="aio-41-code-review"><p>Content from <a href="41-code-review.html">4.1 Developing Software In a Team: Code Review</a></p>
<hr>
<p>Last updated on 2025-06-19 |

        <a href="https://github.com/carpentries-incubator/python-intermediate-development/edit/main/episodes/41-code-review.md" class="external-link">Edit this page <i aria-hidden="true" data-feather="edit"></i></a></p>
<p>Estimated time: <i aria-hidden="true" data-feather="clock"></i> 60 minutes</p>
<div class="text-end">
          <button role="button" aria-pressed="false" tabindex="0" id="expand-code" class="pull-right" data-expand="Expand All Solutions " data-collapse="Collapse All Solutions "> Expand All Solutions <i aria-hidden="true" data-feather="plus"></i></button>
        </div>
<div class="overview card">
<h2 class="card-header">Overview</h2>
<div class="row g-0">
<div class="col-md-4">
<div class="card-body">
<div class="inner">
<h3 class="card-title">Questions</h3>
<ul>
<li>How do we develop software in a team?</li>
<li>What is code review and how it can improve the quality of code?</li>
</ul>
</div>
</div>
</div>
<div class="col-md-8">
<div class="card-body">
<div class="inner bordered">
<h3 class="card-title">Objectives</h3>
<ul>
<li>Describe commonly used code review techniques.</li>
<li>Understand how to do a pull request via GitHub to engage in code
review with a team and contribute to a shared code repository.</li>
</ul>
</div>
</div>
</div>
</div>
</div>
<section><h2 class="section-heading" id="introduction">Introduction<a class="anchor" aria-label="anchor" href="#introduction"></a>
</h2>
<hr class="half-width">
<p>So far in this course we’ve focused on learning software design and
(some) technical practices, tools and infrastructure that help the
development of software in a team environment, but in an individual
setting. Despite developing tests to check our code - no one else from
the team had a look at our code before we merged it into the main
development stream. Software is often designed and built as part of a
team, so in this episode we will be looking at how to manage the process
of team software development and improve our code by engaging in code
review process with other team members.</p>
<div id="activate-your-virtual-environment" class="callout">
<div class="callout-square">
<i class="callout-icon" data-feather="bell"></i>
</div>
<div id="activate-your-virtual-environment" class="callout-inner">
<h3 class="callout-title">Activate your virtual environment</h3>
<div class="callout-content">
<p>If it is not already active, make sure to activate your virtual
environment, called <code>venv</code>, from the root of the software
project directory:</p>
<div class="codewrapper sourceCode" id="cb1">
<h3 class="code-label">BASH<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="sourceCode bash" tabindex="0"><code class="sourceCode bash"><span id="cb1-1"><a href="#cb1-1" tabindex="-1"></a><span class="ex">$</span> source venv/bin/activate <span class="co"># Mac or Linux</span></span>
<span id="cb1-2"><a href="#cb1-2" tabindex="-1"></a><span class="ex">$</span> source venv/Scripts/activate <span class="co"># Windows</span></span>
<span id="cb1-3"><a href="#cb1-3" tabindex="-1"></a><span class="kw">(</span><span class="ex">venv</span><span class="kw">)</span> <span class="ex">$</span></span></code></pre>
</div>
</div>
</div>
</div>
</section><section><h2 class="section-heading" id="collaborative-code-development-models">Collaborative Code Development Models<a class="anchor" aria-label="anchor" href="#collaborative-code-development-models"></a>
</h2>
<hr class="half-width">
<p>The way a team provides contributions to a shared codebase depends on
the type of development model used in a project. Two commonly used
models are described below.</p>
<div class="section level3">
<h3 id="fork-and-pull-model">Fork and Pull Model<a class="anchor" aria-label="anchor" href="#fork-and-pull-model"></a>
</h3>
<p>In the <strong>fork and pull</strong> model, anyone can
<strong>fork</strong> an existing repository (to create their copy of
the project linked to the source) and push changes to their personal
fork. A contributor can work independently on their own fork as they do
not need permissions on the source repository to push modifications to a
fork they own. The changes from contributors can then be
<strong>pulled</strong> into the source repository by the project
maintainer on request and after a code review process. This model is
popular with open source projects as it reduces the start up costs for
new contributors and allows them to work independently without upfront
coordination with source project maintainers. So, for example, you may
use this model when you are an external collaborator on a project rather
than a core team member.</p>
</div>
<div class="section level3">
<h3 id="shared-repository-model">Shared Repository Model<a class="anchor" aria-label="anchor" href="#shared-repository-model"></a>
</h3>
<p>In the <strong>shared repository model</strong>, collaborators are
granted push access to a single shared code repository. By default,
collaborators have write access to the main branch. However, it is best
practice to create feature branches for new developments and protect the
main branch from direct and unreviewed commits to keep it stable - see
<a href="https://docs.github.com/en/repositories/configuring-branches-and-merges-in-your-repository/managing-protected-branches/managing-a-branch-protection-rule" class="external-link">GitHub’s
documentation</a> on how to do this. While this model of collaboration
requires more upfront coordination, it makes it easier to share each
other’s work. It works well for more stable teams and is more prevalent
with teams and organisations collaborating on private projects.</p>
</div>
</section><section><h2 class="section-heading" id="code-review">Code Review<a class="anchor" aria-label="anchor" href="#code-review"></a>
</h2>
<hr class="half-width">
<p>Regardless of the collaborative code development model your team
uses, <a href="https://en.wikipedia.org/wiki/Code_review" class="external-link">code
review</a> is one of the widely accepted best practices for software
development in teams and something you should adopt in your development
process too.</p>
<p>Code review is a software quality assurance practice where one or
several people from the team (different from the code’s author) check
the software by viewing parts of its source code at the point when the
code changes. Code review is very useful for all parties involved -
someone checks your design or code for errors and gets to learn from
your solution; having to explain code to someone else clarifies your
rationale and design decisions in your mind too.</p>
<p>Code review is universally applicable throughout the software
development cycle - from design to development to maintenance. According
to Michael Fagan, the author of the <a href="https://en.wikipedia.org/wiki/Fagan_inspection" class="external-link">code inspection
technique</a>, rigorous inspections can remove 60-90% of errors from the
code even before the first tests are run (<a href="https://doi.org/10.1147%2Fsj.153.0182" class="external-link">Fagan, 1976</a>).
Furthermore, according to Fagan, the cost to remedy a defect in the
early (design) stage is 10 to 100 times less compared to fixing the same
defect in the development and maintenance stages, respectively. Since
the cost of bug fixes grows in orders of magnitude throughout the
software lifecycle, it is far more efficient to find and fix defects as
close as possible to the point where they were introduced.</p>
<p>There are several <strong>code review techniques</strong> with
various degree of formality and the use of a technical infrastructure,
including:</p>
<ul>
<li>
<a href="https://about.gitlab.com/topics/version-control/what-is-code-review/#Over-the-shoulder%20reviews" class="external-link">Over-the-shoulder
code review</a> - one developer talks the other developer through the
code changes while sitting at the same machine.</li>
<li>
<a href="https://about.gitlab.com/topics/version-control/what-is-code-review/#Pair%20programming" class="external-link">Pair
programming</a> - two developers work on the code at the same time with
one of them actively coding and the other providing real-time
feedback.</li>
<li>
<a href="https://en.wikipedia.org/wiki/Fagan_inspection" class="external-link">Formal code
inspection</a> - up to 6 partipants go through a formalised process to
inspect the code specification or design for defects.</li>
<li>
<a href="https://about.gitlab.com/topics/version-control/what-is-code-review/#Tool-assisted%20reviews" class="external-link">Tool
assisted code review</a> - developers use tools such as GitHub to review
the code independently and give feedback.</li>
</ul>
<p>You can read more about these techniques in the <a href="https://www.khoury.northeastern.edu/home/lieber/courses/cs4500/f07/lectures/code-review-types.pdf" class="external-link">“Five
Types of Review” section</a> of the <a href="https://www.yumpu.com/en/document/view/19324443/best-kept-secrets-of-peer-code-review-pdf-smartbear" class="external-link">“Best
Kept Secrets of Peer Code Review” eBook</a>.</p>
<p>It is worth trying multiple code review techniques to see what works
best for you and your team. We will have a look at the
<strong>tool-assisted code review process</strong>, which is likely to
be the most effective and efficient. We will use GitHub’s built-in code
review tool - <strong>pull requests</strong>, or PRs. It is a
lightweight tool, included with GitHub’s core service for free and has
gained popularity within the software development community in recent
years.</p>
</section><section><h2 class="section-heading" id="code-reviews-via-githubs-pull-requests">Code Reviews via GitHub’s Pull Requests<a class="anchor" aria-label="anchor" href="#code-reviews-via-githubs-pull-requests"></a>
</h2>
<hr class="half-width">
<p>Pull requests are fundamental to how teams review and improve code on
GitHub (and similar code sharing platforms) - they let you tell others
about changes you have pushed to a branch in a repository on GitHub and
that your code is ready for review. Once a pull request is opened, you
can discuss and review the potential changes with others on the team and
add follow-up commits based on the feedback before your changes are
merged into the development branch. The name ‘pull request’ suggests you
are <strong>requesting</strong> the codebase moderators to
<strong>pull</strong> your changes into the codebase.</p>
<p>Such changes are normally done on a feature branch, to ensure that
they are separate and self-contained, that the main branch only contains
“production-ready” work, and that the development branch contains code
that has already been extensively tested. You create a branch for your
work based on one of the existing branches (typically the development
branch but can be any other branch), do some commits on that branch,
and, once you are ready to merge your changes, create a pull request to
bring the changes back to the branch that you started from. In this
context, the branch from which you branched off to do your work and
where the changes should be applied back to is called the <strong>base
branch</strong>, while the feature branch that contains changes you
would like to be applied is the <strong>compare branch</strong>.</p>
<p>How you create your feature branches and open pull requests in GitHub
will depend on your collaborative code development model:</p>
<ul>
<li>In the fork and pull model, where you do not have write permissions
to the source repository, you need to fork the repository first before
you create a feature branch (in your fork) to base your pull request
on.</li>
<li>In the shared repository model, in order to create a feature branch
and open a pull request based on it you must have write access to the
source repository or, for organisation-owned repositories, you must be a
member of the organisation that owns the repository. Once you have
access to the repository, you proceed to create a feature branch on that
repository directly.</li>
</ul>
<p>In both development models, it is recommended to create a feature
branch for your work and the subsequent pull request, even though you
can submit pull requests from any branch or commit. This is because,
with a feature branch, you can push follow-up commits as a response to
feedback and update your proposed changes within a self-contained
bundle. The only difference in creating a pull request between the two
models is how you create the feature branch. In either model, once you
are ready to merge your changes in - you will need to specify the base
branch and the compare branch.</p>
<p>Let us see this in action - you are going to act as a reviewer on a
proposed change to the codebase contributed by a fictional colleague on
one of your fellow learner’s repository. One of your fellow learners
will review the proposed changes on your repository. Once the review is
done, you will then take on the role of the fictional colleague and
respond to the review on your repository. If you are completing the
course by yourself, you can add the review on the proposed changes in
your own repository and then respond to your own review comments by
fixing the proposed code. This is actually a very sensible thing to do
in general - looking at your own code in a review window will allow you
to spot mistakes you have not seen before.</p>
<p>Here is an outline of the process of a tool assisted code review.</p>
<!--

```mermaid
%% Must disable useMaxWidth to have the diagram centre
%%{init: { 'sequence': {'useMaxWidth':false} } }%%
sequenceDiagram
    participant A as Author
    participant R as Reviewer
    A->>A: Write some code
    A->>R: Raise a pull request
    R->>R: Add comments to a review
    R->>A: Submit a review
    loop Until approved
        A->>R: Address or respond to review comments
        R->>A: Clarify or resolve comments
    end
    R->>A: Approve pull request
    A->>A: Merge pull request
```

Generated with Mermaid tool, diagram available at: <https://mermaid.live/edit#pako:eNptUrtuwzAM_BVCgOEl_QEPAYx29eKgyOKFsZhYgF6VKLeBkX-vXDvNo5UWSXfHI0VOoneSRCWKApoUGaSKeNAEKVKDX3sleQB2MOBIwANlHE8BDfRkOVBni2JSVnEFE5SRPhLZnsp8K-8ClNURdaQL5F0Unb3y3pZYnYW8PAZWvfJoGWrACHXiwYW_YDuDLY2KPmmF65fttq5gHxQTRGcI5qpuWFtBiyoSIPikNYQ5gcgLoV0ItZRZZUyuK84VY2bNHjdSdtilg1H8hGnnPLxbVhrQ--BGkgtwZ5-jB4oRXMjS6J2Vs8cS5df2plrtXjUGdTyvKqdHeuKSlQ_51Yv_P1WuX9RQOD3CYiMMBYNK5imYZnIncqMNdaLKR0lHTJo70dlLpmJitzvbXlQcEm1E8hL52sjrI0nFLjTLYP3M1-Ub_pDLrQ>
-->
<figure><img src="../fig/code-review-sequence-diagram.svg" class="image-with-shadow figure mx-auto d-block" alt="Code review process sequence" width="600"></figure><p>Recall <a href="31-software-requirements.html">solution requirement
SR1.1.1</a> from an earlier episode. A fictional colleague has
implemented it according to the specification and pushed it to a branch
<code>feature-std-dev</code> of our software repository. You will turn
this branch into a pull request on your repository. You will then engage
in code review for the change (acting as a code reviewer) on a fellow
learner’s repository. Once complete, you will respond to the comments
from another team member on the pull request on your repository (acting
as a code author).</p>
<div class="section level3">
<h3 id="raising-a-pull-request">Raising a Pull Request<a class="anchor" aria-label="anchor" href="#raising-a-pull-request"></a>
</h3>
<ol style="list-style-type: decimal">
<li>Head over to your software repository in GitHub.</li>
<li>Navigate to the pull requests tab.</li>
<li>Create a new pull request by clicking the green
<code>New pull request</code> button. <img src="../fig/github-pull-request-tab.png" class="image-with-shadow figure" alt="GitHub pull requests tab" width="900">
</li>
<li>Select the base and the compare branch: <code>develop</code> and
<code>feature-std-dev</code>, respectively. Recall that the base branch
is where you want your changes to be merged and the compare branch
contains the changes.</li>
<li>Click <code>Create pull request</code> button to open the request.
<img src="../fig/github-create-pull-request.png" class="image-with-shadow figure" alt="Creating a new pull request." width="900">
</li>
<li>Add a comment describing the nature of the changes, and then submit
the pull request by clicking the <code>Create pull request</code> button
(in the new window). <img src="../fig/github-submit-pull-request.png" class="image-with-shadow figure" alt="Submitting a pull request." width="900">
</li>
<li>At this point, the code review process is initiated.</li>
</ol>
<p>We will now discuss what to look for in a code review, before
practising it on this fictional change.</p>
</div>
<div class="section level3">
<h3 id="reviewing-a-pull-request">Reviewing a Pull Request<a class="anchor" aria-label="anchor" href="#reviewing-a-pull-request"></a>
</h3>
<p>Once a review has been raised it is over to the reviewer to review
the code and submit feedback.</p>
<p>Reviewing code effectively takes practice. However, here is some
guidance on what you should be looking for when reviewing a piece of
code.</p>
<div class="section level4">
<h4 id="things-to-look-for-in-a-code-review">Things to Look for in a Code Review<a class="anchor" aria-label="anchor" href="#things-to-look-for-in-a-code-review"></a>
</h4>
<p>Start by understanding what the code <em>should</em> do, by reading
the specification/user requirements, the pull request description or
talking to the developer if need be. In this case, understand what <a href="31-software-requirements.html">SR1.1.1</a> means.</p>
<p>Once you are happy, start reading the code (skip the test code for
now - we will come back to it later). you are going to be assessing the
code in the following key areas.</p>
<div class="section level5">
<h5 id="is-the-proposed-code-readable">Is the proposed code readable?<a class="anchor" aria-label="anchor" href="#is-the-proposed-code-readable"></a>
</h5>
<ul>
<li>Think about the names of the variables and functions - do they <a href="15-coding-conventions.html">follow naming conventions</a>?</li>
<li>Do you understand what conditions in each if statements are
for?</li>
<li>Does a function name match the behavior of the function?</li>
</ul>
</div>
<div class="section level5">
<h5 id="is-the-proposed-code-a-minimal-change">Is the proposed code a minimal change?<a class="anchor" aria-label="anchor" href="#is-the-proposed-code-a-minimal-change"></a>
</h5>
<ul>
<li>Does the code reimplement anything that already exists, either
elsewhere in the codebase or in a library you know about?</li>
<li>Does the code implement something that is not the requirement or in
the issue/ticket?</li>
</ul>
</div>
<div class="section level5">
<h5 id="is-the-structure-of-the-code-clear">Is the structure of the code clear?<a class="anchor" aria-label="anchor" href="#is-the-structure-of-the-code-clear"></a>
</h5>
<ul>
<li>Do functions do just one thing?</li>
<li>Is the code using the right level of modularity?</li>
<li>Is the code consistent with the structure of the rest of the
code?</li>
</ul>
</div>
<div class="section level5">
<h5 id="is-there-an-appropriate-and-up-to-date-documentation-for-the-proposed-code">Is there an appropriate and up-to-date documentation for the
proposed code?<a class="anchor" aria-label="anchor" href="#is-there-an-appropriate-and-up-to-date-documentation-for-the-proposed-code"></a>
</h5>
<ul>
<li>If functionality has changed, has corresponding documentation been
updated?</li>
<li>If new functions have been added, do they have the associated
documentation?</li>
<li>Does the documentation make sense?</li>
<li>Are there clear and useful comments that explain complex designs and
focus on the “why/because” rather than the “what/how”?</li>
</ul>
</div>
</div>
<div class="section level4">
<h4 id="things-not-to-look-for-in-a-code-review">Things Not to Look for in a Code Review<a class="anchor" aria-label="anchor" href="#things-not-to-look-for-in-a-code-review"></a>
</h4>
<p>The overriding priority for reviewing code should be making sure
progress is being made - do not let perfect be the enemy of the good
here. According to <a href="https://www.amazon.co.uk/Best-Kept-Secrets-Peer-Review/dp/1599160676" class="external-link">“Best
Kept Secrets of Peer Code Review” (Cohen, 2006)</a> the first hour of
reviewing code is the most effective, with diminishing returns after
that.</p>
<p>To that end, here are a few things you <em>should not</em> be trying
to spot when reviewing:</p>
<ul>
<li>Linting issues, or anything else that an automated tool can spot -
get the Continuous Integration (CI) to do it.</li>
<li>Bugs - instead make sure there are tests for all cases.</li>
<li>Issues that pre-date the change - raise separate PRs fixing these
issues separately to avoid heading down a rabbit hole.</li>
<li>Architecture re-writes - try to have design discussions upfront, or
else have a meeting to decide whether the code needs to be
rewritten.</li>
</ul>
</div>
<div class="section level4">
<h4 id="adding-a-review-comment">Adding a review comment<a class="anchor" aria-label="anchor" href="#adding-a-review-comment"></a>
</h4>
<p>Here, we are outlining the process of adding a review to a pull
request. There is doing to be an exercise next for you to practice
it.</p>
<ol style="list-style-type: decimal">
<li>Your fellow learner should add you as a collaborator on their
repository to begin with. They can do that from the
<code>Settings</code> tab of the repository, then
<code>Collaborators and teams</code> tab on the left, then clicking the
<code>Add people</code> button. Once they find you by your GitHub name -
you will receive an invitation via email to join the repository as a
collaborator. You will have to do the same for the collaborator doing
the review on your repository.</li>
</ol>
<p><strong>Note:</strong> <em>You do not have to be a collaborator on a
public repository to do code reviews so this step is not strictly
necessary. We are still asking you to do it now as we will get you
working in teams for the rest of the course so it may make sense to
start setting up your collaborators now - as shown in the screenshot
below.</em></p>
<figure><img src="../fig/github-add-collaborator.png" class="image-with-shadow figure mx-auto d-block" alt="Adding a collaborator in GitHub" width="900"></figure><ol start="2" style="list-style-type: decimal">
<li><p>Locate up the pull request from the GitHub’s
<code>Pull Requests</code> tab on the home page of your fellow learner’s
software repository, then head to the <code>Files changed</code> tab on
the pull request. <img src="../fig/github-pull-request-files-changed.png" class="image-with-shadow figure" alt="The files changed tab of a pull request" width="900"></p></li>
<li><p>When you find a line that you want to add a comment to, click on
the blue plus (+) button next to the line. This will bring up a “Write”
box to add your comment. <img src="../fig/github-pull-request-add-comment.png" class="image-with-shadow figure" alt="Adding a review comment to a pull request" width="800"> You can
also add comments referring to multiple lines by clicking the plus and
dragging down over the relevant lines. If you want to make a concrete
suggestion or a change to the code directly, such as renaming a
variable, you can click the <code>Add a suggestion</code> button (which
looks like a document with a plus and a minus in it). This will populate
the comment with the existing code, and you can edit it to be what you
think the code should be.</p></li>
</ol>
<p><em><strong>Note:</strong> you can only make direct code suggestions
if you are a collaborator on a repository. Otherwise, you can add
comments only.</em> <img src="../fig/github-pull-request-add-suggestion.png" class="image-with-shadow figure" alt="Adding a suggestion to a pull request" width="800"> GitHub will then provide a button for the code author to
apply your changes directly.</p>
<ol start="4" style="list-style-type: decimal">
<li><p>Write your comment in the box, and then click
<code>Start review</code>. This will save your comment, but not publish
it yet. You can use <code>Add single comment</code> button to
immediately post a comment. However, it is best to batch the comments
into a single review, so that the author knows when you have finished
adding comments (and avoid spamming their email with
notifications).</p></li>
<li><p>Continue adding comments in this way, if you have any, using the
<code>Add review comment</code> button.</p></li>
</ol>
<div id="effective-review-comments" class="callout">
<div class="callout-square">
<i class="callout-icon" data-feather="bell"></i>
</div>
<div id="effective-review-comments" class="callout-inner">
<h3 class="callout-title">Effective Review Comments</h3>
<div class="callout-content">
<ul>
<li>Make sure your review comments are specific and actionable.</li>
<li>Try to be as specific as you can - instead of “this code is unclear”
instead say “I do not understand what values this variable can
hold”.</li>
<li>Make it clear in the comment if you want something to change as part
of this pull request.</li>
<li>Ideally provide a concrete suggestion (e.g. a better variable
name).</li>
</ul>
</div>
</div>
</div>
<div id="exercise-review-some-code" class="callout challenge">
<div class="callout-square">
<i class="callout-icon" data-feather="zap"></i>
</div>
<div id="exercise-review-some-code" class="callout-inner">
<h3 class="callout-title">Exercise: Review Some Code</h3>
<div class="callout-content">
<p>Pair up with a colleague from your group/team and go to the pull
request your colleague created on their project repository. If there is
an odd number of people in your group, three people can go in a round
robin fashion (the first team member will review the pull request on the
second member’s repository and will receive comments on the pull request
on their repository from the third team member, and so on). If you are
going through the material on your own and do not have a collaborator,
you can be the reviewer on the pull requests on your own repository.</p>
<p>Review the code, looking for the kinds of problems that we have just
discussed. There are examples of all four main problem areas in the pull
request, so try to make at least one suggestion for each area.</p>
<p><strong>Add your review comments but do not submit your review just
yet.</strong></p>
</div>
</div>
</div>
<div id="accordionSolution1" class="accordion challenge-accordion accordion-flush">
<div class="accordion-item">
<button class="accordion-button solution-button collapsed" type="button" data-bs-toggle="collapse" data-bs-target="#collapseSolution1" aria-expanded="false" aria-controls="collapseSolution1">
  <h4 class="accordion-header" id="headingSolution1"> Show me the solution </h4>
</button>
<div id="collapseSolution1" class="accordion-collapse collapse" data-bs-parent="#accordionSolution1" aria-labelledby="headingSolution1">
<div class="accordion-body">
<p>Here are some of the things you might have found were wrong with the
code.</p>
<div class="section level5">
<h5 id="is-the-proposed-code-readable-1">Is the proposed code readable?<a class="anchor" aria-label="anchor" href="#is-the-proposed-code-readable-1"></a>
</h5>
<ul>
<li>Function name <code>s_dev</code> is not the best or self-explanatory
- it uses an uncommon abbreviation and does not make it clear
immediately what the function does without reading the code. A better
name is <code>standard_deviation</code>.</li>
<li>Not clear what variable <code>number</code> contains - better option
is a business-logic name like <code>mean</code> or
<code>mean_of_data</code>.</li>
</ul>
</div>
<div class="section level5">
<h5 id="is-the-proposed-code-a-minimal-change-1">Is the proposed code a minimal change?<a class="anchor" aria-label="anchor" href="#is-the-proposed-code-a-minimal-change-1"></a>
</h5>
<ul>
<li>Could have used <code>np.std</code> to compute standard deviation of
data without having to reimplement from scratch.</li>
</ul>
</div>
<div class="section level5">
<h5 id="is-the-structure-of-the-proposed-code-clear">Is the structure of the proposed code clear?<a class="anchor" aria-label="anchor" href="#is-the-structure-of-the-proposed-code-clear"></a>
</h5>
<ul>
<li>Have the function return the data, rather than having the graph name
(a view layer consideration) leak into the model code.</li>
</ul>
</div>
<div class="section level5">
<h5 id="is-there-an-appropriate-and-up-to-date-documentation-for-the-proposed-code-1">Is there an appropriate and up-to-date documentation for the
proposed code?<a class="anchor" aria-label="anchor" href="#is-there-an-appropriate-and-up-to-date-documentation-for-the-proposed-code-1"></a>
</h5>
<ul>
<li>The documentation say it returns the standard deviation, but it
actually returns a dictionary containing the standard deviation.</li>
</ul>
</div>
</div>
</div>
</div>
</div>
</div>
<div class="section level4">
<h4 id="making-sure-code-is-valid">Making Sure Code is Valid<a class="anchor" aria-label="anchor" href="#making-sure-code-is-valid"></a>
</h4>
<p>The other key thing you want to verify in a code review is that the
code is correct and well tested. One approach to do this is to build up
a list of tests you would expect to see (and the results you would
expect them to have), and then verify that all these tests are present
and correct.</p>
<p>Start by listing out all the tests you would expect to see based on
the specification. As you are going through the code, add to this list
any other tests you can think of, making sure to add tests for:</p>
<ul>
<li>All paths through the code.</li>
<li>Making each <code>if</code> statement be evaluated as
<code>True</code> and <code>False</code>.</li>
<li>Executing loops with empty, single and multi-element sequences.</li>
<li>Edge cases that you spot.</li>
<li>Any circumstances where you are not certain how code would
behave.</li>
</ul>
<p>Once you have the list, go through the tests in the pull request.
Inspect them closely to make sure they test everything you expect them
to.</p>
</div>
</div>
<div class="section level3">
<h3 id="submitting-a-review">Submitting a Review<a class="anchor" aria-label="anchor" href="#submitting-a-review"></a>
</h3>
<p>Once you have a list of tests you want the author to add, it is time
to submit your review.</p>
<ol style="list-style-type: decimal">
<li>To do this, click the <code>Finish your review</code> button at the
top of the <code>Files changed</code> tab. <img src="../fig/github-submit-pull-request-review.png" class="image-with-shadow figure" alt="Using the finishing your review dialog" width="800"> In the comment box, you can add any other comments that
are not associated with a specific line. For example, you can put the
list of tests that you want to see added here.</li>
<li>Next you will need select to one of <code>Comment</code>,
<code>Approve</code> or <code>Request changes</code>. <img src="../fig/github-finish-pull-request-review.png" class="image-with-shadow figure" alt="Using the finishing your review dialog" width="900">
</li>
</ol>
<ul>
<li>Use <code>Approve</code> if you would be happy for the code to go in
with no further changes.</li>
<li>Use <code>Request changes</code> to communicate to the author that
they should address your comments before you will approve it.</li>
<li>Use <code>Comment</code> if you do not want to express a decision on
whether the code should be accepted. For example, if you have been asked
to look at a specific part of the code, or if you are part way through a
review, but wanted to share some comments sooner.</li>
</ul>
<ol start="3" style="list-style-type: decimal">
<li>Finally, you can press <code>Submit review</code> button. This will
publish all the comments you have made as part of the review and let the
author know that the review is complete and it is their turn for
action.</li>
</ol>
<div id="exercise-review-the-code-for-suitable-tests" class="callout challenge">
<div class="callout-square">
<i class="callout-icon" data-feather="zap"></i>
</div>
<div id="exercise-review-the-code-for-suitable-tests" class="callout-inner">
<h3 class="callout-title">Exercise: Review the Code for Suitable Tests</h3>
<div class="callout-content">
<p>Remind yourself of the <a href="31-software-requirements.html">specification for SR1.1.1</a> and
write a list of tests you would expect to see for this feature. Review
the code again and expand this list to include any other edge cases the
code makes you think of. Go through the tests in the pull request and
work out which tests are present.</p>
<p>Once you are happy, you can submit your review. Select
<code>Request changes</code> to let the author know they need to address
your comments.</p>
</div>
</div>
</div>
<div id="accordionSolution2" class="accordion challenge-accordion accordion-flush">
<div class="accordion-item">
<button class="accordion-button solution-button collapsed" type="button" data-bs-toggle="collapse" data-bs-target="#collapseSolution2" aria-expanded="false" aria-controls="collapseSolution2">
  <h4 class="accordion-header" id="headingSolution2"> Show me the solution </h4>
</button>
<div id="collapseSolution2" class="accordion-collapse collapse" data-bs-parent="#accordionSolution2" aria-labelledby="headingSolution2">
<div class="accordion-body">
<p>Your list might include the following:</p>
<ol style="list-style-type: decimal">
<li>Standard deviation for one patient with multiple observations.</li>
<li>Standard deviation for two patients.</li>
<li>Graph includes a standard deviation graph.</li>
<li>Standard deviation function should raise an error if given empty
data.</li>
<li>Computing standard deviation where deviation is different from
variance.</li>
<li>Standard deviation function should give correct result given
negative inputs.</li>
<li>Function should work with numpy arrays.</li>
</ol>
<p>Looking at the tests in the PR, you might be content that tests for
1, 4 and 7 are present so you would request changes to add tests 2, 3, 5
and 6.</p>
<p>In looking at the tests, you may have noticed that the test for numpy
arrays is currently spuriously passing as it does not use the return
value from the function in the assert.</p>
<p>You may have spotted that the function actually computes the variance
rather than the standard deviation. Perhaps that made you think to add
the test for some data where the variance and standard deviation are
different. In more complex examples, it is often easier to spot code
that looks like it could be wrong and think of a test that will exercise
it. This saves embarrassment if the code turns out to be right, means
you have the missing test written if it is wrong, and is often quicker
than trying to execute the code in your head to find out if it is
correct.</p>
</div>
</div>
</div>
</div>
</div>
<div class="section level3">
<h3 id="responding-to-review-comments">Responding to Review Comments<a class="anchor" aria-label="anchor" href="#responding-to-review-comments"></a>
</h3>
<p>Once you receive comments on your code, a few different scenarios can
occur:</p>
<ol style="list-style-type: decimal">
<li>You understand and agree with the reviewer’s comments. In this
scenario, you should make the requested change to your branch (or accept
the suggested change by the reviewer) and commit it. It might be helpful
to add a thumbs up reaction to the comment, so the reviewer knows you
have addressed it. Even better, leave a comment such as “Fixed via
#commit_number” with a link to your commit that implemented the change.
<img src="../fig/github-respond-to-review-comment-with-emoji.png" class="image-with-shadow figure" alt="Responding to a review comment with an emoji" width="800"><img src="../fig/github-respond-to-review-comment-with-commit-link.png" class="image-with-shadow figure" alt="Responding to a review comment with a link to commit" width="800">
</li>
<li>It is not completely clear what the requested change should be - in
this scenario you should reply to such a review to ask for
clarification.</li>
<li>You disagree with the reviewer - in this scenario, it might be best
to talk to them in person. Discussions that happen on code reviews can
often feel quite adversarial - discussing what the best solution is in
person can help defuse this.</li>
</ol>
<div id="exercise-responding-to-comments" class="callout discussion">
<div class="callout-square">
<i class="callout-icon" data-feather="message-circle"></i>
</div>
<div id="exercise-responding-to-comments" class="callout-inner">
<h3 class="callout-title">Exercise: Responding to Comments</h3>
<div class="callout-content">
<p>Look at the pull request that you created on your repository. By now
you should have someone else’s comments on it. For each comment, either
reply explaining why you do not think the change is necessary or make
the change and push a commit fixing it. Reply to each of the comments
indicating you have addressed it.</p>
<p>At the same time, people will be addressing your comments on the pull
request in their repository. If you are satisfied that your comment has
been suitably addressed, you can mark it as resolved. Once all comments
have been addressed, you can approve the pull request by submitting a
new review and this time selecting <code>Approve</code>. This tells the
author you are happy for them to merge the pull request.</p>
</div>
</div>
</div>
</div>
<div class="section level3">
<h3 id="approving-a-pull-request">Approving a Pull Request<a class="anchor" aria-label="anchor" href="#approving-a-pull-request"></a>
</h3>
<ol style="list-style-type: decimal">
<li>Once the reviewer approves the changes, the person whose repository
it is can merge the changes onto the base branch. Typically, it is the
code author’s responsibility to merge but this may differ from team to
team. In our case, you will merge the changes on the PR on your
repository. <img src="../fig/github-merge-pull-request.png" class="image-with-shadow figure" alt="Merging a pull request in GitHub" width="800">
</li>
<li>Delete the merged branch to reduce the clutter in the
repository.</li>
</ol>
</div>
</section><section><h2 class="section-heading" id="writing-easy-to-review-code">Writing Easy-To-Review Code<a class="anchor" aria-label="anchor" href="#writing-easy-to-review-code"></a>
</h2>
<hr class="half-width">
<p>There are a few things you can do to make it as easy as possible for
the reviewer to review your code:</p>
<ul>
<li>Keep the changes <strong>small</strong>.</li>
<li>Keep each commit as <strong>one logical change</strong>.</li>
<li>Provide a <strong>clear description</strong> of the change.</li>
<li>
<strong>Review your code yourself</strong>, before requesting a
review.</li>
</ul>
<p>The most important thing to keep in mind is how long your pull
request is. Smaller changes that just make one small improvement will be
much quicker and easier to review. There is no golden rule, but <a href="https://smartbear.com/resources/ebooks/the-state-of-code-review-2020-report/" class="external-link">studies
into code review</a> show that you should not review more than 400 lines
of code at a time, so this is a reasonable target to aim for. You can
refer to some <a href="https://jserd.springeropen.com/articles/10.1186/s40411-018-0058-0" class="external-link">studies</a>
and <a href="https://google.github.io/eng-practices/review/developer/small-cls.html" class="external-link">Google
recommendations</a> as to what a “large pull request” is but be aware
that it is not an exact science.</p>
<p>Try to keep each commit (within your pull request) to be making one
logical change. This can especially help with larger pull requests that
would otherwise be harder to review. In particular, if you have
reformatted, refactored and changed the behavior of the code make sure
each of these is in a separate commit (i.e reformat the code, commit,
refactor the code, commit, alter the behavior of the code, commit).</p>
<p>Make sure you write a clear description of the content and purpose of
the change. This should be provided as the pull request description.
This should provide the context needed to read the code.</p>
<p>It is also a good idea to review your code yourself, before
requesting a review. In doing this you will spot the more obvious issues
with your code, allowing your reviewer to focus on the things you cannot
spot.</p>
</section><section><h2 class="section-heading" id="writing-effective-review-comments">Writing Effective Review Comments<a class="anchor" aria-label="anchor" href="#writing-effective-review-comments"></a>
</h2>
<hr class="half-width">
<p>Code is written by humans (mostly!), and code review is a form of
communication. As such, empathy is important for effective
reviewing.</p>
<p>When reviewing code, it can be sometimes frustrating when code is
confusing, particularly as it is implemented differently to how you
would have done it. However, it is important as a reviewer to be
compassionate to the person whose code you are reviewing.
Specifically:</p>
<ul>
<li>Identify positives in code as and when you find them (particularly
if it is an improvement on something you have fed back on in a previous
review).</li>
<li>Remember different does not mean better - only request changes if
the code is wrong or hard to understand.</li>
<li>Only provide a few critical suggestions - you are aiming for better
rather than perfect.</li>
<li>Ask questions to understand why something has been done a certain
way rather than assuming you know a better way.</li>
<li>If a conversation is taking place on a review and has not been
resolved by a single back-and-forth exchange, then schedule a
conversation to discuss instead (and record the outcome of the
discussion in the PR’s comments).</li>
</ul></section><section><h2 class="section-heading" id="defining-a-review-process-for-your-team">Defining a Review Process For Your Team<a class="anchor" aria-label="anchor" href="#defining-a-review-process-for-your-team"></a>
</h2>
<hr class="half-width">
<p>To be effective, code review needs to be a process that is followed
by everyone in the team developing the code. Everyone should believe
that the process provides value. One way to foster this is to agree on
the review process as a team and consider, e.g.:</p>
<ul>
<li>Whether all changes need to go through code review</li>
<li>What technologies you are going to use to manage the review
process</li>
<li>How quickly you expect someone to review the code once a PR has been
raised</li>
<li>How long should be spent reviewing code</li>
<li>What kind of issues are (and are not) appropriate to raise in a
PR</li>
<li>How will someone know when they are expected to take action
(e.g. review a PR).</li>
</ul>
<p>You could also consider using pull request states in GitHub:</p>
<ul>
<li>Open a pull request in a <code>DRAFT</code> state to show progress
or request early feedback</li>
<li>
<code>READY FOR REVIEW</code> when you are ready for feedback</li>
<li>
<code>CHANGES REQUESTED</code> to let the author know they need to
fix the requested changes or discuss more</li>
<li>
<code>APPROVED</code> to let the author they can merge their pull
request.</li>
</ul>
<p>Once you have agreed on a review process, you should monitor (either
formally or informally) how well it is working.</p>
<p>It is important that reviews are processed quickly, to avoid costly
context switching for the code author moving on to work on other things
and coming back to their PR. Try and set the targets for when you would
want the first review submitted on a PR and the PR merged, based on how
your team works. If you are regularly missing your targets, then you
should review your process to identify where things are getting stuck
and work out what you can do to move things along.</p>
<div id="optional-exercise-code-review-in-your-own-working-environment" class="callout challenge">
<div class="callout-square">
<i class="callout-icon" data-feather="zap"></i>
</div>
<div id="optional-exercise-code-review-in-your-own-working-environment" class="callout-inner">
<h3 class="callout-title">Optional Exercise: Code Review in Your Own Working Environment</h3>
<div class="callout-content">
<p>In this episode we have looked at some best practices for code review
and practiced tool assisted code review with GitHub’s pull requests.</p>
<p>Now think about how you and your collaborators typically develop
code. What benefits do you see for introducing a code review process in
your work environment? How might you institute code review practices
within your environment? Write down a process for a tool assisted code
review for your team, answering the questions above.</p>
<p>Once complete, discuss with the rest of the class what are the
advantages of a code review process and what challenges you think you
would face in implementing this process in your own working
environment.</p>
</div>
</div>
</div>
<div id="accordionSolution3" class="accordion challenge-accordion accordion-flush">
<div class="accordion-item">
<button class="accordion-button solution-button collapsed" type="button" data-bs-toggle="collapse" data-bs-target="#collapseSolution3" aria-expanded="false" aria-controls="collapseSolution3">
  <h4 class="accordion-header" id="headingSolution3"> Show me the solution </h4>
</button>
<div id="collapseSolution3" class="accordion-collapse collapse" data-bs-parent="#accordionSolution3" aria-labelledby="headingSolution3">
<div class="accordion-body">
<p>The purposes of code review include:</p>
<ul>
<li>improving internal code readability, understandability, quality and
maintainability,</li>
<li>checking for coding standards compliance, code uniformity and
consistency,</li>
<li>checking for test coverage and detecting bugs and code defects
early,</li>
<li>detecting performance problems and identifying code optimisation
points,</li>
<li>finding alternative/better solutions,</li>
<li>sharing knowledge of the code, and of coding standards and
expectations of quality.</li>
</ul>
<p>Finally, it helps increase the sense of collective code ownership and
responsibility, which in turn helps increase the “bus factor” and reduce
the risk resulting from information and capabilities being held by a
single person “responsible” for a certain part of the codebase and not
being shared among team members.</p>
<p>Challenges you might face introducing a code review process:</p>
<ul>
<li>complaints that it is a waste of time,</li>
<li>creating a negative atmosphere where people are overly critical of
each others work, or are defensive of their own,</li>
<li>perfectionism leading to slower development,</li>
<li>people not sharing code to avoid the review process.</li>
</ul>
<p>Make sure to monitor whether these are happening, and adjust the
process accordingly.</p>
</div>
</div>
</div>
</div>
</section><section><h2 class="section-heading" id="further-reading">Further Reading<a class="anchor" aria-label="anchor" href="#further-reading"></a>
</h2>
<hr class="half-width">
<p>There are multiple perspectives to a code review process - from
general practices to technical details relating to different roles
involved in the process. We have discussed the main points, but do check
these useful code review blogs from <a href="https://www.swarmia.com/blog/a-complete-guide-to-code-reviews/?utm_term=code%20review&amp;utm_campaign=Code+review+best+practices&amp;utm_source=adwords&amp;utm_medium=ppc&amp;hsa_acc=6644081770&amp;hsa_cam=14940336179&amp;hsa_grp=131344939434&amp;hsa_ad=552679672005&amp;hsa_src=g&amp;hsa_tgt=kwd-17740433&amp;hsa_kw=code%20review&amp;hsa_mt=b&amp;hsa_net=adwords&amp;hsa_ver=3&amp;gclid=Cj0KCQiAw9qOBhC-ARIsAG-rdn7_nhMMyE7aeSzosRRqZ52vafBOyMrpL4Ypru0PHWK4Rl8QLIhkeA0aAsxqEALw_wcB" class="external-link">Swarmia</a>
and <a href="https://smartbear.com/learn/code-review/best-practices-for-peer-code-review/" class="external-link">Smartbear</a>.</p>
<p>The key thing is to try it, and iterate the process until it works
well for your team.</p>
<div id="keypoints1" class="callout keypoints">
<div class="callout-square">
<i class="callout-icon" data-feather="key"></i>
</div>
<div class="callout-inner">
<h3 class="callout-title">Key Points</h3>
<div class="callout-content">
<ul>
<li>Code review is a team software quality assurance practice where team
members look at parts of the codebase in order to improve their code’s
readability, understandability, quality and maintainability.</li>
<li>It is important to agree on a set of best practices and establish a
code review process in a team to help to sustain a good, stable and
maintainable code for many years.</li>
</ul>
</div>
</div>
</div>
</section></section><section id="aio-42-software-reuse"><p>Content from <a href="42-software-reuse.html">4.2 Preparing Software for Reuse and Release</a></p>
<hr>
<p>Last updated on 2024-12-06 |

        <a href="https://github.com/carpentries-incubator/python-intermediate-development/edit/main/episodes/42-software-reuse.md" class="external-link">Edit this page <i aria-hidden="true" data-feather="edit"></i></a></p>
<p>Estimated time: <i aria-hidden="true" data-feather="clock"></i> 50 minutes</p>
<div class="text-end">
          <button role="button" aria-pressed="false" tabindex="0" id="expand-code" class="pull-right" data-expand="Expand All Solutions " data-collapse="Collapse All Solutions "> Expand All Solutions <i aria-hidden="true" data-feather="plus"></i></button>
        </div>
<div class="overview card">
<h2 class="card-header">Overview</h2>
<div class="row g-0">
<div class="col-md-4">
<div class="card-body">
<div class="inner">
<h3 class="card-title">Questions</h3>
<ul>
<li>What can we do to make our programs reusable by others?</li>
<li>How should we document and license our code?</li>
</ul>
</div>
</div>
</div>
<div class="col-md-8">
<div class="card-body">
<div class="inner bordered">
<h3 class="card-title">Objectives</h3>
<ul>
<li>Describe the different levels of software reusability</li>
<li>Explain why documentation is important</li>
<li>Describe the minimum components of software documentation to aid
reuse</li>
<li>Create a repository README file to guide others to successfully
reuse a program</li>
<li>Understand other documentation components and where they are
useful</li>
<li>Describe the basic types of open source software licence</li>
<li>Explain the importance of conforming to data policy and
regulation</li>
<li>Prioritise and work on improvements for release as a team</li>
</ul>
</div>
</div>
</div>
</div>
</div>
<section><h2 class="section-heading" id="introduction">Introduction<a class="anchor" aria-label="anchor" href="#introduction"></a>
</h2>
<hr class="half-width">
<p>In previous episodes we have looked at skills, practices, and tools
to help us design and develop software in a collaborative environment.
In this lesson we will be looking at a critical piece of the development
puzzle that builds on what we have learnt so far - sharing our software
with others.</p>
</section><section><h2 class="section-heading" id="the-levels-of-software-reusability---good-practice-revisited">The Levels of Software Reusability - Good Practice Revisited<a class="anchor" aria-label="anchor" href="#the-levels-of-software-reusability---good-practice-revisited"></a>
</h2>
<hr class="half-width">
<p>Let us begin by taking a closer look at software reusability and what
we want from it.</p>
<p>Firstly, whilst we want to ensure our software is reusable by others,
as well as ourselves, we should be clear what we mean by ‘reusable’.
There are a number of definitions out there, but a helpful one written
by <a href="https://dx.doi.org/10.3389/fninf.2017.00069" class="external-link">Benureau and
Rougler in 2017</a> offers the following levels by which software can be
characterised:</p>
<ol style="list-style-type: decimal">
<li>Re-runnable: the code is simply executable and can be run again (but
there are no guarantees beyond that)</li>
<li>Repeatable: the software will produce the same result more than
once</li>
<li>Reproducible: published research results generated from the same
version of the software can be generated again from the same input
data</li>
<li>Reusable: easy to use, understand, and modify</li>
<li>Replicable: the software can act as an available reference for any
ambiguity in the algorithmic descriptions made in the published article.
That is, a new implementation can be created from the descriptions in
the article that provide the same results as the original
implementation, and that the original - or reference - implementation,
can be used to clarify any ambiguity in those descriptions for the
purposes of reimplementation</li>
</ol>
<p>Later levels imply the earlier ones. So what should we aim for? As
researchers who develop software - or developers who write research
software - we should be aiming for at least the fourth one: reusability.
Reproducibility is required if we are to successfully claim that what we
are doing when we write software fits within acceptable scientific
practice, but it is also crucial that we can write software that can be
<em>understood</em> and ideally <em>modified</em> by others. If others
are unable to verify that a piece of software follows published
algorithms, how can they be certain it is producing correct results?
Where ‘others’, of course, can include a future version of
ourselves.</p>
</section><section><h2 class="section-heading" id="documenting-code-to-improve-reusability">Documenting Code to Improve Reusability<a class="anchor" aria-label="anchor" href="#documenting-code-to-improve-reusability"></a>
</h2>
<hr class="half-width">
<p>Reproducibility is a cornerstone of science, and scientists who work
in many disciplines are expected to document the processes by which they
have conducted their research so it can be reproduced by others. In
medicinal, pharmacological, and similar research fields for example,
researchers use logbooks which are then used to write up protocols and
methods for publication.</p>
<p>Many things we have covered so far contribute directly to making our
software reproducible - and indeed reusable - by others. A key part of
this we will cover now is software documentation, which is ironically
very often given short shrift in academia. This is often the case even
in fields where the documentation and publication of research method is
otherwise taken very seriously.</p>
<p>A few reasons for this are that writing documentation is often
considered:</p>
<ul>
<li>A low priority compared to actual research (if it is even considered
at all)</li>
<li>Expensive in terms of effort, with little reward</li>
<li>Writing documentation is boring!</li>
</ul>
<p>A very useful form of documentation for understanding our code is
code commenting, and is most effective when used to explain complex
interfaces or behaviour, or the reasoning behind why something is coded
a certain way. But code comments only go so far.</p>
<p>Whilst it is certainly arguable that writing documentation is not as
exciting as writing code, it does not have to be expensive and brings
many benefits. In addition to enabling general reproducibility by
others, documentation…</p>
<ul>
<li>Helps bring new staff researchers and developers up to speed quickly
with using the software</li>
<li>Functions as a great aid to research collaborations involving
software, where those from other teams need to use it</li>
<li>When well written, can act as a basis for detailing algorithms and
other mechanisms in research papers, such that the software’s
functionality can be <em>replicated</em> and re-implemented
elsewhere</li>
<li>Provides a descriptive link back to the science that underlies it.
As a reference, it makes it far easier to know how to update the
software as the scientific theory changes (and potentially vice
versa)</li>
<li>Importantly, it can enable others to understand the software
sufficiently to <em>modify and reuse</em> it to do different things</li>
</ul>
<p>In the next section we will see that writing a sensible minimum set
of documentation in a single document does not have to be expensive, and
can greatly aid reproducibility.</p>
<div class="section level3">
<h3 id="writing-a-readme">Writing a README<a class="anchor" aria-label="anchor" href="#writing-a-readme"></a>
</h3>
<p>A README file is the first piece of documentation (perhaps other than
publications that refer to it) that people should read to acquaint
themselves with the software. It concisely explains what the software is
about and what it is for, and covers the steps necessary to obtain and
install the software and use it to accomplish basic tasks. Think of it
not as a comprehensive reference of all functionality, but more a short
tutorial with links to further information - hence it should contain
brief explanations and be focused on instructional steps.</p>
<p>Our repository already has a README that describes the purpose of the
repository for this workshop, but let us replace it with a new one that
describes the software itself. First let us delete the old one:</p>
<div class="codewrapper sourceCode" id="cb1">
<h3 class="code-label">BASH<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="sourceCode bash" tabindex="0"><code class="sourceCode bash"><span id="cb1-1"><a href="#cb1-1" tabindex="-1"></a><span class="ex">$</span> rm README.md</span></code></pre>
</div>
<p>In the root of your repository create a replacement
<code>README.md</code> file. The <code>.md</code> indicates this is a
<strong>Markdown</strong> file, a lightweight markup language which is
basically a text file with some extra syntax to provide ways of
formatting them. A big advantage of them is that they can be read as
plain-text files or as source files for rendering them with formatting
structures, and are very quick to write. GitHub provides a very useful
<a href="https://guides.github.com/features/mastering-markdown/" class="external-link">guide
to writing Markdown</a> for its repositories.</p>
<p>Let us start writing <code>README.md</code> using a text editor of
your choice and add the following line.</p>
<div class="codewrapper sourceCode" id="cb2">
<h3 class="code-label">MARKDOWN<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="sourceCode markdown" tabindex="0"><code class="sourceCode markdown"><span id="cb2-1"><a href="#cb2-1" tabindex="-1"></a><span class="fu"># Inflam</span></span></code></pre>
</div>
<p>So here, we are giving our software a name. Ideally something unique,
short, snappy, and perhaps to some degree an indicator of what it does.
We would ideally rename the repository to reflect the new name, but let
us leave that for now. In Markdown, the <code>#</code> designates a
heading, two <code>##</code> are used for a subheading, and so on. The
Software Sustainability Institute’s <a href="https://software.ac.uk/resources/guides/choosing-project-and-product-names" class="external-link">guide
on naming projects</a> and products provides some helpful pointers.</p>
<p>We should also add a short description underneath the title.</p>
<div class="codewrapper sourceCode" id="cb3">
<h3 class="code-label">MARKDOWN<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="sourceCode markdown" tabindex="0"><code class="sourceCode markdown"><span id="cb3-1"><a href="#cb3-1" tabindex="-1"></a><span class="fu"># Inflam</span></span>
<span id="cb3-2"><a href="#cb3-2" tabindex="-1"></a>Inflam is a data management system written in Python that manages trial data used in clinical inflammation studies.</span></code></pre>
</div>
<p>To give readers an idea of the software’s capabilities, let us add
some key features next:</p>
<div class="codewrapper sourceCode" id="cb4">
<h3 class="code-label">MARKDOWN<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="sourceCode markdown" tabindex="0"><code class="sourceCode markdown"><span id="cb4-1"><a href="#cb4-1" tabindex="-1"></a><span class="fu"># Inflam</span></span>
<span id="cb4-2"><a href="#cb4-2" tabindex="-1"></a>Inflam is a data management system written in Python that manages trial data used in clinical inflammation studies.</span>
<span id="cb4-3"><a href="#cb4-3" tabindex="-1"></a></span>
<span id="cb4-4"><a href="#cb4-4" tabindex="-1"></a><span class="fu">## Main features</span></span>
<span id="cb4-5"><a href="#cb4-5" tabindex="-1"></a>Here are some key features of Inflam:</span>
<span id="cb4-6"><a href="#cb4-6" tabindex="-1"></a></span>
<span id="cb4-7"><a href="#cb4-7" tabindex="-1"></a><span class="ss">- </span>Provide basic statistical analyses over clinical trial data</span>
<span id="cb4-8"><a href="#cb4-8" tabindex="-1"></a><span class="ss">- </span>Ability to work on trial data in Comma-Separated Value (CSV) format</span>
<span id="cb4-9"><a href="#cb4-9" tabindex="-1"></a><span class="ss">- </span>Generate plots of trial data</span>
<span id="cb4-10"><a href="#cb4-10" tabindex="-1"></a><span class="ss">- </span>Analytical functions and views can be easily extended based on its Model-View-Controller architecture</span></code></pre>
</div>
<p>As well as knowing what the software aims to do and its key features,
it is very important to specify what other software and related
dependencies are needed to use the software (typically called
<code>dependencies</code> or <code>prerequisites</code>):</p>
<div class="codewrapper sourceCode" id="cb5">
<h3 class="code-label">MARKDOWN<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="sourceCode markdown" tabindex="0"><code class="sourceCode markdown"><span id="cb5-1"><a href="#cb5-1" tabindex="-1"></a><span class="fu"># Inflam</span></span>
<span id="cb5-2"><a href="#cb5-2" tabindex="-1"></a>Inflam is a data management system written in Python that manages trial data used in clinical inflammation studies.</span>
<span id="cb5-3"><a href="#cb5-3" tabindex="-1"></a></span>
<span id="cb5-4"><a href="#cb5-4" tabindex="-1"></a><span class="fu">## Main features</span></span>
<span id="cb5-5"><a href="#cb5-5" tabindex="-1"></a>Here are some key features of Inflam:</span>
<span id="cb5-6"><a href="#cb5-6" tabindex="-1"></a></span>
<span id="cb5-7"><a href="#cb5-7" tabindex="-1"></a><span class="ss">- </span>Provide basic statistical analyses over clinical trial data</span>
<span id="cb5-8"><a href="#cb5-8" tabindex="-1"></a><span class="ss">- </span>Ability to work on trial data in Comma-Separated Value (CSV) format</span>
<span id="cb5-9"><a href="#cb5-9" tabindex="-1"></a><span class="ss">- </span>Generate plots of trial data</span>
<span id="cb5-10"><a href="#cb5-10" tabindex="-1"></a><span class="ss">- </span>Analytical functions and views can be easily extended based on its Model-View-Controller architecture</span>
<span id="cb5-11"><a href="#cb5-11" tabindex="-1"></a></span>
<span id="cb5-12"><a href="#cb5-12" tabindex="-1"></a><span class="fu">## Prerequisites</span></span>
<span id="cb5-13"><a href="#cb5-13" tabindex="-1"></a>Inflam requires the following Python packages:</span>
<span id="cb5-14"><a href="#cb5-14" tabindex="-1"></a></span>
<span id="cb5-15"><a href="#cb5-15" tabindex="-1"></a><span class="ss">- </span><span class="co">[</span><span class="ot">NumPy</span><span class="co">](https://www.numpy.org/)</span> - makes use of NumPy's statistical functions</span>
<span id="cb5-16"><a href="#cb5-16" tabindex="-1"></a><span class="ss">- </span><span class="co">[</span><span class="ot">Matplotlib</span><span class="co">](https://matplotlib.org/stable/index.html)</span> - uses Matplotlib to generate statistical plots</span>
<span id="cb5-17"><a href="#cb5-17" tabindex="-1"></a></span>
<span id="cb5-18"><a href="#cb5-18" tabindex="-1"></a>The following optional packages are required to run Inflam's unit tests:</span>
<span id="cb5-19"><a href="#cb5-19" tabindex="-1"></a></span>
<span id="cb5-20"><a href="#cb5-20" tabindex="-1"></a><span class="ss">- </span><span class="co">[</span><span class="ot">pytest</span><span class="co">](https://docs.pytest.org/en/stable/)</span> - Inflam's unit tests are written using pytest</span>
<span id="cb5-21"><a href="#cb5-21" tabindex="-1"></a><span class="ss">- </span><span class="co">[</span><span class="ot">pytest-cov</span><span class="co">](https://pypi.org/project/pytest-cov/)</span> - Adds test coverage stats to unit testing</span></code></pre>
</div>
<p>Here we are making use of Markdown links, with some text describing
the link within <code>[]</code> followed by the link itself within
<code>()</code>.</p>
<p>One really neat feature - and a common practice - of using many CI
infrastructures is that we can include the status of running recent
tests within our README file. Just below the <code># Inflam</code> title
on our README.md file, add the following (replacing
<code>&lt;your_github_username&gt;</code> with your own:</p>
<div class="codewrapper sourceCode" id="cb6">
<h3 class="code-label">MARKDOWN<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="sourceCode markdown" tabindex="0"><code class="sourceCode markdown"><span id="cb6-1"><a href="#cb6-1" tabindex="-1"></a><span class="fu"># Inflam</span></span>
<span id="cb6-2"><a href="#cb6-2" tabindex="-1"></a><span class="al">![Continuous Integration build in GitHub Actions](https://github.com/&lt;your_github_username&gt;/python-intermediate-inflammation/actions/workflows/main.yml/badge.svg?branch=main)</span></span>
<span id="cb6-3"><a href="#cb6-3" tabindex="-1"></a>...</span></code></pre>
</div>
<p>This will embed a <em>badge</em> (icon) at the top of our page that
reflects the most recent GitHub Actions build status of your software
repository, essentially showing whether the tests that were run when the
last change was made to the <code>main</code> branch succeeded or
failed.</p>
<p>That’s got us started with documenting our code, but there are other
aspects we should also cover:</p>
<ul>
<li>
<em>Installation/deployment:</em> step-by-step instructions for
setting up the software so it can be used</li>
<li>
<em>Basic usage:</em> step-by-step instructions that cover using the
software to accomplish basic tasks</li>
<li>
<em>Contributing:</em> for those wishing to contribute to the
software’s development, this is an opportunity to detail what kinds of
contribution are sought and how to get involved</li>
<li>
<em>Contact information/getting help:</em> which may include things
like key author email addresses, and links to mailing lists and other
resources</li>
<li>
<em>Credits/acknowledgements:</em> where appropriate, be sure to
credit those who have helped in the software’s development or inspired
it</li>
<li>
<em>Citation:</em> particularly for academic software, it is a very
good idea to specify a reference to an appropriate academic publication
so other academics can cite use of the software in their own
publications and media. You can do this within a separate <a href="https://github.com/citation-file-format/citation-file-format" class="external-link">CITATION
text file</a> within the repository’s root directory and link to it from
the Markdown</li>
<li>
<em>Licence:</em> a short description of and link to the software’s
licence</li>
</ul>
<p>For more verbose sections, there are usually just highlights in the
README with links to further information, which may be held within other
Markdown files within the repository or elsewhere.</p>
<p>We will finish these off later. See <a href="https://github.com/matiassingers/awesome-readme" class="external-link">Matias Singer’s
curated list of awesome READMEs</a> for inspiration.</p>
</div>
<div class="section level3">
<h3 id="other-documentation">Other Documentation<a class="anchor" aria-label="anchor" href="#other-documentation"></a>
</h3>
<p>There are many different types of other documentation you should also
consider writing and making available that’s beyond the scope of this
course. The key is to consider which audiences you need to write for,
e.g. end users, developers, maintainers, etc., and what they need from
the documentation. There is a Software Sustainability Institute <a href="https://www.software.ac.uk/blog/2019-06-21-what-are-best-practices-research-software-documentation" class="external-link">blog
post on best practices for research software documentation</a> that
helpfully covers the kinds of documentation to consider and other
effective ways to convey the same information.</p>
<p>One that you should always consider is <strong>technical
documentation</strong>. This typically aims to help other developers
understand your code sufficiently well to make their own changes to it,
including external developers, other members in your team and a future
version of yourself too. This may include documentation that covers the
software’s architecture, including its different components and how they
fit together, API (Application Programming Interface) documentation that
describes the interface points designed into your software for other
developers to use, e.g. for a software library, or technical
tutorials/‘HOW TOs’ to accomplish developer-oriented tasks.</p>
</div>
</section><section><h2 class="section-heading" id="choosing-an-open-source-licence">Choosing an Open Source Licence<a class="anchor" aria-label="anchor" href="#choosing-an-open-source-licence"></a>
</h2>
<hr class="half-width">
<p>Software licensing is a whole topic in itself, so we’ll just
summarise here. Your institution’s Intellectual Property (IP) team will
be able to offer specific guidance that fits the way your institution
thinks about software.</p>
<p>In IP law, software is considered a creative work of literature, so
any code you write automatically has copyright protection applied. This
copyright will usually belong to the institution that employs you, but
this may be different for PhD students. If you need to check, this
should be included in your employment/studentship contract or talk to
your university’s IP team.</p>
<p>Since software is automatically under copyright, without a licence no
one may:</p>
<ul>
<li>Copy it</li>
<li>Distribute it</li>
<li>Modify it</li>
<li>Extend it</li>
<li>Use it (actually unclear at present - this has not been properly
tested in court yet)</li>
</ul>
<p>Fundamentally there are two kinds of licence, <strong>Open Source
licences</strong> and <strong>Proprietary licences</strong>, which serve
slightly different purposes:</p>
<ul>
<li>
<em>Proprietary licences</em> are designed to pass on limited rights
to end users, and are most suitable if you want to commercialise your
software. They tend to be customised to suit the requirements of the
software and the institution to which it belongs - again your
institutions IP team will be able to help here.</li>
<li>
<em>Open Source licences</em> are designed more to protect the
rights of end users - they specifically grant permission to make
modifications and redistribute the software to others. The <a href="https://choosealicense.com/" class="external-link">website Choose A License</a> provides
recommendations and a simple summary of some of the most common open
source licences.</li>
</ul>
<p>Within the open source licences, there are two categories,
<strong>copyleft</strong> and <strong>permissive</strong>:</p>
<ul>
<li>The permissive licences such as MIT and the multiple variants of the
BSD licence are designed to give maximum freedom to the end users of
software. These licences allow the end user to do almost anything with
the source code.</li>
<li>The copyleft licences in the GPL still give a lot of freedom to the
end users, but any code that they write based on GPLed code must also be
licensed under the same licence. This gives the developer assurance that
anyone building on their code is also contributing back to the
community. It’s actually a little more complicated than this, and the
variants all have slightly different conditions and applicability, but
this is the core of the licence.</li>
</ul>
<p>Which of these types of licence you prefer is up to you and those you
develop code with. If you want more information, or help choosing a
licence, the <a href="https://choosealicense.com/" class="external-link">Choose An Open-Source
Licence</a> or <a href="https://tldrlegal.com/" class="external-link">tl;dr Legal</a> sites
can help.</p>
<div id="exercise-preparing-for-release" class="callout discussion">
<div class="callout-square">
<i class="callout-icon" data-feather="message-circle"></i>
</div>
<div id="exercise-preparing-for-release" class="callout-inner">
<h3 class="callout-title">Exercise: Preparing for Release</h3>
<div class="callout-content">
<p>In a (hopefully) highly unlikely and thoroughly unrecommended
scenario, your project leader has informed you of the need to release
your software within the next half hour, so it can be assessed for use
by another team. You’ll need to consider finishing the README, choosing
a licence, and fixing any remaining problems you are aware of in your
codebase. Ensure you prioritise and work on the most pressing issues
first!</p>
</div>
</div>
</div>
</section><section><h2 class="section-heading" id="merging-into-main">Merging into <code>main</code>
<a class="anchor" aria-label="anchor" href="#merging-into-main"></a>
</h2>
<hr class="half-width">
<p>Once you have done these updates, commit your changes, and if you are
doing this work on a feature branch also ensure you merge it into
<code>develop</code>, e.g.:</p>
<div class="codewrapper sourceCode" id="cb7">
<h3 class="code-label">BASH<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="sourceCode bash" tabindex="0"><code class="sourceCode bash"><span id="cb7-1"><a href="#cb7-1" tabindex="-1"></a><span class="ex">$</span> git switch develop</span>
<span id="cb7-2"><a href="#cb7-2" tabindex="-1"></a><span class="ex">$</span> git merge my-feature-branch</span></code></pre>
</div>
<p>Finally, once we have fully tested our software and are confident it
works as expected on <code>develop</code>, we can merge our
<code>develop</code> branch into <code>main</code>:</p>
<div class="codewrapper sourceCode" id="cb8">
<h3 class="code-label">BASH<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="sourceCode bash" tabindex="0"><code class="sourceCode bash"><span id="cb8-1"><a href="#cb8-1" tabindex="-1"></a><span class="ex">$</span> git switch main</span>
<span id="cb8-2"><a href="#cb8-2" tabindex="-1"></a><span class="ex">$</span> git merge develop</span>
<span id="cb8-3"><a href="#cb8-3" tabindex="-1"></a><span class="ex">$</span> git push origin main</span></code></pre>
</div>
<p>The software on your <code>main</code> branch is now ready for
release.</p>
</section><section><h2 class="section-heading" id="tagging-a-release-in-github">Tagging a Release in GitHub<a class="anchor" aria-label="anchor" href="#tagging-a-release-in-github"></a>
</h2>
<hr class="half-width">
<p>There are many ways in which Git and GitHub can help us make a
software release from our code. One of these is via
<strong>tagging</strong>, where we attach a human-readable label to a
specific commit. Let us see what tags we currently have in our
repository:</p>
<div class="codewrapper sourceCode" id="cb9">
<h3 class="code-label">BASH<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="sourceCode bash" tabindex="0"><code class="sourceCode bash"><span id="cb9-1"><a href="#cb9-1" tabindex="-1"></a><span class="ex">$</span> git tag</span></code></pre>
</div>
<p>Since we have not tagged any commits yet, there is unsurprisingly no
output. We can create a new tag on the last commit in our
<code>main</code> branch by doing:</p>
<div class="codewrapper sourceCode" id="cb10">
<h3 class="code-label">BASH<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="sourceCode bash" tabindex="0"><code class="sourceCode bash"><span id="cb10-1"><a href="#cb10-1" tabindex="-1"></a><span class="ex">$</span> git tag <span class="at">-a</span> v1.0.0 <span class="at">-m</span> <span class="st">"Version 1.0.0"</span></span></code></pre>
</div>
<p>So we can now do:</p>
<div class="codewrapper sourceCode" id="cb11">
<h3 class="code-label">BASH<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="sourceCode bash" tabindex="0"><code class="sourceCode bash"><span id="cb11-1"><a href="#cb11-1" tabindex="-1"></a><span class="ex">$</span> git tag</span></code></pre>
</div>
<div class="codewrapper">
<h3 class="code-label">OUTPUT<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="output" tabindex="0"><code><span><span class="va">v.1.0.0</span></span></code></pre>
</div>
<p>And also, for more information:</p>
<div class="codewrapper sourceCode" id="cb13">
<h3 class="code-label">BASH<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="sourceCode bash" tabindex="0"><code class="sourceCode bash"><span id="cb13-1"><a href="#cb13-1" tabindex="-1"></a><span class="ex">$</span> git show v1.0.0</span></code></pre>
</div>
<p>You should see something like this:</p>
<div class="codewrapper">
<h3 class="code-label">OUTPUT<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="output" tabindex="0"><code>tag v1.0.0
Tagger: &lt;Name&gt; &lt;email&gt;
Date:   Fri Dec 10 10:22:36 2021 +0000

Version 1.0.0

commit 2df4bfcbfc1429c12f92cecba751fb2d7c1a4e28 (HEAD -&gt; main, tag: v1.0.0, origin/main, origin/develop, origin/HEAD, develop)
Author: &lt;Name&gt; &lt;email&gt;
Date:   Fri Dec 10 10:21:24 2021 +0000

	Finalising README.

diff --git a/README.md b/README.md
index 4818abb..5b8e7fd 100644
--- a/README.md
+++ b/README.md
@@ -22,4 +22,33 @@ Flimflam requires the following Python packages:
 The following optional packages are required to run Flimflam's unit tests:

 - [pytest](https://docs.pytest.org/en/stable/) - Flimflam's unit tests are written using pytest
-- [pytest-cov](https://pypi.org/project/pytest-cov/) - Adds test coverage stats to unit testing
\ No newline at end of file
+- [pytest-cov](https://pypi.org/project/pytest-cov/) - Adds test coverage stats to unit testing
+
+## Installation
+- Clone the repo ``git clone repo``
+- Check everything runs by running ``python -m pytest`` in the root directory
+- Hurray
+
+## Contributing
+- Create an issue [here](https://github.com/Onoddil/python-intermediate-inflammation/issues)
+  - What works, what does not? You tell me
+- Randomly edit some code and see if it improves things, then submit a [pull request](https://github.com/Onoddil/python-intermediate-inflammation/pulls)
+- Just yell at me while I edit the code, pair programmer style!
+
+## Getting Help
+- Nice try
+
+## Credits
+- Directed by Michael Bay
+
+## Citation
+Please cite [J. F. W. Herschel, 1829, MmRAS, 3, 177](https://ui.adsabs.harvard.edu/abs/1829MmRAS...3..177H/abstract) if you used this work in your day-to-day life.
+Please cite [C. Herschel, 1787, RSPT, 77, 1](https://ui.adsabs.harvard.edu/abs/1787RSPT...77....1H/abstract) if you actually use this for scientific work.
+
+## License
+This source code is protected under international copyright law.  All rights
+reserved and protected by the copyright holders.
+This file is confidential and only available to authorized individuals with the
+permission of the copyright holders.  If you encounter this file and do not have
+permission, please contact the copyright holders and delete this file.
\ No newline at end of file</code></pre>
</div>
<p>So now we have added a tag, we need this reflected in our Github
repository. You can push this tag to your remote by doing:</p>
<div class="codewrapper sourceCode" id="cb15">
<h3 class="code-label">BASH<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="sourceCode bash" tabindex="0"><code class="sourceCode bash"><span id="cb15-1"><a href="#cb15-1" tabindex="-1"></a><span class="ex">$</span> git push origin v1.0.0</span></code></pre>
</div>
<div id="what-is-a-version-number-anyway" class="callout">
<div class="callout-square">
<i class="callout-icon" data-feather="bell"></i>
</div>
<div id="what-is-a-version-number-anyway" class="callout-inner">
<h3 class="callout-title">What is a Version Number Anyway?</h3>
<div class="callout-content">
<p>Software version numbers are everywhere, and there are many different
ways to do it. A popular one to consider is <a href="https://semver.org/" class="external-link"><strong>Semantic Versioning</strong></a>,
where a given version number uses the format MAJOR.MINOR.PATCH. You
increment the:</p>
<ul>
<li>MAJOR version when you make incompatible API changes</li>
<li>MINOR version when you add functionality in a backwards compatible
manner</li>
<li>PATCH version when you make backwards compatible bug fixes</li>
</ul>
<p>You can also add a hyphen followed by characters to denote a
pre-release version, e.g. 1.0.0-alpha1 (first alpha release) or
1.2.3-beta4 (fourth beta release)</p>
</div>
</div>
</div>
<p>We can now use the more memorable tag to refer to this specific
commit. Plus, once we have pushed this back up to GitHub, it appears as
a specific release within our code repository which can be downloaded in
compressed <code>.zip</code> or <code>.tar.gz</code> formats. Note that
these downloads just contain the state of the repository at that commit,
and not its entire history.</p>
<p>Using features like tagging allows us to highlight commits that are
particularly important, which is very useful for
<em>reproducibility</em> purposes. We can (and should) refer to specific
commits for software in academic papers that make use of results from
software, but tagging with a specific version number makes that just a
little bit easier for humans.</p>
</section><section><h2 class="section-heading" id="conforming-to-data-policy-and-regulation">Conforming to Data Policy and Regulation<a class="anchor" aria-label="anchor" href="#conforming-to-data-policy-and-regulation"></a>
</h2>
<hr class="half-width">
<p>We may also wish to make data available to either be used with the
software or as generated results. This may be via GitHub or some other
means. An important aspect to remember with sharing data on such systems
is that they may reside in other countries, and we must be careful
depending on the nature of the data.</p>
<p>We need to ensure that we are still conforming to the relevant
policies and guidelines regarding how we manage research data, which may
include funding council, institutional, national, and even international
policies and laws. Within Europe, for example, there is the need to
conform to things like <a href="https://ec.europa.eu/info/law/law-topic/data-protection/eu-data-protection-rules_en" class="external-link">GDPR</a>.
it is a very good idea to make yourself aware of these aspects.</p>
<div id="keypoints1" class="callout keypoints">
<div class="callout-square">
<i class="callout-icon" data-feather="key"></i>
</div>
<div class="callout-inner">
<h3 class="callout-title">Key Points</h3>
<div class="callout-content">
<ul>
<li>The reuse battle is won before it is fought. Select and use good
practices consistently throughout development and not just at the
end.</li>
</ul>
</div>
</div>
</div>
</section></section><section id="aio-43-software-release"><p>Content from <a href="43-software-release.html">4.3 Packaging Code for Release and Distribution</a></p>
<hr>
<p>Last updated on 2025-05-30 |

        <a href="https://github.com/carpentries-incubator/python-intermediate-development/edit/main/episodes/43-software-release.md" class="external-link">Edit this page <i aria-hidden="true" data-feather="edit"></i></a></p>
<p>Estimated time: <i aria-hidden="true" data-feather="clock"></i> 20 minutes</p>
<div class="text-end">
          <button role="button" aria-pressed="false" tabindex="0" id="expand-code" class="pull-right" data-expand="Expand All Solutions " data-collapse="Collapse All Solutions "> Expand All Solutions <i aria-hidden="true" data-feather="plus"></i></button>
        </div>
<div class="overview card">
<h2 class="card-header">Overview</h2>
<div class="row g-0">
<div class="col-md-4">
<div class="card-body">
<div class="inner">
<h3 class="card-title">Questions</h3>
<ul>
<li>How do we prepare our code for sharing as a Python package?</li>
<li>How do we release our project for other people to install and
reuse?</li>
</ul>
</div>
</div>
</div>
<div class="col-md-8">
<div class="card-body">
<div class="inner bordered">
<h3 class="card-title">Objectives</h3>
<ul>
<li>Describe the steps necessary for sharing Python code as installable
packages.</li>
<li>Use Poetry to prepare an installable package.</li>
<li>Explain the differences between runtime and development
dependencies.</li>
</ul>
</div>
</div>
</div>
</div>
</div>
<section><h2 class="section-heading" id="why-package-our-software">Why Package our Software?<a class="anchor" aria-label="anchor" href="#why-package-our-software"></a>
</h2>
<hr class="half-width">
<p>We have now got our software ready to release - the last step is to
package it up so that it can be distributed.</p>
<p>For very small pieces of software, for example a single source file,
it may be appropriate to distribute to non-technical end-users as source
code, but in most cases we want to bundle our application or library
into a package. A package is typically a single file which contains
within it our software and some metadata which allows it to be installed
and used more simply - e.g. a list of dependencies. By distributing our
code as a package, we reduce the complexity of fetching, installing and
integrating it for the end-users.</p>
<p>In this session we will introduce one widely used method for building
an installable package from our code. There are range of methods in
common use, so it is likely you will also encounter projects which take
different approaches.</p>
<p>There is some confusing terminology in this episode around the use of
the term “package”. This term is used to refer to both:</p>
<ul>
<li>A directory containing Python files / modules and an
<code>__init__.py</code> - a “module package”</li>
<li>A way of structuring / bundling a project for easier distribution
and installation - a “distributable package”</li>
</ul></section><section><h2 class="section-heading" id="packaging-our-software-with-poetry">Packaging our Software with Poetry<a class="anchor" aria-label="anchor" href="#packaging-our-software-with-poetry"></a>
</h2>
<hr class="half-width">
<div class="section level3">
<h3 id="installing-poetry">Installing Poetry<a class="anchor" aria-label="anchor" href="#installing-poetry"></a>
</h3>
<p>Because we have recommended GitBash if you are using Windows, we are
going to install Poetry using a different method to the officially
recommended one. If you are on MacOS or Linux, are comfortable with
installing software at the command line and want to use Poetry to manage
multiple projects, you may instead prefer to follow the official <a href="https://python-poetry.org/docs/#installation" class="external-link">Poetry installation
instructions</a>.</p>
<p>We can install Poetry much like any other Python distributable
package, using <code>pip</code>:</p>
<div class="codewrapper sourceCode" id="cb1">
<h3 class="code-label">BASH<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="sourceCode bash" tabindex="0"><code class="sourceCode bash"><span id="cb1-1"><a href="#cb1-1" tabindex="-1"></a><span class="ex">$</span> source venv/bin/activate</span>
<span id="cb1-2"><a href="#cb1-2" tabindex="-1"></a><span class="ex">$</span> python3 <span class="at">-m</span> pip install poetry</span></code></pre>
</div>
<p>To test, we can ask where Poetry is installed:</p>
<div class="codewrapper sourceCode" id="cb2">
<h3 class="code-label">BASH<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="sourceCode bash" tabindex="0"><code class="sourceCode bash"><span id="cb2-1"><a href="#cb2-1" tabindex="-1"></a><span class="ex">$</span> which poetry</span></code></pre>
</div>
<div class="codewrapper">
<h3 class="code-label">OUTPUT<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="output" tabindex="0"><code>/home/alex/python-intermediate-inflammation/venv/bin/poetry</code></pre>
</div>
<p>If you do not get similar output, make sure you have got the correct
virtual environment activated.</p>
<p>Poetry can also handle virtual environments for us, so in order to
behave similarly to how we used them previously, let us change the
Poetry config to put them in the same directory as our project:</p>
<div class="codewrapper sourceCode" id="cb4">
<h3 class="code-label">BASH<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="sourceCode bash" tabindex="0"><code class="sourceCode bash"><span id="cb4-1"><a href="#cb4-1" tabindex="-1"></a><span class="ex">$</span> poetry config virtualenvs.in-project true</span></code></pre>
</div>
</div>
<div class="section level3">
<h3 id="setting-up-our-poetry-config">Setting up our Poetry Config<a class="anchor" aria-label="anchor" href="#setting-up-our-poetry-config"></a>
</h3>
<p>Poetry uses a <strong>pyproject.toml</strong> file to describe the
build system and requirements of the distributable package. This file
format was introduced to solve problems with bootstrapping packages (the
processing we do to prepare to process something) using the older
convention with <strong>setup.py</strong> files and to support a wider
range of build tools. It is described in <a href="https://www.python.org/dev/peps/pep-0518/" class="external-link">PEP 518 (Specifying
Minimum Build System Requirements for Python Projects)</a>.</p>
<p>Make sure you are in the root directory of your software project and
have activated your virtual environment, then we are ready to begin.</p>
<p>To create a <code>pyproject.toml</code> file for our code, we can use
<code>poetry init</code>. This will guide us through the most important
settings - for each prompt, we either enter our data or accept the
default.</p>
<p><em>Displayed below are the questions you should see with the
recommended responses to each question so try to follow these, although
use your own contact details!</em></p>
<p><strong>NB: When you get to the questions about defining our
dependencies, answer no, so we can do this separately
later.</strong></p>
<div id="its-not-interactive" class="callout">
<div class="callout-square">
<i class="callout-icon" data-feather="bell"></i>
</div>
<div id="its-not-interactive" class="callout-inner">
<h3 class="callout-title">It’s Not Interactive?</h3>
<div class="callout-content">
<p>If you’re using Git Bash for Windows, depending on your
configuration, you may find after typing this command that you don’t
have an interactive set of questions displayed. Instead, you may find
the <code>pyproject.toml</code> file is simply generated with a set of
default values.</p>
<p>If this happens, you can edit the <code>pyproject.toml</code> file
and change the values in this file, similarly to how we have in the
output below.</p>
</div>
</div>
</div>
<div class="codewrapper sourceCode" id="cb5">
<h3 class="code-label">BASH<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="sourceCode bash" tabindex="0"><code class="sourceCode bash"><span id="cb5-1"><a href="#cb5-1" tabindex="-1"></a><span class="ex">$</span> poetry init</span></code></pre>
</div>
<div class="codewrapper">
<h3 class="code-label">OUTPUT<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="output" tabindex="0"><code>This command will guide you through creating your pyproject.toml config.

Package name [example]:  inflammation
Version [0.1.0]: 1.0.0
Description []:  Analyse patient inflammation data
Author [None, n to skip]: James Graham &lt;J.Graham@software.ac.uk&gt;
License []:  MIT
Compatible Python versions [&gt;=3.13]:  &gt;=3.10

Would you like to define your main dependencies interactively? (yes/no) [yes] no
Would you like to define your development dependencies interactively? (yes/no) [yes] no
Generated file

[project]
name = "inflammation"
version = "1.0.0"
description = "Analyse patient inflammation data"
authors = [
    {name = "James Graham",email = "J.Graham@software.ac.uk"}
]
license = {text = "MIT"}
readme = "README.md"
requires-python = "&gt;=3.10"
dependencies = [
]


[build-system]
requires = ["poetry-core&gt;=2.0.0,&lt;3.0.0"]
build-backend = "poetry.core.masonry.api"


Do you confirm generation? (yes/no) [yes] yes</code></pre>
</div>
<p>Note that we have called our package “inflammation” in the setup
above, instead of “inflammation-analysis”. This is because Poetry will
automatically find our code if the name of the distributable package
matches the name of our module package. If we wanted our distributable
package to have a different name, for example “inflammation-analysis”,
we could do this by explicitly listing the module packages to bundle -
see <a href="https://python-poetry.org/docs/pyproject/#packages" class="external-link">the
Poetry docs on packages</a> for how to do this.</p>
</div>
<div class="section level3">
<h3 id="project-dependencies">Project Dependencies<a class="anchor" aria-label="anchor" href="#project-dependencies"></a>
</h3>
<p>Previously, we looked at using a <code>requirements.txt</code> file
to define the dependencies of our software. Here, Poetry takes
inspiration from package managers in other languages, particularly NPM
(Node Package Manager), often used for JavaScript development.</p>
<p>Tools like Poetry and NPM understand that there are two different
types of dependency: runtime dependencies and development dependencies.
Runtime dependencies are those dependencies that need to be installed
for our code to run, like NumPy. Development dependencies are
dependencies which are an essential part of your development process for
a project, but are not required to run it. Common examples of
developments dependencies are linters and test frameworks, like
<code>pylint</code> or <code>pytest</code>.</p>
<p>When we add a dependency using Poetry, Poetry will add it to the list
of dependencies in the <code>pyproject.toml</code> file, add a reference
to it in a new <code>poetry.lock</code> file, and automatically install
the package into our virtual environment. If we do not yet have a
virtual environment activated, Poetry will create it for us - using the
name <code>.venv</code>, so it appears hidden unless we do
<code>ls -a</code>. Because we have already activated a virtual
environment, Poetry will use ours instead. The
<code>pyproject.toml</code> file has two separate lists, allowing us to
distinguish between runtime and development dependencies.</p>
<div class="codewrapper sourceCode" id="cb7">
<h3 class="code-label">BASH<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="sourceCode bash" tabindex="0"><code class="sourceCode bash"><span id="cb7-1"><a href="#cb7-1" tabindex="-1"></a><span class="ex">$</span> poetry add matplotlib numpy</span>
<span id="cb7-2"><a href="#cb7-2" tabindex="-1"></a><span class="ex">$</span> poetry add <span class="at">--group</span> dev pylint</span>
<span id="cb7-3"><a href="#cb7-3" tabindex="-1"></a><span class="ex">$</span> poetry install</span></code></pre>
</div>
<p>These two sets of dependencies will be used in different
circumstances. When we build our package and upload it to a package
repository, Poetry will only include references to our runtime
dependencies. This is because someone installing our software through a
tool like <code>pip</code> is only using it, but probably does not
intend to contribute to the development of our software and does not
require development dependencies.</p>
<p>In contrast, if someone downloads our code from GitHub, together with
our <code>pyproject.toml</code>, and installs the project that way, they
will get both our runtime and development dependencies. If someone is
downloading our source code, that suggests that they intend to
contribute to the development, so they will need all of our development
tools.</p>
<p>Have a look at the <code>pyproject.toml</code> file again to see
what’s changed.</p>
</div>
<div class="section level3">
<h3 id="packaging-our-code">Packaging Our Code<a class="anchor" aria-label="anchor" href="#packaging-our-code"></a>
</h3>
<p>The final preparation we need to do is to make sure that our code is
organised in the recommended structure. This is the Python module
structure - a directory containing an <code>__init__.py</code> and our
Python source code files. Make sure that the name of this Python package
(<code>inflammation</code> - unless you have renamed it) matches the
name of your distributable package in <code>pyproject.toml</code> unless
you have chosen to explicitly list the module packages.</p>
<p>By convention distributable package names use hyphens, whereas module
package names use underscores. While we could choose to use underscores
in a distributable package name, we cannot use hyphens in a module
package name, as Python will interpret them as a minus sign in our code
when we try to import them.</p>
<p>Once we have got our <code>pyproject.toml</code> configuration done
and our project is in the right structure, we can go ahead and build a
distributable version of our software:</p>
<div class="codewrapper sourceCode" id="cb8">
<h3 class="code-label">BASH<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="sourceCode bash" tabindex="0"><code class="sourceCode bash"><span id="cb8-1"><a href="#cb8-1" tabindex="-1"></a><span class="ex">$</span> poetry build</span></code></pre>
</div>
<p>This should produce two files for us in the <code>dist</code>
directory. The one we care most about is the <code>.whl</code> or
<strong>wheel</strong> file. This is the file that <code>pip</code> uses
to distribute and install Python packages, so this is the file we would
need to share with other people who want to install our software.</p>
<p>Now if we gave this wheel file to someone else, they could install it
using <code>pip</code> - you do not need to run this command yourself,
you have already installed it using <code>poetry install</code>
above.</p>
<div class="codewrapper sourceCode" id="cb9">
<h3 class="code-label">BASH<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="sourceCode bash" tabindex="0"><code class="sourceCode bash"><span id="cb9-1"><a href="#cb9-1" tabindex="-1"></a><span class="ex">$</span> python3 <span class="at">-m</span> pip install dist/inflammation<span class="pp">*</span>.whl</span></code></pre>
</div>
<p>The star in the line above is a <strong>wildcard</strong>, that means
Bash should use any filenames that match that pattern, with any number
of characters in place for the star. We could also rely on Bash’s
autocomplete functionality and type <code>dist/inflammation</code>, then
hit the <kbd>Tab</kbd> key if we have only got one version built.</p>
<p>After we have been working on our code for a while and want to
publish an update, we just need to update the version number in the
<code>pyproject.toml</code> file (using <a href="https://semver.org/" class="external-link">SemVer</a> perhaps), then use Poetry to build
and publish the new version. If we do not increment the version number,
people might end up using this version, even though they thought they
were using the previous one. Any re-publishing of the package, no matter
how small the changes, needs to come with a new version number. The
advantage of <a href="https://semver.org/" class="external-link">SemVer</a> is that the change
in the version number indicates the degree of change in the code and
thus the degree of risk of breakage when we update.</p>
<div class="codewrapper sourceCode" id="cb10">
<h3 class="code-label">BASH<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="sourceCode bash" tabindex="0"><code class="sourceCode bash"><span id="cb10-1"><a href="#cb10-1" tabindex="-1"></a><span class="ex">$</span> poetry build</span></code></pre>
</div>
<p>In addition to the commands we have already seen, Poetry contains a
few more that can be useful for our development process. For the full
list see the <a href="https://python-poetry.org/docs/cli/" class="external-link">Poetry CLI
documentation</a>.</p>
<p>The final step is to publish our package to a package repository. A
package repository could be either public or private - while you may at
times be working on public projects, it is likely the majority of your
work will be published internally using a private repository such as
JFrog Artifactory. Every repository may be configured slightly
differently, so we will leave that to you to investigate.</p>
</div>
</section><section><h2 class="section-heading" id="what-if-we-need-more-control">What if We Need More Control?<a class="anchor" aria-label="anchor" href="#what-if-we-need-more-control"></a>
</h2>
<hr class="half-width">
<p>Sometimes we need more control over the process of building our
distributable package than Poetry allows. There many ways to distribute
Python code in packages, with some degree of flux in terms of which
methods are most popular. For a more comprehensive overview of Python
packaging you can see the <a href="https://packaging.python.org/en/latest/" class="external-link">Python docs on
packaging</a>, which contains a helpful guide to the overall <a href="https://packaging.python.org/en/latest/flow/" class="external-link">packaging process,
or ‘flow’</a>, using the <a href="https://pypi.org/project/twine/" class="external-link">Twine</a> tool to upload created
packages to PyPI for distribution as an alternative.</p>
<div id="optional-exercise-enhancing-our-package-metadata" class="callout discussion">
<div class="callout-square">
<i class="callout-icon" data-feather="message-circle"></i>
</div>
<div id="optional-exercise-enhancing-our-package-metadata" class="callout-inner">
<h3 class="callout-title">Optional Exercise: Enhancing our Package Metadata</h3>
<div class="callout-content">
<p>The <a href="https://packaging.python.org/" class="external-link">Python Packaging User
Guide</a> provides documentation on <a href="https://packaging.python.org/en/latest/tutorials/packaging-projects/" class="external-link">how
to package a project</a> using a manual approach to building a
<code>pyproject.toml</code> file, and using Twine to upload the
distribution packages to PyPI.</p>
<p>Referring to the <a href="https://packaging.python.org/en/latest/tutorials/packaging-projects/#configuring-metadata" class="external-link">section
on metadata</a> in the documentation, enhance your
<code>pyproject.toml</code> with some additional metadata fields to
improve the information your package.</p>
</div>
</div>
</div>
<div id="keypoints1" class="callout keypoints">
<div class="callout-square">
<i class="callout-icon" data-feather="key"></i>
</div>
<div class="callout-inner">
<h3 class="callout-title">Key Points</h3>
<div class="callout-content">
<ul>
<li>Poetry allows us to produce an installable package and upload it to
a package repository.</li>
<li>Making our software installable with Pip makes it easier for others
to start using it.</li>
<li>For complete control over building a package, we can use a
<code>setup.py</code> file.</li>
</ul>
</div>
</div>
</div>
</section></section><section id="aio-50-section5-intro"><p>Content from <a href="50-section5-intro.html">Section 5: Managing and Improving Software Over Its Lifetime</a></p>
<hr>
<p>Last updated on 2024-12-06 |

        <a href="https://github.com/carpentries-incubator/python-intermediate-development/edit/main/episodes/50-section5-intro.md" class="external-link">Edit this page <i aria-hidden="true" data-feather="edit"></i></a></p>
<p>Estimated time: <i aria-hidden="true" data-feather="clock"></i> 5 minutes</p>
<div class="text-end">
          <button role="button" aria-pressed="false" tabindex="0" id="expand-code" class="pull-right" data-expand="Expand All Solutions " data-collapse="Collapse All Solutions "> Expand All Solutions <i aria-hidden="true" data-feather="plus"></i></button>
        </div>
<div class="overview card">
<h2 class="card-header">Overview</h2>
<div class="row g-0">
<div class="col-md-4">
<div class="card-body">
<div class="inner">
<h3 class="card-title">Questions</h3>
<ul>
<li>How do we manage the process of developing and improving our
software?</li>
<li>How do we ensure we reuse other people’s code while maintaining the
sustainability of our own software?</li>
</ul>
</div>
</div>
</div>
<div class="col-md-8">
<div class="card-body">
<div class="inner bordered">
<h3 class="card-title">Objectives</h3>
<ul>
<li>Use established tools to track and manage software problems and
enhancements in a team.</li>
<li>Understand the importance of critical reflection to improving
software quality and reusability.</li>
<li>Improve software through feedback, work estimation, prioritisation
and agile development.</li>
</ul>
</div>
</div>
</div>
</div>
</div>
<p>In this section of the course we look at managing the
<strong>development and evolution</strong> of software - how to keep
track of the tasks the team has to do, how to improve the quality and
reusability of our software for others as well as ourselves, and how to
assess other people’s software for reuse within our project. The focus
in this section will move beyond just software development to
<strong>software management</strong>: internal planning and prioritising
tasks for future development, management of internal communication as
well as how the outside world interacts with and makes use of our
software, how others can interact with ourselves to report issues, and
the ways we can successfully manage software improvement in response to
feedback.</p>
<figure><img src="../fig/section5-overview.svg" class="image-with-shadow figure mx-auto d-block" alt="Managing software" width="1000"></figure><p>In this section we will:</p>
<ul>
<li>Use GitHub to <strong>track issues with our software</strong>
registered by ourselves and external users.</li>
<li>Use GitHub’s <strong>Mentions</strong> and notifications system to
effectively <strong>communicate within the team</strong> on software
development tasks.</li>
<li>Use GitHub’s <strong>Project Boards</strong> and
<strong>Milestones</strong> for project planning and management.</li>
<li>Learn to manage the <strong>improvement of our software through
feedback</strong> using <strong>agile</strong> management
techniques.</li>
<li>Employ <strong>effort estimation</strong> of development tasks as a
foundational tool for prioritising future team work, and use the
<strong>MoSCoW approach</strong> and software development
<strong>sprints</strong> to manage improvement. As we will see, it is
very difficult to prioritise work effectively without knowing both its
relative importance to others as well as the effort required to deliver
those work items.</li>
<li>Learn how to employ a critical mindset when reviewing software for
reuse.</li>
</ul>
<div id="keypoints1" class="callout keypoints">
<div class="callout-square">
<i class="callout-icon" data-feather="key"></i>
</div>
<div class="callout-inner">
<h3 class="callout-title">Key Points</h3>
<div class="callout-content">
<ul>
<li>For software to succeed it needs to be managed as well as
developed.</li>
<li>Estimating the effort to deliver work items is a foundational tool
for prioritising that work.</li>
</ul>
</div>
</div>
</div></section><section id="aio-51-managing-software"><p>Content from <a href="51-managing-software.html">5.1 Managing a Collaborative Software Project</a></p>
<hr>
<p>Last updated on 2025-02-25 |

        <a href="https://github.com/carpentries-incubator/python-intermediate-development/edit/main/episodes/51-managing-software.md" class="external-link">Edit this page <i aria-hidden="true" data-feather="edit"></i></a></p>
<p>Estimated time: <i aria-hidden="true" data-feather="clock"></i> 35 minutes</p>
<div class="text-end">
          <button role="button" aria-pressed="false" tabindex="0" id="expand-code" class="pull-right" data-expand="Expand All Solutions " data-collapse="Collapse All Solutions "> Expand All Solutions <i aria-hidden="true" data-feather="plus"></i></button>
        </div>
<div class="overview card">
<h2 class="card-header">Overview</h2>
<div class="row g-0">
<div class="col-md-4">
<div class="card-body">
<div class="inner">
<h3 class="card-title">Questions</h3>
<ul>
<li>How can we keep track of identified issues and the list of tasks the
team has to do?</li>
<li>How can we communicate within a team on code-related issues and
share responsibilities?</li>
<li>How can we plan, prioritise and manage tasks for future
development?</li>
</ul>
</div>
</div>
</div>
<div class="col-md-8">
<div class="card-body">
<div class="inner bordered">
<h3 class="card-title">Objectives</h3>
<ul>
<li>Register and track progress on issues with the code in our project
repository</li>
<li>Describe some different types of issues we can have with
software</li>
<li>Manage communications on software development activities within the
team using GitHub’s notification system <strong>Mentions</strong>
</li>
<li>Use GitHub’s <strong>Project Boards</strong> and
<strong>Milestones</strong> for software project management, planning
sprints and releases</li>
</ul>
</div>
</div>
</div>
</div>
</div>
<section><h2 class="section-heading" id="introduction">Introduction<a class="anchor" aria-label="anchor" href="#introduction"></a>
</h2>
<hr class="half-width">
<p>Developing software is a project and, like most projects, it consists
of multiple tasks. Keeping track of identified issues with the software,
the list of tasks the team has to do, progress on each, prioritising
tasks for future development, planning sprints and releases, etc., can
quickly become a non-trivial task in itself. Without a good team project
management process and framework, it can be hard to keep track of what’s
done, or what needs doing, and particularly difficult to convey that to
others in the team or share the responsibilities.</p>
<div id="activate-your-virtual-environment" class="callout">
<div class="callout-square">
<i class="callout-icon" data-feather="bell"></i>
</div>
<div id="activate-your-virtual-environment" class="callout-inner">
<h3 class="callout-title">Activate your virtual environment</h3>
<div class="callout-content">
<p>If it is not already active, make sure to activate your virtual
environment, called <code>venv</code>, from the root of the software
project directory:</p>
<div class="codewrapper sourceCode" id="cb1">
<h3 class="code-label">BASH<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="sourceCode bash" tabindex="0"><code class="sourceCode bash"><span id="cb1-1"><a href="#cb1-1" tabindex="-1"></a><span class="ex">$</span> source venv/bin/activate <span class="co"># Mac or Linux</span></span>
<span id="cb1-2"><a href="#cb1-2" tabindex="-1"></a><span class="ex">$</span> source venv/Scripts/activate <span class="co"># Windows</span></span>
<span id="cb1-3"><a href="#cb1-3" tabindex="-1"></a><span class="kw">(</span><span class="ex">venv</span><span class="kw">)</span> <span class="ex">$</span></span></code></pre>
</div>
</div>
</div>
</div>
</section><section><h2 class="section-heading" id="using-github-to-manage-issues-with-software">Using GitHub to Manage Issues With Software<a class="anchor" aria-label="anchor" href="#using-github-to-manage-issues-with-software"></a>
</h2>
<hr class="half-width">
<p>As a piece of software is used, bugs and other issues will inevitably
come to light - nothing is perfect! If you work on your code with
collaborators, or have non-developer users, it can be helpful to have a
single shared record of all the problems people have found with the
code, not only to keep track of them for you to work on later, but to
avoid people emailing you to report a bug that you already know
about!</p>
<p>GitHub provides <strong>Issues</strong> - a framework for managing
bug reports, feature requests, and lists of future work.</p>
<p>Go back to the home page for your
<code>python-intermediate-inflammation</code> repository in GitHub, and
click on the <code>Issues</code> tab. You should see a page listing the
open issues on your repository - currently there should be none. If you
do not see the <code>Issues</code> tab, you must first enable it in the
settings of your repository: go to the <code>Settings</code> tab, scroll
down to the <code>Features</code> section and activate the checkmark on
<code>Issues</code>.</p>
<figure><img src="../fig/github-issue-list.png" class="image-with-shadow figure mx-auto d-block" alt="List of project issues in GitHub" width="1000"></figure><p>Let us go through the process of creating a new issue. Start by
clicking the <code>New issue</code> button.</p>
<figure><img src="../fig/github-new-issue.png" class="image-with-shadow figure mx-auto d-block" alt="Creating a new issue in GitHub" width="1000"></figure><p>When you create an issue, you can add a range of details to them.
They can be <em>assigned to a specific developer</em> for example - this
can be a helpful way to know who, if anyone, is currently working to fix
the issue, or a way to assign responsibility to someone to deal with
it.</p>
<p>They can also be assigned a <em>label</em>. The labels available for
issues can be customised, and given a colour, allowing you to see at a
glance the state of your code’s issues. The <a href="https://docs.github.com/en/issues/using-labels-and-milestones-to-track-work/managing-labels" class="external-link">default
labels available in GitHub</a> include:</p>
<ul>
<li>
<code>bug</code> - indicates an unexpected problem or unintended
behavior</li>
<li>
<code>documentation</code> - indicates a need for improvements or
additions to documentation</li>
<li>
<code>duplicate</code> - indicates similar or already reported
issues, pull requests, or discussions</li>
<li>
<code>enhancement</code> - indicates new feature requests, or if
they are created by a developer, indicate planned new features</li>
<li>
<code>good first issue</code> - indicates a good issue for
first-time contributors</li>
<li>
<code>help wanted</code> - indicates that a maintainer wants help on
an issue or pull request</li>
<li>
<code>invalid</code> - indicates that an issue, pull request, or
discussion is no longer relevant</li>
<li>
<code>question</code> - indicates that an issue, pull request, or
discussion needs more information</li>
<li>
<code>wontfix</code> - indicates that work will not continue on an
issue, pull request, or discussion</li>
</ul>
<p>You can also create your own custom labels to help with classifying
issues. There are no rules really about naming the labels - use whatever
makes sense for your project. Some conventional custom labels include:
<code>status:in progress</code> (to indicate that someone started
working on the issue), <code>status:blocked</code> (to indicate that the
progress on addressing issue is blocked by another issue or activity),
etc.</p>
<p>As well as highlighting problems, the <code>bug</code> label can make
code much more usable by allowing users to find out if anyone has had
the same problem before, and also how to fix (or work around) it on
their end. Enabling users to solve their own problems can save you a lot
of time. In general, a good bug report should contain only one bug,
specific details of the environment in which the issue appeared
(e.g. operating system or browser, version of the software and its
dependencies), and sufficiently clear and concise steps that allow a
developer to reproduce the bug themselves. They should also be clear on
what the bug reporter considers factual (“I did this and this happened”)
and speculation (“I think it was caused by this”). If an error report
was generated from the software itself, it is a very good idea to
include that in the issue.</p>
<p>The <code>enhancement</code> label is a great way to communicate your
future priorities to your collaborators but also to yourself - it’s far
too easy to leave a software project for a few months to work on
something else, only to come back and forget the improvements you were
going to make. If you have other users for your code, they can use the
label to request new features, or changes to the way the code operates.
It’s generally worth paying attention to these suggestions, especially
if you spend more time developing than running the code. It can be very
easy to end up with quirky behaviour because of off-the-cuff choices
during development. Extra pairs of eyes can point out ways the code can
be made more accessible - the easier the code is to use, the more widely
it will be adopted and the greater impact it will have.</p>
<p>One interesting label is <code>wontfix</code>, which indicates that
an issue simply will not be worked on for whatever reason. Maybe the bug
it reports is outside of the use case of the software, or the feature it
requests simply is not a priority. This can make it clear you have
thought about an issue and dismissed it.</p>
<div id="locking-and-pinning-issues" class="callout">
<div class="callout-square">
<i class="callout-icon" data-feather="bell"></i>
</div>
<div id="locking-and-pinning-issues" class="callout-inner">
<h3 class="callout-title">Locking and Pinning Issues</h3>
<div class="callout-content">
<p>The <strong>Lock conversation</strong> and <strong>Pin issue</strong>
buttons are both available from individual issue pages. Locking
conversations allows you to block future comments on the issue, e.g. if
the conversation around the issue is not constructive or violates your
team’s code of conduct. Pinning issues allows you to pin up to three
issues to the top of the issues page, e.g. to emphasise their
importance.</p>
</div>
</div>
</div>
<div id="manage-issues-with-your-code-openly" class="callout testimonial">
<div class="callout-square">
<i class="callout-icon" data-feather="heart"></i>
</div>
<div id="manage-issues-with-your-code-openly" class="callout-inner">
<h3 class="callout-title">Manage Issues With Your Code Openly</h3>
<div class="callout-content">
<p>Having open, publicly-visible lists of the limitations and problems
with your code is incredibly helpful. Even if some issues end up
languishing unfixed for years, letting users know about them can save
them a huge amount of work attempting to fix what turns out to be an
unfixable problem on their end. It can also help you see at a glance
what state your code is in, making it easier to prioritise future
work!</p>
</div>
</div>
</div>
<div id="exercise-our-first-issue" class="callout challenge">
<div class="callout-square">
<i class="callout-icon" data-feather="zap"></i>
</div>
<div id="exercise-our-first-issue" class="callout-inner">
<h3 class="callout-title">Exercise: Our First Issue!</h3>
<div class="callout-content">
<p>Individually, with a critical eye, think of an aspect of the code you
have developed so far that needs improvement. It could be a bug, for
example, or a documentation issue with your README, a missing LICENSE
file, or an enhancement. In GitHub, enter the details of the issue and
select <code>Submit new issue</code>. Add a label to your issue, if
appropriate.</p>
</div>
</div>
</div>
<div id="accordionSolution1" class="accordion challenge-accordion accordion-flush">
<div class="accordion-item">
<button class="accordion-button solution-button collapsed" type="button" data-bs-toggle="collapse" data-bs-target="#collapseSolution1" aria-expanded="false" aria-controls="collapseSolution1">
  <h4 class="accordion-header" id="headingSolution1"> Show me the solution </h4>
</button>
<div id="collapseSolution1" class="accordion-collapse collapse" data-bs-parent="#accordionSolution1" aria-labelledby="headingSolution1">
<div class="accordion-body">
<p>For example, “Add a licence file” could be a good first issue, with a
label <code>documentation</code>.</p>
</div>
</div>
</div>
</div>
<div class="section level3">
<h3 id="issue-and-pull-request-templates">Issue (and Pull Request) Templates<a class="anchor" aria-label="anchor" href="#issue-and-pull-request-templates"></a>
</h3>
<p>GitHub also allows you to set up issue and pull request templates for
your software project. Such templates provide a structure for the
issue/pull request descriptions, and/or prompt issue reporters and
collaborators to fill in answers to pre-set questions. They can help
contributors raise issues or submit pull requests in a way that is
clear, helpful and provides enough information for maintainers to act
upon (without going back and forth to extract it). GitHub provides a
range of default templates, but you can also <a href="https://docs.github.com/en/communities/using-templates-to-encourage-useful-issues-and-pull-requests/configuring-issue-templates-for-your-repository" class="external-link">write
your own</a>.</p>
</div>
</section><section><h2 class="section-heading" id="using-githubs-notifications-referencing-system-to-communicate">Using GitHub’s Notifications &amp; Referencing System to
Communicate<a class="anchor" aria-label="anchor" href="#using-githubs-notifications-referencing-system-to-communicate"></a>
</h2>
<hr class="half-width">
<p>GitHub implements a comprehensive <a href="https://docs.github.com/en/account-and-profile/managing-subscriptions-and-notifications-on-github/setting-up-notifications/configuring-notifications" class="external-link">notifications
system</a> to keep the team up-to-date with activities in your code
repository and notify you when something happens or changes in your
software project. You can choose whether to watch or unwatch an
individual repository, or can choose to only be notified of certain
event types such as updates to issues, pull requests, direct mentions,
etc. GitHub also provides an additional useful notification feature for
collaborative work - <strong>Mentions</strong>. In addition to
referencing team members (which will result in an appropriate
notification), GitHub allows us to reference issues, pull requests and
comments from one another - providing a useful way of connecting things
and conversations in your project.</p>
<div class="section level3">
<h3 id="referencing-team-members-using-mentions">Referencing Team Members Using Mentions<a class="anchor" aria-label="anchor" href="#referencing-team-members-using-mentions"></a>
</h3>
<p>The mention system notifies team members when somebody else
references them in an issue, comment or pull request - you can use this
to notify people when you want to check a detail with them, or let them
know something has been fixed or changed (much easier than writing out
all the same information again in an email).</p>
<p>You can use the mention system to link to/notify an individual GitHub
account or a whole team for notifying multiple people. Typing
<kbd>@</kbd> in GitHub will bring up a list of all accounts and teams
linked to the repository that can be “mentioned”. People will then
receive notifications based on their preferred notification methods -
e.g. via email or GitHub’s User Interface.</p>
</div>
<div class="section level3">
<h3 id="referencing-issues-pull-requests-and-comments">Referencing Issues, Pull Requests and Comments<a class="anchor" aria-label="anchor" href="#referencing-issues-pull-requests-and-comments"></a>
</h3>
<p>GitHub also lets you mention/reference one issue or pull request from
another (and people “watching” these will be notified of any such
updates). Whilst writing the description of an issue, or commenting on
one, if you type <kbd>#</kbd> you should see a list of the issues and
pull requests on the repository. They are coloured green if they are
open, or white if they are closed. Continue typing the issue number, and
the list will narrow down, then you can hit <kbd>Return</kbd> to select
the entry and link the two. For example, if you realise that several of
your bugs have common roots, or that one enhancement cannot be
implemented before you have finished another, you can use the mention
system to indicate the depending issue(s). This is a simple way to add
much more information to your issues.</p>
<p>While not strictly notifying anyone, GitHub lets you also reference
individual comments and commits. If you click the <code>...</code>
button on a comment, from the drop down list you can select to
<code>Copy link</code> (which is a URL that points to that comment that
can be pasted elsewhere) or to
<code>Reference [a comment] in a new issue</code> (which opens a new
issue and references the comment by its URL). Within a text box for
comments, issue and pull request descriptions, you can reference a
commit by pasting its long, unique identifier (or its first few digits
which uniquely identify it) and GitHub will render it nicely using the
identifier’s short form and link to the commit in question.</p>
<figure><img src="../fig/github-reference-comments-commits.png" class="image-with-shadow figure mx-auto d-block" alt="Referencing comments and commits in GitHub" width="700"></figure><div id="exercise-our-first-mentionreference" class="callout discussion">
<div class="callout-square">
<i class="callout-icon" data-feather="message-circle"></i>
</div>
<div id="exercise-our-first-mentionreference" class="callout-inner">
<h3 class="callout-title">Exercise: Our First Mention/Reference!</h3>
<div class="callout-content">
<p>Add a mention to one of your team members using the <code>@</code>
notation in a comment within an issue or a pull request in your
repository - e.g. to ask them a question or a clarification on something
or to do some additional work.</p>
<p>Alternatively, add another issue to your repository and reference the
issue you created in the previous exercise using the <code>#</code>
notation.</p>
</div>
</div>
</div>
<div id="you-are-also-a-user-of-your-code" class="callout">
<div class="callout-square">
<i class="callout-icon" data-feather="bell"></i>
</div>
<div id="you-are-also-a-user-of-your-code" class="callout-inner">
<h3 class="callout-title">You Are Also a User of Your Code</h3>
<div class="callout-content">
<p>This section focuses a lot on how issues and mentions can help
communicate the current state of the code to others and document what
conversations were held around particular issues. As a sole developer,
and possibly also the only user of the code, you might be tempted to not
bother with recording issues, comments and new features as you do not
need to communicate the information to anyone else.</p>
<p>Unfortunately, human memory is not infallible! After spending six
months on a different topic, it is inevitable you’ll forget some of the
plans you had and problems you faced. Not documenting these things can
lead to you having to re-learn things you already put the effort into
discovering before. Also, if others are brought on to the project at a
later date, the software’s existing issues and potential new features
are already in place to build upon.</p>
</div>
</div>
</div>
</div>
</section><section><h2 class="section-heading" id="software-project-management-in-github">Software Project Management in GitHub<a class="anchor" aria-label="anchor" href="#software-project-management-in-github"></a>
</h2>
<hr class="half-width">
<p>Managing issues within your software project is one aspect of project
management but it gives a relative flat representation of tasks and may
not be as suitable for higher-level project management such as
prioritising tasks for future development, planning sprints and
releases. Luckily, GitHub provides two project management tools for this
purpose - <strong>Projects</strong> and <strong>Milestones</strong>.</p>
<p>Both GitHub Projects and Milestones provide <a href="https://www.atlassian.com/agile" class="external-link">agile development and project
management systems</a> and ways of organising issues into smaller
“sub-projects” (i.e. smaller than the “project” represented by the whole
repository). Projects provide a way of visualising and organising work
which is not time-bound and is on a higher level (e.g. more suitable for
project management tasks). Milestones are typically used to organise
lower-level tasks that have deadlines and progress of which needs to be
closely tracked (e.g. release and version management). The main
difference is that Milestones are a repository-level feature (i.e. they
belong and are managed from a single repository), whereas projects are
account-level and can manage tasks across many repositories under the
same user or organisational account.</p>
<p>How you organise and partition your project work and which tool you
want to use to track progress (if at all) is up to you and the size of
your project. For example, you could create a project per milestone or
have several milestones in a single project, or split milestones into
shorter sprints. We will use Milestones soon to organise work on a mini
sprint within our team - for now, we will have a brief look at
Projects.</p>
<div class="section level3">
<h3 id="projects">Projects<a class="anchor" aria-label="anchor" href="#projects"></a>
</h3>
<p>A GitHub Project uses a “project board” consisting of columns and
cards to keep track of tasks (although GitHub now also provides a table
view over a project’s tasks). You break down your project into smaller
sub-projects, which in turn are split into tasks which you write on
cards, then move the cards between columns that describe the status of
each task. Cards are usually small, descriptive and self-contained tasks
that build on each other. Breaking a project down into clearly-defined
tasks makes it a lot easier to manage. GitHub project boards interact
and integrate with the other features of the site such as issues and
pull requests - cards can be added to track the progress of such tasks
and automatically moved between columns based on their progress or
status.</p>
<p>GitHub projects are “an adaptable, flexible tool for planning and
tracking work on GitHub” - they now provide interchangeable spreadsheet,
task-board, or roadmap views of your project that integrates with your
issues and pull requests on GitHub to help you plan and track your work
effectively. We recommend you to have a look at <a href="https://docs.github.com/en/issues/planning-and-tracking-with-projects/learning-about-projects/about-projects" class="external-link">GitHub’s
documentation on Projects</a> and see if they are suitable for your
software development workflow.</p>
<div id="github-projects-are-a-cross-repository-management-tool" class="callout">
<div class="callout-square">
<i class="callout-icon" data-feather="bell"></i>
</div>
<div id="github-projects-are-a-cross-repository-management-tool" class="callout-inner">
<h3 class="callout-title">GitHub Projects are a Cross-Repository Management Tool</h3>
<div class="callout-content">
<p><a href="https://docs.github.com/en/issues/planning-and-tracking-with-projects/learning-about-projects/about-projects" class="external-link">Project
in GitHub</a> are created on a user or organisation level, i.e. they can
span all repositories owned by a user or organisation in GitHub and are
not a repository-level feature any more. A project can integrate your
issues and pull requests on GitHub from multiple repositories to help
you plan and track your team’s work effectively.</p>
</div>
</div>
</div>
<p>Let us have a quick look at how Projects are created in GitHub - we
will not use them much in this course but it is good to be aware of how
to make use of them when suitable.</p>
<ol style="list-style-type: decimal">
<li>From your GitHub account’s home page (not your repository’s home
page!), select the “Projects” tab, then click the
<code>New project</code> button on the right.</li>
</ol>
<figure><img src="../fig/github-new-project.png" class="image-with-shadow figure mx-auto d-block" alt="Adding a new project board in GitHub" width="800"></figure><ol start="2" style="list-style-type: decimal">
<li>In the “Create project” pop-up window, you can either start from one
of the featured existing project templates or create your project from
scratch using one of the three standard project types/views that you
customise yourself:</li>
</ol>
<ul>
<li>Table - a spreadsheet-style table to filter, sort and group your
issues and pull requests.</li>
<li>Board - a “cards on a board” view of the project, with issues and
pull requests being spread across customizable columns as cards on
kanban board</li>
<li>Roadmap - suitable for a high-level visualisation of your project
over time. <img src="../fig/github-project-template.png" class="image-with-shadow figure" alt="Selecting a project board template in GitHub" width="800">
Regardless of which project type/view you select, you can easily switch
to a different project layout later on.</li>
</ul>
<ol start="3" style="list-style-type: decimal">
<li><p>For example, select the “Board” type for the project, fill in the
name of your project (e.g. “Inflammation project - release v0.1”), and
select <code>Create project</code>.</p></li>
<li><p>After it is created, you should also populate the description of
the project from the project’s Settings, which can be found by clicking
the <code>...</code> button in the top right corner of the project. <img src="../fig/github-project-settings.png" class="image-with-shadow figure" alt="Project board setting in GitHub" width="800"><img src="../fig/github-project-description.png" class="image-with-shadow figure" alt="Adding project description and metadata in GitHub" width="800">
After adding a description, select <code>Save</code>.</p></li>
<li><p>GitHub’s default card board template contains the following three
columns with pretty self-explanatory names:</p></li>
</ol>
<ul>
<li><code>To Do</code></li>
<li><code>In Progress</code></li>
<li><code>Done</code></li>
</ul>
<figure><img src="../fig/github-project-view-add-remove-items.png" class="image-with-shadow figure mx-auto d-block" alt="Default card board in GitHub" width="800"></figure><p>You can add or remove columns from your project board to suit your
use case. One commonly seen extra column is <code>On hold</code> or
<code>Waiting</code> - if you have tasks that get held up by waiting on
other people (e.g. to respond to your questions) then moving them to a
separate column makes their current state clearer. Another way to
organise your table is to have a column for each quarter of the year -
it is up to you to decide how you want to view your project’s
activities.</p>
<p>To add a new column, press the <code>+</code> button on the right; to
remove a column select the <code>...</code> button in the top right
corner of the column itself and then the <code>Delete column</code>
option.</p>
<ol start="6" style="list-style-type: decimal">
<li>You can now add new items (cards) to columns by pressing the
<code>+ Add item</code> button at the bottom of each column (see the
previous image) - a text box to add a card will appear. Cards can be
simple textual notes which you type into the text box and pres
<code>Enter</code> when finished. Cards can also be (links to) existing
issues and pull requests, which can be filtered out from the text box by
pressing <code>#</code> (to activate GitHub’s referencing mechanism) and
selecting the repository and an issue or pull request from that
repository that you want to add.</li>
</ol>
<figure><img src="../fig/github-project-new-items.png" class="image-with-shadow figure mx-auto d-block" alt="Adding issues and notes to a project board in GitHub" width="800"></figure><p>Notes contain task descriptions and can have detailed content like
checklists. In some cases, e.g. if a note becomes too complex, you may
want to convert it into an issue so you can add labels, assign them to
team members or write more detailed comments (for that, use the
<code>Convert to issue</code> option from the <code>...</code> menu on
the card itself).</p>
<figure><img src="../fig/github-convert-task-to-issue.png" class="image-with-shadow figure mx-auto d-block" alt="Converting a task to issue" width="800"></figure><ol start="7" style="list-style-type: decimal">
<li><p>In addition to creating new tasks as notes and converting them to
issues - you can add an existing issue or pull request (from any
repository visible to you) as a task on a column by pasting its URL into
the <code>Add item</code> field and pressing the <code>Enter</code>
key.</p></li>
<li><p>You can drag a task/card from <code>Todo</code> to
<code>In Progress</code> column to indicate that you are working on it
or to the <code>Done</code> column to indicate that it has been
completed. Issues and pull requests on cards will automatically be moved
to the <code>Done</code> column for you when you close the issue or
merge the pull request - which is very convenient and can save you some
project management time.</p></li>
<li><p>Finally, you can change the way you view your project by adding
another view. For example, we can add a Table view to our Board view by
clicking the <code>New button</code> and selecting it from the drop down
menu. <img src="../fig/github-project-add-view.png" class="image-with-shadow figure" alt="Add another project view" width="800"></p></li>
</ol>
<div id="exercise-working-with-projects" class="callout discussion">
<div class="callout-square">
<i class="callout-icon" data-feather="message-circle"></i>
</div>
<div id="exercise-working-with-projects" class="callout-inner">
<h3 class="callout-title">Exercise: Working With Projects</h3>
<div class="callout-content">
<p>Spend a few minutes planning what you want to do with your project as
a bigger chunk of work (you can continue working on the first release of
your software if you like) and play around with your project board to
manage tasks around the project:</p>
<ul>
<li>practice adding and removing columns,</li>
<li>practice adding different types of cards (notes and from already
existing open issues and/or unmerged pull requests),</li>
<li>practice turing cards into issues and closing issues, etc.</li>
</ul>
<p>Make sure to add a certain number of issues to your repository to be
able to use in your project board.</p>
</div>
</div>
</div>
<div id="prioritisation-with-project-boards" class="callout">
<div class="callout-square">
<i class="callout-icon" data-feather="bell"></i>
</div>
<div id="prioritisation-with-project-boards" class="callout-inner">
<h3 class="callout-title">Prioritisation With Project Boards</h3>
<div class="callout-content">
<p>Once your project board has a large number of cards on it, you might
want to begin priorisiting them. Not all tasks are going to be equally
important, and some will require others to be completed before they can
even be begun. Common methods of prioritisation include:</p>
<ul>
<li>
<strong>Vertical position</strong>: the vertical arrangement of
cards in a column implicitly represents their importance. High-priority
issues go to the top of <code>To Do</code>, whilst tasks that depend on
others go beneath them. This is the easiest one to implement, though you
have to remember to correctly place cards when you add them.</li>
<li>
<strong>Priority columns</strong>: instead of a single
<code>To Do</code> column, you can have two or more, for example -
<code>To Do: Low Priority</code> and <code>To Do: High Priority</code>.
When adding a card, you pick which is the appropriate column for it. You
can even add a <code>Triage</code> column for newly-added issues that
you’ve not yet had time to classify. This format works well for project
boards devoted to bugs.</li>
<li>
<strong>Labels</strong>: if you convert each card into an issue,
then you can label them with their priority - remember GitHub lets you
create custom labels and set their colours. Label colours can provide a
very visually clear indication of issue priority but require more
administrative work on the project, as each card has to be an issue to
be assigned a label. If you choose this route for issue prioritisation -
be aware of accessibility issues for colour-blind people when picking
colours.</li>
</ul>
</div>
</div>
</div>
<div id="keypoints1" class="callout keypoints">
<div class="callout-square">
<i class="callout-icon" data-feather="key"></i>
</div>
<div class="callout-inner">
<h3 class="callout-title">Key Points</h3>
<div class="callout-content">
<ul>
<li>We should use GitHub’s <strong>Issues</strong> to keep track of
software problems and other requests for change - even if we are the
only developer and user.</li>
<li>GitHub’s <strong>Mentions</strong> play an important part in
communicating between collaborators and is used as a way of alerting
team members of activities and referencing one issue/pull
requests/comment/commit from another.</li>
<li>Without a good project and issue management framework, it can be
hard to keep track of what’s done, or what needs doing, and particularly
difficult to convey that to others in the team or sharing the
responsibilities.</li>
</ul>
</div>
</div>
</div>
</div>
</section></section><section id="aio-52-assessing-software-suitability-improvement"><p>Content from <a href="52-assessing-software-suitability-improvement.html">5.2 Assessing Software for Suitability and Improvement</a></p>
<hr>
<p>Last updated on 2024-12-06 |

        <a href="https://github.com/carpentries-incubator/python-intermediate-development/edit/main/episodes/52-assessing-software-suitability-improvement.md" class="external-link">Edit this page <i aria-hidden="true" data-feather="edit"></i></a></p>
<p>Estimated time: <i aria-hidden="true" data-feather="clock"></i> 45 minutes</p>
<div class="text-end">
          <button role="button" aria-pressed="false" tabindex="0" id="expand-code" class="pull-right" data-expand="Expand All Solutions " data-collapse="Collapse All Solutions "> Expand All Solutions <i aria-hidden="true" data-feather="plus"></i></button>
        </div>
<div class="overview card">
<h2 class="card-header">Overview</h2>
<div class="row g-0">
<div class="col-md-4">
<div class="card-body">
<div class="inner">
<h3 class="card-title">Questions</h3>
<ul>
<li>What makes good code actually good?</li>
<li>What should we look for when selecting software to reuse?</li>
</ul>
</div>
</div>
</div>
<div class="col-md-8">
<div class="card-body">
<div class="inner bordered">
<h3 class="card-title">Objectives</h3>
<ul>
<li>Explain why a critical mindset is important when selecting
software</li>
<li>Conduct an assessment of software against suitability criteria</li>
<li>Describe what should be included in software issue reports and
register them</li>
</ul>
</div>
</div>
</div>
</div>
</div>
<section><h2 class="section-heading" id="introduction">Introduction<a class="anchor" aria-label="anchor" href="#introduction"></a>
</h2>
<hr class="half-width">
<p>What we have been looking at so far enables us to adopt a more
proactive and managed attitude and approach to the software we develop.
But we should also adopt this attitude when selecting and making use of
third-party software we wish to use. With pressing deadlines it is very
easy to reach for a piece of software that appears to do what you want
without considering properly whether it is a good fit for your project
first. A chain is only as strong as its weakest link, and our software
may inherit weaknesses in any dependent software or create other
problems.</p>
<p>Overall, when adopting software to use it is important to consider
not only whether it has the functionality you want, but a broader range
of qualities that are important for your project. Adopting a critical
mindset when assessing other software against suitability criteria will
help you adopt the same attitude when assessing your own software for
future improvements.</p>
</section><section><h2 class="section-heading" id="assessing-software-for-suitability">Assessing Software for Suitability<a class="anchor" aria-label="anchor" href="#assessing-software-for-suitability"></a>
</h2>
<hr class="half-width">
<div id="exercise-decide-on-your-groups-repository" class="callout discussion">
<div class="callout-square">
<i class="callout-icon" data-feather="message-circle"></i>
</div>
<div id="exercise-decide-on-your-groups-repository" class="callout-inner">
<h3 class="callout-title">Exercise: Decide on Your Group’s Repository!</h3>
<div class="callout-content">
<p>You all have your code repositories you have been working on
throughout the course so far. For the upcoming exercise, groups will
exchange repositories and review the code of the repository they
inherit, and provide feedback.</p>
<ol style="list-style-type: decimal">
<li>Decide as a team on one of your repositories that will represent
your group. You can do this any way you wish, but if you are having
trouble then a pseudo-random number might help:
<code>python -c "import numpy as np; print(np.random.randint(low=1, high=&lt;size_group_plus_1&gt;))"</code>
</li>
<li>Add the URL of the repository to the section of the shared notes
labelled ‘Decide on your Group’s Repository’, next to your team’s
name.</li>
</ol>
</div>
</div>
</div>
<div id="exercise-conduct-assessment-on-third-party-software" class="callout discussion">
<div class="callout-square">
<i class="callout-icon" data-feather="message-circle"></i>
</div>
<div id="exercise-conduct-assessment-on-third-party-software" class="callout-inner">
<h3 class="callout-title">Exercise: Conduct Assessment on Third-Party Software</h3>
<div class="callout-content">
<p><em>The scenario:</em> It is envisaged that a piece of software
developed by another team will be adopted and used for the long term in
a number of future projects. You have been tasked with conducting an
assessment of this software to identify any issues that need resolving
prior to working with it, and will provide feedback to the developing
team to fix these issues.</p>
<ol style="list-style-type: decimal">
<li>As a team, briefly decide who will assess which aspect of the
repository, e.g. its documentation, tests, codebase, etc.</li>
<li>Obtain the URL for the repository you will assess from the shared
notes document, in the section labelled ‘Decide on your Group’s
Repository’ - see the last column which indicates which team’s
repository you are assessing.</li>
<li>Conduct the assessment and register any issues you find on the other
team’s software repository on GitHub.</li>
<li>Be meticulous in your assessment and register as many issues as you
can!</li>
</ol>
</div>
</div>
</div>
<div id="supporting-your-software---how-and-how-much" class="callout">
<div class="callout-square">
<i class="callout-icon" data-feather="bell"></i>
</div>
<div id="supporting-your-software---how-and-how-much" class="callout-inner">
<h3 class="callout-title">Supporting Your Software - How and How Much?</h3>
<div class="callout-content">
<p>Within your collaborations and projects, what should you do to
support other users? Here are some key aspects to consider:</p>
<ul>
<li>Provide contact information: so users know what to do and how to get
in contact if they run into problems</li>
<li>Manage your support: an issue tracker - like the one in GitHub - is
essential to track and manage issues</li>
<li>Manage expectations: let users know the level of support you offer,
in terms of when they can expect responses to queries, the scope of
support (e.g. which platforms, types of releases, etc.), the types of
support (e.g. bug resolution, helping develop tailored solutions), and
expectations for support in the future (e.g. when project funding runs
out)</li>
</ul>
<p>All of this requires effort, and you cannot do everything. It is
therefore important to agree and be clear on how the software will be
supported from the outset, whether it is within the context of a single
laboratory, project, or other collaboration, or across an entire
community.</p>
</div>
</div>
</div>
<div id="keypoints1" class="callout keypoints">
<div class="callout-square">
<i class="callout-icon" data-feather="key"></i>
</div>
<div class="callout-inner">
<h3 class="callout-title">Key Points</h3>
<div class="callout-content">
<ul>
<li>It is as important to have a critical attitude to adopting software
as we do to developing it.</li>
<li>As a team agree on who and to what extent you will support software
you make available to others.</li>
</ul>
</div>
</div>
</div>
</section></section><section id="aio-53-improvement-through-feedback"><p>Content from <a href="53-improvement-through-feedback.html">5.3 Software Improvement Through Feedback</a></p>
<hr>
<p>Last updated on 2024-12-06 |

        <a href="https://github.com/carpentries-incubator/python-intermediate-development/edit/main/episodes/53-improvement-through-feedback.md" class="external-link">Edit this page <i aria-hidden="true" data-feather="edit"></i></a></p>
<p>Estimated time: <i aria-hidden="true" data-feather="clock"></i> 70 minutes</p>
<div class="text-end">
          <button role="button" aria-pressed="false" tabindex="0" id="expand-code" class="pull-right" data-expand="Expand All Solutions " data-collapse="Collapse All Solutions "> Expand All Solutions <i aria-hidden="true" data-feather="plus"></i></button>
        </div>
<div class="overview card">
<h2 class="card-header">Overview</h2>
<div class="row g-0">
<div class="col-md-4">
<div class="card-body">
<div class="inner">
<h3 class="card-title">Questions</h3>
<ul>
<li>How should we handle feedback on our software?</li>
<li>How, and to what extent, should we provide support to our
users?</li>
</ul>
</div>
</div>
</div>
<div class="col-md-8">
<div class="card-body">
<div class="inner bordered">
<h3 class="card-title">Objectives</h3>
<ul>
<li>Prioritise and work on externally registered issues</li>
<li>Respond to submitted issue reports and provide feedback</li>
<li>Explain the importance of software support and choosing a suitable
level of support</li>
</ul>
</div>
</div>
</div>
</div>
</div>
<section><h2 class="section-heading" id="introduction">Introduction<a class="anchor" aria-label="anchor" href="#introduction"></a>
</h2>
<hr class="half-width">
<p>When a software project has been around for even just a short amount
of time, you’ll likely discover many aspects that can be improved. These
can come from issues that have been registered via collaborators or
users, but also those you are aware of internally, which should also be
registered as issues. When starting a new software project, you’ll also
have to determine how you’ll handle all the requirements. But which ones
should you work on first, which are the most important and why, and how
should you organise all this work?</p>
<p>Software has a fundamental role to play in doing science, but
unfortunately software development is often given short shrift in
academia when it comes to prioritising effort. There are also many other
draws on our time in addition to the research, development, and writing
of publications that we do, which makes it all the more important to
prioritise our time for development effectively.</p>
<p>In this lesson we will be looking at prioritising work we need to do
and what we can use from the agile perspective of project management to
help us do this in our software projects.</p>
</section><section><h2 class="section-heading" id="estimation-as-a-foundation-for-prioritisation">Estimation as a Foundation for Prioritisation<a class="anchor" aria-label="anchor" href="#estimation-as-a-foundation-for-prioritisation"></a>
</h2>
<hr class="half-width">
<p>For simplicity, we will refer to our issues as <em>requirements</em>,
since that’s essentially what they are - new requirements for our
software to fulfil.</p>
<p>But before we can prioritise our requirements, there are some things
we need to find out.</p>
<p>Firstly, we need to know:</p>
<ul>
<li>
<em>The period of time we have to resolve these requirements</em> -
e.g. before the next software release, pivotal demonstration, or other
deadlines requiring their completion. This is known as a
<strong>timebox</strong>. This might be a week or two, but for agile,
this should not be longer than a month. Longer deadlines with more
complex requirements may be split into a number of timeboxes.</li>
<li>
<em>How much overall effort we have available</em> -</li>
<li>i.e. who will be involved and how much of their time we will have
during this period.</li>
</ul>
<p>We also need estimates for how long each requirement will take to
resolve, since we cannot meaningfully prioritise requirements without
knowing what the effort tradeoffs will be. Even if we know how important
each requirement is, how would we even know if completing the project is
possible? Or if we do not know how long it will take to deliver those
requirements we deem to be critical to the success of a project, how can
we know if we can include other less important ones?</p>
<p>It is often not the reality, but estimation should ideally be done by
the people likely to do the actual work (i.e. the Research Software
Engineers, researchers, or developers). It shouldn’t be done by project
managers or PIs simply because they are not best placed to estimate, and
those doing the work are the ones who are effectively committing to
these figures.</p>
<div id="why-is-it-so-difficult-to-estimate" class="callout">
<div class="callout-square">
<i class="callout-icon" data-feather="bell"></i>
</div>
<div id="why-is-it-so-difficult-to-estimate" class="callout-inner">
<h3 class="callout-title">Why is it so Difficult to Estimate?</h3>
<div class="callout-content">
<p>Estimation is a very valuable skill to learn, and one that is often
difficult. Lack of experience in estimation can play a part, but a
number of psychological causes can also contribute. One of these is <a href="https://en.wikipedia.org/wiki/Dunning%E2%80%93Kruger_effect" class="external-link">Dunning-Kruger</a>,
a type of cognitive bias in which people tend to overestimate their
abilities, whilst in opposition to this is <a href="https://en.wikipedia.org/wiki/Impostor_syndrome" class="external-link">imposter
syndrome</a>, where due to a lack of confidence people underestimate
their abilities. The key message here is to be honest about what you can
do, and find out as much information that is reasonably appropriate
before arriving at an estimate.</p>
<p>More experience in estimation will also help to reduce these effects.
So keep estimating!</p>
</div>
</div>
</div>
<p>An effective way of helping to make your estimates more accurate is
to do it as a team. Other members can ask prudent questions that may not
have been considered, and bring in other sanity checks and their own
development experience. Just talking things through can help uncover
other complexities and pitfalls, and raise crucial questions to clarify
ambiguities.</p>
<div id="where-to-record-effort-estimates" class="callout">
<div class="callout-square">
<i class="callout-icon" data-feather="bell"></i>
</div>
<div id="where-to-record-effort-estimates" class="callout-inner">
<h3 class="callout-title">Where to Record Effort Estimates?</h3>
<div class="callout-content">
<p>There is no dedicated place to record the effort estimate on an issue
in current GitHub’s interface. Therefore, you can agree on a convention
within your team on how to record this information - e.g. you can add
the effort in person/days in the issue title. Recording estimates within
comments on an issue may not be the best idea as it may get lost among
other comments. Another place where you can record estimates for your
issues is on project boards - there is no default field for this but you
can create a custom numeric field and use it to assign effort estimates
(note that you cannot sum them yet in the current GitHub’s
interface).</p>
</div>
</div>
</div>
<div id="exercise-estimate" class="callout discussion">
<div class="callout-square">
<i class="callout-icon" data-feather="message-circle"></i>
</div>
<div id="exercise-estimate" class="callout-inner">
<h3 class="callout-title">Exercise: Estimate!</h3>
<div class="callout-content">
<p>As a team go through the issues that your partner team has registered
with your software repository, and quickly estimate how long each issue
will take to resolve in minutes. Do this by blind consensus first, each
anonymously submitting an estimate, and then briefly discuss your
rationale and decide on a final estimate. Make sure these are honest
estimates, and you are able to complete them in the allotted time!</p>
</div>
</div>
</div>
</section><section><h2 class="section-heading" id="using-moscow-to-prioritise-work">Using MoSCoW to Prioritise Work<a class="anchor" aria-label="anchor" href="#using-moscow-to-prioritise-work"></a>
</h2>
<hr class="half-width">
<p>Now we have our estimates we can decide how important each
requirement is to the success of the project. This should be decided by
the project stakeholders; those - or their representatives - who have a
stake in the success of the project and are either directly affected or
affected by the project, e.g. Principle Investigators, researchers,
Research Software Engineers, collaborators, etc.</p>
<p>To prioritise these requirements we can use a method called
<strong>MoSCoW</strong>, a way to reach a common understanding with
stakeholders on the importance of successfully delivering each
requirement for a timebox. MoSCoW is an acronym that stands for
<strong>Must have</strong>, <strong>Should have</strong>, <strong>Could
have</strong>, and <strong>Won’t have</strong>. Each requirement is
discussed by the stakeholder group and falls into one of these
categories:</p>
<ul>
<li>
<em>Must Have</em> (MH) - these requirements are critical to the
current timebox for it to succeed. Even the inability to deliver just
one of these would cause the project to be considered a failure.</li>
<li>
<em>Should Have</em> (SH) - these are important requirements but not
<em>necessary</em> for delivery in the timebox. They may be as
<em>important</em> as Must Haves, but there may be other ways to achieve
them or perhaps they can be held back for a future development
timebox.</li>
<li>
<em>Could Have</em> (CH) - these are desirable but not necessary,
and each of these will be included in this timebox if it can be
achieved.</li>
<li>
<em>Won’t Have</em> (WH) - these are agreed to be out of scope for
this timebox, perhaps because they are the least important or not
critical for this phase of development.</li>
</ul>
<p>In typical use, the ratio to aim for of requirements to the MH/SH/CH
categories is 60%/20%/20% for a particular timebox. Importantly, the
division is by the requirement <em>estimates</em>, not by number of
requirements, so 60% means 60% of the overall estimated effort for
requirements are Must Haves.</p>
<p>Why is this important? Because it gives you a unique degree of
control of your project for each time period. It awards you 40% of
flexibility with allocating your effort depending on what’s critical and
how things progress. This effectively forces a tradeoff between the
effort available and critical objectives, maintaining a significant
safety margin. The idea is that as a project progresses, even if it
becomes clear that you are only able to deliver the Must Haves for a
particular time period, you have still delivered it
<em>successfully</em>.</p>
<div class="section level3">
<h3 id="githubs-milestones">GitHub’s Milestones<a class="anchor" aria-label="anchor" href="#githubs-milestones"></a>
</h3>
<p>Once we have decided on those we will work on (i.e. not Won’t Haves),
we can (optionally) use a GitHub’s <strong>Milestone</strong> to
organise them for a particular timebox. Remember, a milestone is a
collection of issues to be worked on in a given period (or timebox). We
can create a new one by selecting <code>Issues</code> on our repository,
then <code>Milestones</code> to display any existing milestones, then
clicking the “New milestone” button to the right.</p>
<figure><img src="../fig/github-milestones.png" class="image-with-shadow figure mx-auto d-block" alt="Milestones in GitHub" width="1000"></figure><figure><img src="../fig/github-create-milestone.png" class="image-with-shadow figure mx-auto d-block" alt="Create a milestone in GitHub" width="1000"></figure><p>We add in a title, a completion date (i.e. the end of this timebox),
and any description for the milestone.</p>
<figure><img src="../fig/github-new-milestone-description.png" class="image-with-shadow figure mx-auto d-block" alt="Create a milestone in GitHub" width="800"></figure><p>Once created, we can view our issues and assign them to our milestone
from the <code>Issues</code> page or from an individual issue page.</p>
<figure><img src="../fig/github-assign-milestone.png" class="image-with-shadow figure mx-auto d-block" alt="Milestones in GitHub" width="1000"></figure><p>Let us now use Milestones to plan and prioritise our team’s next
sprint.</p>
<div id="exercise-prioritise" class="callout discussion">
<div class="callout-square">
<i class="callout-icon" data-feather="message-circle"></i>
</div>
<div id="exercise-prioritise" class="callout-inner">
<h3 class="callout-title">Exercise: Prioritise!</h3>
<div class="callout-content">
<p>Put your stakeholder hats on, and as a team apply MoSCoW to the
repository issues to determine how you will prioritise effort to resolve
them in the allotted time. Try to stick to the 60/20/20 rule, and assign
all issues you will be working on (i.e. not <code>Won't Haves</code>) to
a new milestone, e.g. “Tidy up documentation” or “version 0.1”.</p>
</div>
</div>
</div>
<!--
:::::::::::::::::::::::::::::::::::::::::  callout

## Milestones in Project Boards

Milestones are also visible on project boards.
If an issue or pull request belongs to a milestone,
the name of the milestone will be displayed on the project card.
You can add or remove an issue or pull request from milestones using the details sidebar,
and filter your project cards by milestones using the search bar.

![](fig/github-milestone-in-project-board.png){alt='Milestones in Project Boards' .image-with-shadow width="900px"}
::::::::::::::::::::::::::::::::::::::::::::::::::
-->
</div>
</section><section><h2 class="section-heading" id="using-sprints-to-organise-and-work-on-issues">Using Sprints to Organise and Work on Issues<a class="anchor" aria-label="anchor" href="#using-sprints-to-organise-and-work-on-issues"></a>
</h2>
<hr class="half-width">
<p>A sprint is an activity applied to a timebox, where development is
undertaken on the agreed prioritised work for the period. In a typical
sprint, there are daily meetings called <strong>scrum meetings</strong>
which check on how work is progressing, and serves to highlight any
blockers and challenges to meeting the sprint goal.</p>
<div id="exercise-conduct-a-mini-mini-sprint" class="callout discussion">
<div class="callout-square">
<i class="callout-icon" data-feather="message-circle"></i>
</div>
<div id="exercise-conduct-a-mini-mini-sprint" class="callout-inner">
<h3 class="callout-title">Exercise: Conduct a Mini Mini-Sprint</h3>
<div class="callout-content">
<p>For the remaining time in this course, assign repository issues to
team members and work on resolving them as per your MoSCoW breakdown.
Once an issue has been resolved, notable progress made, or an impasse
has been reached, provide concise feedback on the repository issue. Be
sure to add the other team members to the chosen repository so they have
access to it. You can grant <code>Write</code> access to others on a
GitHub repository via the <code>Settings</code> tab for a repository,
then selecting <code>Collaborators</code>, where you can invite other
GitHub users to your repository with specific permissions.</p>
<p>Time: however long is left</p>
</div>
</div>
</div>
<p>Depending on how many issues were registered on your repository, it
is likely you will not have resolved all the issues in this first
milestone. Of course, in reality, a sprint would be over a much longer
period of time. In any event, as the development progresses into future
sprints any unresolved issues can be reconsidered and prioritised for
another milestone, which are then taken forward, and so on. This process
of receiving new requirements, prioritisation, and working on them is
naturally continuous - with the benefit that at key stages you are
repeatedly <strong>re-evaluating what is important and needs to be
worked on</strong> which helps to ensure real concrete progress against
project goals and requirements which may change over time.</p>
<div id="project-boards-for-planning-sprints" class="callout">
<div class="callout-square">
<i class="callout-icon" data-feather="bell"></i>
</div>
<div id="project-boards-for-planning-sprints" class="callout-inner">
<h3 class="callout-title">Project Boards For Planning Sprints</h3>
<div class="callout-content">
<p>Remember, you can use project boards for higher-level project
management - e.g. planning several sprints in advance (and use
milestones for tracking progress on individual sprints).</p>
</div>
</div>
</div>
<div id="keypoints1" class="callout keypoints">
<div class="callout-square">
<i class="callout-icon" data-feather="key"></i>
</div>
<div class="callout-inner">
<h3 class="callout-title">Key Points</h3>
<div class="callout-content">
<ul>
<li>Prioritisation is a key tool in academia where research goals can
change and software development is often given short shrift.</li>
<li>In order to prioritise things to do we must first estimate the
effort required to do them.</li>
<li>For accurate effort estimation, it should be done by the people who
will <em>actually do the work</em>.</li>
<li>Aim to reduce cognitive biases in effort estimation by being honest
about your abilities.</li>
<li>Ask other team members - or do estimation as a team - to help make
accurate estimates.</li>
<li>MoSCoW is a useful technique for prioritising work to help ensure
projects deliver successfully.</li>
<li>Aim for a 60%/20%/20% ratio of Must Haves/Should Haves/Could Haves
for requirements within a timebox.</li>
</ul>
</div>
</div>
</div>
</section></section><section id="aio-60-wrap-up"><p>Content from <a href="60-wrap-up.html">Wrap-up</a></p>
<hr>
<p>Last updated on 2024-12-06 |

        <a href="https://github.com/carpentries-incubator/python-intermediate-development/edit/main/episodes/60-wrap-up.md" class="external-link">Edit this page <i aria-hidden="true" data-feather="edit"></i></a></p>
<p>Estimated time: <i aria-hidden="true" data-feather="clock"></i> 15 minutes</p>
<div class="text-end">
          <button role="button" aria-pressed="false" tabindex="0" id="expand-code" class="pull-right" data-expand="Expand All Solutions " data-collapse="Collapse All Solutions "> Expand All Solutions <i aria-hidden="true" data-feather="plus"></i></button>
        </div>
<div class="overview card">
<h2 class="card-header">Overview</h2>
<div class="row g-0">
<div class="col-md-4">
<div class="card-body">
<div class="inner">
<h3 class="card-title">Questions</h3>
<ul>
<li>Looking back at what was covered and how different pieces fit
together</li>
<li>Where are some advanced topics and further reading available?</li>
</ul>
</div>
</div>
</div>
<div class="col-md-8">
<div class="card-body">
<div class="inner bordered">
<h3 class="card-title">Objectives</h3>
<ul>
<li>Put the course in context with future learning.</li>
</ul>
</div>
</div>
</div>
</div>
</div>
<section><h2 class="section-heading" id="summary">Summary<a class="anchor" aria-label="anchor" href="#summary"></a>
</h2>
<hr class="half-width">
<p>As part of this course we have looked at a core set of established,
intermediate-level software development tools and best practices for
working as part of a team. The course teaches a selected subset of
skills that have been tried and tested in collaborative research
software development environments, although not an all-encompassing set
of every skill you might need (check some <a href=".#further-resources">further reading</a>). It will provide you
with a solid basis for writing industry-grade code, which relies on the
same best practices taught in this course:</p>
<ul>
<li>Collaborative techniques and tools play an important part of
research software development in teams, but also have benefits in solo
development. We have looked at the benefits of a well-considered
development environment, using practices, tools and infrastructure to
help us write code more effectively in collaboration with others.</li>
<li>We have looked at the importance of being able to verify the
correctness of software and automation, and how we can leverage
techniques and infrastructure to automate and scale tasks such as
testing to save us time - but automation has a role beyond simply
testing: what else can you automate that would save you even more time?
Once found, we have also examined how to locate faults in our
software.</li>
<li>We have gone beyond procedural programming and explored different
software design paradigms, such as object-oriented and functional styles
of programming. We have contrasted their pros, cons, and the situations
in which they work best, and how separation of concerns through
modularity and architectural design can help shape good software.</li>
<li>As an intermediate developer, aspects other than technical skills
become important, particularly in development teams. We have looked at
the importance of good, consistent practices for team working, and the
importance of having a self-critical mindset when developing software,
and ways to manage feedback effectively and efficiently.</li>
</ul>
<div id="reflection-exercise-putting-the-pieces-together" class="callout challenge">
<div class="callout-square">
<i class="callout-icon" data-feather="zap"></i>
</div>
<div id="reflection-exercise-putting-the-pieces-together" class="callout-inner">
<h3 class="callout-title">Reflection Exercise: Putting the Pieces Together</h3>
<div class="callout-content">
<p>As a group, reflect on the concepts (e.g. tools, techniques and
practices) covered throughout the course, how they relate to one
another, how they fit together in a bigger picture or skill learning
pathways and in which order you need to learn them.</p>
</div>
</div>
</div>
<div id="accordionSolution1" class="accordion challenge-accordion accordion-flush">
<div class="accordion-item">
<button class="accordion-button solution-button collapsed" type="button" data-bs-toggle="collapse" data-bs-target="#collapseSolution1" aria-expanded="false" aria-controls="collapseSolution1">
  <h4 class="accordion-header" id="headingSolution1"> Show me the solution </h4>
</button>
<div id="collapseSolution1" class="accordion-collapse collapse" aria-labelledby="headingSolution1" data-bs-parent="#accordionSolution1">
<div class="accordion-body">
<p>One way to think about these concepts is to make a list and try to
organise them along two axes - ‘perceived usefulness of a concept’
versus ‘perceived difficulty or time needed to master a concept’, as
shown in the table below (for the exercise, you can make your own copy
of the <a href="https://docs.google.com/document/d/1NdE6PjqxjSsf1K4ofkCoWc2GA3sY2RIsjRg8BghTXas/edit?usp=sharing" class="external-link">template
table</a> for the purpose of this exercise). You then may think in which
order you want to learn the skills and how much effort they require -
e.g. start with those that are more useful but, for the time being, hold
off those that are not too useful to you and take loads of time to
master. You will likely want to focus on the concepts in the top right
corner of the table first, but investing time to master more difficult
concepts may pay off in the long run by saving you time and effort and
helping reduce technical debt.</p>
<figure><img src="../fig/wrapup-perceived-usefulness-time.png" class="image-with-shadow figure mx-auto d-block" alt="Usefulness versus time to master grid" width="800"></figure><p>Another way you can organise the concepts is using a <a href="https://en.wikipedia.org/wiki/Concept_map" class="external-link">concept map</a> (a
directed graph depicting suggested relationships between concepts) or
any other diagram/visual aid of your choice. Below are some example
views of tools and techniques covered in the course using concept maps.
Your views may differ but that is not to say that either view is right
or wrong. This exercise is meant to get you to reflect on what was
covered in the course and hopefully to reinforce the ideas and concepts
you learned.</p>
<figure><img src="../fig/wrapup-concept-map.png" class="image-with-shadow figure mx-auto d-block" alt="Overview of tools and techniques covered in the course" width="800"></figure><p>A different concept map tries to organise concepts/skills based on
their level of difficulty (novice, intermediate and advanced, and
in-between!) and tries to show which skills are prerequisite for others
and in which order you should consider learning skills.</p>
<figure><img src="../fig/wrapup-concept-map-difficulty-level.png" class="image-with-shadow figure mx-auto d-block" alt="Overview of topics covered in the course based on level of difficulty" width="800"></figure>
</div>
</div>
</div>
</div>
</section><section><h2 class="section-heading" id="further-resources">Further Resources<a class="anchor" aria-label="anchor" href="#further-resources"></a>
</h2>
<hr class="half-width">
<p>Below are some additional resources to help you continue
learning:</p>
<ul>
<li><a href="persistence.html">Additional episode on persisting
data</a></li>
<li><a href="databases.html">Additional episode on databases</a></li>
<li><a href="software-architecture-extra.html">Additional episode on
software architecture</a></li>
<li><a href="programming-paradigms.html">Additional episode on
programming paradigms</a></li>
<li>
<a href="https://coderefinery.org/lessons/" class="external-link">CodeRefinery lessons</a>
on writing software for open and reproducible research</li>
<li><a href="https://docs.python.org/3/" class="external-link">Python documentation</a></li>
<li><a href="https://docs.github.com/en/actions" class="external-link">GitHub Actions
documentation</a></li>
</ul>
<div id="keypoints1" class="callout keypoints">
<div class="callout-square">
<i class="callout-icon" data-feather="key"></i>
</div>
<div class="callout-inner">
<h3 class="callout-title">Key Points</h3>
<div class="callout-content">
<ul>
<li>Collaborative techniques and tools play an important part of
research software development in teams.</li>
</ul>
</div>
</div>
</div>
</section></section>
</div>
    </main>
</div>
<!-- END  : inst/pkgdown/templates/content-extra.html -->

      </div>
<!--/div.row-->
      		<footer class="row footer mx-md-3"><hr>
<div class="col-md-6">
        <p>This lesson is subject to the <a href="CODE_OF_CONDUCT.html">Code of Conduct</a></p>
        <p>

        <a href="https://github.com/carpentries-incubator/python-intermediate-development/edit/main/README.md" class="external-link">Edit on GitHub</a>

	
        | <a href="https://github.com/carpentries-incubator/python-intermediate-development/blob/main/CONTRIBUTING.md" class="external-link">Contributing</a>
        | <a href="https://github.com/carpentries-incubator/python-intermediate-development/" class="external-link">Source</a></p>
				<p><a href="https://github.com/carpentries-incubator/python-intermediate-development/blob/main/CITATION" class="external-link">Cite</a> | <a href="mailto:info@software.ac.uk">Contact</a> | <a href="https://carpentries.org/about/" class="external-link">About</a></p>
			</div>
			<div class="col-md-6">

        <p>Materials licensed under <a href="LICENSE.html">CC-BY 4.0</a> by the authors</p>

        <p>Template licensed under <a href="https://creativecommons.org/licenses/by-sa/4.0/" class="external-link">CC-BY 4.0</a> by <a href="https://carpentries.org/" class="external-link">The Carpentries</a></p>
        <p>Built with <a href="https://github.com/carpentries/sandpaper/tree/0.16.12" class="external-link">sandpaper (0.16.12)</a>, <a href="https://github.com/carpentries/pegboard/tree/0.7.9" class="external-link">pegboard (0.7.9)</a>, and <a href="https://github.com/carpentries/varnish/tree/1.0.6" class="external-link">varnish (1.0.6)</a></p>
			</div>
		</footer>
</div> <!-- / div.container -->
	<div id="to-top">
		<a href="#top">
      <i class="search-icon" data-feather="arrow-up" role="img" aria-label="Back To Top"></i><br><!-- <span class="d-none d-sm-none d-md-none d-lg-none d-xl-block">Back</span> To Top --><span class="d-none d-sm-none d-md-none d-lg-none d-xl-block">Back</span> To Top
		</a>
	</div>
  <script type="application/ld+json">
    {
  "@context": "https://schema.org",
  "@type": "LearningResource",
  "@id": "https://carpentries-incubator.github.io/python-intermediate-development/instructor/aio.html",
  "inLanguage": "en",
  "dct:conformsTo": "https://bioschemas.org/profiles/LearningResource/1.0-RELEASE",
  "description": "A Carpentries Lesson teaching foundational data and coding skills to researchers worldwide",
  "keywords": "software, data, lesson, The Carpentries",
  "name": "All in One View",
  "creativeWorkStatus": "active",
  "url": "https://carpentries-incubator.github.io/python-intermediate-development/instructor/aio.html",
  "identifier": "https://carpentries-incubator.github.io/python-intermediate-development/instructor/aio.html",
  "dateCreated": "2020-04-23",
  "dateModified": "2025-06-19",
  "datePublished": "2025-06-19"
}

  </script><script>
		feather.replace();
	</script>
</body>
</html><!-- END:   inst/pkgdown/templates/layout.html-->

