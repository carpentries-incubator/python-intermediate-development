<!DOCTYPE html>
<!-- START: inst/pkgdown/templates/layout.html --><!-- Generated by pkgdown: do not edit by hand --><html lang="en" data-bs-theme="auto"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta charset="utf-8"><title>Intermediate Research Software Development: Extra Content: Databases</title><meta name="viewport" content="width=device-width, initial-scale=1"><script src="../assets/themetoggle.js"></script><link rel="stylesheet" type="text/css" href="../assets/styles.css"><script src="../assets/scripts.js" type="text/javascript"></script><!-- mathjax --><script type="text/x-mathjax-config">
    MathJax.Hub.Config({
      config: ["MMLorHTML.js"],
      jax: ["input/TeX","input/MathML","output/HTML-CSS","output/NativeMML", "output/PreviewHTML"],
      extensions: ["tex2jax.js","mml2jax.js","MathMenu.js","MathZoom.js", "fast-preview.js", "AssistiveMML.js", "a11y/accessibility-menu.js"],
      TeX: {
        extensions: ["AMSmath.js","AMSsymbols.js","noErrors.js","noUndefined.js"]
      },
      tex2jax: {
        inlineMath: [['\\(', '\\)']],
        displayMath: [ ['$$','$$'], ['\\[', '\\]'] ],
        processEscapes: true
      }
    });
    </script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><!-- Responsive Favicon for The Carpentries --><link rel="apple-touch-icon" sizes="180x180" href="../favicons/incubator/apple-touch-icon.png"><link rel="icon" type="image/png" sizes="32x32" href="../favicons/incubator/favicon-32x32.png"><link rel="icon" type="image/png" sizes="16x16" href="../favicons/incubator/favicon-16x16.png"><link rel="manifest" href="../favicons/incubator/site.webmanifest"><link rel="mask-icon" href="../favicons/incubator/safari-pinned-tab.svg" color="#5bbad5"><meta name="msapplication-TileColor" content="#da532c"><meta name="theme-color" media="(prefers-color-scheme: light)" content="white"><meta name="theme-color" media="(prefers-color-scheme: dark)" content="black"></head><body>
    <header id="top" class="navbar navbar-expand-md top-nav incubator"><svg xmlns="http://www.w3.org/2000/svg" class="d-none"><symbol id="check2" viewbox="0 0 16 16"><path d="M13.854 3.646a.5.5 0 0 1 0 .708l-7 7a.5.5 0 0 1-.708 0l-3.5-3.5a.5.5 0 1 1 .708-.708L6.5 10.293l6.646-6.647a.5.5 0 0 1 .708 0z"></path></symbol><symbol id="circle-half" viewbox="0 0 16 16"><path d="M8 15A7 7 0 1 0 8 1v14zm0 1A8 8 0 1 1 8 0a8 8 0 0 1 0 16z"></path></symbol><symbol id="moon-stars-fill" viewbox="0 0 16 16"><path d="M6 .278a.768.768 0 0 1 .08.858 7.208 7.208 0 0 0-.878 3.46c0 4.021 3.278 7.277 7.318 7.277.527 0 1.04-.055 1.533-.16a.787.787 0 0 1 .81.316.733.733 0 0 1-.031.893A8.349 8.349 0 0 1 8.344 16C3.734 16 0 12.286 0 7.71 0 4.266 2.114 1.312 5.124.06A.752.752 0 0 1 6 .278z"></path><path d="M10.794 3.148a.217.217 0 0 1 .412 0l.387 1.162c.173.518.579.924 1.097 1.097l1.162.387a.217.217 0 0 1 0 .412l-1.162.387a1.734 1.734 0 0 0-1.097 1.097l-.387 1.162a.217.217 0 0 1-.412 0l-.387-1.162A1.734 1.734 0 0 0 9.31 6.593l-1.162-.387a.217.217 0 0 1 0-.412l1.162-.387a1.734 1.734 0 0 0 1.097-1.097l.387-1.162zM13.863.099a.145.145 0 0 1 .274 0l.258.774c.115.346.386.617.732.732l.774.258a.145.145 0 0 1 0 .274l-.774.258a1.156 1.156 0 0 0-.732.732l-.258.774a.145.145 0 0 1-.274 0l-.258-.774a1.156 1.156 0 0 0-.732-.732l-.774-.258a.145.145 0 0 1 0-.274l.774-.258c.346-.115.617-.386.732-.732L13.863.1z"></path></symbol><symbol id="sun-fill" viewbox="0 0 16 16"><path d="M8 12a4 4 0 1 0 0-8 4 4 0 0 0 0 8zM8 0a.5.5 0 0 1 .5.5v2a.5.5 0 0 1-1 0v-2A.5.5 0 0 1 8 0zm0 13a.5.5 0 0 1 .5.5v2a.5.5 0 0 1-1 0v-2A.5.5 0 0 1 8 13zm8-5a.5.5 0 0 1-.5.5h-2a.5.5 0 0 1 0-1h2a.5.5 0 0 1 .5.5zM3 8a.5.5 0 0 1-.5.5h-2a.5.5 0 0 1 0-1h2A.5.5 0 0 1 3 8zm10.657-5.657a.5.5 0 0 1 0 .707l-1.414 1.415a.5.5 0 1 1-.707-.708l1.414-1.414a.5.5 0 0 1 .707 0zm-9.193 9.193a.5.5 0 0 1 0 .707L3.05 13.657a.5.5 0 0 1-.707-.707l1.414-1.414a.5.5 0 0 1 .707 0zm9.193 2.121a.5.5 0 0 1-.707 0l-1.414-1.414a.5.5 0 0 1 .707-.707l1.414 1.414a.5.5 0 0 1 0 .707zM4.464 4.465a.5.5 0 0 1-.707 0L2.343 3.05a.5.5 0 1 1 .707-.707l1.414 1.414a.5.5 0 0 1 0 .708z"></path></symbol></svg><a class="visually-hidden-focusable skip-link" href="#main-content">Skip to main content</a>
  <div class="container-fluid top-nav-container">
    <div class="col-md-8">
      <div class="large-logo">
        <img id="incubator-logo" alt="Lesson Description" src="../assets/images/incubator-logo.svg"><span class="badge text-bg-info">
          <abbr title="This lesson is in the beta phase, which means that it is ready for teaching by instructors outside of the original author team.">
            <a href="https://cdh.carpentries.org/the-lesson-life-cycle.html#polishing-beta-stage" class="external-link alert-link">
              <i aria-hidden="true" class="icon" data-feather="alert-circle" style="border-radius: 5px"></i>
              Beta
            </a>
            <span class="visually-hidden">This lesson is in the beta phase, which means that it is ready for teaching by instructors outside of the original author team.</span>
          </abbr>
        </span>

      </div>
    </div>
    <div class="selector-container">
      <div id="theme-selector">
        <li class="nav-item dropdown" id="theme-button-list">
          <button class="btn btn-link nav-link px-0 px-lg-2 dropdown-toggle d-flex align-items-center" id="bd-theme" type="button" aria-expanded="false" data-bs-toggle="dropdown" data-bs-display="static" aria-label="Toggle theme (auto)">
            <svg class="bi my-1 theme-icon-active"><use href="#circle-half"></use></svg><i data-feather="chevron-down"></i>
          </button>
          <ul class="dropdown-menu dropdown-menu-end" aria-labelledby="bd-theme-text"><li>
              <button type="button" class="btn dropdown-item d-flex align-items-center" data-bs-theme-value="light" aria-pressed="false">
                <svg class="bi me-2 theme-icon"><use href="#sun-fill"></use></svg>
                Light
                <svg class="bi ms-auto d-none"><use href="#check2"></use></svg></button>
            </li>
            <li>
              <button type="button" class="btn dropdown-item d-flex align-items-center" data-bs-theme-value="dark" aria-pressed="false">
                <svg class="bi me-2 theme-icon"><use href="#moon-stars-fill"></use></svg>
                Dark
                <svg class="bi ms-auto d-none"><use href="#check2"></use></svg></button>
            </li>
            <li>
              <button type="button" class="btn dropdown-item d-flex align-items-center active" data-bs-theme-value="auto" aria-pressed="true">
                <svg class="bi me-2 theme-icon"><use href="#circle-half"></use></svg>
                Auto
                <svg class="bi ms-auto d-none"><use href="#check2"></use></svg></button>
            </li>
          </ul></li>
      </div>

      <div class="dropdown" id="instructor-dropdown">
        <button class="btn btn-secondary dropdown-toggle bordered-button" type="button" id="dropdownMenu1" data-bs-toggle="dropdown" aria-expanded="false">
          <i aria-hidden="true" class="icon" data-feather="eye"></i> Instructor View <i data-feather="chevron-down"></i>
        </button>
        <ul class="dropdown-menu" aria-labelledby="dropdownMenu1"><li><button class="dropdown-item" type="button" onclick="window.location.href='../databases.html';">Learner View</button></li>
        </ul></div>
    </div>
  </div>
  <hr></header><nav class="navbar navbar-expand-xl bottom-nav incubator" aria-label="Main Navigation"><div class="container-fluid nav-container">
    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbarSupportedContent" aria-controls="navbarSupportedContent" aria-expanded="false" aria-label="Toggle Navigation">
      <span class="navbar-toggler-icon"></span>
      <span class="menu-title">Menu</span>
    </button>
    <div class="nav-logo">
      <img class="small-logo" alt="Lesson Description" src="../assets/images/incubator-logo-sm.svg"></div>
    <div class="lesson-title-md">
      Intermediate Research Software Development
    </div>
    <div class="search-icon-sm">
      <!-- TODO: do not show until we have search
        <i role="img" aria-label="Search the All In One page" data-feather="search"></i>
      -->
    </div>
    <div class="desktop-nav">
      <ul class="navbar-nav me-auto mb-2 mb-lg-0"><li class="nav-item">
          <span class="lesson-title">
            Intermediate Research Software Development
          </span>
        </li>
        <li class="nav-item">
          <a class="nav-link" href="../instructor/key-points.html">Key Points</a>
        </li>
        <li class="nav-item">
          <a class="nav-link" href="../instructor/instructor-notes.html">Instructor Notes</a>
        </li>
        <li class="nav-item">
          <a class="nav-link" href="../instructor/images.html">Extract All Images</a>
        </li>
        <li class="nav-item dropdown">
          <button class="nav-link dropdown-toggle" id="navbarDropdown" data-bs-toggle="dropdown" aria-expanded="false">
            More <i data-feather="chevron-down"></i>
          </button>
          <ul class="dropdown-menu" aria-labelledby="navbarDropdown"><hr><li><a class="dropdown-item" href="quiz.html">Quiz</a></li><li><a class="dropdown-item" href="installation-instructions.html">Installation Instructions</a></li><li><a class="dropdown-item" href="common-issues.html">Common Issues, Fixes &amp; Tips</a></li><li><a class="dropdown-item" href="software-architecture-extra.html">Extra Content: Software Architecture</a></li><li><a class="dropdown-item" href="programming-paradigms.html">Extra Content: Programming Paradigms</a></li><li><a class="dropdown-item" href="procedural-programming.html">Extra Content: Procedural Programming</a></li><li><a class="dropdown-item" href="functional-programming.html">Extra Content: Functional Programming</a></li><li><a class="dropdown-item" href="object-oriented-programming.html">Extra Content: Object Oriented Programming</a></li><li><a class="dropdown-item" href="persistence.html">Extra Content: Persistence</a></li><li><a class="dropdown-item" href="databases.html">Extra Content: Databases</a></li><li><a class="dropdown-item" href="vscode.html">Extra Content: Using Microsoft Visual Studio Code</a></li><li><a class="dropdown-item" href="reference.html">Reference</a></li>
          </ul></li>
      </ul></div>
    <!--
    <form class="d-flex col-md-2 search-form">
      <fieldset disabled>
      <input class="form-control me-2 searchbox" type="search" placeholder="" aria-label="">
        <button class="btn btn-outline-success tablet-search-button"  type="submit">
          <i class="search-icon" data-feather="search" role="img" aria-label="Search the All In One page"></i>
        </button>
      </fieldset>
    </form>
    -->
    <a id="search-button" class="btn btn-primary" href="../instructor/aio.html" role="button" aria-label="Search the All In One page">Search the All In One page</a>
  </div><!--/div.container-fluid -->
</nav><div class="col-md-12 mobile-title">
  Intermediate Research Software Development
</div>

<aside class="col-md-12 lesson-progress"><div style="width: NA%" class="percentage">
    NA%
  </div>
  <div class="progress incubator">
    <div class="progress-bar incubator" role="progressbar" style="width: NA%" aria-valuenow="NA" aria-label="Lesson Progress" aria-valuemin="0" aria-valuemax="100">
    </div>
  </div>
</aside><div class="container">
      <div class="row">
        <!-- START: inst/pkgdown/templates/navbar.html -->
<div id="sidebar-col" class="col-lg-4">
  <div id="sidebar" class="sidebar">
      <nav aria-labelledby="flush-headingEleven"><button role="button" aria-label="close menu" alt="close menu" aria-expanded="true" aria-controls="sidebar" class="collapse-toggle" data-collapse="Collapse " data-episodes="Episodes ">
          <i class="search-icon" data-feather="x" role="img"></i>
        </button>
        <div class="sidebar-inner">
          <div class="row mobile-row" id="theme-row-mobile">
            <div class="col" id="theme-selector">
              <li class="nav-item dropdown" id="theme-button-list">
                <button class="btn btn-link nav-link px-0 px-lg-2 dropdown-toggle d-flex align-items-center" id="bd-theme" type="button" aria-expanded="false" data-bs-toggle="dropdown" data-bs-display="static" aria-label="Toggle theme (auto)">
                  <svg class="bi my-1 theme-icon-active"><use href="#circle-half"></use></svg><span class="d-lg-none ms-1" id="bd-theme-text">Toggle Theme</span>
                </button>
                <ul class="dropdown-menu dropdown-menu-right" aria-labelledby="bd-theme-text"><li>
                    <button type="button" class="btn dropdown-item d-flex align-items-center" data-bs-theme-value="light" aria-pressed="false">
                      <svg class="bi me-2 theme-icon"><use href="#sun-fill"></use></svg>
                      Light
                      <svg class="bi ms-auto d-none"><use href="#check2"></use></svg></button>
                  </li>
                  <li>
                    <button type="button" class="btn dropdown-item d-flex align-items-center" data-bs-theme-value="dark" aria-pressed="false">
                      <svg class="bi me-2 theme-icon"><use href="#moon-stars-fill"></use></svg>
                      Dark
                      <svg class="bi ms-auto d-none"><use href="#check2"></use></svg></button>
                  </li>
                  <li>
                    <button type="button" class="btn dropdown-item d-flex align-items-center active" data-bs-theme-value="auto" aria-pressed="true">
                      <svg class="bi me-2 theme-icon"><use href="#circle-half"></use></svg>
                      Auto
                      <svg class="bi ms-auto d-none"><use href="#check2"></use></svg></button>
                  </li>
                </ul></li>
            </div>
          </div>
          <div class="row mobile-row">
            <div class="col">
              <div class="sidenav-view-selector">
                <div class="accordion accordion-flush" id="accordionFlush9">
                  <div class="accordion-item">
                    <h2 class="accordion-header" id="flush-headingNine">
                      <button class="accordion-button collapsed" id="instructor" type="button" data-bs-toggle="collapse" data-bs-target="#flush-collapseNine" aria-expanded="false" aria-controls="flush-collapseNine">
                        <i id="eye" aria-hidden="true" class="icon" data-feather="eye"></i> Instructor View
                      </button>
                    </h2>
                    <div id="flush-collapseNine" class="accordion-collapse collapse" aria-labelledby="flush-headingNine" data-bs-parent="#accordionFlush2">
                      <div class="accordion-body">
                        <a href="../databases.html">Learner View</a>
                      </div>
                    </div>
                  </div><!--/div.accordion-item-->
                </div><!--/div.accordion-flush-->
              </div><!--div.sidenav-view-selector -->
            </div><!--/div.col -->

            <hr></div><!--/div.mobile-row -->

          <div class="accordion accordion-flush" id="accordionFlush11">
            <div class="accordion-item">

              <button id="chapters" class="accordion-button show" type="button" data-bs-toggle="collapse" data-bs-target="#flush-collapseEleven" aria-expanded="false" aria-controls="flush-collapseEleven">
                <h2 class="accordion-header chapters" id="flush-headingEleven">
                  EPISODES
                </h2>
              </button>
              <div id="flush-collapseEleven" class="accordion-collapse show collapse" aria-labelledby="flush-headingEleven" data-bs-parent="#accordionFlush11">

                <div class="accordion-body">
                  <div class="accordion accordion-flush" id="accordionFlush1">
  <div class="accordion-item">
    <div class="accordion-header" id="flush-heading1">
        <a href="index.html">Summary and Schedule</a>
    </div><!--/div.accordion-header-->

  </div><!--/div.accordion-item-->
</div><!--/div.accordion-flush-->

<div class="accordion accordion-flush" id="accordionFlush2">
  <div class="accordion-item">
    <div class="accordion-header" id="flush-heading2">
        <a href="00-setting-the-scene.html">Setting the Scene</a>
    </div><!--/div.accordion-header-->

  </div><!--/div.accordion-item-->
</div><!--/div.accordion-flush-->

<div class="accordion accordion-flush" id="accordionFlush3">
  <div class="accordion-item">
    <div class="accordion-header" id="flush-heading3">
        <a href="10-section1-intro.html">Section 1: Setting Up Environment For Collaborative Code Development</a>
    </div><!--/div.accordion-header-->

  </div><!--/div.accordion-item-->
</div><!--/div.accordion-flush-->

<div class="accordion accordion-flush" id="accordionFlush4">
  <div class="accordion-item">
    <div class="accordion-header" id="flush-heading4">
        <a href="11-software-project.html">1.1 Introduction to Our Software Project</a>
    </div><!--/div.accordion-header-->

  </div><!--/div.accordion-item-->
</div><!--/div.accordion-flush-->

<div class="accordion accordion-flush" id="accordionFlush5">
  <div class="accordion-item">
    <div class="accordion-header" id="flush-heading5">
        <a href="12-virtual-environments.html">1.2 Virtual Environments For Software Development</a>
    </div><!--/div.accordion-header-->

  </div><!--/div.accordion-item-->
</div><!--/div.accordion-flush-->

<div class="accordion accordion-flush" id="accordionFlush6">
  <div class="accordion-item">
    <div class="accordion-header" id="flush-heading6">
        <a href="13-ides.html">1.3 Integrated Software Development Environments</a>
    </div><!--/div.accordion-header-->

  </div><!--/div.accordion-item-->
</div><!--/div.accordion-flush-->

<div class="accordion accordion-flush" id="accordionFlush7">
  <div class="accordion-item">
    <div class="accordion-header" id="flush-heading7">
        <a href="14-collaboration-using-git.html">1.4 Software Development Using Git and GitHub</a>
    </div><!--/div.accordion-header-->

  </div><!--/div.accordion-item-->
</div><!--/div.accordion-flush-->

<div class="accordion accordion-flush" id="accordionFlush8">
  <div class="accordion-item">
    <div class="accordion-header" id="flush-heading8">
        <a href="15-coding-conventions.html">1.5 Python Code Style Conventions</a>
    </div><!--/div.accordion-header-->

  </div><!--/div.accordion-item-->
</div><!--/div.accordion-flush-->

<div class="accordion accordion-flush" id="accordionFlush9">
  <div class="accordion-item">
    <div class="accordion-header" id="flush-heading9">
        <a href="16-verifying-code-style-linters.html">1.6 Verifying Code Style Using Linters</a>
    </div><!--/div.accordion-header-->

  </div><!--/div.accordion-item-->
</div><!--/div.accordion-flush-->

<div class="accordion accordion-flush" id="accordionFlush10">
  <div class="accordion-item">
    <div class="accordion-header" id="flush-heading10">
        <a href="17-section1-optional-exercises.html">1.7 Optional Exercises</a>
    </div><!--/div.accordion-header-->

  </div><!--/div.accordion-item-->
</div><!--/div.accordion-flush-->

<div class="accordion accordion-flush" id="accordionFlush11">
  <div class="accordion-item">
    <div class="accordion-header" id="flush-heading11">
        <a href="20-section2-intro.html">Section 2: Ensuring Correctness of Software at Scale</a>
    </div><!--/div.accordion-header-->

  </div><!--/div.accordion-item-->
</div><!--/div.accordion-flush-->

<div class="accordion accordion-flush" id="accordionFlush12">
  <div class="accordion-item">
    <div class="accordion-header" id="flush-heading12">
        <a href="21-automatically-testing-software.html">2.1 Automatically Testing Software</a>
    </div><!--/div.accordion-header-->

  </div><!--/div.accordion-item-->
</div><!--/div.accordion-flush-->

<div class="accordion accordion-flush" id="accordionFlush13">
  <div class="accordion-item">
    <div class="accordion-header" id="flush-heading13">
        <a href="22-scaling-up-unit-testing.html">2.2 Scaling Up Unit Testing</a>
    </div><!--/div.accordion-header-->

  </div><!--/div.accordion-item-->
</div><!--/div.accordion-flush-->

<div class="accordion accordion-flush" id="accordionFlush14">
  <div class="accordion-item">
    <div class="accordion-header" id="flush-heading14">
        <a href="23-continuous-integration-automated-testing.html">2.3 Continuous Integration for Automated Testing</a>
    </div><!--/div.accordion-header-->

  </div><!--/div.accordion-item-->
</div><!--/div.accordion-flush-->

<div class="accordion accordion-flush" id="accordionFlush15">
  <div class="accordion-item">
    <div class="accordion-header" id="flush-heading15">
        <a href="24-diagnosing-issues-improving-robustness.html">2.4 Diagnosing Issues and Improving Robustness</a>
    </div><!--/div.accordion-header-->

  </div><!--/div.accordion-item-->
</div><!--/div.accordion-flush-->

<div class="accordion accordion-flush" id="accordionFlush16">
  <div class="accordion-item">
    <div class="accordion-header" id="flush-heading16">
        <a href="25-section2-optional-exercises.html">2.5 Optional Exercises for Section 2</a>
    </div><!--/div.accordion-header-->

  </div><!--/div.accordion-item-->
</div><!--/div.accordion-flush-->

<div class="accordion accordion-flush" id="accordionFlush17">
  <div class="accordion-item">
    <div class="accordion-header" id="flush-heading17">
        <a href="30-section3-intro.html">Section 3: Software Development as a Process</a>
    </div><!--/div.accordion-header-->

  </div><!--/div.accordion-item-->
</div><!--/div.accordion-flush-->

<div class="accordion accordion-flush" id="accordionFlush18">
  <div class="accordion-item">
    <div class="accordion-header" id="flush-heading18">
        <a href="31-software-requirements.html">3.1 Software Requirements</a>
    </div><!--/div.accordion-header-->

  </div><!--/div.accordion-item-->
</div><!--/div.accordion-flush-->

<div class="accordion accordion-flush" id="accordionFlush19">
  <div class="accordion-item">
    <div class="accordion-header" id="flush-heading19">
        <a href="32-software-architecture-design.html">3.2 Software Architecture and Design</a>
    </div><!--/div.accordion-header-->

  </div><!--/div.accordion-item-->
</div><!--/div.accordion-flush-->

<div class="accordion accordion-flush" id="accordionFlush20">
  <div class="accordion-item">
    <div class="accordion-header" id="flush-heading20">
        <a href="33-code-decoupling-abstractions.html">3.3 Code Decoupling &amp; Abstractions</a>
    </div><!--/div.accordion-header-->

  </div><!--/div.accordion-item-->
</div><!--/div.accordion-flush-->

<div class="accordion accordion-flush" id="accordionFlush21">
  <div class="accordion-item">
    <div class="accordion-header" id="flush-heading21">
        <a href="34-code-refactoring.html">3.4 Code Refactoring</a>
    </div><!--/div.accordion-header-->

  </div><!--/div.accordion-item-->
</div><!--/div.accordion-flush-->

<div class="accordion accordion-flush" id="accordionFlush22">
  <div class="accordion-item">
    <div class="accordion-header" id="flush-heading22">
        <a href="35-software-architecture-revisited.html">3.5 Software Architecture Revisited</a>
    </div><!--/div.accordion-header-->

  </div><!--/div.accordion-item-->
</div><!--/div.accordion-flush-->

<div class="accordion accordion-flush" id="accordionFlush23">
  <div class="accordion-item">
    <div class="accordion-header" id="flush-heading23">
        <a href="40-section4-intro.html">Section 4: Collaborative Software Development for Reuse</a>
    </div><!--/div.accordion-header-->

  </div><!--/div.accordion-item-->
</div><!--/div.accordion-flush-->

<div class="accordion accordion-flush" id="accordionFlush24">
  <div class="accordion-item">
    <div class="accordion-header" id="flush-heading24">
        <a href="41-code-review.html">4.1 Developing Software In a Team: Code Review</a>
    </div><!--/div.accordion-header-->

  </div><!--/div.accordion-item-->
</div><!--/div.accordion-flush-->

<div class="accordion accordion-flush" id="accordionFlush25">
  <div class="accordion-item">
    <div class="accordion-header" id="flush-heading25">
        <a href="42-software-reuse.html">4.2 Preparing Software for Reuse and Release</a>
    </div><!--/div.accordion-header-->

  </div><!--/div.accordion-item-->
</div><!--/div.accordion-flush-->

<div class="accordion accordion-flush" id="accordionFlush26">
  <div class="accordion-item">
    <div class="accordion-header" id="flush-heading26">
        <a href="43-software-release.html">4.3 Packaging Code for Release and Distribution</a>
    </div><!--/div.accordion-header-->

  </div><!--/div.accordion-item-->
</div><!--/div.accordion-flush-->

<div class="accordion accordion-flush" id="accordionFlush27">
  <div class="accordion-item">
    <div class="accordion-header" id="flush-heading27">
        <a href="50-section5-intro.html">Section 5: Managing and Improving Software Over Its Lifetime</a>
    </div><!--/div.accordion-header-->

  </div><!--/div.accordion-item-->
</div><!--/div.accordion-flush-->

<div class="accordion accordion-flush" id="accordionFlush28">
  <div class="accordion-item">
    <div class="accordion-header" id="flush-heading28">
        <a href="51-managing-software.html">5.1 Managing a Collaborative Software Project</a>
    </div><!--/div.accordion-header-->

  </div><!--/div.accordion-item-->
</div><!--/div.accordion-flush-->

<div class="accordion accordion-flush" id="accordionFlush29">
  <div class="accordion-item">
    <div class="accordion-header" id="flush-heading29">
        <a href="52-assessing-software-suitability-improvement.html">5.2 Assessing Software for Suitability and Improvement</a>
    </div><!--/div.accordion-header-->

  </div><!--/div.accordion-item-->
</div><!--/div.accordion-flush-->

<div class="accordion accordion-flush" id="accordionFlush30">
  <div class="accordion-item">
    <div class="accordion-header" id="flush-heading30">
        <a href="53-improvement-through-feedback.html">5.3 Software Improvement Through Feedback</a>
    </div><!--/div.accordion-header-->

  </div><!--/div.accordion-item-->
</div><!--/div.accordion-flush-->

<div class="accordion accordion-flush" id="accordionFlush31">
  <div class="accordion-item">
    <div class="accordion-header" id="flush-heading31">
        <a href="60-wrap-up.html">Wrap-up</a>
    </div><!--/div.accordion-header-->

  </div><!--/div.accordion-item-->
</div><!--/div.accordion-flush-->

                </div>
              </div>
            </div>

            <hr class="half-width"><div class="accordion accordion-flush lesson-resources" id="accordionFlush12">
              <div class="accordion-item">
                <h2 class="accordion-header" id="flush-headingTwelve">
                  <button class="accordion-button collapsed" id="lesson-resources" type="button" data-bs-toggle="collapse" data-bs-target="#flush-collapseTwelve" aria-expanded="false" aria-controls="flush-collapseTwelve">
                    RESOURCES
                  </button>
                </h2>
                <div id="flush-collapseTwelve" class="accordion-collapse collapse" aria-labelledby="flush-headingTwelve" data-bs-parent="#accordionFlush12">
                  <div class="accordion-body">
                    <ul><li>
                        <a href="../instructor/key-points.html">Key Points</a>
                      </li>
                      <li>
                        <a href="../instructor/instructor-notes.html">Instructor Notes</a>
                      </li>
                      <li>
                        <a href="../instructor/images.html">Extract All Images</a>
                      </li>
                      <hr><li><a class="dropdown-item" href="quiz.html">Quiz</a></li><li><a class="dropdown-item" href="installation-instructions.html">Installation Instructions</a></li><li><a class="dropdown-item" href="common-issues.html">Common Issues, Fixes &amp; Tips</a></li><li><a class="dropdown-item" href="software-architecture-extra.html">Extra Content: Software Architecture</a></li><li><a class="dropdown-item" href="programming-paradigms.html">Extra Content: Programming Paradigms</a></li><li><a class="dropdown-item" href="procedural-programming.html">Extra Content: Procedural Programming</a></li><li><a class="dropdown-item" href="functional-programming.html">Extra Content: Functional Programming</a></li><li><a class="dropdown-item" href="object-oriented-programming.html">Extra Content: Object Oriented Programming</a></li><li><a class="dropdown-item" href="persistence.html">Extra Content: Persistence</a></li><li><a class="dropdown-item" href="databases.html">Extra Content: Databases</a></li><li><a class="dropdown-item" href="vscode.html">Extra Content: Using Microsoft Visual Studio Code</a></li><li><a class="dropdown-item" href="reference.html">Reference</a></li>
                    </ul></div>
                </div>
              </div>
            </div>
            <hr class="half-width lesson-resources"><a href="../instructor/aio.html">See all in one page</a>


            <hr class="d-none d-sm-block d-md-none"><div class="d-grid gap-1">

            </div>
          </div><!-- /div.accordion -->
        </div><!-- /div.sidebar-inner -->
      </nav></div><!-- /div.sidebar -->
  </div><!-- /div.sidebar-col -->
<!-- END:   inst/pkgdown/templates/navbar.html-->

        <!-- START: inst/pkgdown/templates/content-instructor.html -->
  <div class="col-xl-8 col-lg-12 primary-content">
    <nav class="lesson-content mx-md-4" aria-label="Previous and Next Chapter"><!-- content for small screens --><div class="d-block d-sm-block d-md-none">
        <a class="chapter-link" href="../instructor/index.html"><i aria-hidden="true" class="small-arrow" data-feather="arrow-left"></i>Previous</a>
        <a class="chapter-link float-end" href="../instructor/index.html">Next<i aria-hidden="true" class="small-arrow" data-feather="arrow-right"></i></a>
      </div>
      <!-- content for large screens -->
      <div class="d-none d-sm-none d-md-block">
        <a class="chapter-link" href="../instructor/index.html" rel="prev">
          <i aria-hidden="true" class="small-arrow" data-feather="arrow-left"></i>
          Home
        </a>
        <a class="chapter-link float-end" href="../instructor/index.html" rel="next">
          Home
          <i aria-hidden="true" class="small-arrow" data-feather="arrow-right"></i>
        </a>
      </div>
      <hr></nav><main id="main-content" class="main-content"><div class="container lesson-content">
        <h1>Extra Content: Databases</h1>
        <p>Last updated on 2024-12-06 |

        <a href="https://github.com/carpentries-incubator/python-intermediate-development/edit/main/learners/databases.md" class="external-link">Edit this page <i aria-hidden="true" data-feather="edit"></i></a></p>



        <p>Estimated time: <i aria-hidden="true" data-feather="clock"></i> 60 minutes</p>

        <div class="text-end">
          <button role="button" aria-pressed="false" tabindex="0" id="expand-code" class="pull-right" data-expand="Expand All Solutions " data-collapse="Collapse All Solutions "> Expand All Solutions <i aria-hidden="true" data-feather="plus"></i></button>
        </div>

        

<div class="overview card">
<h2 class="card-header">Overview</h2>
<div class="row g-0">
<div class="col-md-4">
<div class="card-body">
<div class="inner">
<h3 class="card-title">Questions</h3>
<ul><li>How can we persist complex structured data for efficient
access?</li>
</ul></div>
</div>
</div>
<div class="col-md-8">
<div class="card-body">
<div class="inner bordered">
<h3 class="card-title">Objectives</h3>
<ul><li>Describe the structure of a relational database</li>
<li>Store and retrieve structured data using an Object Relational
Mapping (ORM)</li>
</ul></div>
</div>
</div>
</div>
</div>
<div id="follow-up-from-section-3" class="callout">
<div class="callout-square">
<i class="callout-icon" data-feather="bell"></i>
</div>
<div id="follow-up-from-section-3" class="callout-inner">
<h3 class="callout-title">Follow up from Section 3</h3>
<div class="callout-content">
<p>This episode could be read as a follow up from the end of <a href="35-software-architecture-revisited.html">Section 3 on software
design and development</a>.</p>
</div>
</div>
</div>
<p>A <strong>database</strong> is an organised collection of data,
usually organised in some way to mimic the structure of the entities it
represents. There are several major families of database model, but the
dominant form is the <strong>relational database</strong>.</p>
<p>Relational databases focus on describing the relationships between
entities in the data, similar to the object oriented paradigm. The key
concepts in a relational database are:</p>
<p>Tables</p>
<ul><li>Within a database we can have multiple tables - each table usually
represents all entities of a single type.</li>
<li>E.g., we might have a <code>patients</code> table to represent all
of our patients.</li>
</ul><p>Columns / Fields</p>
<ul><li>Each table has columns - each column has a name and holds data of a
specific type</li>
<li>E.g., we might have a <code>name</code> column in our
<code>patients</code> table which holds text data representing the names
of our patients.</li>
</ul><p>Rows</p>
<ul><li>Each table has rows - each row represents a single entity and has a
value for each field.</li>
<li>E.g., each row in our <code>patients</code> table represents a
single patient - the value of the <code>name</code> field in this row is
our patient’s name.</li>
</ul><p>Primary Keys</p>
<ul><li>Each row has a primary key - this is a unique ID that can be used to
select this from from the data.</li>
<li>E.g., each patient might have a <code>patient_id</code> which can be
used to distinguish two patients with the same name.</li>
</ul><p>Foreign Keys</p>
<ul><li>A relationship between two entities is described using a foreign key
- this is a field which points to the primary key of another row /
table.</li>
<li>E.g., Each patient might have a foreign key field called
<code>doctor</code> pointing to a row in a <code>doctors</code> table
representing the doctor responsible for them - i.e. this doctor <em>has
a</em> patient.</li>
</ul><p>While relational databases are typically accessed using <strong>SQL
queries</strong>, we are going to use a library to help us translate
between Python and the database. <a href="https://www.sqlalchemy.org/" class="external-link">SQLAlchemy</a> is a popular Python
library which contains an <strong>Object Relational Mapping</strong>
(ORM) framework.</p>
<div id="sqlalchemy" class="callout">
<div class="callout-square">
<i class="callout-icon" data-feather="bell"></i>
</div>
<div id="sqlalchemy" class="callout-inner">
<h3 class="callout-title">SQLAlchemy</h3>
<div class="callout-content">
<p>For more information, see SQLAlchemy’s <a href="https://docs.sqlalchemy.org/en/13/orm/tutorial.html" class="external-link">ORM
tutorial</a>.</p>
</div>
</div>
</div>
<p>Our first step is to install SQLAlchemy, then we can create our first
<strong>mapping</strong>.</p>
<div class="codewrapper sourceCode" id="cb1">
<h3 class="code-label">BASH<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="sourceCode bash" tabindex="0"><code class="sourceCode bash"><span id="cb1-1"><a href="#cb1-1" tabindex="-1"></a><span class="ex">$</span> python3 <span class="at">-m</span> pip install sqlalchemy</span></code></pre>
</div>
<p>A mapping is the core component of an ORM - it describes how to
convert between our Python classes and the contents of our database
tables. Typically, we can take our existing classes and convert them
into mappings with a little modification, so we do not have to start
from scratch.</p>
<div class="codewrapper sourceCode" id="cb2">
<h3 class="code-label">PYTHON<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="sourceCode python" tabindex="0"><code class="sourceCode python"><span id="cb2-1"><a href="#cb2-1" tabindex="-1"></a><span class="co"># file: inflammation/models.py</span></span>
<span id="cb2-2"><a href="#cb2-2" tabindex="-1"></a><span class="im">from</span> sqlalchemy <span class="im">import</span> Column, create_engine, Integer, String</span>
<span id="cb2-3"><a href="#cb2-3" tabindex="-1"></a><span class="im">from</span> sqlalchemy.ext.declarative <span class="im">import</span> declarative_base</span>
<span id="cb2-4"><a href="#cb2-4" tabindex="-1"></a></span>
<span id="cb2-5"><a href="#cb2-5" tabindex="-1"></a>Base <span class="op">=</span> declarative_base()</span>
<span id="cb2-6"><a href="#cb2-6" tabindex="-1"></a></span>
<span id="cb2-7"><a href="#cb2-7" tabindex="-1"></a>...</span>
<span id="cb2-8"><a href="#cb2-8" tabindex="-1"></a></span>
<span id="cb2-9"><a href="#cb2-9" tabindex="-1"></a><span class="kw">class</span> Patient(Base):</span>
<span id="cb2-10"><a href="#cb2-10" tabindex="-1"></a>    __tablename__ <span class="op">=</span> <span class="st">'patients'</span></span>
<span id="cb2-11"><a href="#cb2-11" tabindex="-1"></a></span>
<span id="cb2-12"><a href="#cb2-12" tabindex="-1"></a>    <span class="bu">id</span> <span class="op">=</span> Column(Integer, primary_key<span class="op">=</span><span class="va">True</span>)</span>
<span id="cb2-13"><a href="#cb2-13" tabindex="-1"></a>    name <span class="op">=</span> Column(String)</span>
<span id="cb2-14"><a href="#cb2-14" tabindex="-1"></a></span>
<span id="cb2-15"><a href="#cb2-15" tabindex="-1"></a>    <span class="kw">def</span> <span class="fu">__init__</span>(<span class="va">self</span>, <span class="op">*</span>args, <span class="op">**</span>kwargs):</span>
<span id="cb2-16"><a href="#cb2-16" tabindex="-1"></a>        <span class="bu">super</span>().<span class="fu">__init__</span>(<span class="op">*</span>args, <span class="op">**</span>kwargs)</span>
<span id="cb2-17"><a href="#cb2-17" tabindex="-1"></a></span>
<span id="cb2-18"><a href="#cb2-18" tabindex="-1"></a>        <span class="va">self</span>.observations <span class="op">=</span> []</span>
<span id="cb2-19"><a href="#cb2-19" tabindex="-1"></a>        <span class="cf">if</span> <span class="st">'observations'</span> <span class="kw">in</span> kwargs:</span>
<span id="cb2-20"><a href="#cb2-20" tabindex="-1"></a>            <span class="va">self</span>.observations <span class="op">=</span> kwargs[<span class="st">'observations'</span>]</span></code></pre>
</div>
<p>Now that we have defined how to translate between our Python class
and a database table, we need to hook our code up to an actual
database.</p>
<p>The library we are using, SQLAlchemy, does everything through a
database <strong>engine</strong>. This is essentially a wrapper around
the real database, so we do not have to worry about which particular
database software is being used - we just need to write code for a
generic relational database.</p>
<p>For these lessions we are going to use the SQLite engine as this
requires almost no configuration and no external software. Most
relational database software runs as a separate service which we can
connect to from our code. This means that in a large scale environment,
we could have the database and our software running on different
computers - we could even have the database spread across several
servers if we have particularly high demands for performance or
reliability. Some examples of databases which are used like this are
PostgreSQL, MySQL and MSSQL.</p>
<p>On the other hand, SQLite runs entirely within our software and uses
only a single file to hold its data. It will not give us the extremely
high performance or reliability of a properly configured PostgreSQL
database, but it is good enough in many cases and much less work to get
running.</p>
<p>Let us write some test code to setup and connect to an SQLite
database. For now we will store the database in memory rather than an
actual file - it will not actually allow us to store data after the
program finishes, but it allows us not to worry about
<strong>migrations</strong>.</p>
<div id="migrations" class="callout">
<div class="callout-square">
<i class="callout-icon" data-feather="bell"></i>
</div>
<div id="migrations" class="callout-inner">
<h3 class="callout-title">Migrations</h3>
<div class="callout-content">
<p>When we make changes to our mapping (e.g. adding / removing columns),
we need to get the database to update its tables to make sure they match
the new format. This is what the <code>Base.metadata.create_all</code>
method does - creates all of these tables from scratch because we are
using an in-memory database which we know will be removed between
runs.</p>
<p>If we are actually storing data persistently, we need to make sure
that when we change the mapping, we update the database tables without
damaging any of the data they currently contain. We could do this
manually, by running SQL queries against the tables to get them into the
right format, but this is error-prone and can be a lot of work.</p>
<p>In practice, we generate a migration for each change. Tools such as
<a href="https://alembic.sqlalchemy.org/en/latest/" class="external-link">Alembic</a> will
compare our mappings to the known state of the database and generate a
Python file which updates the database to the necessary state.</p>
<p>Migrations can be quite complex, so we will not be using them here -
but you may find it useful to read about them later.</p>
</div>
</div>
</div>
<div class="codewrapper sourceCode" id="cb3">
<h3 class="code-label">PYTHON<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="sourceCode python" tabindex="0"><code class="sourceCode python"><span id="cb3-1"><a href="#cb3-1" tabindex="-1"></a><span class="co"># file: tests/test_models.py</span></span>
<span id="cb3-2"><a href="#cb3-2" tabindex="-1"></a></span>
<span id="cb3-3"><a href="#cb3-3" tabindex="-1"></a>...</span>
<span id="cb3-4"><a href="#cb3-4" tabindex="-1"></a></span>
<span id="cb3-5"><a href="#cb3-5" tabindex="-1"></a><span class="im">from</span> sqlalchemy <span class="im">import</span> create_engine</span>
<span id="cb3-6"><a href="#cb3-6" tabindex="-1"></a><span class="im">from</span> sqlalchemy.orm <span class="im">import</span> sessionmaker</span>
<span id="cb3-7"><a href="#cb3-7" tabindex="-1"></a></span>
<span id="cb3-8"><a href="#cb3-8" tabindex="-1"></a><span class="im">from</span> inflammation.models <span class="im">import</span> Base, Patient</span>
<span id="cb3-9"><a href="#cb3-9" tabindex="-1"></a></span>
<span id="cb3-10"><a href="#cb3-10" tabindex="-1"></a>...</span>
<span id="cb3-11"><a href="#cb3-11" tabindex="-1"></a></span>
<span id="cb3-12"><a href="#cb3-12" tabindex="-1"></a><span class="kw">def</span> test_sqlalchemy_patient_search():</span>
<span id="cb3-13"><a href="#cb3-13" tabindex="-1"></a>    <span class="co">"""Test that we can save and retrieve patient data from a database."""</span></span>
<span id="cb3-14"><a href="#cb3-14" tabindex="-1"></a></span>
<span id="cb3-15"><a href="#cb3-15" tabindex="-1"></a>    <span class="co"># Setup a database connection - we are using a database stored in memory here</span></span>
<span id="cb3-16"><a href="#cb3-16" tabindex="-1"></a>    engine <span class="op">=</span> create_engine(<span class="st">'sqlite:///:memory:'</span>, echo<span class="op">=</span><span class="va">True</span>)</span>
<span id="cb3-17"><a href="#cb3-17" tabindex="-1"></a>    Session <span class="op">=</span> sessionmaker(bind<span class="op">=</span>engine)</span>
<span id="cb3-18"><a href="#cb3-18" tabindex="-1"></a>    session <span class="op">=</span> Session()</span>
<span id="cb3-19"><a href="#cb3-19" tabindex="-1"></a>    Base.metadata.create_all(engine)</span>
<span id="cb3-20"><a href="#cb3-20" tabindex="-1"></a></span>
<span id="cb3-21"><a href="#cb3-21" tabindex="-1"></a>    <span class="co"># Save a patient to the database</span></span>
<span id="cb3-22"><a href="#cb3-22" tabindex="-1"></a>    test_patient <span class="op">=</span> Patient(name<span class="op">=</span><span class="st">'Alice'</span>)</span>
<span id="cb3-23"><a href="#cb3-23" tabindex="-1"></a>    session.add(test_patient)</span>
<span id="cb3-24"><a href="#cb3-24" tabindex="-1"></a></span>
<span id="cb3-25"><a href="#cb3-25" tabindex="-1"></a>    <span class="co"># Search for a patient by name</span></span>
<span id="cb3-26"><a href="#cb3-26" tabindex="-1"></a>    queried_patient <span class="op">=</span> session.query(Patient).filter_by(name<span class="op">=</span><span class="st">'Alice'</span>).first()</span>
<span id="cb3-27"><a href="#cb3-27" tabindex="-1"></a>    <span class="va">self</span>.assertEqual(queried_patient.name, <span class="st">'Alice'</span>)</span>
<span id="cb3-28"><a href="#cb3-28" tabindex="-1"></a>    <span class="va">self</span>.assertEqual(queried_patient.<span class="bu">id</span>, <span class="dv">1</span>)</span>
<span id="cb3-29"><a href="#cb3-29" tabindex="-1"></a></span>
<span id="cb3-30"><a href="#cb3-30" tabindex="-1"></a>    <span class="co"># Wipe our temporary database</span></span>
<span id="cb3-31"><a href="#cb3-31" tabindex="-1"></a>    Base.metadata.drop_all(engine)</span></code></pre>
</div>
<p>For this test, we have imported our models inside the test function,
rather than at the top of the file like we normally would. This is not
recommended in normal code, as it means we are paying the performance
cost of importing every time we run the function, but can be useful in
test code. Since each test function only runs once per test session,
this performance cost is not as important as a function we were going to
call many times. Additionally, if we try to import something which does
not exist, it will fail - by imporing inside the test function, we limit
this to that specific test failing, rather than the whole file failing
to run.</p>
<div class="section level3">
<h3 id="relationships">Relationships<a class="anchor" aria-label="anchor" href="#relationships"></a></h3>
<p>Relational databases do not typically have an ‘array of numbers’
column type, so how are we going to represent our observations of our
patients’ inflammation? Well, our first step is to create a table of
observations. We can then use a <strong>foreign key</strong> to point
from the observation to a patient, so we know which patient the data
belongs to. The table also needs a column for the actual measurement -
we will call this <code>value</code> - and a column for the day the
measurement was taken on.</p>
<p>We can also use the ORM’s <code>relationship</code> helper function
allow us to go between the observations and patients without having to
do any of the complicated table joins manually.</p>
<div class="codewrapper sourceCode" id="cb4">
<h3 class="code-label">PYTHON<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="sourceCode python" tabindex="0"><code class="sourceCode python"><span id="cb4-1"><a href="#cb4-1" tabindex="-1"></a><span class="im">from</span> sqlalchemy <span class="im">import</span> Column, ForeignKey, Integer, String</span>
<span id="cb4-2"><a href="#cb4-2" tabindex="-1"></a><span class="im">from</span> sqlalchemy.ext.declarative <span class="im">import</span> declarative_base</span>
<span id="cb4-3"><a href="#cb4-3" tabindex="-1"></a><span class="im">from</span> sqlalchemy.orm <span class="im">import</span> relationship</span>
<span id="cb4-4"><a href="#cb4-4" tabindex="-1"></a></span>
<span id="cb4-5"><a href="#cb4-5" tabindex="-1"></a>...</span>
<span id="cb4-6"><a href="#cb4-6" tabindex="-1"></a></span>
<span id="cb4-7"><a href="#cb4-7" tabindex="-1"></a><span class="kw">class</span> Observation(Base):</span>
<span id="cb4-8"><a href="#cb4-8" tabindex="-1"></a>    __tablename__ <span class="op">=</span> <span class="st">'observations'</span></span>
<span id="cb4-9"><a href="#cb4-9" tabindex="-1"></a></span>
<span id="cb4-10"><a href="#cb4-10" tabindex="-1"></a>    <span class="bu">id</span> <span class="op">=</span> Column(Integer, primary_key<span class="op">=</span><span class="va">True</span>)</span>
<span id="cb4-11"><a href="#cb4-11" tabindex="-1"></a>    day <span class="op">=</span> Column(Integer)</span>
<span id="cb4-12"><a href="#cb4-12" tabindex="-1"></a>    value <span class="op">=</span> Column(Integer)</span>
<span id="cb4-13"><a href="#cb4-13" tabindex="-1"></a>    patient_id <span class="op">=</span> Column(Integer, ForeignKey(<span class="st">'patients.id'</span>))</span>
<span id="cb4-14"><a href="#cb4-14" tabindex="-1"></a></span>
<span id="cb4-15"><a href="#cb4-15" tabindex="-1"></a>    patient <span class="op">=</span> relationship(<span class="st">'Patient'</span>, back_populates<span class="op">=</span><span class="st">'observations'</span>)</span>
<span id="cb4-16"><a href="#cb4-16" tabindex="-1"></a></span>
<span id="cb4-17"><a href="#cb4-17" tabindex="-1"></a></span>
<span id="cb4-18"><a href="#cb4-18" tabindex="-1"></a><span class="kw">class</span> Patient(Base):</span>
<span id="cb4-19"><a href="#cb4-19" tabindex="-1"></a>    __tablename__ <span class="op">=</span> <span class="st">'patients'</span></span>
<span id="cb4-20"><a href="#cb4-20" tabindex="-1"></a></span>
<span id="cb4-21"><a href="#cb4-21" tabindex="-1"></a>    <span class="bu">id</span> <span class="op">=</span> Column(Integer, primary_key<span class="op">=</span><span class="va">True</span>)</span>
<span id="cb4-22"><a href="#cb4-22" tabindex="-1"></a>    name <span class="op">=</span> Column(String)</span>
<span id="cb4-23"><a href="#cb4-23" tabindex="-1"></a></span>
<span id="cb4-24"><a href="#cb4-24" tabindex="-1"></a>    observations <span class="op">=</span> relationship(<span class="st">'Observation'</span>,</span>
<span id="cb4-25"><a href="#cb4-25" tabindex="-1"></a>                                order_by<span class="op">=</span>Observation.day,</span>
<span id="cb4-26"><a href="#cb4-26" tabindex="-1"></a>                                back_populates<span class="op">=</span><span class="st">'patient'</span>)</span></code></pre>
</div>
<div id="time-is-hard" class="callout">
<div class="callout-square">
<i class="callout-icon" data-feather="bell"></i>
</div>
<div id="time-is-hard" class="callout-inner">
<h3 class="callout-title">Time is Hard</h3>
<div class="callout-content">
<p>We are using an integer field to store the day on which a measurement
was taken. This keeps us consistent with what we had previously as it is
essentialy the position of the measurement in the Numpy array. It also
avoids us having to worry about managing actual date / times.</p>
<p>The Python <code>datetime</code> module we have used previously in
the Academics example would be useful here, and most databases have
support for ‘date’ and ‘time’ columns, but to reduce the complexity, we
will just use integers here.</p>
</div>
</div>
</div>
<p>Our test code for this is going to look very similar to our previous
test code, so we can copy-paste it and make a few changes. This time,
after setting up the database, we need to add a patient and an
observation. We then test that we can get the observations from a
patient we have searched for.</p>
<div class="codewrapper sourceCode" id="cb5">
<h3 class="code-label">PYTHON<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="sourceCode python" tabindex="0"><code class="sourceCode python"><span id="cb5-1"><a href="#cb5-1" tabindex="-1"></a><span class="co"># file: tests/test_models.py</span></span>
<span id="cb5-2"><a href="#cb5-2" tabindex="-1"></a></span>
<span id="cb5-3"><a href="#cb5-3" tabindex="-1"></a><span class="im">from</span> inflammation.models <span class="im">import</span> Base, Observation, Patient</span>
<span id="cb5-4"><a href="#cb5-4" tabindex="-1"></a>...</span>
<span id="cb5-5"><a href="#cb5-5" tabindex="-1"></a></span>
<span id="cb5-6"><a href="#cb5-6" tabindex="-1"></a><span class="kw">def</span> test_sqlalchemy_observations():</span>
<span id="cb5-7"><a href="#cb5-7" tabindex="-1"></a>    <span class="co">"""Test that we can save and retrieve inflammation observations from a database."""</span></span>
<span id="cb5-8"><a href="#cb5-8" tabindex="-1"></a></span>
<span id="cb5-9"><a href="#cb5-9" tabindex="-1"></a>    <span class="co"># Setup a database connection - we are using a database stored in memory here</span></span>
<span id="cb5-10"><a href="#cb5-10" tabindex="-1"></a>    engine <span class="op">=</span> create_engine(<span class="st">'sqlite:///:memory:'</span>, echo<span class="op">=</span><span class="va">True</span>)</span>
<span id="cb5-11"><a href="#cb5-11" tabindex="-1"></a>    Session <span class="op">=</span> sessionmaker(bind<span class="op">=</span>engine)</span>
<span id="cb5-12"><a href="#cb5-12" tabindex="-1"></a>    session <span class="op">=</span> Session()</span>
<span id="cb5-13"><a href="#cb5-13" tabindex="-1"></a>    Base.metadata.create_all(engine)</span>
<span id="cb5-14"><a href="#cb5-14" tabindex="-1"></a></span>
<span id="cb5-15"><a href="#cb5-15" tabindex="-1"></a>    <span class="co"># Save a patient to the database</span></span>
<span id="cb5-16"><a href="#cb5-16" tabindex="-1"></a>    test_patient <span class="op">=</span> Patient(name<span class="op">=</span><span class="st">'Alice'</span>)</span>
<span id="cb5-17"><a href="#cb5-17" tabindex="-1"></a>    session.add(test_patient)</span>
<span id="cb5-18"><a href="#cb5-18" tabindex="-1"></a></span>
<span id="cb5-19"><a href="#cb5-19" tabindex="-1"></a>    test_observation <span class="op">=</span> Observation(patient<span class="op">=</span>test_patient, day<span class="op">=</span><span class="dv">0</span>, value<span class="op">=</span><span class="dv">1</span>)</span>
<span id="cb5-20"><a href="#cb5-20" tabindex="-1"></a>    session.add(test_observation)</span>
<span id="cb5-21"><a href="#cb5-21" tabindex="-1"></a></span>
<span id="cb5-22"><a href="#cb5-22" tabindex="-1"></a>    queried_patient <span class="op">=</span> session.query(Patient).filter_by(name<span class="op">=</span><span class="st">'Alice'</span>).first()</span>
<span id="cb5-23"><a href="#cb5-23" tabindex="-1"></a>    first_observation <span class="op">=</span> queried_patient.observations[<span class="dv">0</span>]</span>
<span id="cb5-24"><a href="#cb5-24" tabindex="-1"></a>    <span class="va">self</span>.assertEqual(first_observation.patient, queried_patient)</span>
<span id="cb5-25"><a href="#cb5-25" tabindex="-1"></a>    <span class="va">self</span>.assertEqual(first_observation.day, <span class="dv">0</span>)</span>
<span id="cb5-26"><a href="#cb5-26" tabindex="-1"></a>    <span class="va">self</span>.assertEqual(first_observation.value, <span class="dv">1</span>)</span>
<span id="cb5-27"><a href="#cb5-27" tabindex="-1"></a></span>
<span id="cb5-28"><a href="#cb5-28" tabindex="-1"></a>    <span class="co"># Wipe our temporary database</span></span>
<span id="cb5-29"><a href="#cb5-29" tabindex="-1"></a>    Base.metadata.drop_all(engine)</span></code></pre>
</div>
<p>Finally, let us put in a way to convert all of our observations into
a Numpy array, so we can use our previous analysis code. We will use the
<code>property</code> decorator here again, to create a method that we
can use as if it was a normal data attribute.</p>
<div class="codewrapper sourceCode" id="cb6">
<h3 class="code-label">PYTHON<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="sourceCode python" tabindex="0"><code class="sourceCode python"><span id="cb6-1"><a href="#cb6-1" tabindex="-1"></a><span class="co"># file: inflammation/models.py</span></span>
<span id="cb6-2"><a href="#cb6-2" tabindex="-1"></a></span>
<span id="cb6-3"><a href="#cb6-3" tabindex="-1"></a>...</span>
<span id="cb6-4"><a href="#cb6-4" tabindex="-1"></a></span>
<span id="cb6-5"><a href="#cb6-5" tabindex="-1"></a><span class="kw">class</span> Patient(Base):</span>
<span id="cb6-6"><a href="#cb6-6" tabindex="-1"></a>    __tablename__ <span class="op">=</span> <span class="st">'patients'</span></span>
<span id="cb6-7"><a href="#cb6-7" tabindex="-1"></a></span>
<span id="cb6-8"><a href="#cb6-8" tabindex="-1"></a>    <span class="bu">id</span> <span class="op">=</span> Column(Integer, primary_key<span class="op">=</span><span class="va">True</span>)</span>
<span id="cb6-9"><a href="#cb6-9" tabindex="-1"></a>    name <span class="op">=</span> Column(String)</span>
<span id="cb6-10"><a href="#cb6-10" tabindex="-1"></a></span>
<span id="cb6-11"><a href="#cb6-11" tabindex="-1"></a>    observations <span class="op">=</span> relationship(<span class="st">'Observation'</span>,</span>
<span id="cb6-12"><a href="#cb6-12" tabindex="-1"></a>                                order_by<span class="op">=</span>Observation.day,</span>
<span id="cb6-13"><a href="#cb6-13" tabindex="-1"></a>                                back_populates<span class="op">=</span><span class="st">'patient'</span>)</span>
<span id="cb6-14"><a href="#cb6-14" tabindex="-1"></a></span>
<span id="cb6-15"><a href="#cb6-15" tabindex="-1"></a>    <span class="at">@property</span></span>
<span id="cb6-16"><a href="#cb6-16" tabindex="-1"></a>    <span class="kw">def</span> values(<span class="va">self</span>):</span>
<span id="cb6-17"><a href="#cb6-17" tabindex="-1"></a>        <span class="co">"""Convert inflammation data into Numpy array."""</span></span>
<span id="cb6-18"><a href="#cb6-18" tabindex="-1"></a>        last_day <span class="op">=</span> <span class="va">self</span>.observations[<span class="op">-</span><span class="dv">1</span>].day</span>
<span id="cb6-19"><a href="#cb6-19" tabindex="-1"></a>        values <span class="op">=</span> np.zeros(last_day <span class="op">+</span> <span class="dv">1</span>)</span>
<span id="cb6-20"><a href="#cb6-20" tabindex="-1"></a></span>
<span id="cb6-21"><a href="#cb6-21" tabindex="-1"></a>        <span class="cf">for</span> observation <span class="kw">in</span> <span class="va">self</span>.observations:</span>
<span id="cb6-22"><a href="#cb6-22" tabindex="-1"></a>            values[observation.day] <span class="op">=</span> observation.value</span>
<span id="cb6-23"><a href="#cb6-23" tabindex="-1"></a></span>
<span id="cb6-24"><a href="#cb6-24" tabindex="-1"></a>        <span class="cf">return</span> values</span></code></pre>
</div>
<p>Once again we will copy-paste the test code and make some changes.
This time we want to create a few observations for our patient and test
that we can turn them into a Numpy array.</p>
<div class="codewrapper sourceCode" id="cb7">
<h3 class="code-label">PYTHON<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="sourceCode python" tabindex="0"><code class="sourceCode python"><span id="cb7-1"><a href="#cb7-1" tabindex="-1"></a><span class="co"># file: tests/test_models.py</span></span>
<span id="cb7-2"><a href="#cb7-2" tabindex="-1"></a><span class="im">from</span> inflammation.models <span class="im">import</span> Base, Observation, Patient</span>
<span id="cb7-3"><a href="#cb7-3" tabindex="-1"></a>...</span>
<span id="cb7-4"><a href="#cb7-4" tabindex="-1"></a><span class="kw">def</span> test_sqlalchemy_observations_to_array():</span>
<span id="cb7-5"><a href="#cb7-5" tabindex="-1"></a>    <span class="co">"""Test that we can save and retrieve inflammation observations from a database."""</span></span>
<span id="cb7-6"><a href="#cb7-6" tabindex="-1"></a></span>
<span id="cb7-7"><a href="#cb7-7" tabindex="-1"></a>    <span class="co"># Setup a database connection - we are using a database stored in memory here</span></span>
<span id="cb7-8"><a href="#cb7-8" tabindex="-1"></a>    engine <span class="op">=</span> create_engine(<span class="st">'sqlite:///:memory:'</span>)</span>
<span id="cb7-9"><a href="#cb7-9" tabindex="-1"></a>    Session <span class="op">=</span> sessionmaker(bind<span class="op">=</span>engine)</span>
<span id="cb7-10"><a href="#cb7-10" tabindex="-1"></a>    session <span class="op">=</span> Session()</span>
<span id="cb7-11"><a href="#cb7-11" tabindex="-1"></a>    Base.metadata.create_all(engine)</span>
<span id="cb7-12"><a href="#cb7-12" tabindex="-1"></a></span>
<span id="cb7-13"><a href="#cb7-13" tabindex="-1"></a>    <span class="co"># Save a patient to the database</span></span>
<span id="cb7-14"><a href="#cb7-14" tabindex="-1"></a>    test_patient <span class="op">=</span> Patient(name<span class="op">=</span><span class="st">'Alice'</span>)</span>
<span id="cb7-15"><a href="#cb7-15" tabindex="-1"></a>    session.add(test_patient)</span>
<span id="cb7-16"><a href="#cb7-16" tabindex="-1"></a></span>
<span id="cb7-17"><a href="#cb7-17" tabindex="-1"></a>    <span class="cf">for</span> i <span class="kw">in</span> <span class="bu">range</span>(<span class="dv">5</span>):</span>
<span id="cb7-18"><a href="#cb7-18" tabindex="-1"></a>        test_observation <span class="op">=</span> Observation(patient<span class="op">=</span>test_patient, day<span class="op">=</span>i, value<span class="op">=</span>i)</span>
<span id="cb7-19"><a href="#cb7-19" tabindex="-1"></a>        session.add(test_observation)</span>
<span id="cb7-20"><a href="#cb7-20" tabindex="-1"></a></span>
<span id="cb7-21"><a href="#cb7-21" tabindex="-1"></a>    queried_patient <span class="op">=</span> session.query(Patient).filter_by(name<span class="op">=</span><span class="st">'Alice'</span>).first()</span>
<span id="cb7-22"><a href="#cb7-22" tabindex="-1"></a>    npt.assert_array_equal([<span class="dv">0</span>, <span class="dv">1</span>, <span class="dv">2</span>, <span class="dv">3</span>, <span class="dv">4</span>], queried_patient.values)</span>
<span id="cb7-23"><a href="#cb7-23" tabindex="-1"></a></span>
<span id="cb7-24"><a href="#cb7-24" tabindex="-1"></a>    <span class="co"># Wipe our temporary database</span></span>
<span id="cb7-25"><a href="#cb7-25" tabindex="-1"></a>    Base.metadata.drop_all(engine)</span></code></pre>
</div>
<div id="further-array-testing" class="callout challenge">
<div class="callout-square">
<i class="callout-icon" data-feather="zap"></i>
</div>
<div id="further-array-testing" class="callout-inner">
<h3 class="callout-title">Further Array Testing</h3>
<div class="callout-content">
<p>there is an important feature of the behaviour of our
<code>Patient.values</code> property that’s not currently being tested.
What is this feature? Write one or more extra tests to cover this
feature.</p>
</div>
</div>
</div>
<div id="accordionSolution1" class="accordion challenge-accordion accordion-flush">
<div class="accordion-item">
<button class="accordion-button solution-button collapsed" type="button" data-bs-toggle="collapse" data-bs-target="#collapseSolution1" aria-expanded="false" aria-controls="collapseSolution1">
  <h4 class="accordion-header" id="headingSolution1">
  Hint
  </h4>
</button>
<div id="collapseSolution1" class="accordion-collapse collapse" data-bs-parent="#accordionSolution1" aria-labelledby="headingSolution1">
<div class="accordion-body">
<p>The <code>Patient.values</code> property creates an array of zeroes,
then fills it with data from the table. If a measurement was not taken
on a particular day, that day’s value will be left as zero.</p>
<p>If this is intended behaviour, it would be useful to write a test for
it, to ensure that we do not break it in future. Using tests in this way
is known as <strong>regression testing</strong>.</p>
</div>
</div>
</div>
</div>
<div id="refactoring-for-reduced-redundancy" class="callout discussion">
<div class="callout-square">
<i class="callout-icon" data-feather="message-circle"></i>
</div>
<div id="refactoring-for-reduced-redundancy" class="callout-inner">
<h3 class="callout-title">Refactoring for Reduced Redundancy</h3>
<div class="callout-content">
<p>You have probably noticed that there is a lot of replicated code in
our database tests. It is fine if some code is replicated a bit, but if
you keep needing to copy the same code, that’s a sign it should be
refactored.</p>
<p>Refactoring is the process of changing the structure of our code,
without changing its behaviour, and one of the main benefits of good
test coverage is that it makes refactoring easier. If we have got a good
set of tests, it is much more likely that we will detect any changes to
behaviour - even when these changes might be in the tests
themselves.</p>
<p>Try refactoring the database tests to see if you can reduce the
amount of replicated code by moving it into one or more functions at the
top of the test file.</p>
</div>
</div>
</div>
<div id="advanced-challenge-connecting-more-views" class="callout discussion">
<div class="callout-square">
<i class="callout-icon" data-feather="message-circle"></i>
</div>
<div id="advanced-challenge-connecting-more-views" class="callout-inner">
<h3 class="callout-title">Advanced Challenge: Connecting More Views</h3>
<div class="callout-content">
<p>We have added the ability to store patient records in the database,
but not actually connected it to any useful views. there is a common
pattern in data management software which is often referred to as
<strong>CRUD</strong> - Create, Read, Update, Delete. These are the four
fundamental views that we need to provide to allow people to manage
their data effectively.</p>
<p>Each of these applies at the level of a single record, so for both
patients and observations we should have a view to: create a new record,
show an existing record, update an existing record and delete an
existing record. It is also sometimes useful to provide a view which
lists all existing records for each type - for example, a list of all
patients would probably be useful, but a list of all observations might
not be.</p>
<p>Pick one (or several) of these views to implement - you may want to
refer back to the section where we added our initial patient read
view.</p>
</div>
</div>
</div>
<div id="advanced-challenge-managing-dates-properly" class="callout discussion">
<div class="callout-square">
<i class="callout-icon" data-feather="message-circle"></i>
</div>
<div id="advanced-challenge-managing-dates-properly" class="callout-inner">
<h3 class="callout-title">Advanced Challenge: Managing Dates Properly</h3>
<div class="callout-content">
<p>Try converting our existing models to use actual dates instead of
just a day number. The Python <a href="https://docs.python.org/3/library/datetime.html" class="external-link">datetime module
documentation</a> and SQLAlchemy <a href="https://docs.sqlalchemy.org/en/13/core/type_basics.html" class="external-link">Column
and Data Types page</a> will be useful to you here.</p>
</div>
</div>
</div>
<div id="keypoints1" class="callout keypoints">
<div class="callout-square">
<i class="callout-icon" data-feather="key"></i>
</div>
<div class="callout-inner">
<h3 class="callout-title">Key Points</h3>
<div class="callout-content">
<ul><li>Relational databases are often the best persistence mechanism for
data which fits well to the Object Oriented paradigm.</li>
</ul></div>
</div>
</div>
</div>



      </div> <!-- / div.lesson-content -->
    </main><!-- / main#main-content.main-content --><nav class="bottom-pagination mx-md-4" aria-label="Previous and Next Chapter"><div class="d-block d-sm-block d-md-none">
        <a class="chapter-link" href="../instructor/index.html"><i aria-hidden="true" class="small-arrow" data-feather="arrow-left"></i>Previous</a>
        <a class="chapter-link float-end" href="../instructor/index.html">Next<i aria-hidden="true" class="small-arrow" data-feather="arrow-right"></i></a>
      </div>
      <!-- content for large screens -->
      <div class="d-none d-sm-none d-md-block">
        <a class="chapter-link" href="../instructor/index.html" rel="prev">
          <i aria-hidden="true" class="small-arrow" data-feather="arrow-left"></i>
          Home
        </a>
        <a class="chapter-link float-end" href="../instructor/index.html" rel="next">
          Home
          <i aria-hidden="true" class="small-arrow" data-feather="arrow-right"></i>
        </a>
      </div>
    </nav></div> <!-- / div.primary-content.col-xs-12 -->
<!-- END:   inst/pkgdown/templates/content-instructor.html-->

      </div><!--/div.row-->
      		<footer class="row footer mx-md-3"><hr><div class="col-md-6">
        <p>This lesson is subject to the <a href="CODE_OF_CONDUCT.html">Code of Conduct</a></p>
        <p>

        <a href="https://github.com/carpentries-incubator/python-intermediate-development/edit/main/learners/databases.md" class="external-link">Edit on GitHub</a>

	
        | <a href="https://github.com/carpentries-incubator/python-intermediate-development/blob/main/CONTRIBUTING.md" class="external-link">Contributing</a>
        | <a href="https://github.com/carpentries-incubator/python-intermediate-development/" class="external-link">Source</a></p>
				<p><a href="https://github.com/carpentries-incubator/python-intermediate-development/blob/main/CITATION" class="external-link">Cite</a> | <a href="mailto:info@software.ac.uk">Contact</a> | <a href="https://carpentries.org/about/" class="external-link">About</a></p>
			</div>
			<div class="col-md-6">

        <p>Materials licensed under <a href="LICENSE.html">CC-BY 4.0</a> by the authors</p>

        <p>Template licensed under <a href="https://creativecommons.org/licenses/by-sa/4.0/" class="external-link">CC-BY 4.0</a> by <a href="https://carpentries.org/" class="external-link">The Carpentries</a></p>
        <p>Built with <a href="https://github.com/carpentries/sandpaper/tree/0.16.11" class="external-link">sandpaper (0.16.11)</a>, <a href="https://github.com/carpentries/pegboard/tree/0.7.9" class="external-link">pegboard (0.7.9)</a>, and <a href="https://github.com/carpentries/varnish/tree/1.0.5" class="external-link">varnish (1.0.5)</a></p>
			</div>
		</footer></div> <!-- / div.container -->
	<div id="to-top">
		<a href="#top">
      <i class="search-icon" data-feather="arrow-up" role="img" aria-label="Back To Top"></i><br><!-- <span class="d-none d-sm-none d-md-none d-lg-none d-xl-block">Back</span> To Top --><span class="d-none d-sm-none d-md-none d-lg-none d-xl-block">Back</span> To Top
		</a>
	</div>
  <script type="application/ld+json">
    {
  "@context": "https://schema.org",
  "@type": "TrainingMaterial",
  "@id": "https://carpentries-incubator.github.io/python-intermediate-development/instructor/databases.html",
  "inLanguage": "en",
  "dct:conformsTo": "https://bioschemas.org/profiles/TrainingMaterial/1.0-RELEASE",
  "description": "A Carpentries Lesson teaching foundational data and coding skills to researchers worldwide",
  "keywords": "software, data, lesson, The Carpentries",
  "name": "Extra Content: Databases",
  "creativeWorkStatus": "active",
  "url": "https://carpentries-incubator.github.io/python-intermediate-development/instructor/databases.html",
  "identifier": "https://carpentries-incubator.github.io/python-intermediate-development/instructor/databases.html",
  "dateCreated": "2020-04-23",
  "dateModified": "2024-12-06",
  "datePublished": "2025-04-01"
}

  </script><script>
		feather.replace();
	</script></body></html><!-- END:   inst/pkgdown/templates/layout.html-->

