<!DOCTYPE html>
<!-- START: inst/pkgdown/templates/layout.html --><!-- Generated by pkgdown: do not edit by hand --><html lang="en" data-bs-theme="auto"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta charset="utf-8"><title>Intermediate Research Software Development: 3.3 Code Decoupling &amp; Abstractions</title><meta name="viewport" content="width=device-width, initial-scale=1"><script src="../assets/themetoggle.js"></script><link rel="stylesheet" type="text/css" href="../assets/styles.css"><script src="../assets/scripts.js" type="text/javascript"></script><!-- mathjax --><script type="text/x-mathjax-config">
    MathJax.Hub.Config({
      config: ["MMLorHTML.js"],
      jax: ["input/TeX","input/MathML","output/HTML-CSS","output/NativeMML", "output/PreviewHTML"],
      extensions: ["tex2jax.js","mml2jax.js","MathMenu.js","MathZoom.js", "fast-preview.js", "AssistiveMML.js", "a11y/accessibility-menu.js"],
      TeX: {
        extensions: ["AMSmath.js","AMSsymbols.js","noErrors.js","noUndefined.js"]
      },
      tex2jax: {
        inlineMath: [['\\(', '\\)']],
        displayMath: [ ['$$','$$'], ['\\[', '\\]'] ],
        processEscapes: true
      }
    });
    </script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><!-- Responsive Favicon for The Carpentries --><link rel="apple-touch-icon" sizes="180x180" href="../favicons/incubator/apple-touch-icon.png"><link rel="icon" type="image/png" sizes="32x32" href="../favicons/incubator/favicon-32x32.png"><link rel="icon" type="image/png" sizes="16x16" href="../favicons/incubator/favicon-16x16.png"><link rel="manifest" href="../favicons/incubator/site.webmanifest"><link rel="mask-icon" href="../favicons/incubator/safari-pinned-tab.svg" color="#5bbad5"><meta name="msapplication-TileColor" content="#da532c"><meta name="theme-color" media="(prefers-color-scheme: light)" content="white"><meta name="theme-color" media="(prefers-color-scheme: dark)" content="black"></head><body>
    <header id="top" class="navbar navbar-expand-md top-nav incubator"><svg xmlns="http://www.w3.org/2000/svg" class="d-none"><symbol id="check2" viewbox="0 0 16 16"><path d="M13.854 3.646a.5.5 0 0 1 0 .708l-7 7a.5.5 0 0 1-.708 0l-3.5-3.5a.5.5 0 1 1 .708-.708L6.5 10.293l6.646-6.647a.5.5 0 0 1 .708 0z"></path></symbol><symbol id="circle-half" viewbox="0 0 16 16"><path d="M8 15A7 7 0 1 0 8 1v14zm0 1A8 8 0 1 1 8 0a8 8 0 0 1 0 16z"></path></symbol><symbol id="moon-stars-fill" viewbox="0 0 16 16"><path d="M6 .278a.768.768 0 0 1 .08.858 7.208 7.208 0 0 0-.878 3.46c0 4.021 3.278 7.277 7.318 7.277.527 0 1.04-.055 1.533-.16a.787.787 0 0 1 .81.316.733.733 0 0 1-.031.893A8.349 8.349 0 0 1 8.344 16C3.734 16 0 12.286 0 7.71 0 4.266 2.114 1.312 5.124.06A.752.752 0 0 1 6 .278z"></path><path d="M10.794 3.148a.217.217 0 0 1 .412 0l.387 1.162c.173.518.579.924 1.097 1.097l1.162.387a.217.217 0 0 1 0 .412l-1.162.387a1.734 1.734 0 0 0-1.097 1.097l-.387 1.162a.217.217 0 0 1-.412 0l-.387-1.162A1.734 1.734 0 0 0 9.31 6.593l-1.162-.387a.217.217 0 0 1 0-.412l1.162-.387a1.734 1.734 0 0 0 1.097-1.097l.387-1.162zM13.863.099a.145.145 0 0 1 .274 0l.258.774c.115.346.386.617.732.732l.774.258a.145.145 0 0 1 0 .274l-.774.258a1.156 1.156 0 0 0-.732.732l-.258.774a.145.145 0 0 1-.274 0l-.258-.774a1.156 1.156 0 0 0-.732-.732l-.774-.258a.145.145 0 0 1 0-.274l.774-.258c.346-.115.617-.386.732-.732L13.863.1z"></path></symbol><symbol id="sun-fill" viewbox="0 0 16 16"><path d="M8 12a4 4 0 1 0 0-8 4 4 0 0 0 0 8zM8 0a.5.5 0 0 1 .5.5v2a.5.5 0 0 1-1 0v-2A.5.5 0 0 1 8 0zm0 13a.5.5 0 0 1 .5.5v2a.5.5 0 0 1-1 0v-2A.5.5 0 0 1 8 13zm8-5a.5.5 0 0 1-.5.5h-2a.5.5 0 0 1 0-1h2a.5.5 0 0 1 .5.5zM3 8a.5.5 0 0 1-.5.5h-2a.5.5 0 0 1 0-1h2A.5.5 0 0 1 3 8zm10.657-5.657a.5.5 0 0 1 0 .707l-1.414 1.415a.5.5 0 1 1-.707-.708l1.414-1.414a.5.5 0 0 1 .707 0zm-9.193 9.193a.5.5 0 0 1 0 .707L3.05 13.657a.5.5 0 0 1-.707-.707l1.414-1.414a.5.5 0 0 1 .707 0zm9.193 2.121a.5.5 0 0 1-.707 0l-1.414-1.414a.5.5 0 0 1 .707-.707l1.414 1.414a.5.5 0 0 1 0 .707zM4.464 4.465a.5.5 0 0 1-.707 0L2.343 3.05a.5.5 0 1 1 .707-.707l1.414 1.414a.5.5 0 0 1 0 .708z"></path></symbol></svg><a class="visually-hidden-focusable skip-link" href="#main-content">Skip to main content</a>
  <div class="container-fluid top-nav-container">
    <div class="col-md-8">
      <div class="large-logo">
        <img id="incubator-logo" alt="Lesson Description" src="../assets/images/incubator-logo.svg"><span class="badge text-bg-info">
          <abbr title="This lesson is in the beta phase, which means that it is ready for teaching by instructors outside of the original author team.">
            <a href="https://docs.carpentries.org/resources/curriculum/lesson-life-cycle.html" class="external-link alert-link">
              <i aria-hidden="true" class="icon" data-feather="alert-circle" style="border-radius: 5px"></i>
              Beta
            </a>
            <span class="visually-hidden">This lesson is in the beta phase, which means that it is ready for teaching by instructors outside of the original author team.</span>
          </abbr>
        </span>

      </div>
    </div>
    <div class="selector-container">
      <div id="theme-selector">
        <li class="nav-item dropdown" id="theme-button-list">
          <button class="btn btn-link nav-link px-0 px-lg-2 dropdown-toggle d-flex align-items-center" id="bd-theme" type="button" aria-expanded="false" data-bs-toggle="dropdown" data-bs-display="static" aria-label="Toggle theme (auto)">
            <svg class="bi my-1 theme-icon-active"><use href="#circle-half"></use></svg><i data-feather="chevron-down"></i>
          </button>
          <ul class="dropdown-menu dropdown-menu-end" aria-labelledby="bd-theme-text"><li>
              <button type="button" class="btn dropdown-item d-flex align-items-center" data-bs-theme-value="light" aria-pressed="false">
                <svg class="bi me-2 theme-icon"><use href="#sun-fill"></use></svg>
                Light
                <svg class="bi ms-auto d-none"><use href="#check2"></use></svg></button>
            </li>
            <li>
              <button type="button" class="btn dropdown-item d-flex align-items-center" data-bs-theme-value="dark" aria-pressed="false">
                <svg class="bi me-2 theme-icon"><use href="#moon-stars-fill"></use></svg>
                Dark
                <svg class="bi ms-auto d-none"><use href="#check2"></use></svg></button>
            </li>
            <li>
              <button type="button" class="btn dropdown-item d-flex align-items-center active" data-bs-theme-value="auto" aria-pressed="true">
                <svg class="bi me-2 theme-icon"><use href="#circle-half"></use></svg>
                Auto
                <svg class="bi ms-auto d-none"><use href="#check2"></use></svg></button>
            </li>
          </ul></li>
      </div>

      <div class="dropdown" id="instructor-dropdown">
        <button class="btn btn-secondary dropdown-toggle bordered-button" type="button" id="dropdownMenu1" data-bs-toggle="dropdown" aria-expanded="false">
          <i aria-hidden="true" class="icon" data-feather="eye"></i> Instructor View <i data-feather="chevron-down"></i>
        </button>
        <ul class="dropdown-menu" aria-labelledby="dropdownMenu1"><li><button class="dropdown-item" type="button" onclick="window.location.href='../33-code-decoupling-abstractions.html';">Learner View</button></li>
        </ul></div>
    </div>
  </div>
  <hr></header><nav class="navbar navbar-expand-xl bottom-nav incubator" aria-label="Main Navigation"><div class="container-fluid nav-container">
    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbarSupportedContent" aria-controls="navbarSupportedContent" aria-expanded="false" aria-label="Toggle Navigation">
      <span class="navbar-toggler-icon"></span>
      <span class="menu-title">Menu</span>
    </button>
    <div class="nav-logo">
      <img class="small-logo" alt="Lesson Description" src="../assets/images/incubator-logo-sm.svg"></div>
    <div class="lesson-title-md">
      Intermediate Research Software Development
    </div>
    <div class="search-icon-sm">
      <!-- TODO: do not show until we have search
        <i role="img" aria-label="Search the All In One page" data-feather="search"></i>
      -->
    </div>
    <div class="desktop-nav">
      <ul class="navbar-nav me-auto mb-2 mb-lg-0"><li class="nav-item">
          <span class="lesson-title">
            Intermediate Research Software Development
          </span>
        </li>
        <li class="nav-item">
          <a class="nav-link" href="../instructor/key-points.html">Key Points</a>
        </li>
        <li class="nav-item">
          <a class="nav-link" href="../instructor/instructor-notes.html">Instructor Notes</a>
        </li>
        <li class="nav-item">
          <a class="nav-link" href="../instructor/images.html">Extract All Images</a>
        </li>
        <li class="nav-item dropdown">
          <button class="nav-link dropdown-toggle" id="navbarDropdown" data-bs-toggle="dropdown" aria-expanded="false">
            More <i data-feather="chevron-down"></i>
          </button>
          <ul class="dropdown-menu" aria-labelledby="navbarDropdown"><hr><li><a class="dropdown-item" href="quiz.html">Quiz</a></li><li><a class="dropdown-item" href="installation-instructions.html">Installation Instructions</a></li><li><a class="dropdown-item" href="common-issues.html">Common Issues, Fixes &amp; Tips</a></li><li><a class="dropdown-item" href="software-architecture-extra.html">Extra Content: Software Architecture</a></li><li><a class="dropdown-item" href="programming-paradigms.html">Extra Content: Programming Paradigms</a></li><li><a class="dropdown-item" href="procedural-programming.html">Extra Content: Procedural Programming</a></li><li><a class="dropdown-item" href="functional-programming.html">Extra Content: Functional Programming</a></li><li><a class="dropdown-item" href="object-oriented-programming.html">Extra Content: Object Oriented Programming</a></li><li><a class="dropdown-item" href="persistence.html">Extra Content: Persistence</a></li><li><a class="dropdown-item" href="databases.html">Extra Content: Databases</a></li><li><a class="dropdown-item" href="vscode.html">Extra Content: Using Microsoft Visual Studio Code</a></li><li><a class="dropdown-item" href="reference.html">Reference</a></li>
          </ul></li>
      </ul></div>
    <!--
    <form class="d-flex col-md-2 search-form">
      <fieldset disabled>
      <input class="form-control me-2 searchbox" type="search" placeholder="" aria-label="">
        <button class="btn btn-outline-success tablet-search-button"  type="submit">
          <i class="search-icon" data-feather="search" role="img" aria-label="Search the All In One page"></i>
        </button>
      </fieldset>
    </form>
    -->
    <a id="search-button" class="btn btn-primary" href="../instructor/aio.html" role="button" aria-label="Search the All In One page">Search the All In One page</a>
  </div><!--/div.container-fluid -->
</nav><div class="col-md-12 mobile-title">
  Intermediate Research Software Development
</div>

<aside class="col-md-12 lesson-progress"><div style="width: 54%" class="percentage">
    54%
  </div>
  <div class="progress incubator">
    <div class="progress-bar incubator" role="progressbar" style="width: 54%" aria-valuenow="54" aria-label="Lesson Progress" aria-valuemin="0" aria-valuemax="100">
    </div>
  </div>
</aside><div class="container">
      <div class="row">
        <!-- START: inst/pkgdown/templates/navbar.html -->
<div id="sidebar-col" class="col-lg-4">
  <div id="sidebar" class="sidebar">
      <nav aria-labelledby="flush-headingEleven"><button role="button" aria-label="close menu" alt="close menu" aria-expanded="true" aria-controls="sidebar" class="collapse-toggle" data-collapse="Collapse " data-episodes="Episodes ">
          <i class="search-icon" data-feather="x" role="img"></i>
        </button>
        <div class="sidebar-inner">
          <div class="row mobile-row" id="theme-row-mobile">
            <div class="col" id="theme-selector">
              <li class="nav-item dropdown" id="theme-button-list">
                <button class="btn btn-link nav-link px-0 px-lg-2 dropdown-toggle d-flex align-items-center" id="bd-theme" type="button" aria-expanded="false" data-bs-toggle="dropdown" data-bs-display="static" aria-label="Toggle theme (auto)">
                  <svg class="bi my-1 theme-icon-active"><use href="#circle-half"></use></svg><span class="d-lg-none ms-1" id="bd-theme-text">Toggle Theme</span>
                </button>
                <ul class="dropdown-menu dropdown-menu-right" aria-labelledby="bd-theme-text"><li>
                    <button type="button" class="btn dropdown-item d-flex align-items-center" data-bs-theme-value="light" aria-pressed="false">
                      <svg class="bi me-2 theme-icon"><use href="#sun-fill"></use></svg>
                      Light
                      <svg class="bi ms-auto d-none"><use href="#check2"></use></svg></button>
                  </li>
                  <li>
                    <button type="button" class="btn dropdown-item d-flex align-items-center" data-bs-theme-value="dark" aria-pressed="false">
                      <svg class="bi me-2 theme-icon"><use href="#moon-stars-fill"></use></svg>
                      Dark
                      <svg class="bi ms-auto d-none"><use href="#check2"></use></svg></button>
                  </li>
                  <li>
                    <button type="button" class="btn dropdown-item d-flex align-items-center active" data-bs-theme-value="auto" aria-pressed="true">
                      <svg class="bi me-2 theme-icon"><use href="#circle-half"></use></svg>
                      Auto
                      <svg class="bi ms-auto d-none"><use href="#check2"></use></svg></button>
                  </li>
                </ul></li>
            </div>
          </div>
          <div class="row mobile-row">
            <div class="col">
              <div class="sidenav-view-selector">
                <div class="accordion accordion-flush" id="accordionFlush9">
                  <div class="accordion-item">
                    <h2 class="accordion-header" id="flush-headingNine">
                      <button class="accordion-button collapsed" id="instructor" type="button" data-bs-toggle="collapse" data-bs-target="#flush-collapseNine" aria-expanded="false" aria-controls="flush-collapseNine">
                        <i id="eye" aria-hidden="true" class="icon" data-feather="eye"></i> Instructor View
                      </button>
                    </h2>
                    <div id="flush-collapseNine" class="accordion-collapse collapse" aria-labelledby="flush-headingNine" data-bs-parent="#accordionFlush2">
                      <div class="accordion-body">
                        <a href="../33-code-decoupling-abstractions.html">Learner View</a>
                      </div>
                    </div>
                  </div><!--/div.accordion-item-->
                </div><!--/div.accordion-flush-->
              </div><!--div.sidenav-view-selector -->
            </div><!--/div.col -->

            <hr></div><!--/div.mobile-row -->

          <div class="accordion accordion-flush" id="accordionFlush11">
            <div class="accordion-item">

              <button id="chapters" class="accordion-button show" type="button" data-bs-toggle="collapse" data-bs-target="#flush-collapseEleven" aria-expanded="false" aria-controls="flush-collapseEleven">
                <h2 class="accordion-header chapters" id="flush-headingEleven">
                  EPISODES
                </h2>
              </button>
              <div id="flush-collapseEleven" class="accordion-collapse show collapse" aria-labelledby="flush-headingEleven" data-bs-parent="#accordionFlush11">

                <div class="accordion-body">
                  <div class="accordion accordion-flush" id="accordionFlush1">
  <div class="accordion-item">
    <div class="accordion-header" id="flush-heading1">
        <a href="index.html">Summary and Schedule</a>
    </div><!--/div.accordion-header-->

  </div><!--/div.accordion-item-->
</div><!--/div.accordion-flush-->

<div class="accordion accordion-flush" id="accordionFlush2">
  <div class="accordion-item">
    <div class="accordion-header" id="flush-heading2">
        <a href="00-setting-the-scene.html">Setting the Scene</a>
    </div><!--/div.accordion-header-->

  </div><!--/div.accordion-item-->
</div><!--/div.accordion-flush-->

<div class="accordion accordion-flush" id="accordionFlush3">
  <div class="accordion-item">
    <div class="accordion-header" id="flush-heading3">
        <a href="10-section1-intro.html">Section 1: Setting Up Environment For Collaborative Code Development</a>
    </div><!--/div.accordion-header-->

  </div><!--/div.accordion-item-->
</div><!--/div.accordion-flush-->

<div class="accordion accordion-flush" id="accordionFlush4">
  <div class="accordion-item">
    <div class="accordion-header" id="flush-heading4">
        <a href="11-software-project.html">1.1 Introduction to Our Software Project</a>
    </div><!--/div.accordion-header-->

  </div><!--/div.accordion-item-->
</div><!--/div.accordion-flush-->

<div class="accordion accordion-flush" id="accordionFlush5">
  <div class="accordion-item">
    <div class="accordion-header" id="flush-heading5">
        <a href="12-virtual-environments.html">1.2 Virtual Environments For Software Development</a>
    </div><!--/div.accordion-header-->

  </div><!--/div.accordion-item-->
</div><!--/div.accordion-flush-->

<div class="accordion accordion-flush" id="accordionFlush6">
  <div class="accordion-item">
    <div class="accordion-header" id="flush-heading6">
        <a href="13-ides.html">1.3 Integrated Software Development Environments</a>
    </div><!--/div.accordion-header-->

  </div><!--/div.accordion-item-->
</div><!--/div.accordion-flush-->

<div class="accordion accordion-flush" id="accordionFlush7">
  <div class="accordion-item">
    <div class="accordion-header" id="flush-heading7">
        <a href="14-collaboration-using-git.html">1.4 Software Development Using Git and GitHub</a>
    </div><!--/div.accordion-header-->

  </div><!--/div.accordion-item-->
</div><!--/div.accordion-flush-->

<div class="accordion accordion-flush" id="accordionFlush8">
  <div class="accordion-item">
    <div class="accordion-header" id="flush-heading8">
        <a href="15-coding-conventions.html">1.5 Python Code Style Conventions</a>
    </div><!--/div.accordion-header-->

  </div><!--/div.accordion-item-->
</div><!--/div.accordion-flush-->

<div class="accordion accordion-flush" id="accordionFlush9">
  <div class="accordion-item">
    <div class="accordion-header" id="flush-heading9">
        <a href="16-verifying-code-style-linters.html">1.6 Verifying Code Style Using Linters</a>
    </div><!--/div.accordion-header-->

  </div><!--/div.accordion-item-->
</div><!--/div.accordion-flush-->

<div class="accordion accordion-flush" id="accordionFlush10">
  <div class="accordion-item">
    <div class="accordion-header" id="flush-heading10">
        <a href="17-section1-optional-exercises.html">1.7 Optional Exercises</a>
    </div><!--/div.accordion-header-->

  </div><!--/div.accordion-item-->
</div><!--/div.accordion-flush-->

<div class="accordion accordion-flush" id="accordionFlush11">
  <div class="accordion-item">
    <div class="accordion-header" id="flush-heading11">
        <a href="20-section2-intro.html">Section 2: Ensuring Correctness of Software at Scale</a>
    </div><!--/div.accordion-header-->

  </div><!--/div.accordion-item-->
</div><!--/div.accordion-flush-->

<div class="accordion accordion-flush" id="accordionFlush12">
  <div class="accordion-item">
    <div class="accordion-header" id="flush-heading12">
        <a href="21-automatically-testing-software.html">2.1 Automatically Testing Software</a>
    </div><!--/div.accordion-header-->

  </div><!--/div.accordion-item-->
</div><!--/div.accordion-flush-->

<div class="accordion accordion-flush" id="accordionFlush13">
  <div class="accordion-item">
    <div class="accordion-header" id="flush-heading13">
        <a href="22-scaling-up-unit-testing.html">2.2 Scaling Up Unit Testing</a>
    </div><!--/div.accordion-header-->

  </div><!--/div.accordion-item-->
</div><!--/div.accordion-flush-->

<div class="accordion accordion-flush" id="accordionFlush14">
  <div class="accordion-item">
    <div class="accordion-header" id="flush-heading14">
        <a href="23-continuous-integration-automated-testing.html">2.3 Continuous Integration for Automated Testing</a>
    </div><!--/div.accordion-header-->

  </div><!--/div.accordion-item-->
</div><!--/div.accordion-flush-->

<div class="accordion accordion-flush" id="accordionFlush15">
  <div class="accordion-item">
    <div class="accordion-header" id="flush-heading15">
        <a href="24-diagnosing-issues-improving-robustness.html">2.4 Diagnosing Issues and Improving Robustness</a>
    </div><!--/div.accordion-header-->

  </div><!--/div.accordion-item-->
</div><!--/div.accordion-flush-->

<div class="accordion accordion-flush" id="accordionFlush16">
  <div class="accordion-item">
    <div class="accordion-header" id="flush-heading16">
        <a href="25-section2-optional-exercises.html">2.5 Optional Exercises for Section 2</a>
    </div><!--/div.accordion-header-->

  </div><!--/div.accordion-item-->
</div><!--/div.accordion-flush-->

<div class="accordion accordion-flush" id="accordionFlush17">
  <div class="accordion-item">
    <div class="accordion-header" id="flush-heading17">
        <a href="30-section3-intro.html">Section 3: Software Development as a Process</a>
    </div><!--/div.accordion-header-->

  </div><!--/div.accordion-item-->
</div><!--/div.accordion-flush-->

<div class="accordion accordion-flush" id="accordionFlush18">
  <div class="accordion-item">
    <div class="accordion-header" id="flush-heading18">
        <a href="31-software-requirements.html">3.1 Software Requirements</a>
    </div><!--/div.accordion-header-->

  </div><!--/div.accordion-item-->
</div><!--/div.accordion-flush-->

<div class="accordion accordion-flush" id="accordionFlush19">
  <div class="accordion-item">
    <div class="accordion-header" id="flush-heading19">
        <a href="32-software-architecture-design.html">3.2 Software Architecture and Design</a>
    </div><!--/div.accordion-header-->

  </div><!--/div.accordion-item-->
</div><!--/div.accordion-flush-->

<div class="accordion accordion-flush" id="accordionFlushcurrent">
  <div class="accordion-item">
    <div class="accordion-header" id="flush-headingcurrent">
      <button class="accordion-button" type="button" data-bs-toggle="collapse" data-bs-target="#flush-collapsecurrent" aria-expanded="true" aria-controls="flush-collapsecurrent">
        <span class="visually-hidden">Current Chapter</span>
        <span class="current-chapter">
        3.3 Code Decoupling &amp; Abstractions
        </span>
      </button>
    </div><!--/div.accordion-header-->

    <div id="flush-collapsecurrent" class="accordion-collapse collapse show" aria-labelledby="flush-headingcurrent" data-bs-parent="#accordionFlushcurrent">
      <div class="accordion-body">
        <ul><li><a href="#introduction">Introduction</a></li>
<li><a href="#encapsulation-classes">Encapsulation &amp; Classes</a></li>
<li><a href="#interfaces">Interfaces</a></li>
<li><a href="#polymorphism">Polymorphism</a></li>
<li><a href="#testing-using-mock-objects">Testing Using Mock Objects</a></li>
<li><a href="#safe-code-structure-changes">Safe Code Structure Changes</a></li>
        </ul></div><!--/div.accordion-body-->
    </div><!--/div.accordion-collapse-->

  </div><!--/div.accordion-item-->
</div><!--/div.accordion-flush-->

<div class="accordion accordion-flush" id="accordionFlush21">
  <div class="accordion-item">
    <div class="accordion-header" id="flush-heading21">
        <a href="34-code-refactoring.html">3.4 Code Refactoring</a>
    </div><!--/div.accordion-header-->

  </div><!--/div.accordion-item-->
</div><!--/div.accordion-flush-->

<div class="accordion accordion-flush" id="accordionFlush22">
  <div class="accordion-item">
    <div class="accordion-header" id="flush-heading22">
        <a href="35-software-architecture-revisited.html">3.5 Software Architecture Revisited</a>
    </div><!--/div.accordion-header-->

  </div><!--/div.accordion-item-->
</div><!--/div.accordion-flush-->

<div class="accordion accordion-flush" id="accordionFlush23">
  <div class="accordion-item">
    <div class="accordion-header" id="flush-heading23">
        <a href="40-section4-intro.html">Section 4: Collaborative Software Development for Reuse</a>
    </div><!--/div.accordion-header-->

  </div><!--/div.accordion-item-->
</div><!--/div.accordion-flush-->

<div class="accordion accordion-flush" id="accordionFlush24">
  <div class="accordion-item">
    <div class="accordion-header" id="flush-heading24">
        <a href="41-code-review.html">4.1 Developing Software In a Team: Code Review</a>
    </div><!--/div.accordion-header-->

  </div><!--/div.accordion-item-->
</div><!--/div.accordion-flush-->

<div class="accordion accordion-flush" id="accordionFlush25">
  <div class="accordion-item">
    <div class="accordion-header" id="flush-heading25">
        <a href="42-software-reuse.html">4.2 Preparing Software for Reuse and Release</a>
    </div><!--/div.accordion-header-->

  </div><!--/div.accordion-item-->
</div><!--/div.accordion-flush-->

<div class="accordion accordion-flush" id="accordionFlush26">
  <div class="accordion-item">
    <div class="accordion-header" id="flush-heading26">
        <a href="43-software-release.html">4.3 Packaging Code for Release and Distribution</a>
    </div><!--/div.accordion-header-->

  </div><!--/div.accordion-item-->
</div><!--/div.accordion-flush-->

<div class="accordion accordion-flush" id="accordionFlush27">
  <div class="accordion-item">
    <div class="accordion-header" id="flush-heading27">
        <a href="50-section5-intro.html">Section 5: Managing and Improving Software Over Its Lifetime</a>
    </div><!--/div.accordion-header-->

  </div><!--/div.accordion-item-->
</div><!--/div.accordion-flush-->

<div class="accordion accordion-flush" id="accordionFlush28">
  <div class="accordion-item">
    <div class="accordion-header" id="flush-heading28">
        <a href="51-managing-software.html">5.1 Managing a Collaborative Software Project</a>
    </div><!--/div.accordion-header-->

  </div><!--/div.accordion-item-->
</div><!--/div.accordion-flush-->

<div class="accordion accordion-flush" id="accordionFlush29">
  <div class="accordion-item">
    <div class="accordion-header" id="flush-heading29">
        <a href="52-assessing-software-suitability-improvement.html">5.2 Assessing Software for Suitability and Improvement</a>
    </div><!--/div.accordion-header-->

  </div><!--/div.accordion-item-->
</div><!--/div.accordion-flush-->

<div class="accordion accordion-flush" id="accordionFlush30">
  <div class="accordion-item">
    <div class="accordion-header" id="flush-heading30">
        <a href="53-improvement-through-feedback.html">5.3 Software Improvement Through Feedback</a>
    </div><!--/div.accordion-header-->

  </div><!--/div.accordion-item-->
</div><!--/div.accordion-flush-->

<div class="accordion accordion-flush" id="accordionFlush31">
  <div class="accordion-item">
    <div class="accordion-header" id="flush-heading31">
        <a href="60-wrap-up.html">Wrap-up</a>
    </div><!--/div.accordion-header-->

  </div><!--/div.accordion-item-->
</div><!--/div.accordion-flush-->

                </div>
              </div>
            </div>

            <hr class="half-width"><div class="accordion accordion-flush lesson-resources" id="accordionFlush12">
              <div class="accordion-item">
                <h2 class="accordion-header" id="flush-headingTwelve">
                  <button class="accordion-button collapsed" id="lesson-resources" type="button" data-bs-toggle="collapse" data-bs-target="#flush-collapseTwelve" aria-expanded="false" aria-controls="flush-collapseTwelve">
                    RESOURCES
                  </button>
                </h2>
                <div id="flush-collapseTwelve" class="accordion-collapse collapse" aria-labelledby="flush-headingTwelve" data-bs-parent="#accordionFlush12">
                  <div class="accordion-body">
                    <ul><li>
                        <a href="../instructor/key-points.html">Key Points</a>
                      </li>
                      <li>
                        <a href="../instructor/instructor-notes.html">Instructor Notes</a>
                      </li>
                      <li>
                        <a href="../instructor/images.html">Extract All Images</a>
                      </li>
                      <hr><li><a class="dropdown-item" href="quiz.html">Quiz</a></li><li><a class="dropdown-item" href="installation-instructions.html">Installation Instructions</a></li><li><a class="dropdown-item" href="common-issues.html">Common Issues, Fixes &amp; Tips</a></li><li><a class="dropdown-item" href="software-architecture-extra.html">Extra Content: Software Architecture</a></li><li><a class="dropdown-item" href="programming-paradigms.html">Extra Content: Programming Paradigms</a></li><li><a class="dropdown-item" href="procedural-programming.html">Extra Content: Procedural Programming</a></li><li><a class="dropdown-item" href="functional-programming.html">Extra Content: Functional Programming</a></li><li><a class="dropdown-item" href="object-oriented-programming.html">Extra Content: Object Oriented Programming</a></li><li><a class="dropdown-item" href="persistence.html">Extra Content: Persistence</a></li><li><a class="dropdown-item" href="databases.html">Extra Content: Databases</a></li><li><a class="dropdown-item" href="vscode.html">Extra Content: Using Microsoft Visual Studio Code</a></li><li><a class="dropdown-item" href="reference.html">Reference</a></li>
                    </ul></div>
                </div>
              </div>
            </div>
            <hr class="half-width lesson-resources"><a href="../instructor/aio.html">See all in one page</a>


            <hr class="d-none d-sm-block d-md-none"><div class="d-grid gap-1">

            </div>
          </div><!-- /div.accordion -->
        </div><!-- /div.sidebar-inner -->
      </nav></div><!-- /div.sidebar -->
  </div><!-- /div.sidebar-col -->
<!-- END:   inst/pkgdown/templates/navbar.html-->

        <!-- START: inst/pkgdown/templates/content-instructor.html -->
  <div class="col-xl-8 col-lg-12 primary-content">
    <nav class="lesson-content mx-md-4" aria-label="Previous and Next Chapter"><!-- content for small screens --><div class="d-block d-sm-block d-md-none">
        <a class="chapter-link" href="../instructor/32-software-architecture-design.html"><i aria-hidden="true" class="small-arrow" data-feather="arrow-left"></i>Previous</a>
        <a class="chapter-link float-end" href="../instructor/34-code-refactoring.html">Next<i aria-hidden="true" class="small-arrow" data-feather="arrow-right"></i></a>
      </div>
      <!-- content for large screens -->
      <div class="d-none d-sm-none d-md-block">
        <a class="chapter-link" href="../instructor/32-software-architecture-design.html" rel="prev">
          <i aria-hidden="true" class="small-arrow" data-feather="arrow-left"></i>
          Previous: 3.2 Software
        </a>
        <a class="chapter-link float-end" href="../instructor/34-code-refactoring.html" rel="next">
          Next: 3.4 Code Refactoring...
          <i aria-hidden="true" class="small-arrow" data-feather="arrow-right"></i>
        </a>
      </div>
      <hr></nav><main id="main-content" class="main-content"><div class="container lesson-content">
        <h1>3.3 Code Decoupling &amp; Abstractions</h1>
        <p>Last updated on 2025-03-10 |

        <a href="https://github.com/carpentries-incubator/python-intermediate-development/edit/main/episodes/33-code-decoupling-abstractions.md" class="external-link">Edit this page <i aria-hidden="true" data-feather="edit"></i></a></p>



        <p>Estimated time: <i aria-hidden="true" data-feather="clock"></i> 75 minutes</p>

        <div class="text-end">
          <button role="button" aria-pressed="false" tabindex="0" id="expand-code" class="pull-right" data-expand="Expand All Solutions " data-collapse="Collapse All Solutions "> Expand All Solutions <i aria-hidden="true" data-feather="plus"></i></button>
        </div>

        

<div class="overview card">
<h2 class="card-header">Overview</h2>
<div class="row g-0">
<div class="col-md-4">
<div class="card-body">
<div class="inner">
<h3 class="card-title">Questions</h3>
<ul><li>What is decoupled code?</li>
<li>What are commonly used code abstractions?</li>
<li>When is it useful to use classes to structure code?</li>
<li>How can we make sure the components of our software are
reusable?</li>
</ul></div>
</div>
</div>
<div class="col-md-8">
<div class="card-body">
<div class="inner bordered">
<h3 class="card-title">Objectives</h3>
<ul><li>Understand the benefits of code decoupling.</li>
<li>Introduce appropriate abstractions to simplify code.</li>
<li>Understand the principles of encapsulation, polymorphism and
interfaces.</li>
<li>Use mocks to replace a class in test code.</li>
</ul></div>
</div>
</div>
</div>
</div>
<section><h2 class="section-heading" id="introduction">Introduction<a class="anchor" aria-label="anchor" href="#introduction"></a></h2>
<hr class="half-width"><p><strong>Code decoupling</strong> refers to breaking up the software
into smaller components and reducing the interdependence between these
components so that they can be tested and maintained independently. Two
components of code can be considered <em>decoupled</em> if a change in
one does not necessitate a change in the other. While two connected
units cannot always be totally decoupled, <em>loose coupling</em> is
something we should aim for.</p>
<p><strong>Code abstraction</strong> is the process of hiding the
implementation details of a piece of code behind an interface - i.e. the
details of <em>how</em> something works are hidden away, leaving us to
deal only with <em>what</em> it does. This allows developers to work
with the code at a higher level of abstraction, without needing to
understand fully (or keep in mind) all the underlying details and
thereby reducing the cognitive load when programming.</p>
<p>Abstractions can aid decoupling of code. If one part of the code only
uses another part through an appropriate abstraction then it becomes
easier for these parts to change independently. Benefits of using these
techniques include having the codebase that is:</p>
<ul><li>easier to read as you only need to understand the details of the
(smaller) component you are looking at and not the whole monolithic
codebase.</li>
<li>easier to test, as one of the components can be replaced by a test
or a mock version of it.</li>
<li>easier to maintain, as changes can be isolated from other parts of
the code.</li>
</ul><p>Let us start redesigning our code by introducing some of the
abstraction techniques to incrementally decouple it into smaller
components to improve its overall design.</p>
<p>In the code from our current branch <code>full-data-analysis</code>,
you may have noticed that loading data from CSV files from a
<code>data</code> directory is “hardcoded” into the
<code>analyse_data()</code> function. Data loading is a functionality
separate from data analysis, so firstly let us decouple the data loading
part into a separate component (function).</p>
<div id="exercise-decouple-data-loading-from-data-analysis" class="callout challenge">
<div class="callout-square">
<i class="callout-icon" data-feather="zap"></i>
</div>
<div id="exercise-decouple-data-loading-from-data-analysis" class="callout-inner">
<h3 class="callout-title">Exercise: Decouple Data Loading from Data Analysis</h3>
<div class="callout-content">
<p>Modify <code>compute_data.py</code> to separate out the data loading
functionality from <code>analyse_data()</code> into a new function
<code>load_inflammation_data()</code>, that returns a list of 2D NumPy
arrays with inflammation data loaded from all inflammation CSV files
found in a specified directory path. Then, change your
<code>analyse_data()</code> function to make use of this new function
instead.</p>
</div>
</div>
</div>
<div id="accordionSolution1" class="accordion challenge-accordion accordion-flush">
<div class="accordion-item">
<button class="accordion-button solution-button collapsed" type="button" data-bs-toggle="collapse" data-bs-target="#collapseSolution1" aria-expanded="false" aria-controls="collapseSolution1">
  <h4 class="accordion-header" id="headingSolution1"> Show me the solution </h4>
</button>
<div id="collapseSolution1" class="accordion-collapse collapse" data-bs-parent="#accordionSolution1" aria-labelledby="headingSolution1">
<div class="accordion-body">
<p>The new function <code>load_inflammation_data()</code> that reads all
the inflammation data into the format needed for the analysis could look
something like: .</p>
<div class="codewrapper sourceCode" id="cb1">
<h3 class="code-label">PYTHON<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="sourceCode python" tabindex="0"><code class="sourceCode python"><span id="cb1-1"><a href="#cb1-1" tabindex="-1"></a><span class="kw">def</span> load_inflammation_data(dir_path):</span>
<span id="cb1-2"><a href="#cb1-2" tabindex="-1"></a>    data_file_paths <span class="op">=</span> glob.glob(os.path.join(dir_path, <span class="st">'inflammation*.csv'</span>))</span>
<span id="cb1-3"><a href="#cb1-3" tabindex="-1"></a>    <span class="cf">if</span> <span class="bu">len</span>(data_file_paths) <span class="op">==</span> <span class="dv">0</span>:</span>
<span id="cb1-4"><a href="#cb1-4" tabindex="-1"></a>        <span class="cf">raise</span> <span class="pp">ValueError</span>(<span class="ss">f"No inflammation CSV files found in path </span><span class="sc">{</span>dir_path<span class="sc">}</span><span class="ss">"</span>)</span>
<span id="cb1-5"><a href="#cb1-5" tabindex="-1"></a>    data <span class="op">=</span> <span class="bu">map</span>(models.load_csv, data_file_paths) <span class="co"># Load inflammation data from each CSV file</span></span>
<span id="cb1-6"><a href="#cb1-6" tabindex="-1"></a>    <span class="cf">return</span> <span class="bu">list</span>(data) <span class="co"># Return the list of 2D NumPy arrays with inflammation data</span></span></code></pre>
</div>
<p>The new function <code>analyse_data()</code> could then look
like:</p>
<div class="codewrapper sourceCode" id="cb2">
<h3 class="code-label">PYTHON<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="sourceCode python" tabindex="0"><code class="sourceCode python"><span id="cb2-1"><a href="#cb2-1" tabindex="-1"></a><span class="kw">def</span> analyse_data(data_dir):</span>
<span id="cb2-2"><a href="#cb2-2" tabindex="-1"></a>    data <span class="op">=</span> load_inflammation_data(data_dir)</span>
<span id="cb2-3"><a href="#cb2-3" tabindex="-1"></a></span>
<span id="cb2-4"><a href="#cb2-4" tabindex="-1"></a>    means_by_day <span class="op">=</span> <span class="bu">map</span>(models.daily_mean, data)</span>
<span id="cb2-5"><a href="#cb2-5" tabindex="-1"></a>    means_by_day_matrix <span class="op">=</span> np.stack(<span class="bu">list</span>(means_by_day))</span>
<span id="cb2-6"><a href="#cb2-6" tabindex="-1"></a></span>
<span id="cb2-7"><a href="#cb2-7" tabindex="-1"></a>    daily_standard_deviation <span class="op">=</span> np.std(means_by_day_matrix, axis<span class="op">=</span><span class="dv">0</span>)</span>
<span id="cb2-8"><a href="#cb2-8" tabindex="-1"></a></span>
<span id="cb2-9"><a href="#cb2-9" tabindex="-1"></a>    graph_data <span class="op">=</span> {</span>
<span id="cb2-10"><a href="#cb2-10" tabindex="-1"></a>        <span class="st">'standard deviation by day'</span>: daily_standard_deviation,</span>
<span id="cb2-11"><a href="#cb2-11" tabindex="-1"></a>    }</span>
<span id="cb2-12"><a href="#cb2-12" tabindex="-1"></a>    views.visualize(graph_data)</span></code></pre>
</div>
<p>The code is now easier to follow since we do not need to understand
the data loading part to understand the statistical analysis part, and
vice versa. In most cases, functions work best when they are short!</p>
</div>
</div>
</div>
</div>
<p>However, even with this change, the data loading is still coupled
with the data analysis to a large extent. For example, if we have to
support loading data from different sources (e.g. JSON files or an SQL
database), we would have to pass some kind of a flag into
<code>analyse_data()</code> indicating the type of data we want to read
from. Instead, we would like to decouple the consideration of data
source from the <code>analyse_data()</code> function entirely. One way
we can do this is by using <em>encapsulation</em> and
<em>classes</em>.</p>
</section><section><h2 class="section-heading" id="encapsulation-classes">Encapsulation &amp; Classes<a class="anchor" aria-label="anchor" href="#encapsulation-classes"></a></h2>
<hr class="half-width"><p><strong>Encapsulation</strong> is the process of packing the “data”
and “functions operating on that data” into a single component/object.
It is also provides a mechanism for restricting the access to that data.
Encapsulation means that the internal representation of a component is
generally hidden from view outside of the component’s definition.</p>
<p>Encapsulation allows developers to present a consistent interface to
the component/object that is independent of its internal implementation.
For example, encapsulation can be used to hide the values or state of a
structured data object inside a <strong>class</strong>, preventing
direct access to them that could violate the object’s state maintained
by the class’ methods. Note that object-oriented programming (OOP)
languages support encapsulation, but encapsulation is not unique to
OOP.</p>
<p>So, a class is a way of grouping together data with some methods that
manipulate that data. In Python, you can <em>declare</em> a class as
follows:</p>
<div class="codewrapper sourceCode" id="cb3">
<h3 class="code-label">PYTHON<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="sourceCode python" tabindex="0"><code class="sourceCode python"><span id="cb3-1"><a href="#cb3-1" tabindex="-1"></a><span class="kw">class</span> Circle:</span>
<span id="cb3-2"><a href="#cb3-2" tabindex="-1"></a>  <span class="cf">pass</span></span></code></pre>
</div>
<p>Classes are typically named using “CapitalisedWords” naming
convention - e.g. FileReader, OutputStream, Rectangle.</p>
<p>You can <em>construct</em> an <em>instance</em> of a class elsewhere
in the code by doing the following:</p>
<div class="codewrapper sourceCode" id="cb4">
<h3 class="code-label">PYTHON<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="sourceCode python" tabindex="0"><code class="sourceCode python"><span id="cb4-1"><a href="#cb4-1" tabindex="-1"></a>my_circle <span class="op">=</span> Circle()</span></code></pre>
</div>
<p>When you construct a class in this ways, the class’
<em>constructor</em> method is called. It is also possible to pass
values to the constructor in order to configure the class instance:</p>
<div class="codewrapper sourceCode" id="cb5">
<h3 class="code-label">PYTHON<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="sourceCode python" tabindex="0"><code class="sourceCode python"><span id="cb5-1"><a href="#cb5-1" tabindex="-1"></a><span class="kw">class</span> Circle:</span>
<span id="cb5-2"><a href="#cb5-2" tabindex="-1"></a>  <span class="kw">def</span> <span class="fu">__init__</span>(<span class="va">self</span>, radius):</span>
<span id="cb5-3"><a href="#cb5-3" tabindex="-1"></a>    <span class="va">self</span>.radius <span class="op">=</span> radius</span>
<span id="cb5-4"><a href="#cb5-4" tabindex="-1"></a></span>
<span id="cb5-5"><a href="#cb5-5" tabindex="-1"></a>my_circle <span class="op">=</span> Circle(<span class="dv">10</span>)</span></code></pre>
</div>
<p>The constructor has the special name <code>__init__</code>. Note it
has a special first parameter called <code>self</code> by convention -
it is used to access the current <em>instance</em> of the object being
created.</p>
<p>A class can be thought of as a cookie cutter template, and instances
as the cookies themselves. That is, one class can have many
instances.</p>
<p>Classes can also have other methods defined on them. Like
constructors, they have the special parameter <code>self</code> that
must come first.</p>
<div class="codewrapper sourceCode" id="cb6">
<h3 class="code-label">PYTHON<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="sourceCode python" tabindex="0"><code class="sourceCode python"><span id="cb6-1"><a href="#cb6-1" tabindex="-1"></a><span class="im">import</span> math</span>
<span id="cb6-2"><a href="#cb6-2" tabindex="-1"></a></span>
<span id="cb6-3"><a href="#cb6-3" tabindex="-1"></a><span class="kw">class</span> Circle:</span>
<span id="cb6-4"><a href="#cb6-4" tabindex="-1"></a>  ...</span>
<span id="cb6-5"><a href="#cb6-5" tabindex="-1"></a>  <span class="kw">def</span> get_area(<span class="va">self</span>):</span>
<span id="cb6-6"><a href="#cb6-6" tabindex="-1"></a>    <span class="cf">return</span> math.pi <span class="op">*</span> <span class="va">self</span>.radius <span class="op">*</span> <span class="va">self</span>.radius</span>
<span id="cb6-7"><a href="#cb6-7" tabindex="-1"></a>...</span>
<span id="cb6-8"><a href="#cb6-8" tabindex="-1"></a><span class="bu">print</span>(my_circle.get_area())</span></code></pre>
</div>
<p>On the last line of the code above, the instance of the class,
<code>my_circle</code>, will be automatically passed as the first
parameter (<code>self</code>) when calling the <code>get_area()</code>
method. The <code>get_area()</code> method can then access the variable
<code>radius</code> encapsulated within the object, which is otherwise
invisible to the world outside of the object. The method
<code>get_area()</code> itself can also be accessed via the
object/instance only.</p>
<p>As we can see, internal representation of any instance of class
<code>Circle</code> is hidden outside of this class (encapsulation). In
addition, implementation of the method <code>get_area()</code> is hidden
too (abstraction).</p>
<div id="encapsulation-abstraction" class="callout">
<div class="callout-square">
<i class="callout-icon" data-feather="bell"></i>
</div>
<div id="encapsulation-abstraction" class="callout-inner">
<h3 class="callout-title">Encapsulation &amp; Abstraction</h3>
<div class="callout-content">
<p>Encapsulation provides <strong>information hiding</strong>.
Abstraction provides <strong>implementation hiding</strong>.</p>
</div>
</div>
</div>
<div id="exercise-use-classes-to-abstract-out-data-loading" class="callout challenge">
<div class="callout-square">
<i class="callout-icon" data-feather="zap"></i>
</div>
<div id="exercise-use-classes-to-abstract-out-data-loading" class="callout-inner">
<h3 class="callout-title">Exercise: Use Classes to Abstract out Data Loading</h3>
<div class="callout-content">
<p>Inside <code>compute_data.py</code>, declare a new class
<code>CSVDataSource</code> that contains the
<code>load_inflammation_data()</code> function we wrote in the previous
exercise as a method of this class. The directory path where to load the
files from should be passed in the class’ constructor method. Finally,
construct an instance of the class <code>CSVDataSource</code> outside
the statistical analysis and pass it to <code>analyse_data()</code>
function.</p>
<blockquote>
<h2 id="hint">Hint</h2>
<p>At the end of this exercise, the code in the
<code>analyse_data()</code> function should look like:</p>
<div class="codewrapper sourceCode" id="cb7">
<h3 class="code-label">PYTHON<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="sourceCode python" tabindex="0"><code class="sourceCode python"><span id="cb7-1"><a href="#cb7-1" tabindex="-1"></a><span class="kw">def</span> analyse_data(data_source):</span>
<span id="cb7-2"><a href="#cb7-2" tabindex="-1"></a>    data <span class="op">=</span> data_source.load_inflammation_data()</span>
<span id="cb7-3"><a href="#cb7-3" tabindex="-1"></a>    ...</span></code></pre>
</div>
<p>The controller code should look like:</p>
<div class="codewrapper sourceCode" id="cb8">
<h3 class="code-label">PYTHON<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="sourceCode python" tabindex="0"><code class="sourceCode python"><span id="cb8-1"><a href="#cb8-1" tabindex="-1"></a>data_source <span class="op">=</span> CSVDataSource(os.path.dirname(infiles[<span class="dv">0</span>]))</span>
<span id="cb8-2"><a href="#cb8-2" tabindex="-1"></a>analyse_data(data_source)</span></code></pre>
</div>
</blockquote>
</div>
</div>
</div>
<div id="accordionSolution2" class="accordion challenge-accordion accordion-flush">
<div class="accordion-item">
<button class="accordion-button solution-button collapsed" type="button" data-bs-toggle="collapse" data-bs-target="#collapseSolution2" aria-expanded="false" aria-controls="collapseSolution2">
  <h4 class="accordion-header" id="headingSolution2"> Show me the solution </h4>
</button>
<div id="collapseSolution2" class="accordion-collapse collapse" data-bs-parent="#accordionSolution2" aria-labelledby="headingSolution2">
<div class="accordion-body">
<p>For example, we can declare class <code>CSVDataSource</code> like
this:</p>
<div class="codewrapper sourceCode" id="cb9">
<h3 class="code-label">PYTHON<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="sourceCode python" tabindex="0"><code class="sourceCode python"><span id="cb9-1"><a href="#cb9-1" tabindex="-1"></a><span class="kw">class</span> CSVDataSource:</span>
<span id="cb9-2"><a href="#cb9-2" tabindex="-1"></a>    <span class="co">"""</span></span>
<span id="cb9-3"><a href="#cb9-3" tabindex="-1"></a><span class="co">    Loads all the inflammation CSV files within a specified directory.</span></span>
<span id="cb9-4"><a href="#cb9-4" tabindex="-1"></a><span class="co">    """</span></span>
<span id="cb9-5"><a href="#cb9-5" tabindex="-1"></a>    <span class="kw">def</span> <span class="fu">__init__</span>(<span class="va">self</span>, dir_path):</span>
<span id="cb9-6"><a href="#cb9-6" tabindex="-1"></a>        <span class="va">self</span>.dir_path <span class="op">=</span> dir_path</span>
<span id="cb9-7"><a href="#cb9-7" tabindex="-1"></a></span>
<span id="cb9-8"><a href="#cb9-8" tabindex="-1"></a>    <span class="kw">def</span> load_inflammation_data(<span class="va">self</span>):</span>
<span id="cb9-9"><a href="#cb9-9" tabindex="-1"></a>        data_file_paths <span class="op">=</span> glob.glob(os.path.join(<span class="va">self</span>.dir_path, <span class="st">'inflammation*.csv'</span>))</span>
<span id="cb9-10"><a href="#cb9-10" tabindex="-1"></a>        <span class="cf">if</span> <span class="bu">len</span>(data_file_paths) <span class="op">==</span> <span class="dv">0</span>:</span>
<span id="cb9-11"><a href="#cb9-11" tabindex="-1"></a>            <span class="cf">raise</span> <span class="pp">ValueError</span>(<span class="ss">f"No inflammation CSV files found in path </span><span class="sc">{</span><span class="va">self</span><span class="sc">.</span>dir_path<span class="sc">}</span><span class="ss">"</span>)</span>
<span id="cb9-12"><a href="#cb9-12" tabindex="-1"></a>        data <span class="op">=</span> <span class="bu">map</span>(models.load_csv, data_file_paths)</span>
<span id="cb9-13"><a href="#cb9-13" tabindex="-1"></a>        <span class="cf">return</span> <span class="bu">list</span>(data)</span></code></pre>
</div>
<p>In the controller, we create an instance of CSVDataSource and pass it
into the the statistical analysis function.</p>
<div class="codewrapper sourceCode" id="cb10">
<h3 class="code-label">PYTHON<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="sourceCode python" tabindex="0"><code class="sourceCode python"><span id="cb10-1"><a href="#cb10-1" tabindex="-1"></a>data_source <span class="op">=</span> CSVDataSource(os.path.dirname(infiles[<span class="dv">0</span>]))</span>
<span id="cb10-2"><a href="#cb10-2" tabindex="-1"></a>analyse_data(data_source)</span></code></pre>
</div>
<p>The <code>analyse_data()</code> function is modified to receive any
data source object (that implements the
<code>load_inflammation_data()</code> method) as a parameter.</p>
<div class="codewrapper sourceCode" id="cb11">
<h3 class="code-label">PYTHON<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="sourceCode python" tabindex="0"><code class="sourceCode python"><span id="cb11-1"><a href="#cb11-1" tabindex="-1"></a><span class="kw">def</span> analyse_data(data_source):</span>
<span id="cb11-2"><a href="#cb11-2" tabindex="-1"></a>    data <span class="op">=</span> data_source.load_inflammation_data()</span>
<span id="cb11-3"><a href="#cb11-3" tabindex="-1"></a>    ...</span></code></pre>
</div>
<p>We have now fully decoupled the reading of the data from the
statistical analysis and the analysis is not fixed to reading from a
directory of CSV files. Indeed, we can pass various data sources to this
function now, as long as they implement the
<code>load_inflammation_data()</code> method.</p>
<p>While the overall behaviour of the code and its results are
unchanged, the way we invoke data analysis has changed.</p>
</div>
</div>
</div>
</div>
</section><section><h2 class="section-heading" id="interfaces">Interfaces<a class="anchor" aria-label="anchor" href="#interfaces"></a></h2>
<hr class="half-width"><p>An <strong>interface</strong> is another important concept in
software design related to abstraction and encapsulation. For a software
component, it declares the operations that can be invoked on that
component, along with input arguments and what it returns. By knowing
these details, we can communicate with this component without the need
to know how it implements this interface.</p>
<p>API (Application Programming Interface) is one example of an
interface that allows separate systems (external to one another) to
communicate with each other. For example, a request to Google Maps
service API may get you the latitude and longitude for a given address.
Twitter API may return all tweets that contain a given keyword that have
been posted within a certain date range.</p>
<p>Internal interfaces within software dictate how different parts of
the system interact with each other. Even when these are not explicitly
documented - they still exist.</p>
<p>For example, our <code>Circle</code> class implicitly has an
interface - you can call <code>get_area()</code> method on it and it
will return a number representing its surface area.</p>
<div id="exercise-identify-an-interface-between-csvdatasource-and-analyse_data" class="callout challenge">
<div class="callout-square">
<i class="callout-icon" data-feather="zap"></i>
</div>
<div id="exercise-identify-an-interface-between-csvdatasource-and-analyse_data" class="callout-inner">
<h3 class="callout-title">Exercise: Identify an Interface Between
<code>CSVDataSource</code> and <code>analyse_data</code>
</h3>
<div class="callout-content">
<p>What would you say is the interface between the CSVDataSource class
and <code>analyse_data()</code> function? Think about what functions
<code>analyse_data()</code> needs to be able to call to perform its
duty, what parameters they need and what they return.</p>
</div>
</div>
</div>
<div id="accordionSolution3" class="accordion challenge-accordion accordion-flush">
<div class="accordion-item">
<button class="accordion-button solution-button collapsed" type="button" data-bs-toggle="collapse" data-bs-target="#collapseSolution3" aria-expanded="false" aria-controls="collapseSolution3">
  <h4 class="accordion-header" id="headingSolution3"> Show me the solution </h4>
</button>
<div id="collapseSolution3" class="accordion-collapse collapse" data-bs-parent="#accordionSolution3" aria-labelledby="headingSolution3">
<div class="accordion-body">
<p>The interface is the <code>load_inflammation_data()</code> method,
which takes no parameters and returns a list where each entry is a 2D
NumPy array of patient inflammation data (read from some data
source).</p>
<p>Any object passed into <code>analyse_data()</code> should conform to
this interface.</p>
</div>
</div>
</div>
</div>
</section><section><h2 class="section-heading" id="polymorphism">Polymorphism<a class="anchor" aria-label="anchor" href="#polymorphism"></a></h2>
<hr class="half-width"><p>In general, <strong>polymorphism</strong> is the idea of having
multiple implementations/forms/shapes of the same abstract concept. It
is the provision of a single interface to entities of different types,
or the use of a single symbol to represent multiple different types.</p>
<p>There are <a href="https://www.bmc.com/blogs/polymorphism-programming/" class="external-link">different
versions of polymorphism</a>. For example, method or operator
overloading is one type of polymorphism enabling methods and operators
to take parameters of different types.</p>
<p>We will have a look at the <em>interface-based polymorphism</em>. In
OOP, it is possible to have different object classes that conform to the
same interface. For example, let us have a look at the following class
representing a <code>Rectangle</code>:</p>
<div class="codewrapper sourceCode" id="cb12">
<h3 class="code-label">PYTHON<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="sourceCode python" tabindex="0"><code class="sourceCode python"><span id="cb12-1"><a href="#cb12-1" tabindex="-1"></a><span class="kw">class</span> Rectangle:</span>
<span id="cb12-2"><a href="#cb12-2" tabindex="-1"></a>  <span class="kw">def</span> <span class="fu">__init__</span>(<span class="va">self</span>, width, height):</span>
<span id="cb12-3"><a href="#cb12-3" tabindex="-1"></a>    <span class="va">self</span>.width <span class="op">=</span> width</span>
<span id="cb12-4"><a href="#cb12-4" tabindex="-1"></a>    <span class="va">self</span>.height <span class="op">=</span> height</span>
<span id="cb12-5"><a href="#cb12-5" tabindex="-1"></a>  <span class="kw">def</span> get_area(<span class="va">self</span>):</span>
<span id="cb12-6"><a href="#cb12-6" tabindex="-1"></a>    <span class="cf">return</span> <span class="va">self</span>.width <span class="op">*</span> <span class="va">self</span>.height</span></code></pre>
</div>
<p>Like <code>Circle</code>, this class provides the
<code>get_area()</code> method. The method takes the same number of
parameters (none), and returns a number. However, the implementation is
different. This is interface-based polymorphism.</p>
<p>The word “polymorphism” means “many forms”, and in programming it
refers to methods/functions/operators with the same name that can be
executed on many objects or classes.</p>
<p>Using our <code>Circle</code> and <code>Rectangle</code> classes, we
can create a list of different shapes and iterate through the list to
find their total surface area as follows:</p>
<div class="codewrapper sourceCode" id="cb13">
<h3 class="code-label">PYTHON<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="sourceCode python" tabindex="0"><code class="sourceCode python"><span id="cb13-1"><a href="#cb13-1" tabindex="-1"></a>my_circle <span class="op">=</span> Circle(radius<span class="op">=</span><span class="dv">10</span>)</span>
<span id="cb13-2"><a href="#cb13-2" tabindex="-1"></a>my_rectangle <span class="op">=</span> Rectangle(width<span class="op">=</span><span class="dv">5</span>, height<span class="op">=</span><span class="dv">3</span>)</span>
<span id="cb13-3"><a href="#cb13-3" tabindex="-1"></a>my_shapes <span class="op">=</span> [my_circle, my_rectangle]</span>
<span id="cb13-4"><a href="#cb13-4" tabindex="-1"></a>total_area <span class="op">=</span> <span class="bu">sum</span>(shape.get_area() <span class="cf">for</span> shape <span class="kw">in</span> my_shapes)</span></code></pre>
</div>
<p>Note that we have not created a common superclass or linked the
classes <code>Circle</code> and <code>Rectangle</code> together in any
way. It is possible due to polymorphism. You could also say that, when
we are calculating the total surface area, the method for calculating
the area of each shape is abstracted away to the relevant class.</p>
<p>How can polymorphism be useful in our software project? For example,
we can replace our <code>CSVDataSource</code> with another class that
reads a totally different file format (e.g. JSON), or reads from an
external service or a database. All of these changes can be now be made
without changing the analysis function as we have decoupled the process
of data loading from the data analysis earlier. Conversely, if we wanted
to write a new analysis function, we could support any of these data
sources with no extra work.</p>
<div id="exercise-add-an-additional-datasource" class="callout challenge">
<div class="callout-square">
<i class="callout-icon" data-feather="zap"></i>
</div>
<div id="exercise-add-an-additional-datasource" class="callout-inner">
<h3 class="callout-title">Exercise: Add an Additional DataSource</h3>
<div class="callout-content">
<p>Create another class that supports loading patient data from JSON
files, with the appropriate <code>load_inflammation_data()</code>
method. Here is an example function that you can add to your
<code>models.py</code> file to load observations from a JSON file:</p>
<div class="codewrapper sourceCode" id="cb14">
<h3 class="code-label">PYTHON<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="sourceCode python" tabindex="0"><code class="sourceCode python"><span id="cb14-1"><a href="#cb14-1" tabindex="-1"></a><span class="kw">def</span> load_json(filename):</span>
<span id="cb14-2"><a href="#cb14-2" tabindex="-1"></a>    <span class="co">"""Load a numpy array from a JSON document.</span></span>
<span id="cb14-3"><a href="#cb14-3" tabindex="-1"></a><span class="co">    </span></span>
<span id="cb14-4"><a href="#cb14-4" tabindex="-1"></a><span class="co">    Expected format:</span></span>
<span id="cb14-5"><a href="#cb14-5" tabindex="-1"></a><span class="co">    [</span></span>
<span id="cb14-6"><a href="#cb14-6" tabindex="-1"></a><span class="co">      {</span></span>
<span id="cb14-7"><a href="#cb14-7" tabindex="-1"></a><span class="co">        "observations": [0, 1]</span></span>
<span id="cb14-8"><a href="#cb14-8" tabindex="-1"></a><span class="co">      },</span></span>
<span id="cb14-9"><a href="#cb14-9" tabindex="-1"></a><span class="co">      {</span></span>
<span id="cb14-10"><a href="#cb14-10" tabindex="-1"></a><span class="co">        "observations": [0, 2]</span></span>
<span id="cb14-11"><a href="#cb14-11" tabindex="-1"></a><span class="co">      }    </span></span>
<span id="cb14-12"><a href="#cb14-12" tabindex="-1"></a><span class="co">    ]</span></span>
<span id="cb14-13"><a href="#cb14-13" tabindex="-1"></a><span class="co">    :param filename: Filename of CSV to load</span></span>
<span id="cb14-14"><a href="#cb14-14" tabindex="-1"></a><span class="co">    """</span></span>
<span id="cb14-15"><a href="#cb14-15" tabindex="-1"></a>    <span class="cf">with</span> <span class="bu">open</span>(filename, <span class="st">'r'</span>, encoding<span class="op">=</span><span class="st">'utf-8'</span>) <span class="im">as</span> <span class="bu">file</span>:</span>
<span id="cb14-16"><a href="#cb14-16" tabindex="-1"></a>        data_as_json <span class="op">=</span> json.load(<span class="bu">file</span>)</span>
<span id="cb14-17"><a href="#cb14-17" tabindex="-1"></a>        <span class="cf">return</span> [np.array(entry[<span class="st">'observations'</span>]) <span class="cf">for</span> entry <span class="kw">in</span> data_as_json]</span></code></pre>
</div>
<p>Finally, at run-time, construct an appropriate data source instance
based on the file extension.</p>
</div>
</div>
</div>
<div id="accordionSolution4" class="accordion challenge-accordion accordion-flush">
<div class="accordion-item">
<button class="accordion-button solution-button collapsed" type="button" data-bs-toggle="collapse" data-bs-target="#collapseSolution4" aria-expanded="false" aria-controls="collapseSolution4">
  <h4 class="accordion-header" id="headingSolution4"> Show me the solution </h4>
</button>
<div id="collapseSolution4" class="accordion-collapse collapse" data-bs-parent="#accordionSolution4" aria-labelledby="headingSolution4">
<div class="accordion-body">
<p>The class that reads inflammation data from JSON files could look
something like:</p>
<div class="codewrapper sourceCode" id="cb15">
<h3 class="code-label">PYTHON<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="sourceCode python" tabindex="0"><code class="sourceCode python"><span id="cb15-1"><a href="#cb15-1" tabindex="-1"></a><span class="kw">class</span> JSONDataSource:</span>
<span id="cb15-2"><a href="#cb15-2" tabindex="-1"></a>  <span class="co">"""</span></span>
<span id="cb15-3"><a href="#cb15-3" tabindex="-1"></a><span class="co">  Loads patient data with inflammation values from JSON files within a specified folder.</span></span>
<span id="cb15-4"><a href="#cb15-4" tabindex="-1"></a><span class="co">  """</span></span>
<span id="cb15-5"><a href="#cb15-5" tabindex="-1"></a>  <span class="kw">def</span> <span class="fu">__init__</span>(<span class="va">self</span>, dir_path):</span>
<span id="cb15-6"><a href="#cb15-6" tabindex="-1"></a>    <span class="va">self</span>.dir_path <span class="op">=</span> dir_path</span>
<span id="cb15-7"><a href="#cb15-7" tabindex="-1"></a></span>
<span id="cb15-8"><a href="#cb15-8" tabindex="-1"></a>  <span class="kw">def</span> load_inflammation_data(<span class="va">self</span>):</span>
<span id="cb15-9"><a href="#cb15-9" tabindex="-1"></a>    data_file_paths <span class="op">=</span> glob.glob(os.path.join(<span class="va">self</span>.dir_path, <span class="st">'inflammation*.json'</span>))</span>
<span id="cb15-10"><a href="#cb15-10" tabindex="-1"></a>    <span class="cf">if</span> <span class="bu">len</span>(data_file_paths) <span class="op">==</span> <span class="dv">0</span>:</span>
<span id="cb15-11"><a href="#cb15-11" tabindex="-1"></a>      <span class="cf">raise</span> <span class="pp">ValueError</span>(<span class="ss">f"No inflammation JSON files found in path </span><span class="sc">{</span><span class="va">self</span><span class="sc">.</span>dir_path<span class="sc">}</span><span class="ss">"</span>)</span>
<span id="cb15-12"><a href="#cb15-12" tabindex="-1"></a>    data <span class="op">=</span> <span class="bu">map</span>(models.load_json, data_file_paths)</span>
<span id="cb15-13"><a href="#cb15-13" tabindex="-1"></a>    <span class="cf">return</span> <span class="bu">list</span>(data)</span></code></pre>
</div>
<p>Additionally, in the controller we will need to select an appropriate
DataSource instance to provide to the analysis:</p>
<div class="codewrapper sourceCode" id="cb16">
<h3 class="code-label">PYTHON<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="sourceCode python" tabindex="0"><code class="sourceCode python"><span id="cb16-1"><a href="#cb16-1" tabindex="-1"></a>_, extension <span class="op">=</span> os.path.splitext(infiles[<span class="dv">0</span>])</span>
<span id="cb16-2"><a href="#cb16-2" tabindex="-1"></a><span class="cf">if</span> extension <span class="op">==</span> <span class="st">'.json'</span>:</span>
<span id="cb16-3"><a href="#cb16-3" tabindex="-1"></a>  data_source <span class="op">=</span> JSONDataSource(os.path.dirname(infiles[<span class="dv">0</span>]))</span>
<span id="cb16-4"><a href="#cb16-4" tabindex="-1"></a><span class="cf">elif</span> extension <span class="op">==</span> <span class="st">'.csv'</span>:</span>
<span id="cb16-5"><a href="#cb16-5" tabindex="-1"></a>  data_source <span class="op">=</span> CSVDataSource(os.path.dirname(infiles[<span class="dv">0</span>]))</span>
<span id="cb16-6"><a href="#cb16-6" tabindex="-1"></a><span class="cf">else</span>:</span>
<span id="cb16-7"><a href="#cb16-7" tabindex="-1"></a>  <span class="cf">raise</span> <span class="pp">ValueError</span>(<span class="ss">f'Unsupported data file format: </span><span class="sc">{</span>extension<span class="sc">}</span><span class="ss">'</span>)</span>
<span id="cb16-8"><a href="#cb16-8" tabindex="-1"></a>analyse_data(data_source)</span></code></pre>
</div>
<p>As you can seen, all the above changes have been made made without
modifying the analysis code itself.</p>
</div>
</div>
</div>
</div>
</section><section><h2 class="section-heading" id="testing-using-mock-objects">Testing Using Mock Objects<a class="anchor" aria-label="anchor" href="#testing-using-mock-objects"></a></h2>
<hr class="half-width"><p>We can use a <strong>mock object</strong> abstraction to make testing
more straightforward. Instead of having our tests use real data stored
on a file system, we can provide a mock or dummy implementation instead
of one of the real classes. Providing that what we use as a substitute
conforms to the same interface, the code we are testing should work just
the same. Such mock/dummy implementation could just return some fixed
example data.</p>
<p>An convenient way to do this in Python is using Python’s <a href="https://docs.python.org/3/library/unittest.mock.html" class="external-link">mock object
library</a>. This is a whole topic in itself - but a basic mock can be
constructed using a couple of lines of code:</p>
<div class="codewrapper sourceCode" id="cb17">
<h3 class="code-label">PYTHON<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="sourceCode python" tabindex="0"><code class="sourceCode python"><span id="cb17-1"><a href="#cb17-1" tabindex="-1"></a><span class="im">from</span> unittest.mock <span class="im">import</span> Mock</span>
<span id="cb17-2"><a href="#cb17-2" tabindex="-1"></a></span>
<span id="cb17-3"><a href="#cb17-3" tabindex="-1"></a>mock_version <span class="op">=</span> Mock()</span>
<span id="cb17-4"><a href="#cb17-4" tabindex="-1"></a>mock_version.method_to_mock.return_value <span class="op">=</span> <span class="dv">42</span></span></code></pre>
</div>
<p>Here we construct a mock in the same way you would construct a class.
Then we specify a method that we want to behave a specific way.</p>
<p>Now whenever you call <code>mock_version.method_to_mock()</code> the
return value will be <code>42</code>.</p>
<div id="exercise-test-using-a-mock-implementation" class="callout challenge">
<div class="callout-square">
<i class="callout-icon" data-feather="zap"></i>
</div>
<div id="exercise-test-using-a-mock-implementation" class="callout-inner">
<h3 class="callout-title">Exercise: Test Using a Mock Implementation</h3>
<div class="callout-content">
<p>Add a new test file called <code>test_compute_data.py</code> in the
tests folder and add a test to verify whether we can successfully run
<code>analyse_data()</code> when passing it a data source.</p>
<p>Complete this test for <code>analyse_data()</code>, using a mock
object in place of the <code>data_source</code>:</p>
<div class="codewrapper sourceCode" id="cb18">
<h3 class="code-label">PYTHON<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="sourceCode python" tabindex="0"><code class="sourceCode python"><span id="cb18-1"><a href="#cb18-1" tabindex="-1"></a><span class="im">from</span> unittest.mock <span class="im">import</span> Mock</span>
<span id="cb18-2"><a href="#cb18-2" tabindex="-1"></a></span>
<span id="cb18-3"><a href="#cb18-3" tabindex="-1"></a><span class="kw">def</span> test_analyse_data_mock_source():</span>
<span id="cb18-4"><a href="#cb18-4" tabindex="-1"></a>  <span class="im">from</span> inflammation.compute_data <span class="im">import</span> analyse_data</span>
<span id="cb18-5"><a href="#cb18-5" tabindex="-1"></a>  data_source <span class="op">=</span> Mock()</span>
<span id="cb18-6"><a href="#cb18-6" tabindex="-1"></a></span>
<span id="cb18-7"><a href="#cb18-7" tabindex="-1"></a>  <span class="co"># </span><span class="al">TODO</span><span class="co">: configure data_source mock</span></span>
<span id="cb18-8"><a href="#cb18-8" tabindex="-1"></a></span>
<span id="cb18-9"><a href="#cb18-9" tabindex="-1"></a>  analyse_data(data_source)</span></code></pre>
</div>
<p>Create a mock that returns some fixed data and to use as the
<code>data_source</code> in order to test the <code>analyse_data</code>
method.</p>
<p>Use this mock in the test.</p>
<p>Do not forget to import <code>Mock</code> from the
<code>unittest.mock</code> package.</p>
<p>Note that the <code>analyse_data()</code> function visualizes the
data with <code>views.visualize(graph_data)</code>. You do not have to
assert that this is done correctly. For now, it is fine to just check
that the call to <code>analyse_data()</code> can proceed
successfully.</p>
<p>In the next episode we will adapt the <code>analyse_data()</code>
function so that we can write a test that asserts whether standard
deviation calculations are correct.</p>
</div>
</div>
</div>
<div id="accordionSolution5" class="accordion challenge-accordion accordion-flush">
<div class="accordion-item">
<button class="accordion-button solution-button collapsed" type="button" data-bs-toggle="collapse" data-bs-target="#collapseSolution5" aria-expanded="false" aria-controls="collapseSolution5">
  <h4 class="accordion-header" id="headingSolution5"> Show me the solution </h4>
</button>
<div id="collapseSolution5" class="accordion-collapse collapse" data-bs-parent="#accordionSolution5" aria-labelledby="headingSolution5">
<div class="accordion-body">
<div class="codewrapper sourceCode" id="cb19">
<h3 class="code-label">PYTHON<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="sourceCode python" tabindex="0"><code class="sourceCode python"><span id="cb19-1"><a href="#cb19-1" tabindex="-1"></a><span class="im">from</span> unittest.mock <span class="im">import</span> Mock</span>
<span id="cb19-2"><a href="#cb19-2" tabindex="-1"></a></span>
<span id="cb19-3"><a href="#cb19-3" tabindex="-1"></a><span class="kw">def</span> test_analyse_data_mock_source():</span>
<span id="cb19-4"><a href="#cb19-4" tabindex="-1"></a>  <span class="im">from</span> inflammation.compute_data <span class="im">import</span> analyse_data</span>
<span id="cb19-5"><a href="#cb19-5" tabindex="-1"></a>  data_source <span class="op">=</span> Mock()</span>
<span id="cb19-6"><a href="#cb19-6" tabindex="-1"></a>  mock_data <span class="op">=</span> [[[<span class="dv">0</span>, <span class="dv">2</span>, <span class="dv">0</span>]],</span>
<span id="cb19-7"><a href="#cb19-7" tabindex="-1"></a>              [[<span class="dv">0</span>, <span class="dv">1</span>, <span class="dv">0</span>]]]</span>
<span id="cb19-8"><a href="#cb19-8" tabindex="-1"></a>  data_source.load_inflammation_data.return_value <span class="op">=</span> mock_data</span>
<span id="cb19-9"><a href="#cb19-9" tabindex="-1"></a></span>
<span id="cb19-10"><a href="#cb19-10" tabindex="-1"></a>  analyse_data(data_source)</span></code></pre>
</div>
</div>
</div>
</div>
</div>
</section><section><h2 class="section-heading" id="safe-code-structure-changes">Safe Code Structure Changes<a class="anchor" aria-label="anchor" href="#safe-code-structure-changes"></a></h2>
<hr class="half-width"><p>With the changes to the code structure we have done using code
decoupling and abstractions we have already refactored our code to a
certain extent, but we have not fully tested that the changes work as
intended. We will now look into how to properly refactor code to
guarantee that the code still works as before any modifications.</p>
<div id="keypoints1" class="callout keypoints">
<div class="callout-square">
<i class="callout-icon" data-feather="key"></i>
</div>
<div class="callout-inner">
<h3 class="callout-title">Key Points</h3>
<div class="callout-content">
<ul><li>Code decoupling is separating code into smaller components and
reducing the interdependence between them so that the code is easier to
understand, test and maintain.</li>
<li>Abstractions can hide certain details of the code behind classes and
interfaces.</li>
<li>Encapsulation bundles data into a structured component along with
methods that operate on the data, and provides a mechanism for
restricting access to that data, hiding the internal representation of
the component.</li>
<li>Polymorphism describes the provision of a single interface to
entities of different types, or the use of a single symbol to represent
different types.</li>
</ul></div>
</div>
</div>
</section></div> <!-- / div.lesson-content -->
    </main><!-- / main#main-content.main-content --><nav class="bottom-pagination mx-md-4" aria-label="Previous and Next Chapter"><div class="d-block d-sm-block d-md-none">
        <a class="chapter-link" href="../instructor/32-software-architecture-design.html"><i aria-hidden="true" class="small-arrow" data-feather="arrow-left"></i>Previous</a>
        <a class="chapter-link float-end" href="../instructor/34-code-refactoring.html">Next<i aria-hidden="true" class="small-arrow" data-feather="arrow-right"></i></a>
      </div>
      <!-- content for large screens -->
      <div class="d-none d-sm-none d-md-block">
        <a class="chapter-link" href="../instructor/32-software-architecture-design.html" rel="prev">
          <i aria-hidden="true" class="small-arrow" data-feather="arrow-left"></i>
          Previous: 3.2 Software
        </a>
        <a class="chapter-link float-end" href="../instructor/34-code-refactoring.html" rel="next">
          Next: 3.4 Code Refactoring...
          <i aria-hidden="true" class="small-arrow" data-feather="arrow-right"></i>
        </a>
      </div>
    </nav></div> <!-- / div.primary-content.col-xs-12 -->
<!-- END:   inst/pkgdown/templates/content-instructor.html-->

      </div><!--/div.row-->
      		<footer class="row footer mx-md-3"><hr><div class="col-md-6">
        <p>This lesson is subject to the <a href="CODE_OF_CONDUCT.html">Code of Conduct</a></p>
        <p>

        <a href="https://github.com/carpentries-incubator/python-intermediate-development/edit/main/episodes/33-code-decoupling-abstractions.md" class="external-link">Edit on GitHub</a>

	
        | <a href="https://github.com/carpentries-incubator/python-intermediate-development/blob/main/CONTRIBUTING.md" class="external-link">Contributing</a>
        | <a href="https://github.com/carpentries-incubator/python-intermediate-development/" class="external-link">Source</a></p>
				<p><a href="https://github.com/carpentries-incubator/python-intermediate-development/blob/main/CITATION" class="external-link">Cite</a> | <a href="mailto:info@software.ac.uk">Contact</a> | <a href="https://carpentries.org/about/" class="external-link">About</a></p>
			</div>
			<div class="col-md-6">

        <p>Materials licensed under <a href="LICENSE.html">CC-BY 4.0</a> by the authors</p>

        <p>Template licensed under <a href="https://creativecommons.org/licenses/by-sa/4.0/" class="external-link">CC-BY 4.0</a> by <a href="https://carpentries.org/" class="external-link">The Carpentries</a></p>
        <p>Built with <a href="https://github.com/carpentries/sandpaper/tree/0.16.12" class="external-link">sandpaper (0.16.12)</a>, <a href="https://github.com/carpentries/pegboard/tree/0.7.9" class="external-link">pegboard (0.7.9)</a>, and <a href="https://github.com/carpentries/varnish/tree/1.0.6" class="external-link">varnish (1.0.6)</a></p>
			</div>
		</footer></div> <!-- / div.container -->
	<div id="to-top">
		<a href="#top">
      <i class="search-icon" data-feather="arrow-up" role="img" aria-label="Back To Top"></i><br><!-- <span class="d-none d-sm-none d-md-none d-lg-none d-xl-block">Back</span> To Top --><span class="d-none d-sm-none d-md-none d-lg-none d-xl-block">Back</span> To Top
		</a>
	</div>
  <script type="application/ld+json">
    {
  "@context": "https://schema.org",
  "@type": "LearningResource",
  "@id": "https://carpentries-incubator.github.io/python-intermediate-development/instructor/33-code-decoupling-abstractions.html",
  "inLanguage": "en",
  "dct:conformsTo": "https://bioschemas.org/profiles/LearningResource/1.0-RELEASE",
  "description": "A Carpentries Lesson teaching foundational data and coding skills to researchers worldwide",
  "keywords": "software, data, lesson, The Carpentries",
  "name": "3.3 Code Decoupling &amp;amp; Abstractions",
  "creativeWorkStatus": "active",
  "url": "https://carpentries-incubator.github.io/python-intermediate-development/instructor/33-code-decoupling-abstractions.html",
  "identifier": "https://carpentries-incubator.github.io/python-intermediate-development/instructor/33-code-decoupling-abstractions.html",
  "dateCreated": "2020-04-23",
  "dateModified": "2025-03-10",
  "datePublished": "2025-07-22"
}

  </script><script>
		feather.replace();
	</script></body></html><!-- END:   inst/pkgdown/templates/layout.html-->

