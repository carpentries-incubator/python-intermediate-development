<!DOCTYPE html>
<!-- START: inst/pkgdown/templates/layout.html --><!-- Generated by pkgdown: do not edit by hand --><html lang="en" data-bs-theme="auto"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta charset="utf-8"><title>Intermediate Research Software Development: 2.2 Scaling Up Unit Testing</title><meta name="viewport" content="width=device-width, initial-scale=1"><script src="assets/themetoggle.js"></script><link rel="stylesheet" type="text/css" href="assets/styles.css"><script src="assets/scripts.js" type="text/javascript"></script><!-- mathjax --><script type="text/x-mathjax-config">
    MathJax.Hub.Config({
      config: ["MMLorHTML.js"],
      jax: ["input/TeX","input/MathML","output/HTML-CSS","output/NativeMML", "output/PreviewHTML"],
      extensions: ["tex2jax.js","mml2jax.js","MathMenu.js","MathZoom.js", "fast-preview.js", "AssistiveMML.js", "a11y/accessibility-menu.js"],
      TeX: {
        extensions: ["AMSmath.js","AMSsymbols.js","noErrors.js","noUndefined.js"]
      },
      tex2jax: {
        inlineMath: [['\\(', '\\)']],
        displayMath: [ ['$$','$$'], ['\\[', '\\]'] ],
        processEscapes: true
      }
    });
    </script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><!-- Responsive Favicon for The Carpentries --><link rel="apple-touch-icon" sizes="180x180" href="favicons/incubator/apple-touch-icon.png"><link rel="icon" type="image/png" sizes="32x32" href="favicons/incubator/favicon-32x32.png"><link rel="icon" type="image/png" sizes="16x16" href="favicons/incubator/favicon-16x16.png"><link rel="manifest" href="favicons/incubator/site.webmanifest"><link rel="mask-icon" href="favicons/incubator/safari-pinned-tab.svg" color="#5bbad5"><meta name="msapplication-TileColor" content="#da532c"><meta name="theme-color" media="(prefers-color-scheme: light)" content="white"><meta name="theme-color" media="(prefers-color-scheme: dark)" content="black"></head><body>
    <header id="top" class="navbar navbar-expand-md top-nav incubator"><svg xmlns="http://www.w3.org/2000/svg" class="d-none"><symbol id="check2" viewbox="0 0 16 16"><path d="M13.854 3.646a.5.5 0 0 1 0 .708l-7 7a.5.5 0 0 1-.708 0l-3.5-3.5a.5.5 0 1 1 .708-.708L6.5 10.293l6.646-6.647a.5.5 0 0 1 .708 0z"></path></symbol><symbol id="circle-half" viewbox="0 0 16 16"><path d="M8 15A7 7 0 1 0 8 1v14zm0 1A8 8 0 1 1 8 0a8 8 0 0 1 0 16z"></path></symbol><symbol id="moon-stars-fill" viewbox="0 0 16 16"><path d="M6 .278a.768.768 0 0 1 .08.858 7.208 7.208 0 0 0-.878 3.46c0 4.021 3.278 7.277 7.318 7.277.527 0 1.04-.055 1.533-.16a.787.787 0 0 1 .81.316.733.733 0 0 1-.031.893A8.349 8.349 0 0 1 8.344 16C3.734 16 0 12.286 0 7.71 0 4.266 2.114 1.312 5.124.06A.752.752 0 0 1 6 .278z"></path><path d="M10.794 3.148a.217.217 0 0 1 .412 0l.387 1.162c.173.518.579.924 1.097 1.097l1.162.387a.217.217 0 0 1 0 .412l-1.162.387a1.734 1.734 0 0 0-1.097 1.097l-.387 1.162a.217.217 0 0 1-.412 0l-.387-1.162A1.734 1.734 0 0 0 9.31 6.593l-1.162-.387a.217.217 0 0 1 0-.412l1.162-.387a1.734 1.734 0 0 0 1.097-1.097l.387-1.162zM13.863.099a.145.145 0 0 1 .274 0l.258.774c.115.346.386.617.732.732l.774.258a.145.145 0 0 1 0 .274l-.774.258a1.156 1.156 0 0 0-.732.732l-.258.774a.145.145 0 0 1-.274 0l-.258-.774a1.156 1.156 0 0 0-.732-.732l-.774-.258a.145.145 0 0 1 0-.274l.774-.258c.346-.115.617-.386.732-.732L13.863.1z"></path></symbol><symbol id="sun-fill" viewbox="0 0 16 16"><path d="M8 12a4 4 0 1 0 0-8 4 4 0 0 0 0 8zM8 0a.5.5 0 0 1 .5.5v2a.5.5 0 0 1-1 0v-2A.5.5 0 0 1 8 0zm0 13a.5.5 0 0 1 .5.5v2a.5.5 0 0 1-1 0v-2A.5.5 0 0 1 8 13zm8-5a.5.5 0 0 1-.5.5h-2a.5.5 0 0 1 0-1h2a.5.5 0 0 1 .5.5zM3 8a.5.5 0 0 1-.5.5h-2a.5.5 0 0 1 0-1h2A.5.5 0 0 1 3 8zm10.657-5.657a.5.5 0 0 1 0 .707l-1.414 1.415a.5.5 0 1 1-.707-.708l1.414-1.414a.5.5 0 0 1 .707 0zm-9.193 9.193a.5.5 0 0 1 0 .707L3.05 13.657a.5.5 0 0 1-.707-.707l1.414-1.414a.5.5 0 0 1 .707 0zm9.193 2.121a.5.5 0 0 1-.707 0l-1.414-1.414a.5.5 0 0 1 .707-.707l1.414 1.414a.5.5 0 0 1 0 .707zM4.464 4.465a.5.5 0 0 1-.707 0L2.343 3.05a.5.5 0 1 1 .707-.707l1.414 1.414a.5.5 0 0 1 0 .708z"></path></symbol></svg><a class="visually-hidden-focusable skip-link" href="#main-content">Skip to main content</a>
  <div class="container-fluid top-nav-container">
    <div class="col-md-8">
      <div class="large-logo">
        <img id="incubator-logo" alt="Lesson Description" src="assets/images/incubator-logo.svg"><span class="badge text-bg-info">
          <abbr title="This lesson is in the beta phase, which means that it is ready for teaching by instructors outside of the original author team.">
            <a href="https://cdh.carpentries.org/the-lesson-life-cycle.html#polishing-beta-stage" class="external-link alert-link">
              <i aria-hidden="true" class="icon" data-feather="alert-circle" style="border-radius: 5px"></i>
              Beta
            </a>
            <span class="visually-hidden">This lesson is in the beta phase, which means that it is ready for teaching by instructors outside of the original author team.</span>
          </abbr>
        </span>

      </div>
    </div>
    <div class="selector-container">
      <div id="theme-selector">
        <li class="nav-item dropdown" id="theme-button-list">
          <button class="btn btn-link nav-link px-0 px-lg-2 dropdown-toggle d-flex align-items-center" id="bd-theme" type="button" aria-expanded="false" data-bs-toggle="dropdown" data-bs-display="static" aria-label="Toggle theme (auto)">
            <svg class="bi my-1 theme-icon-active"><use href="#circle-half"></use></svg><i data-feather="chevron-down"></i>
          </button>
          <ul class="dropdown-menu dropdown-menu-end" aria-labelledby="bd-theme-text"><li>
              <button type="button" class="btn dropdown-item d-flex align-items-center" data-bs-theme-value="light" aria-pressed="false">
                <svg class="bi me-2 theme-icon"><use href="#sun-fill"></use></svg>
                Light
                <svg class="bi ms-auto d-none"><use href="#check2"></use></svg></button>
            </li>
            <li>
              <button type="button" class="btn dropdown-item d-flex align-items-center" data-bs-theme-value="dark" aria-pressed="false">
                <svg class="bi me-2 theme-icon"><use href="#moon-stars-fill"></use></svg>
                Dark
                <svg class="bi ms-auto d-none"><use href="#check2"></use></svg></button>
            </li>
            <li>
              <button type="button" class="btn dropdown-item d-flex align-items-center active" data-bs-theme-value="auto" aria-pressed="true">
                <svg class="bi me-2 theme-icon"><use href="#circle-half"></use></svg>
                Auto
                <svg class="bi ms-auto d-none"><use href="#check2"></use></svg></button>
            </li>
          </ul></li>
      </div>

      <div class="dropdown" id="instructor-dropdown">
        <button class="btn btn-secondary dropdown-toggle bordered-button" type="button" id="dropdownMenu1" data-bs-toggle="dropdown" aria-expanded="false">
          <i aria-hidden="true" class="icon" data-feather="eye"></i> Learner View <i data-feather="chevron-down"></i>
        </button>
        <ul class="dropdown-menu" aria-labelledby="dropdownMenu1"><li><button class="dropdown-item" type="button" onclick="window.location.href='instructor/22-scaling-up-unit-testing.html';">Instructor View</button></li>
        </ul></div>
    </div>
  </div>
  <hr></header><nav class="navbar navbar-expand-xl bottom-nav incubator" aria-label="Main Navigation"><div class="container-fluid nav-container">
    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbarSupportedContent" aria-controls="navbarSupportedContent" aria-expanded="false" aria-label="Toggle Navigation">
      <span class="navbar-toggler-icon"></span>
      <span class="menu-title">Menu</span>
    </button>
    <div class="nav-logo">
      <img class="small-logo" alt="Lesson Description" src="assets/images/incubator-logo-sm.svg"></div>
    <div class="lesson-title-md">
      Intermediate Research Software Development
    </div>
    <div class="search-icon-sm">
      <!-- TODO: do not show until we have search
        <i role="img" aria-label="Search the All In One page" data-feather="search"></i>
      -->
    </div>
    <div class="desktop-nav">
      <ul class="navbar-nav me-auto mb-2 mb-lg-0"><li class="nav-item">
          <span class="lesson-title">
            Intermediate Research Software Development
          </span>
        </li>
        <li class="nav-item">
          <a class="nav-link" href="key-points.html">Key Points</a>
        </li>
        <li class="nav-item">
          <a class="nav-link" href="reference.html#glossary">Glossary</a>
        </li>
        <li class="nav-item">
          <a class="nav-link" href="profiles.html">Learner Profiles</a>
        </li>
        <li class="nav-item dropdown">
          <button class="nav-link dropdown-toggle" id="navbarDropdown" data-bs-toggle="dropdown" aria-expanded="false">
            More <i data-feather="chevron-down"></i>
          </button>
          <ul class="dropdown-menu" aria-labelledby="navbarDropdown"><li><a class="dropdown-item" href="quiz.html">Quiz</a></li><li><a class="dropdown-item" href="installation-instructions.html">Installation Instructions</a></li><li><a class="dropdown-item" href="common-issues.html">Common Issues, Fixes &amp; Tips</a></li><li><a class="dropdown-item" href="software-architecture-extra.html">Extra Content: Software Architecture</a></li><li><a class="dropdown-item" href="programming-paradigms.html">Extra Content: Programming Paradigms</a></li><li><a class="dropdown-item" href="procedural-programming.html">Extra Content: Procedural Programming</a></li><li><a class="dropdown-item" href="functional-programming.html">Extra Content: Functional Programming</a></li><li><a class="dropdown-item" href="object-oriented-programming.html">Extra Content: Object Oriented Programming</a></li><li><a class="dropdown-item" href="persistence.html">Extra Content: Persistence</a></li><li><a class="dropdown-item" href="databases.html">Extra Content: Databases</a></li><li><a class="dropdown-item" href="vscode.html">Extra Content: Using Microsoft Visual Studio Code</a></li><li><a class="dropdown-item" href="reference.html">Reference</a></li>
          </ul></li>
      </ul></div>
    <!--
    <form class="d-flex col-md-2 search-form">
      <fieldset disabled>
      <input class="form-control me-2 searchbox" type="search" placeholder="" aria-label="">
        <button class="btn btn-outline-success tablet-search-button"  type="submit">
          <i class="search-icon" data-feather="search" role="img" aria-label="Search the All In One page"></i>
        </button>
      </fieldset>
    </form>
    -->
    <a id="search-button" class="btn btn-primary" href="aio.html" role="button" aria-label="Search the All In One page">Search the All In One page</a>
  </div><!--/div.container-fluid -->
</nav><div class="col-md-12 mobile-title">
  Intermediate Research Software Development
</div>

<aside class="col-md-12 lesson-progress"><div style="width: 30%" class="percentage">
    30%
  </div>
  <div class="progress incubator">
    <div class="progress-bar incubator" role="progressbar" style="width: 30%" aria-valuenow="30" aria-label="Lesson Progress" aria-valuemin="0" aria-valuemax="100">
    </div>
  </div>
</aside><div class="container">
      <div class="row">
        <!-- START: inst/pkgdown/templates/navbar.html -->
<div id="sidebar-col" class="col-lg-4">
  <div id="sidebar" class="sidebar">
      <nav aria-labelledby="flush-headingEleven"><button role="button" aria-label="close menu" alt="close menu" aria-expanded="true" aria-controls="sidebar" class="collapse-toggle" data-collapse="Collapse " data-episodes="Episodes ">
          <i class="search-icon" data-feather="x" role="img"></i>
        </button>
        <div class="sidebar-inner">
          <div class="row mobile-row" id="theme-row-mobile">
            <div class="col" id="theme-selector">
              <li class="nav-item dropdown" id="theme-button-list">
                <button class="btn btn-link nav-link px-0 px-lg-2 dropdown-toggle d-flex align-items-center" id="bd-theme" type="button" aria-expanded="false" data-bs-toggle="dropdown" data-bs-display="static" aria-label="Toggle theme (auto)">
                  <svg class="bi my-1 theme-icon-active"><use href="#circle-half"></use></svg><span class="d-lg-none ms-1" id="bd-theme-text">Toggle Theme</span>
                </button>
                <ul class="dropdown-menu dropdown-menu-right" aria-labelledby="bd-theme-text"><li>
                    <button type="button" class="btn dropdown-item d-flex align-items-center" data-bs-theme-value="light" aria-pressed="false">
                      <svg class="bi me-2 theme-icon"><use href="#sun-fill"></use></svg>
                      Light
                      <svg class="bi ms-auto d-none"><use href="#check2"></use></svg></button>
                  </li>
                  <li>
                    <button type="button" class="btn dropdown-item d-flex align-items-center" data-bs-theme-value="dark" aria-pressed="false">
                      <svg class="bi me-2 theme-icon"><use href="#moon-stars-fill"></use></svg>
                      Dark
                      <svg class="bi ms-auto d-none"><use href="#check2"></use></svg></button>
                  </li>
                  <li>
                    <button type="button" class="btn dropdown-item d-flex align-items-center active" data-bs-theme-value="auto" aria-pressed="true">
                      <svg class="bi me-2 theme-icon"><use href="#circle-half"></use></svg>
                      Auto
                      <svg class="bi ms-auto d-none"><use href="#check2"></use></svg></button>
                  </li>
                </ul></li>
            </div>
          </div>
          <div class="row mobile-row">
            <div class="col">
              <div class="sidenav-view-selector">
                <div class="accordion accordion-flush" id="accordionFlush9">
                  <div class="accordion-item">
                    <h2 class="accordion-header" id="flush-headingNine">
                      <button class="accordion-button collapsed" id="instructor" type="button" data-bs-toggle="collapse" data-bs-target="#flush-collapseNine" aria-expanded="false" aria-controls="flush-collapseNine">
                        <i id="eye" aria-hidden="true" class="icon" data-feather="eye"></i> Learner View
                      </button>
                    </h2>
                    <div id="flush-collapseNine" class="accordion-collapse collapse" aria-labelledby="flush-headingNine" data-bs-parent="#accordionFlush2">
                      <div class="accordion-body">
                        <a href="instructor/22-scaling-up-unit-testing.html">Instructor View</a>
                      </div>
                    </div>
                  </div><!--/div.accordion-item-->
                </div><!--/div.accordion-flush-->
              </div><!--div.sidenav-view-selector -->
            </div><!--/div.col -->

            <hr></div><!--/div.mobile-row -->

          <div class="accordion accordion-flush" id="accordionFlush11">
            <div class="accordion-item">

              <button id="chapters" class="accordion-button show" type="button" data-bs-toggle="collapse" data-bs-target="#flush-collapseEleven" aria-expanded="false" aria-controls="flush-collapseEleven">
                <h2 class="accordion-header chapters" id="flush-headingEleven">
                  EPISODES
                </h2>
              </button>
              <div id="flush-collapseEleven" class="accordion-collapse show collapse" aria-labelledby="flush-headingEleven" data-bs-parent="#accordionFlush11">

                <div class="accordion-body">
                  <div class="accordion accordion-flush" id="accordionFlush1">
  <div class="accordion-item">
    <div class="accordion-header" id="flush-heading1">
        <a href="index.html">Summary and Setup</a>
    </div><!--/div.accordion-header-->

  </div><!--/div.accordion-item-->
</div><!--/div.accordion-flush-->

<div class="accordion accordion-flush" id="accordionFlush2">
  <div class="accordion-item">
    <div class="accordion-header" id="flush-heading2">
        <a href="00-setting-the-scene.html">Setting the Scene</a>
    </div><!--/div.accordion-header-->

  </div><!--/div.accordion-item-->
</div><!--/div.accordion-flush-->

<div class="accordion accordion-flush" id="accordionFlush3">
  <div class="accordion-item">
    <div class="accordion-header" id="flush-heading3">
        <a href="10-section1-intro.html">Section 1: Setting Up Environment For Collaborative Code Development</a>
    </div><!--/div.accordion-header-->

  </div><!--/div.accordion-item-->
</div><!--/div.accordion-flush-->

<div class="accordion accordion-flush" id="accordionFlush4">
  <div class="accordion-item">
    <div class="accordion-header" id="flush-heading4">
        <a href="11-software-project.html">1.1 Introduction to Our Software Project</a>
    </div><!--/div.accordion-header-->

  </div><!--/div.accordion-item-->
</div><!--/div.accordion-flush-->

<div class="accordion accordion-flush" id="accordionFlush5">
  <div class="accordion-item">
    <div class="accordion-header" id="flush-heading5">
        <a href="12-virtual-environments.html">1.2 Virtual Environments For Software Development</a>
    </div><!--/div.accordion-header-->

  </div><!--/div.accordion-item-->
</div><!--/div.accordion-flush-->

<div class="accordion accordion-flush" id="accordionFlush6">
  <div class="accordion-item">
    <div class="accordion-header" id="flush-heading6">
        <a href="13-ides.html">1.3 Integrated Software Development Environments</a>
    </div><!--/div.accordion-header-->

  </div><!--/div.accordion-item-->
</div><!--/div.accordion-flush-->

<div class="accordion accordion-flush" id="accordionFlush7">
  <div class="accordion-item">
    <div class="accordion-header" id="flush-heading7">
        <a href="14-collaboration-using-git.html">1.4 Software Development Using Git and GitHub</a>
    </div><!--/div.accordion-header-->

  </div><!--/div.accordion-item-->
</div><!--/div.accordion-flush-->

<div class="accordion accordion-flush" id="accordionFlush8">
  <div class="accordion-item">
    <div class="accordion-header" id="flush-heading8">
        <a href="15-coding-conventions.html">1.5 Python Code Style Conventions</a>
    </div><!--/div.accordion-header-->

  </div><!--/div.accordion-item-->
</div><!--/div.accordion-flush-->

<div class="accordion accordion-flush" id="accordionFlush9">
  <div class="accordion-item">
    <div class="accordion-header" id="flush-heading9">
        <a href="16-verifying-code-style-linters.html">1.6 Verifying Code Style Using Linters</a>
    </div><!--/div.accordion-header-->

  </div><!--/div.accordion-item-->
</div><!--/div.accordion-flush-->

<div class="accordion accordion-flush" id="accordionFlush10">
  <div class="accordion-item">
    <div class="accordion-header" id="flush-heading10">
        <a href="17-section1-optional-exercises.html">1.7 Optional Exercises for Section 1</a>
    </div><!--/div.accordion-header-->

  </div><!--/div.accordion-item-->
</div><!--/div.accordion-flush-->

<div class="accordion accordion-flush" id="accordionFlush11">
  <div class="accordion-item">
    <div class="accordion-header" id="flush-heading11">
        <a href="20-section2-intro.html">Section 2: Ensuring Correctness of Software at Scale</a>
    </div><!--/div.accordion-header-->

  </div><!--/div.accordion-item-->
</div><!--/div.accordion-flush-->

<div class="accordion accordion-flush" id="accordionFlush12">
  <div class="accordion-item">
    <div class="accordion-header" id="flush-heading12">
        <a href="21-automatically-testing-software.html">2.1 Automatically Testing Software</a>
    </div><!--/div.accordion-header-->

  </div><!--/div.accordion-item-->
</div><!--/div.accordion-flush-->

<div class="accordion accordion-flush" id="accordionFlushcurrent">
  <div class="accordion-item">
    <div class="accordion-header" id="flush-headingcurrent">
      <button class="accordion-button" type="button" data-bs-toggle="collapse" data-bs-target="#flush-collapsecurrent" aria-expanded="true" aria-controls="flush-collapsecurrent">
        <span class="visually-hidden">Current Chapter</span>
        <span class="current-chapter">
        2.2 Scaling Up Unit Testing
        </span>
      </button>
    </div><!--/div.accordion-header-->

    <div id="flush-collapsecurrent" class="accordion-collapse collapse show" aria-labelledby="flush-headingcurrent" data-bs-parent="#accordionFlushcurrent">
      <div class="accordion-body">
        <ul><li><a href="#introduction">Introduction</a></li>
<li><a href="#parameterising-our-unit-tests">Parameterising Our Unit Tests</a></li>
<li><a href="#code-coverage---how-much-of-our-code-is-tested">Code Coverage - How Much of Our Code is Tested?</a></li>
<li><a href="#test-driven-development">Test Driven Development</a></li>
<li><a href="#limits-to-testing">Limits to Testing</a></li>
<li><a href="#optional-exercises">Optional exercises</a></li>
        </ul></div><!--/div.accordion-body-->
    </div><!--/div.accordion-collapse-->

  </div><!--/div.accordion-item-->
</div><!--/div.accordion-flush-->

<div class="accordion accordion-flush" id="accordionFlush14">
  <div class="accordion-item">
    <div class="accordion-header" id="flush-heading14">
        <a href="23-continuous-integration-automated-testing.html">2.3 Continuous Integration for Automated Testing</a>
    </div><!--/div.accordion-header-->

  </div><!--/div.accordion-item-->
</div><!--/div.accordion-flush-->

<div class="accordion accordion-flush" id="accordionFlush15">
  <div class="accordion-item">
    <div class="accordion-header" id="flush-heading15">
        <a href="24-diagnosing-issues-improving-robustness.html">2.4 Diagnosing Issues and Improving Robustness</a>
    </div><!--/div.accordion-header-->

  </div><!--/div.accordion-item-->
</div><!--/div.accordion-flush-->

<div class="accordion accordion-flush" id="accordionFlush16">
  <div class="accordion-item">
    <div class="accordion-header" id="flush-heading16">
        <a href="25-section2-optional-exercises.html">2.5 Optional Exercises for Section 2</a>
    </div><!--/div.accordion-header-->

  </div><!--/div.accordion-item-->
</div><!--/div.accordion-flush-->

<div class="accordion accordion-flush" id="accordionFlush17">
  <div class="accordion-item">
    <div class="accordion-header" id="flush-heading17">
        <a href="30-section3-intro.html">Section 3: Software Development as a Process</a>
    </div><!--/div.accordion-header-->

  </div><!--/div.accordion-item-->
</div><!--/div.accordion-flush-->

<div class="accordion accordion-flush" id="accordionFlush18">
  <div class="accordion-item">
    <div class="accordion-header" id="flush-heading18">
        <a href="31-software-requirements.html">3.1 Software Requirements</a>
    </div><!--/div.accordion-header-->

  </div><!--/div.accordion-item-->
</div><!--/div.accordion-flush-->

<div class="accordion accordion-flush" id="accordionFlush19">
  <div class="accordion-item">
    <div class="accordion-header" id="flush-heading19">
        <a href="32-software-architecture-design.html">3.2 Software Architecture and Design</a>
    </div><!--/div.accordion-header-->

  </div><!--/div.accordion-item-->
</div><!--/div.accordion-flush-->

<div class="accordion accordion-flush" id="accordionFlush20">
  <div class="accordion-item">
    <div class="accordion-header" id="flush-heading20">
        <a href="33-code-decoupling-abstractions.html">3.3 Code Decoupling &amp; Abstractions</a>
    </div><!--/div.accordion-header-->

  </div><!--/div.accordion-item-->
</div><!--/div.accordion-flush-->

<div class="accordion accordion-flush" id="accordionFlush21">
  <div class="accordion-item">
    <div class="accordion-header" id="flush-heading21">
        <a href="34-code-refactoring.html">3.4 Code Refactoring</a>
    </div><!--/div.accordion-header-->

  </div><!--/div.accordion-item-->
</div><!--/div.accordion-flush-->

<div class="accordion accordion-flush" id="accordionFlush22">
  <div class="accordion-item">
    <div class="accordion-header" id="flush-heading22">
        <a href="35-software-architecture-revisited.html">3.5 Software Architecture Revisited</a>
    </div><!--/div.accordion-header-->

  </div><!--/div.accordion-item-->
</div><!--/div.accordion-flush-->

<div class="accordion accordion-flush" id="accordionFlush23">
  <div class="accordion-item">
    <div class="accordion-header" id="flush-heading23">
        <a href="40-section4-intro.html">Section 4: Collaborative Software Development for Reuse</a>
    </div><!--/div.accordion-header-->

  </div><!--/div.accordion-item-->
</div><!--/div.accordion-flush-->

<div class="accordion accordion-flush" id="accordionFlush24">
  <div class="accordion-item">
    <div class="accordion-header" id="flush-heading24">
        <a href="41-code-review.html">4.1 Developing Software In a Team: Code Review</a>
    </div><!--/div.accordion-header-->

  </div><!--/div.accordion-item-->
</div><!--/div.accordion-flush-->

<div class="accordion accordion-flush" id="accordionFlush25">
  <div class="accordion-item">
    <div class="accordion-header" id="flush-heading25">
        <a href="42-software-reuse.html">4.2 Preparing Software for Reuse and Release</a>
    </div><!--/div.accordion-header-->

  </div><!--/div.accordion-item-->
</div><!--/div.accordion-flush-->

<div class="accordion accordion-flush" id="accordionFlush26">
  <div class="accordion-item">
    <div class="accordion-header" id="flush-heading26">
        <a href="43-software-release.html">4.3 Packaging Code for Release and Distribution</a>
    </div><!--/div.accordion-header-->

  </div><!--/div.accordion-item-->
</div><!--/div.accordion-flush-->

<div class="accordion accordion-flush" id="accordionFlush27">
  <div class="accordion-item">
    <div class="accordion-header" id="flush-heading27">
        <a href="50-section5-intro.html">Section 5: Managing and Improving Software Over Its Lifetime</a>
    </div><!--/div.accordion-header-->

  </div><!--/div.accordion-item-->
</div><!--/div.accordion-flush-->

<div class="accordion accordion-flush" id="accordionFlush28">
  <div class="accordion-item">
    <div class="accordion-header" id="flush-heading28">
        <a href="51-managing-software.html">5.1 Managing a Collaborative Software Project</a>
    </div><!--/div.accordion-header-->

  </div><!--/div.accordion-item-->
</div><!--/div.accordion-flush-->

<div class="accordion accordion-flush" id="accordionFlush29">
  <div class="accordion-item">
    <div class="accordion-header" id="flush-heading29">
        <a href="52-assessing-software-suitability-improvement.html">5.2 Assessing Software for Suitability and Improvement</a>
    </div><!--/div.accordion-header-->

  </div><!--/div.accordion-item-->
</div><!--/div.accordion-flush-->

<div class="accordion accordion-flush" id="accordionFlush30">
  <div class="accordion-item">
    <div class="accordion-header" id="flush-heading30">
        <a href="53-improvement-through-feedback.html">5.3 Software Improvement Through Feedback</a>
    </div><!--/div.accordion-header-->

  </div><!--/div.accordion-item-->
</div><!--/div.accordion-flush-->

<div class="accordion accordion-flush" id="accordionFlush31">
  <div class="accordion-item">
    <div class="accordion-header" id="flush-heading31">
        <a href="60-wrap-up.html">Wrap-up</a>
    </div><!--/div.accordion-header-->

  </div><!--/div.accordion-item-->
</div><!--/div.accordion-flush-->

                </div>
              </div>
            </div>

            <hr class="half-width"><div class="accordion accordion-flush lesson-resources" id="accordionFlush12">
              <div class="accordion-item">
                <h2 class="accordion-header" id="flush-headingTwelve">
                  <button class="accordion-button collapsed" id="lesson-resources" type="button" data-bs-toggle="collapse" data-bs-target="#flush-collapseTwelve" aria-expanded="false" aria-controls="flush-collapseTwelve">
                    RESOURCES
                  </button>
                </h2>
                <div id="flush-collapseTwelve" class="accordion-collapse collapse" aria-labelledby="flush-headingTwelve" data-bs-parent="#accordionFlush12">
                  <div class="accordion-body">
                    <ul><li>
                        <a href="key-points.html">Key Points</a>
                      </li>
                      <li>
                        <a href="reference.html#glossary">Glossary</a>
                      </li>
                      <li>
                        <a href="profiles.html">Learner Profiles</a>
                      </li>
                      <li><a href="quiz.html">Quiz</a></li><li><a href="installation-instructions.html">Installation Instructions</a></li><li><a href="common-issues.html">Common Issues, Fixes &amp; Tips</a></li><li><a href="software-architecture-extra.html">Extra Content: Software Architecture</a></li><li><a href="programming-paradigms.html">Extra Content: Programming Paradigms</a></li><li><a href="procedural-programming.html">Extra Content: Procedural Programming</a></li><li><a href="functional-programming.html">Extra Content: Functional Programming</a></li><li><a href="object-oriented-programming.html">Extra Content: Object Oriented Programming</a></li><li><a href="persistence.html">Extra Content: Persistence</a></li><li><a href="databases.html">Extra Content: Databases</a></li><li><a href="vscode.html">Extra Content: Using Microsoft Visual Studio Code</a></li><li><a href="reference.html">Reference</a></li>
                    </ul></div>
                </div>
              </div>
            </div>
            <hr class="half-width lesson-resources"><a href="aio.html">See all in one page</a>


            <hr class="d-none d-sm-block d-md-none"><div class="d-grid gap-1">

            </div>
          </div><!-- /div.accordion -->
        </div><!-- /div.sidebar-inner -->
      </nav></div><!-- /div.sidebar -->
  </div><!-- /div.sidebar-col -->
<!-- END:   inst/pkgdown/templates/navbar.html-->

        <!-- START: inst/pkgdown/templates/content-instructor.html -->
  <div class="col-xl-8 col-lg-12 primary-content">
    <nav class="lesson-content mx-md-4" aria-label="Previous and Next Chapter"><!-- content for small screens --><div class="d-block d-sm-block d-md-none">
        <a class="chapter-link" href="21-automatically-testing-software.html"><i aria-hidden="true" class="small-arrow" data-feather="arrow-left"></i>Previous</a>
        <a class="chapter-link float-end" href="23-continuous-integration-automated-testing.html">Next<i aria-hidden="true" class="small-arrow" data-feather="arrow-right"></i></a>
      </div>
      <!-- content for large screens -->
      <div class="d-none d-sm-none d-md-block">
        <a class="chapter-link" href="21-automatically-testing-software.html" rel="prev">
          <i aria-hidden="true" class="small-arrow" data-feather="arrow-left"></i>
          Previous: 2.1 Automatically
        </a>
        <a class="chapter-link float-end" href="23-continuous-integration-automated-testing.html" rel="next">
          Next: 2.3 Continuous...
          <i aria-hidden="true" class="small-arrow" data-feather="arrow-right"></i>
        </a>
      </div>
      <hr></nav><main id="main-content" class="main-content"><div class="container lesson-content">
        <h1>2.2 Scaling Up Unit Testing</h1>
        <p>Last updated on 2024-12-06 |

        <a href="https://github.com/carpentries-incubator/python-intermediate-development/edit/main/episodes/22-scaling-up-unit-testing.md" class="external-link">Edit this page <i aria-hidden="true" data-feather="edit"></i></a></p>



        <div class="text-end">
          <button role="button" aria-pressed="false" tabindex="0" id="expand-code" class="pull-right" data-expand="Expand All Solutions " data-collapse="Collapse All Solutions "> Expand All Solutions <i aria-hidden="true" data-feather="plus"></i></button>
        </div>

        

<div class="overview card">
<h2 class="card-header">Overview</h2>
<div class="row g-0">
<div class="col-md-4">
<div class="card-body">
<div class="inner">
<h3 class="card-title">Questions</h3>
<ul><li>How can we make it easier to write lots of tests?</li>
<li>How can we know how much of our code is being tested?</li>
</ul></div>
</div>
</div>
<div class="col-md-8">
<div class="card-body">
<div class="inner bordered">
<h3 class="card-title">Objectives</h3>
<ul><li>Use parameterisation to automatically run tests over a set of
inputs</li>
<li>Use code coverage to understand how much of our code is being tested
using unit tests</li>
</ul></div>
</div>
</div>
</div>
</div>
<section><h2 class="section-heading" id="introduction">Introduction<a class="anchor" aria-label="anchor" href="#introduction"></a></h2>
<hr class="half-width"><p>We are starting to build up a number of tests that test the same
function, but just with different parameters. However, continuing to
write a new function for every single test case is not likely to scale
well as our development progresses. How can we make our job of writing
tests more efficient? And importantly, as the number of tests increases,
how can we determine how much of our code base is actually being
tested?</p>
</section><section><h2 class="section-heading" id="parameterising-our-unit-tests">Parameterising Our Unit Tests<a class="anchor" aria-label="anchor" href="#parameterising-our-unit-tests"></a></h2>
<hr class="half-width"><p>So far, we have been writing a single function for every new test we
need. But when we simply want to use the same test code but with
different data for another test, it would be great to be able to specify
multiple sets of data to use with the same test code. Test
<strong>parameterisation</strong> gives us this.</p>
<p>So instead of writing a separate function for each different test, we
can <strong>parameterise</strong> the tests with multiple test inputs.
For example, in <code>tests/test_models.py</code> let us rewrite the
<code>test_daily_mean_zeros()</code> and
<code>test_daily_mean_integers()</code> into a single test function:</p>
<div class="codewrapper sourceCode" id="cb1">
<h3 class="code-label">PYTHON<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="sourceCode python" tabindex="0"><code class="sourceCode python"><span id="cb1-1"><a href="#cb1-1" tabindex="-1"></a><span class="im">from</span> inflammation.models <span class="im">import</span> daily_mean</span>
<span id="cb1-2"><a href="#cb1-2" tabindex="-1"></a></span>
<span id="cb1-3"><a href="#cb1-3" tabindex="-1"></a><span class="at">@pytest.mark.parametrize</span>(</span>
<span id="cb1-4"><a href="#cb1-4" tabindex="-1"></a>    <span class="st">"test, expected"</span>,</span>
<span id="cb1-5"><a href="#cb1-5" tabindex="-1"></a>    [</span>
<span id="cb1-6"><a href="#cb1-6" tabindex="-1"></a>        ([ [<span class="dv">0</span>, <span class="dv">0</span>], [<span class="dv">0</span>, <span class="dv">0</span>], [<span class="dv">0</span>, <span class="dv">0</span>] ], [<span class="dv">0</span>, <span class="dv">0</span>]),</span>
<span id="cb1-7"><a href="#cb1-7" tabindex="-1"></a>        ([ [<span class="dv">1</span>, <span class="dv">2</span>], [<span class="dv">3</span>, <span class="dv">4</span>], [<span class="dv">5</span>, <span class="dv">6</span>] ], [<span class="dv">3</span>, <span class="dv">4</span>]),</span>
<span id="cb1-8"><a href="#cb1-8" tabindex="-1"></a>    ])</span>
<span id="cb1-9"><a href="#cb1-9" tabindex="-1"></a><span class="kw">def</span> test_daily_mean(test, expected):</span>
<span id="cb1-10"><a href="#cb1-10" tabindex="-1"></a>    <span class="co">"""Test mean function works for array of zeroes and positive integers."""</span></span>
<span id="cb1-11"><a href="#cb1-11" tabindex="-1"></a>    npt.assert_array_equal(daily_mean(np.array(test)), np.array(expected))</span></code></pre>
</div>
<p>Here, we use Pytest’s <strong>mark</strong> capability to add
metadata to this specific test - in this case, marking that it is a
parameterised test. <code>parameterize()</code> function is actually a
<a href="https://www.programiz.com/python-programming/decorator" class="external-link">Python
<strong>decorator</strong></a>. A decorator, when applied to a function,
adds some functionality to it when it is called, and here, what we want
to do is specify multiple input and expected output test cases so the
function is called over each of these inputs automatically when this
test is called.</p>
<p>We specify these as arguments to the <code>parameterize()</code>
decorator, firstly indicating the names of these arguments that will be
passed to the function (<code>test</code>, <code>expected</code>), and
secondly the actual arguments themselves that correspond to each of
these names - the input data (the <code>test</code> argument), and the
expected result (the <code>expected</code> argument). In this case, we
are passing in two tests to <code>test_daily_mean()</code> which will be
run sequentially.</p>
<p>So our first test will run <code>daily_mean()</code> on
<code>[ [0, 0], [0, 0], [0, 0] ]</code> (our <code>test</code>
argument), and check to see if it equals <code>[0, 0]</code> (our
<code>expected</code> argument). Similarly, our second test will run
<code>daily_mean()</code> with <code>[ [1, 2], [3, 4], [5, 6] ]</code>
and check it produces <code>[3, 4]</code>.</p>
<p>The big plus here is that we do not need to write separate functions
for each of the tests - our test code can remain compact and readable as
we write more tests and adding more tests scales better as our code
becomes more complex.</p>
<div id="exercise-write-parameterised-unit-tests" class="callout challenge">
<div class="callout-square">
<i class="callout-icon" data-feather="zap"></i>
</div>
<div id="exercise-write-parameterised-unit-tests" class="callout-inner">
<h3 class="callout-title">Exercise: Write Parameterised Unit Tests</h3>
<div class="callout-content">
<p>Rewrite your test functions for <code>daily_max()</code> and
<code>daily_min()</code> to be parameterised, adding in new test cases
for each of them.</p>
</div>
</div>
</div>
<div id="accordionSolution1" class="accordion challenge-accordion accordion-flush">
<div class="accordion-item">
<button class="accordion-button solution-button collapsed" type="button" data-bs-toggle="collapse" data-bs-target="#collapseSolution1" aria-expanded="false" aria-controls="collapseSolution1">
  <h4 class="accordion-header" id="headingSolution1"> Show me the solution </h4>
</button>
<div id="collapseSolution1" class="accordion-collapse collapse" aria-labelledby="headingSolution1" data-bs-parent="#accordionSolution1">
<div class="accordion-body">
<div class="codewrapper sourceCode" id="cb2">
<h3 class="code-label">PYTHON<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="sourceCode python" tabindex="0"><code class="sourceCode python"><span id="cb2-1"><a href="#cb2-1" tabindex="-1"></a><span class="im">from</span> inflammation.models <span class="im">import</span> daily_max, daily_min</span>
<span id="cb2-2"><a href="#cb2-2" tabindex="-1"></a>...</span>
<span id="cb2-3"><a href="#cb2-3" tabindex="-1"></a><span class="at">@pytest.mark.parametrize</span>(</span>
<span id="cb2-4"><a href="#cb2-4" tabindex="-1"></a>    <span class="st">"test, expected"</span>,</span>
<span id="cb2-5"><a href="#cb2-5" tabindex="-1"></a>    [</span>
<span id="cb2-6"><a href="#cb2-6" tabindex="-1"></a>        ([ [<span class="dv">0</span>, <span class="dv">0</span>, <span class="dv">0</span>], [<span class="dv">0</span>, <span class="dv">0</span>, <span class="dv">0</span>], [<span class="dv">0</span>, <span class="dv">0</span>, <span class="dv">0</span>] ], [<span class="dv">0</span>, <span class="dv">0</span>, <span class="dv">0</span>]),</span>
<span id="cb2-7"><a href="#cb2-7" tabindex="-1"></a>        ([ [<span class="dv">4</span>, <span class="dv">2</span>, <span class="dv">5</span>], [<span class="dv">1</span>, <span class="dv">6</span>, <span class="dv">2</span>], [<span class="dv">4</span>, <span class="dv">1</span>, <span class="dv">9</span>] ], [<span class="dv">4</span>, <span class="dv">6</span>, <span class="dv">9</span>]),</span>
<span id="cb2-8"><a href="#cb2-8" tabindex="-1"></a>        ([ [<span class="dv">4</span>, <span class="op">-</span><span class="dv">2</span>, <span class="dv">5</span>], [<span class="dv">1</span>, <span class="op">-</span><span class="dv">6</span>, <span class="dv">2</span>], [<span class="op">-</span><span class="dv">4</span>, <span class="op">-</span><span class="dv">1</span>, <span class="dv">9</span>] ], [<span class="dv">4</span>, <span class="op">-</span><span class="dv">1</span>, <span class="dv">9</span>]),</span>
<span id="cb2-9"><a href="#cb2-9" tabindex="-1"></a>    ])</span>
<span id="cb2-10"><a href="#cb2-10" tabindex="-1"></a><span class="kw">def</span> test_daily_max(test, expected):</span>
<span id="cb2-11"><a href="#cb2-11" tabindex="-1"></a>    <span class="co">"""Test max function works for zeroes, positive integers, mix of positive/negative integers."""</span></span>
<span id="cb2-12"><a href="#cb2-12" tabindex="-1"></a>    npt.assert_array_equal(daily_max(np.array(test)), np.array(expected))</span>
<span id="cb2-13"><a href="#cb2-13" tabindex="-1"></a></span>
<span id="cb2-14"><a href="#cb2-14" tabindex="-1"></a></span>
<span id="cb2-15"><a href="#cb2-15" tabindex="-1"></a><span class="at">@pytest.mark.parametrize</span>(</span>
<span id="cb2-16"><a href="#cb2-16" tabindex="-1"></a>    <span class="st">"test, expected"</span>,</span>
<span id="cb2-17"><a href="#cb2-17" tabindex="-1"></a>    [</span>
<span id="cb2-18"><a href="#cb2-18" tabindex="-1"></a>        ([ [<span class="dv">0</span>, <span class="dv">0</span>, <span class="dv">0</span>], [<span class="dv">0</span>, <span class="dv">0</span>, <span class="dv">0</span>], [<span class="dv">0</span>, <span class="dv">0</span>, <span class="dv">0</span>] ], [<span class="dv">0</span>, <span class="dv">0</span>, <span class="dv">0</span>]),</span>
<span id="cb2-19"><a href="#cb2-19" tabindex="-1"></a>        ([ [<span class="dv">4</span>, <span class="dv">2</span>, <span class="dv">5</span>], [<span class="dv">1</span>, <span class="dv">6</span>, <span class="dv">2</span>], [<span class="dv">4</span>, <span class="dv">1</span>, <span class="dv">9</span>] ], [<span class="dv">1</span>, <span class="dv">1</span>, <span class="dv">2</span>]),</span>
<span id="cb2-20"><a href="#cb2-20" tabindex="-1"></a>        ([ [<span class="dv">4</span>, <span class="op">-</span><span class="dv">2</span>, <span class="dv">5</span>], [<span class="dv">1</span>, <span class="op">-</span><span class="dv">6</span>, <span class="dv">2</span>], [<span class="op">-</span><span class="dv">4</span>, <span class="op">-</span><span class="dv">1</span>, <span class="dv">9</span>] ], [<span class="op">-</span><span class="dv">4</span>, <span class="op">-</span><span class="dv">6</span>, <span class="dv">2</span>]),</span>
<span id="cb2-21"><a href="#cb2-21" tabindex="-1"></a>    ])</span>
<span id="cb2-22"><a href="#cb2-22" tabindex="-1"></a><span class="kw">def</span> test_daily_min(test, expected):</span>
<span id="cb2-23"><a href="#cb2-23" tabindex="-1"></a>    <span class="co">"""Test min function works for zeroes, positive integers, mix of positive/negative integers."""</span></span>
<span id="cb2-24"><a href="#cb2-24" tabindex="-1"></a>    npt.assert_array_equal(daily_min(np.array(test)), np.array(expected))</span>
<span id="cb2-25"><a href="#cb2-25" tabindex="-1"></a>...</span></code></pre>
</div>
</div>
</div>
</div>
</div>
<p>Try them out!</p>
<p>Let us commit our revised <code>test_models.py</code> file and test
cases to our <code>test-suite</code> branch (but do not push them to the
remote repository just yet!):</p>
<div class="codewrapper sourceCode" id="cb3">
<h3 class="code-label">BASH<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="sourceCode bash" tabindex="0"><code class="sourceCode bash"><span id="cb3-1"><a href="#cb3-1" tabindex="-1"></a><span class="ex">$</span> git add tests/test_models.py</span>
<span id="cb3-2"><a href="#cb3-2" tabindex="-1"></a><span class="ex">$</span> git commit <span class="at">-m</span> <span class="st">"Add parameterisation mean, min, max test cases"</span></span></code></pre>
</div>
</section><section><h2 class="section-heading" id="code-coverage---how-much-of-our-code-is-tested">Code Coverage - How Much of Our Code is Tested?<a class="anchor" aria-label="anchor" href="#code-coverage---how-much-of-our-code-is-tested"></a></h2>
<hr class="half-width"><p>Pytest cannot think of test cases for us. We still have to decide
what to test and how many tests to run. Our best guide here is
economics: we want the tests that are most likely to give us useful
information that we do not already have. For example, if
<code>daily_mean(np.array([[2, 0], [4, 0]])))</code> works, there is
probably not much point testing
<code>daily_mean(np.array([[3, 0], [4, 0]])))</code>, since it is hard
to think of a bug that would show up in one case but not in the
other.</p>
<p>Now, we should try to choose tests that are as different from each
other as possible, so that we force the code we are testing to execute
in all the different ways it can - to ensure our tests have a high
degree of <strong>code coverage</strong>.</p>
<p>A simple way to check the code coverage for a set of tests is to
install an additional package <code>pytest-cov</code> to our virtual
environment, which is used by <code>pytest</code> to tell us how many
statements in our code are being tested.</p>
<div class="codewrapper sourceCode" id="cb4">
<h3 class="code-label">BASH<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="sourceCode bash" tabindex="0"><code class="sourceCode bash"><span id="cb4-1"><a href="#cb4-1" tabindex="-1"></a><span class="ex">$</span> python3 <span class="at">-m</span> pip install pytest-cov</span>
<span id="cb4-2"><a href="#cb4-2" tabindex="-1"></a><span class="ex">$</span> python3 <span class="at">-m</span> pytest <span class="at">--cov</span><span class="op">=</span>inflammation.models tests/test_models.py</span></code></pre>
</div>
<p>So here, we specify the additional named argument <code>--cov</code>
to <code>pytest</code> specifying the code to analyse for test
coverage.</p>
<div class="codewrapper">
<h3 class="code-label">OUTPUT<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="output" tabindex="0"><code>============================= test session starts ==============================
platform darwin -- Python 3.11.4, pytest-7.4.3, pluggy-1.3.0
rootdir: /Users/alex/work/SSI/training/lessons/python-intermediate-inflammation
plugins: cov-4.1.0
collected 9 items

tests/test_models.py .........                                            [100%]

---------- coverage: platform darwin, python 3.11.4-final-0 ----------
Name                     Stmts   Miss  Cover
--------------------------------------------
inflammation/models.py       9      1    89%
--------------------------------------------
TOTAL                        9      1    89%

============================== 9 passed in 0.26s ===============================</code></pre>
</div>
<p>Here we can see that our tests are doing very well - 89% of
statements in <code>inflammation/models.py</code> have been executed.
But which statements are not being tested? The additional argument
<code>--cov-report term-missing</code> can tell us:</p>
<div class="codewrapper sourceCode" id="cb6">
<h3 class="code-label">BASH<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="sourceCode bash" tabindex="0"><code class="sourceCode bash"><span id="cb6-1"><a href="#cb6-1" tabindex="-1"></a><span class="ex">$</span> python3 <span class="at">-m</span> pytest <span class="at">--cov</span><span class="op">=</span>inflammation.models <span class="at">--cov-report</span> term-missing tests/test_models.py</span></code></pre>
</div>
<div class="codewrapper">
<h3 class="code-label">OUTPUT<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="output" tabindex="0"><code>...
Name                     Stmts   Miss  Cover   Missing
------------------------------------------------------
inflammation/models.py       9      1    89%   18
------------------------------------------------------
TOTAL                        9      1    89%
...</code></pre>
</div>
<p>So there is still one statement not being tested at line 18, and it
turns out it is in the function <code>load_csv()</code>. Here we should
consider whether or not to write a test for this function, and, in
general, any other functions that may not be tested. Of course, if there
are hundreds or thousands of lines that are not covered it may not be
feasible to write tests for them all. But we should prioritise the ones
for which we write tests, considering how often they are used, how
complex they are, and importantly, the extent to which they affect our
program’s results.</p>
<p>Again, we should also update our <code>requirements.txt</code> file
with our latest package environment, which now also includes
<code>pytest-cov</code>, and commit it:</p>
<div class="codewrapper sourceCode" id="cb8">
<h3 class="code-label">BASH<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="sourceCode bash" tabindex="0"><code class="sourceCode bash"><span id="cb8-1"><a href="#cb8-1" tabindex="-1"></a><span class="ex">$</span> python3 <span class="at">-m</span> pip freeze <span class="op">&gt;</span> requirements.txt</span>
<span id="cb8-2"><a href="#cb8-2" tabindex="-1"></a><span class="ex">$</span> cat requirements.txt</span></code></pre>
</div>
<p>You’ll notice <code>pytest-cov</code> and <code>coverage</code> have
been added. Let us commit this file and push our new branch to
GitHub:</p>
<div class="codewrapper sourceCode" id="cb9">
<h3 class="code-label">BASH<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="sourceCode bash" tabindex="0"><code class="sourceCode bash"><span id="cb9-1"><a href="#cb9-1" tabindex="-1"></a><span class="ex">$</span> git add requirements.txt</span>
<span id="cb9-2"><a href="#cb9-2" tabindex="-1"></a><span class="ex">$</span> git commit <span class="at">-m</span> <span class="st">"Add coverage support"</span></span>
<span id="cb9-3"><a href="#cb9-3" tabindex="-1"></a><span class="ex">$</span> git push origin test-suite</span></code></pre>
</div>
<div id="what-about-testing-against-indeterminate-output" class="callout">
<div class="callout-square">
<i class="callout-icon" data-feather="bell"></i>
</div>
<div id="what-about-testing-against-indeterminate-output" class="callout-inner">
<h3 class="callout-title">What about Testing Against Indeterminate Output?</h3>
<div class="callout-content">
<p>What if your implementation depends on a degree of random behaviour?
This can be desired within a number of applications, particularly in
simulations (for example, molecular simulations) or other stochastic
behavioural models of complex systems. So how can you test against such
systems if the outputs are different when given the same inputs?</p>
<p>One way is to <em>remove the randomness</em> during testing. For
those portions of your code that use a language feature or library to
generate a random number, you can instead produce a known sequence of
numbers instead when testing, to make the results deterministic and
hence easier to test against. You could encapsulate this different
behaviour in separate functions, methods, or classes and call the
appropriate one depending on whether you are testing or not. This is
essentially a type of <strong>mocking</strong>, where you are creating a
“mock” version that mimics some behaviour for the purposes of
testing.</p>
<p>Another way is to <em>control the randomness</em> during testing to
provide results that are deterministic - the same each time.
Implementations of randomness in computing languages, including Python,
are actually never truly random - they are
<strong>pseudorandom</strong>: the sequence of ‘random’ numbers are
typically generated using a mathematical algorithm. A
<strong>seed</strong> value is used to initialise an implementation’s
random number generator, and from that point, the sequence of numbers is
actually deterministic. Many implementations just use the system time as
the default seed, but you can set your own. By doing so, the generated
sequence of numbers is the same, e.g. using Python’s <code>random</code>
library to randomly select a sample of ten numbers from a sequence
between 0-99:</p>
<div class="codewrapper sourceCode" id="cb10">
<h3 class="code-label">PYTHON<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="sourceCode python" tabindex="0"><code class="sourceCode python"><span id="cb10-1"><a href="#cb10-1" tabindex="-1"></a><span class="im">import</span> random</span>
<span id="cb10-2"><a href="#cb10-2" tabindex="-1"></a></span>
<span id="cb10-3"><a href="#cb10-3" tabindex="-1"></a>random.seed(<span class="dv">1</span>)</span>
<span id="cb10-4"><a href="#cb10-4" tabindex="-1"></a><span class="bu">print</span>(random.sample(<span class="bu">range</span>(<span class="dv">0</span>, <span class="dv">100</span>), <span class="dv">10</span>))</span>
<span id="cb10-5"><a href="#cb10-5" tabindex="-1"></a>random.seed(<span class="dv">1</span>)</span>
<span id="cb10-6"><a href="#cb10-6" tabindex="-1"></a><span class="bu">print</span>(random.sample(<span class="bu">range</span>(<span class="dv">0</span>, <span class="dv">100</span>), <span class="dv">10</span>))</span></code></pre>
</div>
<p>Will produce:</p>
<div class="codewrapper">
<h3 class="code-label">OUTPUT<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="output" tabindex="0"><code>[17, 72, 97, 8, 32, 15, 63, 57, 60, 83]
[17, 72, 97, 8, 32, 15, 63, 57, 60, 83]</code></pre>
</div>
<p>So since your program’s randomness is essentially eliminated, your
tests can be written to test against the known output. The trick of
course, is to ensure that the output being testing against is
definitively correct!</p>
<p>The other thing you can do while keeping the random behaviour, is to
<em>test the output data against expected constraints</em> of that
output. For example, if you know that all data should be within
particular ranges, or within a particular statistical distribution type
(e.g. normal distribution over time), you can test against that,
conducting multiple test runs that take advantage of the randomness to
fill the known “space” of expected results. Note that this is not as
precise or complete, and bear in mind this could mean you need to run
<em>a lot</em> of tests which may take considerable time.</p>
</div>
</div>
</div>
</section><section><h2 class="section-heading" id="test-driven-development">Test Driven Development<a class="anchor" aria-label="anchor" href="#test-driven-development"></a></h2>
<hr class="half-width"><p>In the <a href="21-automatically-testing-software.html">previous
episode</a> we learnt how to create <em>unit tests</em> to make sure our
code is behaving as we intended. <strong>Test Driven
Development</strong> (TDD) is an extension of this. If we can define a
set of tests for everything our code needs to do, then why not treat
those tests as the specification.</p>
<p>When doing Test Driven Development, we write our tests first and only
write enough code to make the tests pass. We tend to do this at the
level of individual features - define the feature, write the tests,
write the code. The main advantages are:</p>
<ul><li>It forces us to think about how our code will be used before we
write it</li>
<li>It prevents us from doing work that we do not need to do, e.g. “I
might need this later…”</li>
<li>It forces us to test that the tests <em>fail</em> before we have
implemented the code, meaning we do not inadvertently forget to add the
correct asserts.</li>
</ul><p>You may also see this process called <strong>Red, Green,
Refactor</strong>: ‘Red’ for the failing tests, ‘Green’ for the code
that makes them pass, then ‘Refactor’ (tidy up) the result.</p>
<p>For the challenges from here on, try to first convert the
specification into a unit test, then try writing the code to pass the
test.</p>
</section><section><h2 class="section-heading" id="limits-to-testing">Limits to Testing<a class="anchor" aria-label="anchor" href="#limits-to-testing"></a></h2>
<hr class="half-width"><p>Like any other piece of experimental apparatus, a complex program
requires a much higher investment in testing than a simple one. Putting
it another way, a small script that is only going to be used once, to
produce one figure, probably does not need separate testing: its output
is either correct or not. A linear algebra library that will be used by
thousands of people in twice that number of applications over the course
of a decade, on the other hand, definitely does. The key is identify and
prioritise against what will most affect the code’s ability to generate
accurate results.</p>
<p>it is also important to remember that unit testing cannot catch every
bug in an application, no matter how many tests you write. To mitigate
this manual testing is also important. Also remember to test using as
much input data as you can, since very often code is developed and
tested against the same small sets of data. Increasing the amount of
data you test against - from numerous sources - gives you greater
confidence that the results are correct.</p>
<p>Our software will inevitably increase in complexity as it develops.
Using automated testing where appropriate can save us considerable time,
especially in the long term, and allows others to verify against correct
behaviour.</p>
</section><section><h2 class="section-heading" id="optional-exercises">Optional exercises<a class="anchor" aria-label="anchor" href="#optional-exercises"></a></h2>
<hr class="half-width"><p>Checkout <a href="25-section2-optional-exercises.html">these optional
exercises</a> to learn more about code coverage.</p>
<div id="keypoints1" class="callout keypoints">
<div class="callout-square">
<i class="callout-icon" data-feather="key"></i>
</div>
<div class="callout-inner">
<h3 class="callout-title">Key Points</h3>
<div class="callout-content">
<ul><li>We can assign multiple inputs to tests using parametrisation.</li>
<li>it is important to understand the <strong>coverage</strong> of our
tests across our code.</li>
<li>Writing unit tests takes time, so apply them where it makes the most
sense.</li>
</ul></div>
</div>
</div>
</section></div> <!-- / div.lesson-content -->
    </main><!-- / main#main-content.main-content --><nav class="bottom-pagination mx-md-4" aria-label="Previous and Next Chapter"><div class="d-block d-sm-block d-md-none">
        <a class="chapter-link" href="21-automatically-testing-software.html"><i aria-hidden="true" class="small-arrow" data-feather="arrow-left"></i>Previous</a>
        <a class="chapter-link float-end" href="23-continuous-integration-automated-testing.html">Next<i aria-hidden="true" class="small-arrow" data-feather="arrow-right"></i></a>
      </div>
      <!-- content for large screens -->
      <div class="d-none d-sm-none d-md-block">
        <a class="chapter-link" href="21-automatically-testing-software.html" rel="prev">
          <i aria-hidden="true" class="small-arrow" data-feather="arrow-left"></i>
          Previous: 2.1 Automatically
        </a>
        <a class="chapter-link float-end" href="23-continuous-integration-automated-testing.html" rel="next">
          Next: 2.3 Continuous...
          <i aria-hidden="true" class="small-arrow" data-feather="arrow-right"></i>
        </a>
      </div>
    </nav></div> <!-- / div.primary-content.col-xs-12 -->
<!-- END:   inst/pkgdown/templates/content-instructor.html-->

      </div><!--/div.row-->
      		<footer class="row footer mx-md-3"><hr><div class="col-md-6">
        <p>This lesson is subject to the <a href="CODE_OF_CONDUCT.html">Code of Conduct</a></p>
        <p>

        <a href="https://github.com/carpentries-incubator/python-intermediate-development/edit/main/episodes/22-scaling-up-unit-testing.md" class="external-link">Edit on GitHub</a>

	
        | <a href="https://github.com/carpentries-incubator/python-intermediate-development/blob/main/CONTRIBUTING.md" class="external-link">Contributing</a>
        | <a href="https://github.com/carpentries-incubator/python-intermediate-development/" class="external-link">Source</a></p>
				<p><a href="https://github.com/carpentries-incubator/python-intermediate-development/blob/main/CITATION" class="external-link">Cite</a> | <a href="mailto:info@software.ac.uk">Contact</a> | <a href="https://carpentries.org/about/" class="external-link">About</a></p>
			</div>
			<div class="col-md-6">

        <p>Materials licensed under <a href="LICENSE.html">CC-BY 4.0</a> by the authors</p>

        <p>Template licensed under <a href="https://creativecommons.org/licenses/by-sa/4.0/" class="external-link">CC-BY 4.0</a> by <a href="https://carpentries.org/" class="external-link">The Carpentries</a></p>
        <p>Built with <a href="https://github.com/carpentries/sandpaper/tree/0.16.11" class="external-link">sandpaper (0.16.11)</a>, <a href="https://github.com/carpentries/pegboard/tree/0.7.9" class="external-link">pegboard (0.7.9)</a>, and <a href="https://github.com/carpentries/varnish/tree/1.0.5" class="external-link">varnish (1.0.5)</a></p>
			</div>
		</footer></div> <!-- / div.container -->
	<div id="to-top">
		<a href="#top">
      <i class="search-icon" data-feather="arrow-up" role="img" aria-label="Back To Top"></i><br><!-- <span class="d-none d-sm-none d-md-none d-lg-none d-xl-block">Back</span> To Top --><span class="d-none d-sm-none d-md-none d-lg-none d-xl-block">Back</span> To Top
		</a>
	</div>
  <script type="application/ld+json">
    {
  "@context": "https://schema.org",
  "@type": "TrainingMaterial",
  "@id": "https://carpentries-incubator.github.io/python-intermediate-development/22-scaling-up-unit-testing.html",
  "inLanguage": "en",
  "dct:conformsTo": "https://bioschemas.org/profiles/TrainingMaterial/1.0-RELEASE",
  "description": "A Carpentries Lesson teaching foundational data and coding skills to researchers worldwide",
  "keywords": "software, data, lesson, The Carpentries",
  "name": "2.2 Scaling Up Unit Testing",
  "creativeWorkStatus": "active",
  "url": "https://carpentries-incubator.github.io/python-intermediate-development/22-scaling-up-unit-testing.html",
  "identifier": "https://carpentries-incubator.github.io/python-intermediate-development/22-scaling-up-unit-testing.html",
  "dateCreated": "2020-04-23",
  "dateModified": "2024-12-06",
  "datePublished": "2025-02-25"
}

  </script><script>
		feather.replace();
	</script></body></html><!-- END:   inst/pkgdown/templates/layout.html-->

